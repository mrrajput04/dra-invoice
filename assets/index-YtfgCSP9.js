(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var Qm={exports:{}},ac={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ky;function X4(){if(ky)return ac;ky=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,o){var u=null;if(o!==void 0&&(u=""+o),a.key!==void 0&&(u=""+a.key),"key"in a){o={};for(var f in a)f!=="key"&&(o[f]=a[f])}else o=a;return a=o.ref,{$$typeof:t,type:r,key:u,ref:a!==void 0?a:null,props:o}}return ac.Fragment=e,ac.jsx=n,ac.jsxs=n,ac}var Ly;function W4(){return Ly||(Ly=1,Qm.exports=X4()),Qm.exports}var C=W4(),Zm={exports:{}},rt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vy;function K4(){if(Vy)return rt;Vy=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function x(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function b(Q,_e,U){this.props=Q,this.context=_e,this.refs=T,this.updater=U||E}b.prototype.isReactComponent={},b.prototype.setState=function(Q,_e){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,_e,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function k(){}k.prototype=b.prototype;function q(Q,_e,U){this.props=Q,this.context=_e,this.refs=T,this.updater=U||E}var Y=q.prototype=new k;Y.constructor=q,w(Y,b.prototype),Y.isPureReactComponent=!0;var ee=Array.isArray,he={H:null,A:null,T:null,S:null,V:null},Ae=Object.prototype.hasOwnProperty;function D(Q,_e,U,W,K,Z){return U=Z.ref,{$$typeof:t,type:Q,key:_e,ref:U!==void 0?U:null,props:Z}}function I(Q,_e){return D(Q.type,_e,void 0,void 0,void 0,Q.props)}function R(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function P(Q){var _e={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(U){return _e[U]})}var B=/\/+/g;function H(Q,_e){return typeof Q=="object"&&Q!==null&&Q.key!=null?P(""+Q.key):_e.toString(36)}function V(){}function Je(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(V,V):(Q.status="pending",Q.then(function(_e){Q.status==="pending"&&(Q.status="fulfilled",Q.value=_e)},function(_e){Q.status==="pending"&&(Q.status="rejected",Q.reason=_e)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function He(Q,_e,U,W,K){var Z=typeof Q;(Z==="undefined"||Z==="boolean")&&(Q=null);var ce=!1;if(Q===null)ce=!0;else switch(Z){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(Q.$$typeof){case t:case e:ce=!0;break;case g:return ce=Q._init,He(ce(Q._payload),_e,U,W,K)}}if(ce)return K=K(Q),ce=W===""?"."+H(Q,0):W,ee(K)?(U="",ce!=null&&(U=ce.replace(B,"$&/")+"/"),He(K,_e,U,"",function(Be){return Be})):K!=null&&(R(K)&&(K=I(K,U+(K.key==null||Q&&Q.key===K.key?"":(""+K.key).replace(B,"$&/")+"/")+ce)),_e.push(K)),1;ce=0;var Le=W===""?".":W+":";if(ee(Q))for(var Fe=0;Fe<Q.length;Fe++)W=Q[Fe],Z=Le+H(W,Fe),ce+=He(W,_e,U,Z,K);else if(Fe=x(Q),typeof Fe=="function")for(Q=Fe.call(Q),Fe=0;!(W=Q.next()).done;)W=W.value,Z=Le+H(W,Fe++),ce+=He(W,_e,U,Z,K);else if(Z==="object"){if(typeof Q.then=="function")return He(Je(Q),_e,U,W,K);throw _e=String(Q),Error("Objects are not valid as a React child (found: "+(_e==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":_e)+"). If you meant to render a collection of children, use an array instead.")}return ce}function de(Q,_e,U){if(Q==null)return Q;var W=[],K=0;return He(Q,W,"","",function(Z){return _e.call(U,Z,K++)}),W}function Ce(Q){if(Q._status===-1){var _e=Q._result;_e=_e(),_e.then(function(U){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=U)},function(U){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=U)}),Q._status===-1&&(Q._status=0,Q._result=_e)}if(Q._status===1)return Q._result.default;throw Q._result}var ze=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var _e=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(_e))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)};function Xe(){}return rt.Children={map:de,forEach:function(Q,_e,U){de(Q,function(){_e.apply(this,arguments)},U)},count:function(Q){var _e=0;return de(Q,function(){_e++}),_e},toArray:function(Q){return de(Q,function(_e){return _e})||[]},only:function(Q){if(!R(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},rt.Component=b,rt.Fragment=n,rt.Profiler=a,rt.PureComponent=q,rt.StrictMode=r,rt.Suspense=d,rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=he,rt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return he.H.useMemoCache(Q)}},rt.cache=function(Q){return function(){return Q.apply(null,arguments)}},rt.cloneElement=function(Q,_e,U){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var W=w({},Q.props),K=Q.key,Z=void 0;if(_e!=null)for(ce in _e.ref!==void 0&&(Z=void 0),_e.key!==void 0&&(K=""+_e.key),_e)!Ae.call(_e,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&_e.ref===void 0||(W[ce]=_e[ce]);var ce=arguments.length-2;if(ce===1)W.children=U;else if(1<ce){for(var Le=Array(ce),Fe=0;Fe<ce;Fe++)Le[Fe]=arguments[Fe+2];W.children=Le}return D(Q.type,K,void 0,void 0,Z,W)},rt.createContext=function(Q){return Q={$$typeof:u,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:o,_context:Q},Q},rt.createElement=function(Q,_e,U){var W,K={},Z=null;if(_e!=null)for(W in _e.key!==void 0&&(Z=""+_e.key),_e)Ae.call(_e,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(K[W]=_e[W]);var ce=arguments.length-2;if(ce===1)K.children=U;else if(1<ce){for(var Le=Array(ce),Fe=0;Fe<ce;Fe++)Le[Fe]=arguments[Fe+2];K.children=Le}if(Q&&Q.defaultProps)for(W in ce=Q.defaultProps,ce)K[W]===void 0&&(K[W]=ce[W]);return D(Q,Z,void 0,void 0,null,K)},rt.createRef=function(){return{current:null}},rt.forwardRef=function(Q){return{$$typeof:f,render:Q}},rt.isValidElement=R,rt.lazy=function(Q){return{$$typeof:g,_payload:{_status:-1,_result:Q},_init:Ce}},rt.memo=function(Q,_e){return{$$typeof:h,type:Q,compare:_e===void 0?null:_e}},rt.startTransition=function(Q){var _e=he.T,U={};he.T=U;try{var W=Q(),K=he.S;K!==null&&K(U,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(Xe,ze)}catch(Z){ze(Z)}finally{he.T=_e}},rt.unstable_useCacheRefresh=function(){return he.H.useCacheRefresh()},rt.use=function(Q){return he.H.use(Q)},rt.useActionState=function(Q,_e,U){return he.H.useActionState(Q,_e,U)},rt.useCallback=function(Q,_e){return he.H.useCallback(Q,_e)},rt.useContext=function(Q){return he.H.useContext(Q)},rt.useDebugValue=function(){},rt.useDeferredValue=function(Q,_e){return he.H.useDeferredValue(Q,_e)},rt.useEffect=function(Q,_e,U){var W=he.H;if(typeof U=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(Q,_e)},rt.useId=function(){return he.H.useId()},rt.useImperativeHandle=function(Q,_e,U){return he.H.useImperativeHandle(Q,_e,U)},rt.useInsertionEffect=function(Q,_e){return he.H.useInsertionEffect(Q,_e)},rt.useLayoutEffect=function(Q,_e){return he.H.useLayoutEffect(Q,_e)},rt.useMemo=function(Q,_e){return he.H.useMemo(Q,_e)},rt.useOptimistic=function(Q,_e){return he.H.useOptimistic(Q,_e)},rt.useReducer=function(Q,_e,U){return he.H.useReducer(Q,_e,U)},rt.useRef=function(Q){return he.H.useRef(Q)},rt.useState=function(Q){return he.H.useState(Q)},rt.useSyncExternalStore=function(Q,_e,U){return he.H.useSyncExternalStore(Q,_e,U)},rt.useTransition=function(){return he.H.useTransition()},rt.version="19.1.0",rt}var By;function rg(){return By||(By=1,Zm.exports=K4()),Zm.exports}var ve=rg(),Jm={exports:{}},sc={},ep={exports:{}},tp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Uy;function Q4(){return Uy||(Uy=1,function(t){function e(de,Ce){var ze=de.length;de.push(Ce);e:for(;0<ze;){var Xe=ze-1>>>1,Q=de[Xe];if(0<a(Q,Ce))de[Xe]=Ce,de[ze]=Q,ze=Xe;else break e}}function n(de){return de.length===0?null:de[0]}function r(de){if(de.length===0)return null;var Ce=de[0],ze=de.pop();if(ze!==Ce){de[0]=ze;e:for(var Xe=0,Q=de.length,_e=Q>>>1;Xe<_e;){var U=2*(Xe+1)-1,W=de[U],K=U+1,Z=de[K];if(0>a(W,ze))K<Q&&0>a(Z,W)?(de[Xe]=Z,de[K]=ze,Xe=K):(de[Xe]=W,de[U]=ze,Xe=U);else if(K<Q&&0>a(Z,ze))de[Xe]=Z,de[K]=ze,Xe=K;else break e}}return Ce}function a(de,Ce){var ze=de.sortIndex-Ce.sortIndex;return ze!==0?ze:de.id-Ce.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();t.unstable_now=function(){return u.now()-f}}var d=[],h=[],g=1,y=null,x=3,E=!1,w=!1,T=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,Y=typeof setImmediate<"u"?setImmediate:null;function ee(de){for(var Ce=n(h);Ce!==null;){if(Ce.callback===null)r(h);else if(Ce.startTime<=de)r(h),Ce.sortIndex=Ce.expirationTime,e(d,Ce);else break;Ce=n(h)}}function he(de){if(T=!1,ee(de),!w)if(n(d)!==null)w=!0,Ae||(Ae=!0,H());else{var Ce=n(h);Ce!==null&&He(he,Ce.startTime-de)}}var Ae=!1,D=-1,I=5,R=-1;function P(){return b?!0:!(t.unstable_now()-R<I)}function B(){if(b=!1,Ae){var de=t.unstable_now();R=de;var Ce=!0;try{e:{w=!1,T&&(T=!1,q(D),D=-1),E=!0;var ze=x;try{t:{for(ee(de),y=n(d);y!==null&&!(y.expirationTime>de&&P());){var Xe=y.callback;if(typeof Xe=="function"){y.callback=null,x=y.priorityLevel;var Q=Xe(y.expirationTime<=de);if(de=t.unstable_now(),typeof Q=="function"){y.callback=Q,ee(de),Ce=!0;break t}y===n(d)&&r(d),ee(de)}else r(d);y=n(d)}if(y!==null)Ce=!0;else{var _e=n(h);_e!==null&&He(he,_e.startTime-de),Ce=!1}}break e}finally{y=null,x=ze,E=!1}Ce=void 0}}finally{Ce?H():Ae=!1}}}var H;if(typeof Y=="function")H=function(){Y(B)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Je=V.port2;V.port1.onmessage=B,H=function(){Je.postMessage(null)}}else H=function(){k(B,0)};function He(de,Ce){D=k(function(){de(t.unstable_now())},Ce)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(de){de.callback=null},t.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<de?Math.floor(1e3/de):5},t.unstable_getCurrentPriorityLevel=function(){return x},t.unstable_next=function(de){switch(x){case 1:case 2:case 3:var Ce=3;break;default:Ce=x}var ze=x;x=Ce;try{return de()}finally{x=ze}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(de,Ce){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var ze=x;x=de;try{return Ce()}finally{x=ze}},t.unstable_scheduleCallback=function(de,Ce,ze){var Xe=t.unstable_now();switch(typeof ze=="object"&&ze!==null?(ze=ze.delay,ze=typeof ze=="number"&&0<ze?Xe+ze:Xe):ze=Xe,de){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ze+Q,de={id:g++,callback:Ce,priorityLevel:de,startTime:ze,expirationTime:Q,sortIndex:-1},ze>Xe?(de.sortIndex=ze,e(h,de),n(d)===null&&de===n(h)&&(T?(q(D),D=-1):T=!0,He(he,ze-Xe))):(de.sortIndex=Q,e(d,de),w||E||(w=!0,Ae||(Ae=!0,H()))),de},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(de){var Ce=x;return function(){var ze=x;x=Ce;try{return de.apply(this,arguments)}finally{x=ze}}}}(tp)),tp}var jy;function Z4(){return jy||(jy=1,ep.exports=Q4()),ep.exports}var np={exports:{}},Zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zy;function J4(){if(zy)return Zn;zy=1;var t=rg();function e(d){var h="https://react.dev/errors/"+d;if(1<arguments.length){h+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)h+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+d+"; visit "+h+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(d,h,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:d,containerInfo:h,implementation:g}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(d,h){if(d==="font")return"";if(typeof h=="string")return h==="use-credentials"?h:""}return Zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Zn.createPortal=function(d,h){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!h||h.nodeType!==1&&h.nodeType!==9&&h.nodeType!==11)throw Error(e(299));return o(d,h,null,g)},Zn.flushSync=function(d){var h=u.T,g=r.p;try{if(u.T=null,r.p=2,d)return d()}finally{u.T=h,r.p=g,r.d.f()}},Zn.preconnect=function(d,h){typeof d=="string"&&(h?(h=h.crossOrigin,h=typeof h=="string"?h==="use-credentials"?h:"":void 0):h=null,r.d.C(d,h))},Zn.prefetchDNS=function(d){typeof d=="string"&&r.d.D(d)},Zn.preinit=function(d,h){if(typeof d=="string"&&h&&typeof h.as=="string"){var g=h.as,y=f(g,h.crossOrigin),x=typeof h.integrity=="string"?h.integrity:void 0,E=typeof h.fetchPriority=="string"?h.fetchPriority:void 0;g==="style"?r.d.S(d,typeof h.precedence=="string"?h.precedence:void 0,{crossOrigin:y,integrity:x,fetchPriority:E}):g==="script"&&r.d.X(d,{crossOrigin:y,integrity:x,fetchPriority:E,nonce:typeof h.nonce=="string"?h.nonce:void 0})}},Zn.preinitModule=function(d,h){if(typeof d=="string")if(typeof h=="object"&&h!==null){if(h.as==null||h.as==="script"){var g=f(h.as,h.crossOrigin);r.d.M(d,{crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0})}}else h==null&&r.d.M(d)},Zn.preload=function(d,h){if(typeof d=="string"&&typeof h=="object"&&h!==null&&typeof h.as=="string"){var g=h.as,y=f(g,h.crossOrigin);r.d.L(d,g,{crossOrigin:y,integrity:typeof h.integrity=="string"?h.integrity:void 0,nonce:typeof h.nonce=="string"?h.nonce:void 0,type:typeof h.type=="string"?h.type:void 0,fetchPriority:typeof h.fetchPriority=="string"?h.fetchPriority:void 0,referrerPolicy:typeof h.referrerPolicy=="string"?h.referrerPolicy:void 0,imageSrcSet:typeof h.imageSrcSet=="string"?h.imageSrcSet:void 0,imageSizes:typeof h.imageSizes=="string"?h.imageSizes:void 0,media:typeof h.media=="string"?h.media:void 0})}},Zn.preloadModule=function(d,h){if(typeof d=="string")if(h){var g=f(h.as,h.crossOrigin);r.d.m(d,{as:typeof h.as=="string"&&h.as!=="script"?h.as:void 0,crossOrigin:g,integrity:typeof h.integrity=="string"?h.integrity:void 0})}else r.d.m(d)},Zn.requestFormReset=function(d){r.d.r(d)},Zn.unstable_batchedUpdates=function(d,h){return d(h)},Zn.useFormState=function(d,h,g){return u.H.useFormState(d,h,g)},Zn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Zn.version="19.1.0",Zn}var Hy;function eb(){if(Hy)return np.exports;Hy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),np.exports=J4(),np.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gy;function tb(){if(Gy)return sc;Gy=1;var t=Z4(),e=rg(),n=eb();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(r(188))}function d(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var l=i,c=s;;){var p=l.return;if(p===null)break;var v=p.alternate;if(v===null){if(c=p.return,c!==null){l=c;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===l)return f(p),i;if(v===c)return f(p),s;v=v.sibling}throw Error(r(188))}if(l.return!==c.return)l=p,c=v;else{for(var S=!1,O=p.child;O;){if(O===l){S=!0,l=p,c=v;break}if(O===c){S=!0,c=p,l=v;break}O=O.sibling}if(!S){for(O=v.child;O;){if(O===l){S=!0,l=v,c=p;break}if(O===c){S=!0,c=v,l=p;break}O=O.sibling}if(!S)throw Error(r(189))}}if(l.alternate!==c)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?i:s}function h(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=h(i),s!==null)return s;i=i.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),x=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),Y=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),D=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function H(i){return i===null||typeof i!="object"?null:(i=B&&i[B]||i["@@iterator"],typeof i=="function"?i:null)}var V=Symbol.for("react.client.reference");function Je(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===V?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case b:return"Profiler";case T:return"StrictMode";case he:return"Suspense";case Ae:return"SuspenseList";case R:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case Y:return(i.displayName||"Context")+".Provider";case q:return(i._context.displayName||"Context")+".Consumer";case ee:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case D:return s=i.displayName||null,s!==null?s:Je(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return Je(i(s))}catch{}}return null}var He=Array.isArray,de=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ce=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ze={pending:!1,data:null,method:null,action:null},Xe=[],Q=-1;function _e(i){return{current:i}}function U(i){0>Q||(i.current=Xe[Q],Xe[Q]=null,Q--)}function W(i,s){Q++,Xe[Q]=i.current,i.current=s}var K=_e(null),Z=_e(null),ce=_e(null),Le=_e(null);function Fe(i,s){switch(W(ce,s),W(Z,i),W(K,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?cy(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=cy(s),i=fy(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}U(K),W(K,i)}function Be(){U(K),U(Z),U(ce)}function Me(i){i.memoizedState!==null&&W(Le,i);var s=K.current,l=fy(s,i.type);s!==l&&(W(Z,i),W(K,l))}function ut(i){Z.current===i&&(U(K),U(Z)),Le.current===i&&(U(Le),ec._currentValue=ze)}var nt=Object.prototype.hasOwnProperty,Kt=t.unstable_scheduleCallback,ot=t.unstable_cancelCallback,ir=t.unstable_shouldYield,Ut=t.unstable_requestPaint,Ve=t.unstable_now,Wn=t.unstable_getCurrentPriorityLevel,ar=t.unstable_ImmediatePriority,mr=t.unstable_UserBlockingPriority,pr=t.unstable_NormalPriority,Bo=t.unstable_LowPriority,xi=t.unstable_IdlePriority,Kn=t.log,ea=t.unstable_setDisableYieldValue,Ht=null,_t=null;function an(i){if(typeof Kn=="function"&&ea(i),_t&&typeof _t.setStrictMode=="function")try{_t.setStrictMode(Ht,i)}catch{}}var bn=Math.clz32?Math.clz32:yi,Vs=Math.log,Uo=Math.LN2;function yi(i){return i>>>=0,i===0?32:31-(Vs(i)/Uo|0)|0}var _i=256,Ei=4194304;function gr(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function ka(i,s,l){var c=i.pendingLanes;if(c===0)return 0;var p=0,v=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var O=c&134217727;return O!==0?(c=O&~v,c!==0?p=gr(c):(S&=O,S!==0?p=gr(S):l||(l=O&~i,l!==0&&(p=gr(l))))):(O=c&~v,O!==0?p=gr(O):S!==0?p=gr(S):l||(l=c&~i,l!==0&&(p=gr(l)))),p===0?0:s!==0&&s!==p&&(s&v)===0&&(v=p&-p,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:p}function ta(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function La(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Va(){var i=_i;return _i<<=1,(_i&4194048)===0&&(_i=256),i}function Ba(){var i=Ei;return Ei<<=1,(Ei&62914560)===0&&(Ei=4194304),i}function ai(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function si(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ti(i,s,l,c,p,v){var S=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var O=i.entanglements,X=i.expirationTimes,se=i.hiddenUpdates;for(l=S&~l;0<l;){var ye=31-bn(l),Te=1<<ye;O[ye]=0,X[ye]=-1;var ue=se[ye];if(ue!==null)for(se[ye]=null,ye=0;ye<ue.length;ye++){var fe=ue[ye];fe!==null&&(fe.lane&=-536870913)}l&=~Te}c!==0&&jr(i,c,0),v!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=v&~(S&~s))}function jr(i,s,l){i.pendingLanes|=s,i.suspendedLanes&=~s;var c=31-bn(s);i.entangledLanes|=s,i.entanglements[c]=i.entanglements[c]|1073741824|l&4194090}function Bs(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var c=31-bn(l),p=1<<c;p&s|i[c]&s&&(i[c]|=s),l&=~p}}function wi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ua(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ai(){var i=Ce.p;return i!==0?i:(i=window.event,i===void 0?32:Iy(i.type))}function jo(i,s){var l=Ce.p;try{return Ce.p=i,s()}finally{Ce.p=l}}var Gt=Math.random().toString(36).slice(2),sn="__reactFiber$"+Gt,Xt="__reactProps$"+Gt,vr="__reactContainer$"+Gt,Us="__reactEvents$"+Gt,ou="__reactListeners$"+Gt,N="__reactHandles$"+Gt,z="__reactResources$"+Gt,M="__reactMarker$"+Gt;function L(i){delete i[sn],delete i[Xt],delete i[Us],delete i[ou],delete i[N]}function j(i){var s=i[sn];if(s)return s;for(var l=i.parentNode;l;){if(s=l[vr]||l[sn]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=py(i);i!==null;){if(l=i[sn])return l;i=py(i)}return s}i=l,l=i.parentNode}return null}function G(i){if(i=i[sn]||i[vr]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function ae(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function me(i){var s=i[z];return s||(s=i[z]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ne(i){i[M]=!0}var oe=new Set,le={};function be(i,s){Ne(i,s),Ne(i+"Capture",s)}function Ne(i,s){for(le[i]=s,i=0;i<s.length;i++)oe.add(s[i])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Re={},Pe={};function Qe(i){return nt.call(Pe,i)?!0:nt.call(Re,i)?!1:Ue.test(i)?Pe[i]=!0:(Re[i]=!0,!1)}function Et(i,s,l){if(Qe(s))if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+l)}}function dt(i,s,l){if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+l)}}function mt(i,s,l,c){if(c===null)i.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(s,l,""+c)}}var Cr,Si;function sr(i){if(Cr===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Cr=s&&s[1]||"",Si=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Cr+i+Si}var xr=!1;function bi(i,s){if(!i||xr)return"";xr=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(fe){var ue=fe}Reflect.construct(i,[],Te)}else{try{Te.call()}catch(fe){ue=fe}i.call(Te.prototype)}}else{try{throw Error()}catch(fe){ue=fe}(Te=i())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(fe){if(fe&&ue&&typeof fe.stack=="string")return[fe.stack,ue.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),S=v[0],O=v[1];if(S&&O){var X=S.split(`
`),se=O.split(`
`);for(p=c=0;c<X.length&&!X[c].includes("DetermineComponentFrameRoot");)c++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(c===X.length||p===se.length)for(c=X.length-1,p=se.length-1;1<=c&&0<=p&&X[c]!==se[p];)p--;for(;1<=c&&0<=p;c--,p--)if(X[c]!==se[p]){if(c!==1||p!==1)do if(c--,p--,0>p||X[c]!==se[p]){var ye=`
`+X[c].replace(" at new "," at ");return i.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",i.displayName)),ye}while(1<=c&&0<=p);break}}}finally{xr=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?sr(l):""}function or(i){switch(i.tag){case 26:case 27:case 5:return sr(i.type);case 16:return sr("Lazy");case 13:return sr("Suspense");case 19:return sr("SuspenseList");case 0:case 15:return bi(i.type,!1);case 11:return bi(i.type.render,!1);case 1:return bi(i.type,!0);case 31:return sr("Activity");default:return""}}function zo(i){try{var s="";do s+=or(i),i=i.return;while(i);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function lr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function lu(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function td(i){var s=lu(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),c=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,v=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return p.call(this)},set:function(S){c=""+S,v.call(this,S)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Ho(i){i._valueTracker||(i._valueTracker=td(i))}function uu(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),c="";return i&&(c=lu(i)?i.checked?"true":"false":i.value),i=c,i!==l?(s.setValue(i),!0):!1}function js(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var nd=/[\n"\\]/g;function cn(i){return i.replace(nd,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Rr(i,s,l,c,p,v,S,O){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),s!=null?S==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+lr(s)):i.value!==""+lr(s)&&(i.value=""+lr(s)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),s!=null?ja(i,S,lr(s)):l!=null?ja(i,S,lr(l)):c!=null&&i.removeAttribute("value"),p==null&&v!=null&&(i.defaultChecked=!!v),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?i.name=""+lr(O):i.removeAttribute("name")}function zs(i,s,l,c,p,v,S,O){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+lr(l):"",s=s!=null?""+lr(s):l,O||s===i.value||(i.value=s),i.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,i.checked=O?i.checked:!!c,i.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S)}function ja(i,s,l){s==="number"&&js(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function na(i,s,l,c){if(i=i.options,s){s={};for(var p=0;p<l.length;p++)s["$"+l[p]]=!0;for(l=0;l<i.length;l++)p=s.hasOwnProperty("$"+i[l].value),i[l].selected!==p&&(i[l].selected=p),p&&c&&(i[l].defaultSelected=!0)}else{for(l=""+lr(l),s=null,p=0;p<i.length;p++){if(i[p].value===l){i[p].selected=!0,c&&(i[p].defaultSelected=!0);return}s!==null||i[p].disabled||(s=i[p])}s!==null&&(s.selected=!0)}}function Mt(i,s,l){if(s!=null&&(s=""+lr(s),s!==i.value&&(i.value=s),l==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=l!=null?""+lr(l):""}function Hs(i,s,l,c){if(s==null){if(c!=null){if(l!=null)throw Error(r(92));if(He(c)){if(1<c.length)throw Error(r(93));c=c[0]}l=c}l==null&&(l=""),s=l}l=lr(s),i.defaultValue=l,c=i.textContent,c===l&&c!==""&&c!==null&&(i.value=c)}function zr(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var Gs=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function of(i,s,l){var c=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":c?i.setProperty(s,l):typeof l!="number"||l===0||Gs.has(s)?s==="float"?i.cssFloat=l:i[s]=(""+l).trim():i[s]=l+"px"}function cu(i,s,l){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&l[p]!==c&&of(i,p,c)}else for(var v in s)s.hasOwnProperty(v)&&of(i,v,s[v])}function fu(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var rd=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),id=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Go(i){return id.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var ra=null;function Hr(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ia=null,aa=null;function hu(i){var s=G(i);if(s&&(i=s.stateNode)){var l=i[Xt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Rr(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+cn(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var c=l[s];if(c!==i&&c.form===i.form){var p=c[Xt]||null;if(!p)throw Error(r(90));Rr(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<l.length;s++)c=l[s],c.form===i.form&&uu(c)}break e;case"textarea":Mt(i,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&na(i,!!l.multiple,s,!1)}}}var Ci=!1;function lf(i,s,l){if(Ci)return i(s,l);Ci=!0;try{var c=i(s);return c}finally{if(Ci=!1,(ia!==null||aa!==null)&&(th(),ia&&(s=ia,i=aa,aa=ia=null,hu(s),i)))for(s=0;s<i.length;s++)hu(i[s])}}function qs(i,s){var l=i.stateNode;if(l===null)return null;var c=l[Xt]||null;if(c===null)return null;l=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(r(231,s,typeof l));return l}var oi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gr=!1;if(oi)try{var $s={};Object.defineProperty($s,"passive",{get:function(){Gr=!0}}),window.addEventListener("test",$s,$s),window.removeEventListener("test",$s,$s)}catch{Gr=!1}var Ri=null,za=null,sa=null;function du(){if(sa)return sa;var i,s=za,l=s.length,c,p="value"in Ri?Ri.value:Ri.textContent,v=p.length;for(i=0;i<l&&s[i]===p[i];i++);var S=l-i;for(c=1;c<=S&&s[l-c]===p[v-c];c++);return sa=p.slice(i,1<c?1-c:void 0)}function Ni(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ii(){return!0}function mu(){return!1}function Cn(i){function s(l,c,p,v,S){this._reactName=l,this._targetInst=p,this.type=c,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var O in i)i.hasOwnProperty(O)&&(l=i[O],this[O]=l?l(v):v[O]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ii:mu,this.isPropagationStopped=mu,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ii)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ii)},persist:function(){},isPersistent:Ii}),s}var bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qo=Cn(bt),Ys=g({},bt,{view:0,detail:0}),uf=Cn(Ys),$o,Yo,Di,Xs=g({},Ys,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qs,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Di&&(Di&&i.type==="mousemove"?($o=i.screenX-Di.screenX,Yo=i.screenY-Di.screenY):Yo=$o=0,Di=i),$o)},movementY:function(i){return"movementY"in i?i.movementY:Yo}}),qr=Cn(Xs),cf=g({},Xs,{dataTransfer:0}),ad=Cn(cf),Ws=g({},Ys,{relatedTarget:0}),Xo=Cn(Ws),pu=g({},bt,{animationName:0,elapsedTime:0,pseudoElement:0}),Wo=Cn(pu),ff=g({},bt,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),Ko=Cn(ff),sd=g({},bt,{data:0}),gu=Cn(sd),Ks={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},hf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},df={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function vu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=df[i])?!!s[i]:!1}function Qs(){return vu}var mf=g({},Ys,{key:function(i){if(i.key){var s=Ks[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ni(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?hf[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qs,charCode:function(i){return i.type==="keypress"?Ni(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ni(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),Qo=Cn(mf),pf=g({},Xs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),xu=Cn(pf),oa=g({},Ys,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qs}),gf=Cn(oa),vf=g({},bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),xf=Cn(vf),yf=g({},Xs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Zo=Cn(yf),ur=g({},bt,{newState:0,oldState:0}),_f=Cn(ur),Ef=[9,13,27,32],Oi=oi&&"CompositionEvent"in window,m=null;oi&&"documentMode"in document&&(m=document.documentMode);var _=oi&&"TextEvent"in window&&!m,A=oi&&(!Oi||m&&8<m&&11>=m),F=" ",re=!1;function pe(i,s){switch(i){case"keyup":return Ef.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function De(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var pt=!1;function _n(i,s){switch(i){case"compositionend":return De(s);case"keypress":return s.which!==32?null:(re=!0,F);case"textInput":return i=s.data,i===F&&re?null:i;default:return null}}function gt(i,s){if(pt)return i==="compositionend"||!Oi&&pe(i,s)?(i=du(),sa=za=Ri=null,pt=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return A&&s.locale!=="ko"?null:s.data;default:return null}}var Rn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function En(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Rn[i.type]:s==="textarea"}function la(i,s,l,c){ia?aa?aa.push(c):aa=[c]:ia=c,s=oh(s,"onChange"),0<s.length&&(l=new qo("onChange","change",null,l,c),i.push({event:l,listeners:s}))}var kn=null,Fi=null;function yu(i){ay(i,0)}function Tf(i){var s=ae(i);if(uu(s))return i}function b1(i,s){if(i==="change")return s}var C1=!1;if(oi){var od;if(oi){var ld="oninput"in document;if(!ld){var R1=document.createElement("div");R1.setAttribute("oninput","return;"),ld=typeof R1.oninput=="function"}od=ld}else od=!1;C1=od&&(!document.documentMode||9<document.documentMode)}function N1(){kn&&(kn.detachEvent("onpropertychange",I1),Fi=kn=null)}function I1(i){if(i.propertyName==="value"&&Tf(Fi)){var s=[];la(s,Fi,i,Hr(i)),lf(yu,s)}}function AS(i,s,l){i==="focusin"?(N1(),kn=s,Fi=l,kn.attachEvent("onpropertychange",I1)):i==="focusout"&&N1()}function SS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return Tf(Fi)}function bS(i,s){if(i==="click")return Tf(s)}function CS(i,s){if(i==="input"||i==="change")return Tf(s)}function RS(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Nr=typeof Object.is=="function"?Object.is:RS;function _u(i,s){if(Nr(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),c=Object.keys(s);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var p=l[c];if(!nt.call(s,p)||!Nr(i[p],s[p]))return!1}return!0}function D1(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function O1(i,s){var l=D1(i);i=0;for(var c;l;){if(l.nodeType===3){if(c=i+l.textContent.length,i<=s&&c>=s)return{node:l,offset:s-i};i=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=D1(l)}}function F1(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?F1(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function M1(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=js(i.document);s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=js(i.document)}return s}function ud(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var NS=oi&&"documentMode"in document&&11>=document.documentMode,Jo=null,cd=null,Eu=null,fd=!1;function P1(i,s,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;fd||Jo==null||Jo!==js(c)||(c=Jo,"selectionStart"in c&&ud(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),Eu&&_u(Eu,c)||(Eu=c,c=oh(cd,"onSelect"),0<c.length&&(s=new qo("onSelect","select",null,s,l),i.push({event:s,listeners:c}),s.target=Jo)))}function Zs(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var el={animationend:Zs("Animation","AnimationEnd"),animationiteration:Zs("Animation","AnimationIteration"),animationstart:Zs("Animation","AnimationStart"),transitionrun:Zs("Transition","TransitionRun"),transitionstart:Zs("Transition","TransitionStart"),transitioncancel:Zs("Transition","TransitionCancel"),transitionend:Zs("Transition","TransitionEnd")},hd={},k1={};oi&&(k1=document.createElement("div").style,"AnimationEvent"in window||(delete el.animationend.animation,delete el.animationiteration.animation,delete el.animationstart.animation),"TransitionEvent"in window||delete el.transitionend.transition);function Js(i){if(hd[i])return hd[i];if(!el[i])return i;var s=el[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in k1)return hd[i]=s[l];return i}var L1=Js("animationend"),V1=Js("animationiteration"),B1=Js("animationstart"),IS=Js("transitionrun"),DS=Js("transitionstart"),OS=Js("transitioncancel"),U1=Js("transitionend"),j1=new Map,dd="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");dd.push("scrollEnd");function li(i,s){j1.set(i,s),be(s,[i])}var z1=new WeakMap;function $r(i,s){if(typeof i=="object"&&i!==null){var l=z1.get(i);return l!==void 0?l:(s={value:i,source:s,stack:zo(s)},z1.set(i,s),s)}return{value:i,source:s,stack:zo(s)}}var Yr=[],tl=0,md=0;function wf(){for(var i=tl,s=md=tl=0;s<i;){var l=Yr[s];Yr[s++]=null;var c=Yr[s];Yr[s++]=null;var p=Yr[s];Yr[s++]=null;var v=Yr[s];if(Yr[s++]=null,c!==null&&p!==null){var S=c.pending;S===null?p.next=p:(p.next=S.next,S.next=p),c.pending=p}v!==0&&H1(l,p,v)}}function Af(i,s,l,c){Yr[tl++]=i,Yr[tl++]=s,Yr[tl++]=l,Yr[tl++]=c,md|=c,i.lanes|=c,i=i.alternate,i!==null&&(i.lanes|=c)}function pd(i,s,l,c){return Af(i,s,l,c),Sf(i)}function nl(i,s){return Af(i,null,null,s),Sf(i)}function H1(i,s,l){i.lanes|=l;var c=i.alternate;c!==null&&(c.lanes|=l);for(var p=!1,v=i.return;v!==null;)v.childLanes|=l,c=v.alternate,c!==null&&(c.childLanes|=l),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(p=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,p&&s!==null&&(p=31-bn(l),i=v.hiddenUpdates,c=i[p],c===null?i[p]=[s]:c.push(s),s.lane=l|536870912),v):null}function Sf(i){if(50<$u)throw $u=0,Em=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var rl={};function FS(i,s,l,c){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ir(i,s,l,c){return new FS(i,s,l,c)}function gd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function ua(i,s){var l=i.alternate;return l===null?(l=Ir(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function G1(i,s){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,s=l.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function bf(i,s,l,c,p,v){var S=0;if(c=i,typeof i=="function")gd(i)&&(S=1);else if(typeof i=="string")S=P4(i,l,K.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case R:return i=Ir(31,l,s,p),i.elementType=R,i.lanes=v,i;case w:return eo(l.children,p,v,s);case T:S=8,p|=24;break;case b:return i=Ir(12,l,s,p|2),i.elementType=b,i.lanes=v,i;case he:return i=Ir(13,l,s,p),i.elementType=he,i.lanes=v,i;case Ae:return i=Ir(19,l,s,p),i.elementType=Ae,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case k:case Y:S=10;break e;case q:S=9;break e;case ee:S=11;break e;case D:S=14;break e;case I:S=16,c=null;break e}S=29,l=Error(r(130,i===null?"null":typeof i,"")),c=null}return s=Ir(S,l,s,p),s.elementType=i,s.type=c,s.lanes=v,s}function eo(i,s,l,c){return i=Ir(7,i,c,s),i.lanes=l,i}function vd(i,s,l){return i=Ir(6,i,null,s),i.lanes=l,i}function xd(i,s,l){return s=Ir(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var il=[],al=0,Cf=null,Rf=0,Xr=[],Wr=0,to=null,ca=1,fa="";function no(i,s){il[al++]=Rf,il[al++]=Cf,Cf=i,Rf=s}function q1(i,s,l){Xr[Wr++]=ca,Xr[Wr++]=fa,Xr[Wr++]=to,to=i;var c=ca;i=fa;var p=32-bn(c)-1;c&=~(1<<p),l+=1;var v=32-bn(s)+p;if(30<v){var S=p-p%5;v=(c&(1<<S)-1).toString(32),c>>=S,p-=S,ca=1<<32-bn(s)+p|l<<p|c,fa=v+i}else ca=1<<v|l<<p|c,fa=i}function yd(i){i.return!==null&&(no(i,1),q1(i,1,0))}function _d(i){for(;i===Cf;)Cf=il[--al],il[al]=null,Rf=il[--al],il[al]=null;for(;i===to;)to=Xr[--Wr],Xr[Wr]=null,fa=Xr[--Wr],Xr[Wr]=null,ca=Xr[--Wr],Xr[Wr]=null}var cr=null,en=null,At=!1,ro=null,Mi=!1,Ed=Error(r(519));function io(i){var s=Error(r(418,""));throw Au($r(s,i)),Ed}function $1(i){var s=i.stateNode,l=i.type,c=i.memoizedProps;switch(s[sn]=i,s[Xt]=c,l){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(l=0;l<Xu.length;l++)ft(Xu[l],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":ft("invalid",s),zs(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Ho(s);break;case"select":ft("invalid",s);break;case"textarea":ft("invalid",s),Hs(s,c.value,c.defaultValue,c.children),Ho(s)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||c.suppressHydrationWarning===!0||uy(s.textContent,l)?(c.popover!=null&&(ft("beforetoggle",s),ft("toggle",s)),c.onScroll!=null&&ft("scroll",s),c.onScrollEnd!=null&&ft("scrollend",s),c.onClick!=null&&(s.onclick=lh),s=!0):s=!1,s||io(i)}function Y1(i){for(cr=i.return;cr;)switch(cr.tag){case 5:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:cr=cr.return}}function Tu(i){if(i!==cr)return!1;if(!At)return Y1(i),At=!0,!1;var s=i.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Lm(i.type,i.memoizedProps)),l=!l),l&&en&&io(i),Y1(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(s===0){en=ci(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;i=i.nextSibling}en=null}}else s===27?(s=en,is(i.type)?(i=jm,jm=null,en=i):en=s):en=cr?ci(i.stateNode.nextSibling):null;return!0}function wu(){en=cr=null,At=!1}function X1(){var i=ro;return i!==null&&(Er===null?Er=i:Er.push.apply(Er,i),ro=null),i}function Au(i){ro===null?ro=[i]:ro.push(i)}var Td=_e(null),ao=null,ha=null;function Ha(i,s,l){W(Td,s._currentValue),s._currentValue=l}function da(i){i._currentValue=Td.current,U(Td)}function wd(i,s,l){for(;i!==null;){var c=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),i===l)break;i=i.return}}function Ad(i,s,l,c){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var v=p.dependencies;if(v!==null){var S=p.child;v=v.firstContext;e:for(;v!==null;){var O=v;v=p;for(var X=0;X<s.length;X++)if(O.context===s[X]){v.lanes|=l,O=v.alternate,O!==null&&(O.lanes|=l),wd(v.return,l,i),c||(S=null);break e}v=O.next}}else if(p.tag===18){if(S=p.return,S===null)throw Error(r(341));S.lanes|=l,v=S.alternate,v!==null&&(v.lanes|=l),wd(S,l,i),S=null}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===i){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}}function Su(i,s,l,c){i=null;for(var p=s,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var S=p.alternate;if(S===null)throw Error(r(387));if(S=S.memoizedProps,S!==null){var O=p.type;Nr(p.pendingProps.value,S.value)||(i!==null?i.push(O):i=[O])}}else if(p===Le.current){if(S=p.alternate,S===null)throw Error(r(387));S.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(ec):i=[ec])}p=p.return}i!==null&&Ad(s,i,l,c),s.flags|=262144}function Nf(i){for(i=i.firstContext;i!==null;){if(!Nr(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function so(i){ao=i,ha=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Qn(i){return W1(ao,i)}function If(i,s){return ao===null&&so(i),W1(i,s)}function W1(i,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},ha===null){if(i===null)throw Error(r(308));ha=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else ha=ha.next=s;return l}var MS=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(l,c){i.push(c)}};this.abort=function(){s.aborted=!0,i.forEach(function(l){return l()})}},PS=t.unstable_scheduleCallback,kS=t.unstable_NormalPriority,Tn={$$typeof:Y,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Sd(){return{controller:new MS,data:new Map,refCount:0}}function bu(i){i.refCount--,i.refCount===0&&PS(kS,function(){i.controller.abort()})}var Cu=null,bd=0,sl=0,ol=null;function LS(i,s){if(Cu===null){var l=Cu=[];bd=0,sl=Rm(),ol={status:"pending",value:void 0,then:function(c){l.push(c)}}}return bd++,s.then(K1,K1),s}function K1(){if(--bd===0&&Cu!==null){ol!==null&&(ol.status="fulfilled");var i=Cu;Cu=null,sl=0,ol=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function VS(i,s){var l=[],c={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return i.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<l.length;p++)(0,l[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),c}var Q1=de.S;de.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&LS(i,s),Q1!==null&&Q1(i,s)};var oo=_e(null);function Cd(){var i=oo.current;return i!==null?i:qt.pooledCache}function Df(i,s){s===null?W(oo,oo.current):W(oo,s.pool)}function Z1(){var i=Cd();return i===null?null:{parent:Tn._currentValue,pool:i}}var Ru=Error(r(460)),J1=Error(r(474)),Of=Error(r(542)),Rd={then:function(){}};function ev(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Ff(){}function tv(i,s,l){switch(l=i[l],l===void 0?i.push(s):l!==s&&(s.then(Ff,Ff),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,rv(i),i;default:if(typeof s.status=="string")s.then(Ff,Ff);else{if(i=qt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,rv(i),i}throw Nu=s,Ru}}var Nu=null;function nv(){if(Nu===null)throw Error(r(459));var i=Nu;return Nu=null,i}function rv(i){if(i===Ru||i===Of)throw Error(r(483))}var Ga=!1;function Nd(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Id(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function qa(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function $a(i,s,l){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,(Rt&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=Sf(i),H1(i,null,l),s}return Af(i,c,s,l),Sf(i)}function Iu(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var c=s.lanes;c&=i.pendingLanes,l|=c,s.lanes=l,Bs(i,l)}}function Dd(i,s){var l=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var p=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?p=v=S:v=v.next=S,l=l.next}while(l!==null);v===null?p=v=s:v=v.next=s}else p=v=s;l={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}var Od=!1;function Du(){if(Od){var i=ol;if(i!==null)throw i}}function Ou(i,s,l,c){Od=!1;var p=i.updateQueue;Ga=!1;var v=p.firstBaseUpdate,S=p.lastBaseUpdate,O=p.shared.pending;if(O!==null){p.shared.pending=null;var X=O,se=X.next;X.next=null,S===null?v=se:S.next=se,S=X;var ye=i.alternate;ye!==null&&(ye=ye.updateQueue,O=ye.lastBaseUpdate,O!==S&&(O===null?ye.firstBaseUpdate=se:O.next=se,ye.lastBaseUpdate=X))}if(v!==null){var Te=p.baseState;S=0,ye=se=X=null,O=v;do{var ue=O.lane&-536870913,fe=ue!==O.lane;if(fe?(vt&ue)===ue:(c&ue)===ue){ue!==0&&ue===sl&&(Od=!0),ye!==null&&(ye=ye.next={lane:0,tag:O.tag,payload:O.payload,callback:null,next:null});e:{var Ze=i,Ye=O;ue=s;var Lt=l;switch(Ye.tag){case 1:if(Ze=Ye.payload,typeof Ze=="function"){Te=Ze.call(Lt,Te,ue);break e}Te=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Ye.payload,ue=typeof Ze=="function"?Ze.call(Lt,Te,ue):Ze,ue==null)break e;Te=g({},Te,ue);break e;case 2:Ga=!0}}ue=O.callback,ue!==null&&(i.flags|=64,fe&&(i.flags|=8192),fe=p.callbacks,fe===null?p.callbacks=[ue]:fe.push(ue))}else fe={lane:ue,tag:O.tag,payload:O.payload,callback:O.callback,next:null},ye===null?(se=ye=fe,X=Te):ye=ye.next=fe,S|=ue;if(O=O.next,O===null){if(O=p.shared.pending,O===null)break;fe=O,O=fe.next,fe.next=null,p.lastBaseUpdate=fe,p.shared.pending=null}}while(!0);ye===null&&(X=Te),p.baseState=X,p.firstBaseUpdate=se,p.lastBaseUpdate=ye,v===null&&(p.shared.lanes=0),es|=S,i.lanes=S,i.memoizedState=Te}}function iv(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function av(i,s){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)iv(l[i],s)}var ll=_e(null),Mf=_e(0);function sv(i,s){i=_a,W(Mf,i),W(ll,s),_a=i|s.baseLanes}function Fd(){W(Mf,_a),W(ll,ll.current)}function Md(){_a=Mf.current,U(ll),U(Mf)}var Ya=0,at=null,Pt=null,fn=null,Pf=!1,ul=!1,lo=!1,kf=0,Fu=0,cl=null,BS=0;function on(){throw Error(r(321))}function Pd(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!Nr(i[l],s[l]))return!1;return!0}function kd(i,s,l,c,p,v){return Ya=v,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,de.H=i===null||i.memoizedState===null?Hv:Gv,lo=!1,v=l(c,p),lo=!1,ul&&(v=lv(s,l,c,p)),ov(i),v}function ov(i){de.H=zf;var s=Pt!==null&&Pt.next!==null;if(Ya=0,fn=Pt=at=null,Pf=!1,Fu=0,cl=null,s)throw Error(r(300));i===null||Nn||(i=i.dependencies,i!==null&&Nf(i)&&(Nn=!0))}function lv(i,s,l,c){at=i;var p=0;do{if(ul&&(cl=null),Fu=0,ul=!1,25<=p)throw Error(r(301));if(p+=1,fn=Pt=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}de.H=$S,v=s(l,c)}while(ul);return v}function US(){var i=de.H,s=i.useState()[0];return s=typeof s.then=="function"?Mu(s):s,i=i.useState()[0],(Pt!==null?Pt.memoizedState:null)!==i&&(at.flags|=1024),s}function Ld(){var i=kf!==0;return kf=0,i}function Vd(i,s,l){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~l}function Bd(i){if(Pf){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Pf=!1}Ya=0,fn=Pt=at=null,ul=!1,Fu=kf=0,cl=null}function yr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?at.memoizedState=fn=i:fn=fn.next=i,fn}function hn(){if(Pt===null){var i=at.alternate;i=i!==null?i.memoizedState:null}else i=Pt.next;var s=fn===null?at.memoizedState:fn.next;if(s!==null)fn=s,Pt=i;else{if(i===null)throw at.alternate===null?Error(r(467)):Error(r(310));Pt=i,i={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},fn===null?at.memoizedState=fn=i:fn=fn.next=i}return fn}function Ud(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Mu(i){var s=Fu;return Fu+=1,cl===null&&(cl=[]),i=tv(cl,i,s),s=at,(fn===null?s.memoizedState:fn.next)===null&&(s=s.alternate,de.H=s===null||s.memoizedState===null?Hv:Gv),i}function Lf(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Mu(i);if(i.$$typeof===Y)return Qn(i)}throw Error(r(438,String(i)))}function jd(i){var s=null,l=at.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var c=at.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=Ud(),at.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(i),c=0;c<i;c++)l[c]=P;return s.index++,l}function ma(i,s){return typeof s=="function"?s(i):s}function Vf(i){var s=hn();return zd(s,Pt,i)}function zd(i,s,l){var c=i.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=l;var p=i.baseQueue,v=c.pending;if(v!==null){if(p!==null){var S=p.next;p.next=v.next,v.next=S}s.baseQueue=p=v,c.pending=null}if(v=i.baseState,p===null)i.memoizedState=v;else{s=p.next;var O=S=null,X=null,se=s,ye=!1;do{var Te=se.lane&-536870913;if(Te!==se.lane?(vt&Te)===Te:(Ya&Te)===Te){var ue=se.revertLane;if(ue===0)X!==null&&(X=X.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),Te===sl&&(ye=!0);else if((Ya&ue)===ue){se=se.next,ue===sl&&(ye=!0);continue}else Te={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},X===null?(O=X=Te,S=v):X=X.next=Te,at.lanes|=ue,es|=ue;Te=se.action,lo&&l(v,Te),v=se.hasEagerState?se.eagerState:l(v,Te)}else ue={lane:Te,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},X===null?(O=X=ue,S=v):X=X.next=ue,at.lanes|=Te,es|=Te;se=se.next}while(se!==null&&se!==s);if(X===null?S=v:X.next=O,!Nr(v,i.memoizedState)&&(Nn=!0,ye&&(l=ol,l!==null)))throw l;i.memoizedState=v,i.baseState=S,i.baseQueue=X,c.lastRenderedState=v}return p===null&&(c.lanes=0),[i.memoizedState,c.dispatch]}function Hd(i){var s=hn(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var c=l.dispatch,p=l.pending,v=s.memoizedState;if(p!==null){l.pending=null;var S=p=p.next;do v=i(v,S.action),S=S.next;while(S!==p);Nr(v,s.memoizedState)||(Nn=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,c]}function uv(i,s,l){var c=at,p=hn(),v=At;if(v){if(l===void 0)throw Error(r(407));l=l()}else l=s();var S=!Nr((Pt||p).memoizedState,l);S&&(p.memoizedState=l,Nn=!0),p=p.queue;var O=hv.bind(null,c,p,i);if(Pu(2048,8,O,[i]),p.getSnapshot!==s||S||fn!==null&&fn.memoizedState.tag&1){if(c.flags|=2048,fl(9,Bf(),fv.bind(null,c,p,l,s),null),qt===null)throw Error(r(349));v||(Ya&124)!==0||cv(c,s,l)}return l}function cv(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=at.updateQueue,s===null?(s=Ud(),at.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function fv(i,s,l,c){s.value=l,s.getSnapshot=c,dv(s)&&mv(i)}function hv(i,s,l){return l(function(){dv(s)&&mv(i)})}function dv(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!Nr(i,l)}catch{return!0}}function mv(i){var s=nl(i,2);s!==null&&Pr(s,i,2)}function Gd(i){var s=yr();if(typeof i=="function"){var l=i;if(i=l(),lo){an(!0);try{l()}finally{an(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:i},s}function pv(i,s,l,c){return i.baseState=l,zd(i,Pt,typeof c=="function"?c:ma)}function jS(i,s,l,c,p){if(jf(i))throw Error(r(485));if(i=s.action,i!==null){var v={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){v.listeners.push(S)}};de.T!==null?l(!0):v.isTransition=!1,c(v),l=s.pending,l===null?(v.next=s.pending=v,gv(s,v)):(v.next=l.next,s.pending=l.next=v)}}function gv(i,s){var l=s.action,c=s.payload,p=i.state;if(s.isTransition){var v=de.T,S={};de.T=S;try{var O=l(p,c),X=de.S;X!==null&&X(S,O),vv(i,s,O)}catch(se){qd(i,s,se)}finally{de.T=v}}else try{v=l(p,c),vv(i,s,v)}catch(se){qd(i,s,se)}}function vv(i,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){xv(i,s,c)},function(c){return qd(i,s,c)}):xv(i,s,l)}function xv(i,s,l){s.status="fulfilled",s.value=l,yv(s),i.state=l,s=i.pending,s!==null&&(l=s.next,l===s?i.pending=null:(l=l.next,s.next=l,gv(i,l)))}function qd(i,s,l){var c=i.pending;if(i.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=l,yv(s),s=s.next;while(s!==c)}i.action=null}function yv(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function _v(i,s){return s}function Ev(i,s){if(At){var l=qt.formState;if(l!==null){e:{var c=at;if(At){if(en){t:{for(var p=en,v=Mi;p.nodeType!==8;){if(!v){p=null;break t}if(p=ci(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){en=ci(p.nextSibling),c=p.data==="F!";break e}}io(c)}c=!1}c&&(s=l[0])}}return l=yr(),l.memoizedState=l.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:_v,lastRenderedState:s},l.queue=c,l=Uv.bind(null,at,c),c.dispatch=l,c=Gd(!1),v=Kd.bind(null,at,!1,c.queue),c=yr(),p={state:s,dispatch:null,action:i,pending:null},c.queue=p,l=jS.bind(null,at,p,v,l),p.dispatch=l,c.memoizedState=i,[s,l,!1]}function Tv(i){var s=hn();return wv(s,Pt,i)}function wv(i,s,l){if(s=zd(i,s,_v)[0],i=Vf(ma)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=Mu(s)}catch(S){throw S===Ru?Of:S}else c=s;s=hn();var p=s.queue,v=p.dispatch;return l!==s.memoizedState&&(at.flags|=2048,fl(9,Bf(),zS.bind(null,p,l),null)),[c,v,i]}function zS(i,s){i.action=s}function Av(i){var s=hn(),l=Pt;if(l!==null)return wv(s,l,i);hn(),s=s.memoizedState,l=hn();var c=l.queue.dispatch;return l.memoizedState=i,[s,c,!1]}function fl(i,s,l,c){return i={tag:i,create:l,deps:c,inst:s,next:null},s=at.updateQueue,s===null&&(s=Ud(),at.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=i.next=i:(c=l.next,l.next=i,i.next=c,s.lastEffect=i),i}function Bf(){return{destroy:void 0,resource:void 0}}function Sv(){return hn().memoizedState}function Uf(i,s,l,c){var p=yr();c=c===void 0?null:c,at.flags|=i,p.memoizedState=fl(1|s,Bf(),l,c)}function Pu(i,s,l,c){var p=hn();c=c===void 0?null:c;var v=p.memoizedState.inst;Pt!==null&&c!==null&&Pd(c,Pt.memoizedState.deps)?p.memoizedState=fl(s,v,l,c):(at.flags|=i,p.memoizedState=fl(1|s,v,l,c))}function bv(i,s){Uf(8390656,8,i,s)}function Cv(i,s){Pu(2048,8,i,s)}function Rv(i,s){return Pu(4,2,i,s)}function Nv(i,s){return Pu(4,4,i,s)}function Iv(i,s){if(typeof s=="function"){i=i();var l=s(i);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Dv(i,s,l){l=l!=null?l.concat([i]):null,Pu(4,4,Iv.bind(null,s,i),l)}function $d(){}function Ov(i,s){var l=hn();s=s===void 0?null:s;var c=l.memoizedState;return s!==null&&Pd(s,c[1])?c[0]:(l.memoizedState=[i,s],i)}function Fv(i,s){var l=hn();s=s===void 0?null:s;var c=l.memoizedState;if(s!==null&&Pd(s,c[1]))return c[0];if(c=i(),lo){an(!0);try{i()}finally{an(!1)}}return l.memoizedState=[c,s],c}function Yd(i,s,l){return l===void 0||(Ya&1073741824)!==0?i.memoizedState=s:(i.memoizedState=l,i=kx(),at.lanes|=i,es|=i,l)}function Mv(i,s,l,c){return Nr(l,s)?l:ll.current!==null?(i=Yd(i,l,c),Nr(i,s)||(Nn=!0),i):(Ya&42)===0?(Nn=!0,i.memoizedState=l):(i=kx(),at.lanes|=i,es|=i,s)}function Pv(i,s,l,c,p){var v=Ce.p;Ce.p=v!==0&&8>v?v:8;var S=de.T,O={};de.T=O,Kd(i,!1,s,l);try{var X=p(),se=de.S;if(se!==null&&se(O,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ye=VS(X,c);ku(i,s,ye,Mr(i))}else ku(i,s,c,Mr(i))}catch(Te){ku(i,s,{then:function(){},status:"rejected",reason:Te},Mr())}finally{Ce.p=v,de.T=S}}function HS(){}function Xd(i,s,l,c){if(i.tag!==5)throw Error(r(476));var p=kv(i).queue;Pv(i,p,s,ze,l===null?HS:function(){return Lv(i),l(c)})}function kv(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:ze,baseState:ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:ze},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:ma,lastRenderedState:l},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function Lv(i){var s=kv(i).next.queue;ku(i,s,{},Mr())}function Wd(){return Qn(ec)}function Vv(){return hn().memoizedState}function Bv(){return hn().memoizedState}function GS(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var l=Mr();i=qa(l);var c=$a(s,i,l);c!==null&&(Pr(c,s,l),Iu(c,s,l)),s={cache:Sd()},i.payload=s;return}s=s.return}}function qS(i,s,l){var c=Mr();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},jf(i)?jv(s,l):(l=pd(i,s,l,c),l!==null&&(Pr(l,i,c),zv(l,s,c)))}function Uv(i,s,l){var c=Mr();ku(i,s,l,c)}function ku(i,s,l,c){var p={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(jf(i))jv(s,p);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var S=s.lastRenderedState,O=v(S,l);if(p.hasEagerState=!0,p.eagerState=O,Nr(O,S))return Af(i,s,p,0),qt===null&&wf(),!1}catch{}finally{}if(l=pd(i,s,p,c),l!==null)return Pr(l,i,c),zv(l,s,c),!0}return!1}function Kd(i,s,l,c){if(c={lane:2,revertLane:Rm(),action:c,hasEagerState:!1,eagerState:null,next:null},jf(i)){if(s)throw Error(r(479))}else s=pd(i,l,c,2),s!==null&&Pr(s,i,2)}function jf(i){var s=i.alternate;return i===at||s!==null&&s===at}function jv(i,s){ul=Pf=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function zv(i,s,l){if((l&4194048)!==0){var c=s.lanes;c&=i.pendingLanes,l|=c,s.lanes=l,Bs(i,l)}}var zf={readContext:Qn,use:Lf,useCallback:on,useContext:on,useEffect:on,useImperativeHandle:on,useLayoutEffect:on,useInsertionEffect:on,useMemo:on,useReducer:on,useRef:on,useState:on,useDebugValue:on,useDeferredValue:on,useTransition:on,useSyncExternalStore:on,useId:on,useHostTransitionStatus:on,useFormState:on,useActionState:on,useOptimistic:on,useMemoCache:on,useCacheRefresh:on},Hv={readContext:Qn,use:Lf,useCallback:function(i,s){return yr().memoizedState=[i,s===void 0?null:s],i},useContext:Qn,useEffect:bv,useImperativeHandle:function(i,s,l){l=l!=null?l.concat([i]):null,Uf(4194308,4,Iv.bind(null,s,i),l)},useLayoutEffect:function(i,s){return Uf(4194308,4,i,s)},useInsertionEffect:function(i,s){Uf(4,2,i,s)},useMemo:function(i,s){var l=yr();s=s===void 0?null:s;var c=i();if(lo){an(!0);try{i()}finally{an(!1)}}return l.memoizedState=[c,s],c},useReducer:function(i,s,l){var c=yr();if(l!==void 0){var p=l(s);if(lo){an(!0);try{l(s)}finally{an(!1)}}}else p=s;return c.memoizedState=c.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},c.queue=i,i=i.dispatch=qS.bind(null,at,i),[c.memoizedState,i]},useRef:function(i){var s=yr();return i={current:i},s.memoizedState=i},useState:function(i){i=Gd(i);var s=i.queue,l=Uv.bind(null,at,s);return s.dispatch=l,[i.memoizedState,l]},useDebugValue:$d,useDeferredValue:function(i,s){var l=yr();return Yd(l,i,s)},useTransition:function(){var i=Gd(!1);return i=Pv.bind(null,at,i.queue,!0,!1),yr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,l){var c=at,p=yr();if(At){if(l===void 0)throw Error(r(407));l=l()}else{if(l=s(),qt===null)throw Error(r(349));(vt&124)!==0||cv(c,s,l)}p.memoizedState=l;var v={value:l,getSnapshot:s};return p.queue=v,bv(hv.bind(null,c,v,i),[i]),c.flags|=2048,fl(9,Bf(),fv.bind(null,c,v,l,s),null),l},useId:function(){var i=yr(),s=qt.identifierPrefix;if(At){var l=fa,c=ca;l=(c&~(1<<32-bn(c)-1)).toString(32)+l,s=""+s+"R"+l,l=kf++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=BS++,s=""+s+"r"+l.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Wd,useFormState:Ev,useActionState:Ev,useOptimistic:function(i){var s=yr();s.memoizedState=s.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=Kd.bind(null,at,!0,l),l.dispatch=s,[i,s]},useMemoCache:jd,useCacheRefresh:function(){return yr().memoizedState=GS.bind(null,at)}},Gv={readContext:Qn,use:Lf,useCallback:Ov,useContext:Qn,useEffect:Cv,useImperativeHandle:Dv,useInsertionEffect:Rv,useLayoutEffect:Nv,useMemo:Fv,useReducer:Vf,useRef:Sv,useState:function(){return Vf(ma)},useDebugValue:$d,useDeferredValue:function(i,s){var l=hn();return Mv(l,Pt.memoizedState,i,s)},useTransition:function(){var i=Vf(ma)[0],s=hn().memoizedState;return[typeof i=="boolean"?i:Mu(i),s]},useSyncExternalStore:uv,useId:Vv,useHostTransitionStatus:Wd,useFormState:Tv,useActionState:Tv,useOptimistic:function(i,s){var l=hn();return pv(l,Pt,i,s)},useMemoCache:jd,useCacheRefresh:Bv},$S={readContext:Qn,use:Lf,useCallback:Ov,useContext:Qn,useEffect:Cv,useImperativeHandle:Dv,useInsertionEffect:Rv,useLayoutEffect:Nv,useMemo:Fv,useReducer:Hd,useRef:Sv,useState:function(){return Hd(ma)},useDebugValue:$d,useDeferredValue:function(i,s){var l=hn();return Pt===null?Yd(l,i,s):Mv(l,Pt.memoizedState,i,s)},useTransition:function(){var i=Hd(ma)[0],s=hn().memoizedState;return[typeof i=="boolean"?i:Mu(i),s]},useSyncExternalStore:uv,useId:Vv,useHostTransitionStatus:Wd,useFormState:Av,useActionState:Av,useOptimistic:function(i,s){var l=hn();return Pt!==null?pv(l,Pt,i,s):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:jd,useCacheRefresh:Bv},hl=null,Lu=0;function Hf(i){var s=Lu;return Lu+=1,hl===null&&(hl=[]),tv(hl,i,s)}function Vu(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function Gf(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function qv(i){var s=i._init;return s(i._payload)}function $v(i){function s(te,J){if(i){var ie=te.deletions;ie===null?(te.deletions=[J],te.flags|=16):ie.push(J)}}function l(te,J){if(!i)return null;for(;J!==null;)s(te,J),J=J.sibling;return null}function c(te){for(var J=new Map;te!==null;)te.key!==null?J.set(te.key,te):J.set(te.index,te),te=te.sibling;return J}function p(te,J){return te=ua(te,J),te.index=0,te.sibling=null,te}function v(te,J,ie){return te.index=ie,i?(ie=te.alternate,ie!==null?(ie=ie.index,ie<J?(te.flags|=67108866,J):ie):(te.flags|=67108866,J)):(te.flags|=1048576,J)}function S(te){return i&&te.alternate===null&&(te.flags|=67108866),te}function O(te,J,ie,Ee){return J===null||J.tag!==6?(J=vd(ie,te.mode,Ee),J.return=te,J):(J=p(J,ie),J.return=te,J)}function X(te,J,ie,Ee){var Ge=ie.type;return Ge===w?ye(te,J,ie.props.children,Ee,ie.key):J!==null&&(J.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===I&&qv(Ge)===J.type)?(J=p(J,ie.props),Vu(J,ie),J.return=te,J):(J=bf(ie.type,ie.key,ie.props,null,te.mode,Ee),Vu(J,ie),J.return=te,J)}function se(te,J,ie,Ee){return J===null||J.tag!==4||J.stateNode.containerInfo!==ie.containerInfo||J.stateNode.implementation!==ie.implementation?(J=xd(ie,te.mode,Ee),J.return=te,J):(J=p(J,ie.children||[]),J.return=te,J)}function ye(te,J,ie,Ee,Ge){return J===null||J.tag!==7?(J=eo(ie,te.mode,Ee,Ge),J.return=te,J):(J=p(J,ie),J.return=te,J)}function Te(te,J,ie){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=vd(""+J,te.mode,ie),J.return=te,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case x:return ie=bf(J.type,J.key,J.props,null,te.mode,ie),Vu(ie,J),ie.return=te,ie;case E:return J=xd(J,te.mode,ie),J.return=te,J;case I:var Ee=J._init;return J=Ee(J._payload),Te(te,J,ie)}if(He(J)||H(J))return J=eo(J,te.mode,ie,null),J.return=te,J;if(typeof J.then=="function")return Te(te,Hf(J),ie);if(J.$$typeof===Y)return Te(te,If(te,J),ie);Gf(te,J)}return null}function ue(te,J,ie,Ee){var Ge=J!==null?J.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Ge!==null?null:O(te,J,""+ie,Ee);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:return ie.key===Ge?X(te,J,ie,Ee):null;case E:return ie.key===Ge?se(te,J,ie,Ee):null;case I:return Ge=ie._init,ie=Ge(ie._payload),ue(te,J,ie,Ee)}if(He(ie)||H(ie))return Ge!==null?null:ye(te,J,ie,Ee,null);if(typeof ie.then=="function")return ue(te,J,Hf(ie),Ee);if(ie.$$typeof===Y)return ue(te,J,If(te,ie),Ee);Gf(te,ie)}return null}function fe(te,J,ie,Ee,Ge){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return te=te.get(ie)||null,O(J,te,""+Ee,Ge);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case x:return te=te.get(Ee.key===null?ie:Ee.key)||null,X(J,te,Ee,Ge);case E:return te=te.get(Ee.key===null?ie:Ee.key)||null,se(J,te,Ee,Ge);case I:var lt=Ee._init;return Ee=lt(Ee._payload),fe(te,J,ie,Ee,Ge)}if(He(Ee)||H(Ee))return te=te.get(ie)||null,ye(J,te,Ee,Ge,null);if(typeof Ee.then=="function")return fe(te,J,ie,Hf(Ee),Ge);if(Ee.$$typeof===Y)return fe(te,J,ie,If(J,Ee),Ge);Gf(J,Ee)}return null}function Ze(te,J,ie,Ee){for(var Ge=null,lt=null,qe=J,We=J=0,Dn=null;qe!==null&&We<ie.length;We++){qe.index>We?(Dn=qe,qe=null):Dn=qe.sibling;var Tt=ue(te,qe,ie[We],Ee);if(Tt===null){qe===null&&(qe=Dn);break}i&&qe&&Tt.alternate===null&&s(te,qe),J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt,qe=Dn}if(We===ie.length)return l(te,qe),At&&no(te,We),Ge;if(qe===null){for(;We<ie.length;We++)qe=Te(te,ie[We],Ee),qe!==null&&(J=v(qe,J,We),lt===null?Ge=qe:lt.sibling=qe,lt=qe);return At&&no(te,We),Ge}for(qe=c(qe);We<ie.length;We++)Dn=fe(qe,te,We,ie[We],Ee),Dn!==null&&(i&&Dn.alternate!==null&&qe.delete(Dn.key===null?We:Dn.key),J=v(Dn,J,We),lt===null?Ge=Dn:lt.sibling=Dn,lt=Dn);return i&&qe.forEach(function(us){return s(te,us)}),At&&no(te,We),Ge}function Ye(te,J,ie,Ee){if(ie==null)throw Error(r(151));for(var Ge=null,lt=null,qe=J,We=J=0,Dn=null,Tt=ie.next();qe!==null&&!Tt.done;We++,Tt=ie.next()){qe.index>We?(Dn=qe,qe=null):Dn=qe.sibling;var us=ue(te,qe,Tt.value,Ee);if(us===null){qe===null&&(qe=Dn);break}i&&qe&&us.alternate===null&&s(te,qe),J=v(us,J,We),lt===null?Ge=us:lt.sibling=us,lt=us,qe=Dn}if(Tt.done)return l(te,qe),At&&no(te,We),Ge;if(qe===null){for(;!Tt.done;We++,Tt=ie.next())Tt=Te(te,Tt.value,Ee),Tt!==null&&(J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt);return At&&no(te,We),Ge}for(qe=c(qe);!Tt.done;We++,Tt=ie.next())Tt=fe(qe,te,We,Tt.value,Ee),Tt!==null&&(i&&Tt.alternate!==null&&qe.delete(Tt.key===null?We:Tt.key),J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt);return i&&qe.forEach(function(Y4){return s(te,Y4)}),At&&no(te,We),Ge}function Lt(te,J,ie,Ee){if(typeof ie=="object"&&ie!==null&&ie.type===w&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case x:e:{for(var Ge=ie.key;J!==null;){if(J.key===Ge){if(Ge=ie.type,Ge===w){if(J.tag===7){l(te,J.sibling),Ee=p(J,ie.props.children),Ee.return=te,te=Ee;break e}}else if(J.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===I&&qv(Ge)===J.type){l(te,J.sibling),Ee=p(J,ie.props),Vu(Ee,ie),Ee.return=te,te=Ee;break e}l(te,J);break}else s(te,J);J=J.sibling}ie.type===w?(Ee=eo(ie.props.children,te.mode,Ee,ie.key),Ee.return=te,te=Ee):(Ee=bf(ie.type,ie.key,ie.props,null,te.mode,Ee),Vu(Ee,ie),Ee.return=te,te=Ee)}return S(te);case E:e:{for(Ge=ie.key;J!==null;){if(J.key===Ge)if(J.tag===4&&J.stateNode.containerInfo===ie.containerInfo&&J.stateNode.implementation===ie.implementation){l(te,J.sibling),Ee=p(J,ie.children||[]),Ee.return=te,te=Ee;break e}else{l(te,J);break}else s(te,J);J=J.sibling}Ee=xd(ie,te.mode,Ee),Ee.return=te,te=Ee}return S(te);case I:return Ge=ie._init,ie=Ge(ie._payload),Lt(te,J,ie,Ee)}if(He(ie))return Ze(te,J,ie,Ee);if(H(ie)){if(Ge=H(ie),typeof Ge!="function")throw Error(r(150));return ie=Ge.call(ie),Ye(te,J,ie,Ee)}if(typeof ie.then=="function")return Lt(te,J,Hf(ie),Ee);if(ie.$$typeof===Y)return Lt(te,J,If(te,ie),Ee);Gf(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,J!==null&&J.tag===6?(l(te,J.sibling),Ee=p(J,ie),Ee.return=te,te=Ee):(l(te,J),Ee=vd(ie,te.mode,Ee),Ee.return=te,te=Ee),S(te)):l(te,J)}return function(te,J,ie,Ee){try{Lu=0;var Ge=Lt(te,J,ie,Ee);return hl=null,Ge}catch(qe){if(qe===Ru||qe===Of)throw qe;var lt=Ir(29,qe,null,te.mode);return lt.lanes=Ee,lt.return=te,lt}finally{}}}var dl=$v(!0),Yv=$v(!1),Kr=_e(null),Pi=null;function Xa(i){var s=i.alternate;W(wn,wn.current&1),W(Kr,i),Pi===null&&(s===null||ll.current!==null||s.memoizedState!==null)&&(Pi=i)}function Xv(i){if(i.tag===22){if(W(wn,wn.current),W(Kr,i),Pi===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(Pi=i)}}else Wa()}function Wa(){W(wn,wn.current),W(Kr,Kr.current)}function pa(i){U(Kr),Pi===i&&(Pi=null),U(wn)}var wn=_e(0);function qf(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Um(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function Qd(i,s,l,c){s=i.memoizedState,l=l(c,s),l=l==null?s:g({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Zd={enqueueSetState:function(i,s,l){i=i._reactInternals;var c=Mr(),p=qa(c);p.payload=s,l!=null&&(p.callback=l),s=$a(i,p,c),s!==null&&(Pr(s,i,c),Iu(s,i,c))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var c=Mr(),p=qa(c);p.tag=1,p.payload=s,l!=null&&(p.callback=l),s=$a(i,p,c),s!==null&&(Pr(s,i,c),Iu(s,i,c))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=Mr(),c=qa(l);c.tag=2,s!=null&&(c.callback=s),s=$a(i,c,l),s!==null&&(Pr(s,i,l),Iu(s,i,l))}};function Wv(i,s,l,c,p,v,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,v,S):s.prototype&&s.prototype.isPureReactComponent?!_u(l,c)||!_u(p,v):!0}function Kv(i,s,l,c){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,c),s.state!==i&&Zd.enqueueReplaceState(s,s.state,null)}function uo(i,s){var l=s;if("ref"in s){l={};for(var c in s)c!=="ref"&&(l[c]=s[c])}if(i=i.defaultProps){l===s&&(l=g({},l));for(var p in i)l[p]===void 0&&(l[p]=i[p])}return l}var $f=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Qv(i){$f(i)}function Zv(i){console.error(i)}function Jv(i){$f(i)}function Yf(i,s){try{var l=i.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function ex(i,s,l){try{var c=i.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Jd(i,s,l){return l=qa(l),l.tag=3,l.payload={element:null},l.callback=function(){Yf(i,s)},l}function tx(i){return i=qa(i),i.tag=3,i}function nx(i,s,l,c){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var v=c.value;i.payload=function(){return p(v)},i.callback=function(){ex(s,l,c)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){ex(s,l,c),typeof p!="function"&&(ts===null?ts=new Set([this]):ts.add(this));var O=c.stack;this.componentDidCatch(c.value,{componentStack:O!==null?O:""})})}function YS(i,s,l,c,p){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=l.alternate,s!==null&&Su(s,l,p,!0),l=Kr.current,l!==null){switch(l.tag){case 13:return Pi===null?wm():l.alternate===null&&tn===0&&(tn=3),l.flags&=-257,l.flags|=65536,l.lanes=p,c===Rd?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([c]):s.add(c),Sm(i,c,p)),!1;case 22:return l.flags|=65536,c===Rd?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([c]):l.add(c)),Sm(i,c,p)),!1}throw Error(r(435,l.tag))}return Sm(i,c,p),wm(),!1}if(At)return s=Kr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==Ed&&(i=Error(r(422),{cause:c}),Au($r(i,l)))):(c!==Ed&&(s=Error(r(423),{cause:c}),Au($r(s,l))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,c=$r(c,l),p=Jd(i.stateNode,c,p),Dd(i,p),tn!==4&&(tn=2)),!1;var v=Error(r(520),{cause:c});if(v=$r(v,l),qu===null?qu=[v]:qu.push(v),tn!==4&&(tn=2),s===null)return!0;c=$r(c,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,i=p&-p,l.lanes|=i,i=Jd(l.stateNode,c,i),Dd(l,i),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(ts===null||!ts.has(v))))return l.flags|=65536,p&=-p,l.lanes|=p,p=tx(p),nx(p,i,l,c),Dd(l,p),!1}l=l.return}while(l!==null);return!1}var rx=Error(r(461)),Nn=!1;function Ln(i,s,l,c){s.child=i===null?Yv(s,null,l,c):dl(s,i.child,l,c)}function ix(i,s,l,c,p){l=l.render;var v=s.ref;if("ref"in c){var S={};for(var O in c)O!=="ref"&&(S[O]=c[O])}else S=c;return so(s),c=kd(i,s,l,S,v,p),O=Ld(),i!==null&&!Nn?(Vd(i,s,p),ga(i,s,p)):(At&&O&&yd(s),s.flags|=1,Ln(i,s,c,p),s.child)}function ax(i,s,l,c,p){if(i===null){var v=l.type;return typeof v=="function"&&!gd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,sx(i,s,v,c,p)):(i=bf(l.type,null,c,s,s.mode,p),i.ref=s.ref,i.return=s,s.child=i)}if(v=i.child,!om(i,p)){var S=v.memoizedProps;if(l=l.compare,l=l!==null?l:_u,l(S,c)&&i.ref===s.ref)return ga(i,s,p)}return s.flags|=1,i=ua(v,c),i.ref=s.ref,i.return=s,s.child=i}function sx(i,s,l,c,p){if(i!==null){var v=i.memoizedProps;if(_u(v,c)&&i.ref===s.ref)if(Nn=!1,s.pendingProps=c=v,om(i,p))(i.flags&131072)!==0&&(Nn=!0);else return s.lanes=i.lanes,ga(i,s,p)}return em(i,s,l,c,p)}function ox(i,s,l){var c=s.pendingProps,p=c.children,v=i!==null?i.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=v!==null?v.baseLanes|l:l,i!==null){for(p=s.child=i.child,v=0;p!==null;)v=v|p.lanes|p.childLanes,p=p.sibling;s.childLanes=v&~c}else s.childLanes=0,s.child=null;return lx(i,s,c,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&Df(s,v!==null?v.cachePool:null),v!==null?sv(s,v):Fd(),Xv(s);else return s.lanes=s.childLanes=536870912,lx(i,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(Df(s,v.cachePool),sv(s,v),Wa(),s.memoizedState=null):(i!==null&&Df(s,null),Fd(),Wa());return Ln(i,s,p,l),s.child}function lx(i,s,l,c){var p=Cd();return p=p===null?null:{parent:Tn._currentValue,pool:p},s.memoizedState={baseLanes:l,cachePool:p},i!==null&&Df(s,null),Fd(),Xv(s),i!==null&&Su(i,s,c,!0),null}function Xf(i,s){var l=s.ref;if(l===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(i===null||i.ref!==l)&&(s.flags|=4194816)}}function em(i,s,l,c,p){return so(s),l=kd(i,s,l,c,void 0,p),c=Ld(),i!==null&&!Nn?(Vd(i,s,p),ga(i,s,p)):(At&&c&&yd(s),s.flags|=1,Ln(i,s,l,p),s.child)}function ux(i,s,l,c,p,v){return so(s),s.updateQueue=null,l=lv(s,c,l,p),ov(i),c=Ld(),i!==null&&!Nn?(Vd(i,s,v),ga(i,s,v)):(At&&c&&yd(s),s.flags|=1,Ln(i,s,l,v),s.child)}function cx(i,s,l,c,p){if(so(s),s.stateNode===null){var v=rl,S=l.contextType;typeof S=="object"&&S!==null&&(v=Qn(S)),v=new l(c,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Zd,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=c,v.state=s.memoizedState,v.refs={},Nd(s),S=l.contextType,v.context=typeof S=="object"&&S!==null?Qn(S):rl,v.state=s.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&(Qd(s,l,S,c),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(S=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),S!==v.state&&Zd.enqueueReplaceState(v,v.state,null),Ou(s,c,v,p),Du(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(i===null){v=s.stateNode;var O=s.memoizedProps,X=uo(l,O);v.props=X;var se=v.context,ye=l.contextType;S=rl,typeof ye=="object"&&ye!==null&&(S=Qn(ye));var Te=l.getDerivedStateFromProps;ye=typeof Te=="function"||typeof v.getSnapshotBeforeUpdate=="function",O=s.pendingProps!==O,ye||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(O||se!==S)&&Kv(s,v,c,S),Ga=!1;var ue=s.memoizedState;v.state=ue,Ou(s,c,v,p),Du(),se=s.memoizedState,O||ue!==se||Ga?(typeof Te=="function"&&(Qd(s,l,Te,c),se=s.memoizedState),(X=Ga||Wv(s,l,X,c,ue,se,S))?(ye||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=se),v.props=c,v.state=se,v.context=S,c=X):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{v=s.stateNode,Id(i,s),S=s.memoizedProps,ye=uo(l,S),v.props=ye,Te=s.pendingProps,ue=v.context,se=l.contextType,X=rl,typeof se=="object"&&se!==null&&(X=Qn(se)),O=l.getDerivedStateFromProps,(se=typeof O=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==Te||ue!==X)&&Kv(s,v,c,X),Ga=!1,ue=s.memoizedState,v.state=ue,Ou(s,c,v,p),Du();var fe=s.memoizedState;S!==Te||ue!==fe||Ga||i!==null&&i.dependencies!==null&&Nf(i.dependencies)?(typeof O=="function"&&(Qd(s,l,O,c),fe=s.memoizedState),(ye=Ga||Wv(s,l,ye,c,ue,fe,X)||i!==null&&i.dependencies!==null&&Nf(i.dependencies))?(se||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,fe,X),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,fe,X)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=fe),v.props=c,v.state=fe,v.context=X,c=ye):(typeof v.componentDidUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),c=!1)}return v=c,Xf(i,s),c=(s.flags&128)!==0,v||c?(v=s.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,i!==null&&c?(s.child=dl(s,i.child,null,p),s.child=dl(s,null,l,p)):Ln(i,s,l,p),s.memoizedState=v.state,i=s.child):i=ga(i,s,p),i}function fx(i,s,l,c){return wu(),s.flags|=256,Ln(i,s,l,c),s.child}var tm={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function nm(i){return{baseLanes:i,cachePool:Z1()}}function rm(i,s,l){return i=i!==null?i.childLanes&~l:0,s&&(i|=Qr),i}function hx(i,s,l){var c=s.pendingProps,p=!1,v=(s.flags&128)!==0,S;if((S=v)||(S=i!==null&&i.memoizedState===null?!1:(wn.current&2)!==0),S&&(p=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,i===null){if(At){if(p?Xa(s):Wa(),At){var O=en,X;if(X=O){e:{for(X=O,O=Mi;X.nodeType!==8;){if(!O){O=null;break e}if(X=ci(X.nextSibling),X===null){O=null;break e}}O=X}O!==null?(s.memoizedState={dehydrated:O,treeContext:to!==null?{id:ca,overflow:fa}:null,retryLane:536870912,hydrationErrors:null},X=Ir(18,null,null,0),X.stateNode=O,X.return=s,s.child=X,cr=s,en=null,X=!0):X=!1}X||io(s)}if(O=s.memoizedState,O!==null&&(O=O.dehydrated,O!==null))return Um(O)?s.lanes=32:s.lanes=536870912,null;pa(s)}return O=c.children,c=c.fallback,p?(Wa(),p=s.mode,O=Wf({mode:"hidden",children:O},p),c=eo(c,p,l,null),O.return=s,c.return=s,O.sibling=c,s.child=O,p=s.child,p.memoizedState=nm(l),p.childLanes=rm(i,S,l),s.memoizedState=tm,c):(Xa(s),im(s,O))}if(X=i.memoizedState,X!==null&&(O=X.dehydrated,O!==null)){if(v)s.flags&256?(Xa(s),s.flags&=-257,s=am(i,s,l)):s.memoizedState!==null?(Wa(),s.child=i.child,s.flags|=128,s=null):(Wa(),p=c.fallback,O=s.mode,c=Wf({mode:"visible",children:c.children},O),p=eo(p,O,l,null),p.flags|=2,c.return=s,p.return=s,c.sibling=p,s.child=c,dl(s,i.child,null,l),c=s.child,c.memoizedState=nm(l),c.childLanes=rm(i,S,l),s.memoizedState=tm,s=p);else if(Xa(s),Um(O)){if(S=O.nextSibling&&O.nextSibling.dataset,S)var se=S.dgst;S=se,c=Error(r(419)),c.stack="",c.digest=S,Au({value:c,source:null,stack:null}),s=am(i,s,l)}else if(Nn||Su(i,s,l,!1),S=(l&i.childLanes)!==0,Nn||S){if(S=qt,S!==null&&(c=l&-l,c=(c&42)!==0?1:wi(c),c=(c&(S.suspendedLanes|l))!==0?0:c,c!==0&&c!==X.retryLane))throw X.retryLane=c,nl(i,c),Pr(S,i,c),rx;O.data==="$?"||wm(),s=am(i,s,l)}else O.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=X.treeContext,en=ci(O.nextSibling),cr=s,At=!0,ro=null,Mi=!1,i!==null&&(Xr[Wr++]=ca,Xr[Wr++]=fa,Xr[Wr++]=to,ca=i.id,fa=i.overflow,to=s),s=im(s,c.children),s.flags|=4096);return s}return p?(Wa(),p=c.fallback,O=s.mode,X=i.child,se=X.sibling,c=ua(X,{mode:"hidden",children:c.children}),c.subtreeFlags=X.subtreeFlags&65011712,se!==null?p=ua(se,p):(p=eo(p,O,l,null),p.flags|=2),p.return=s,c.return=s,c.sibling=p,s.child=c,c=p,p=s.child,O=i.child.memoizedState,O===null?O=nm(l):(X=O.cachePool,X!==null?(se=Tn._currentValue,X=X.parent!==se?{parent:se,pool:se}:X):X=Z1(),O={baseLanes:O.baseLanes|l,cachePool:X}),p.memoizedState=O,p.childLanes=rm(i,S,l),s.memoizedState=tm,c):(Xa(s),l=i.child,i=l.sibling,l=ua(l,{mode:"visible",children:c.children}),l.return=s,l.sibling=null,i!==null&&(S=s.deletions,S===null?(s.deletions=[i],s.flags|=16):S.push(i)),s.child=l,s.memoizedState=null,l)}function im(i,s){return s=Wf({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Wf(i,s){return i=Ir(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function am(i,s,l){return dl(s,i.child,null,l),i=im(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function dx(i,s,l){i.lanes|=s;var c=i.alternate;c!==null&&(c.lanes|=s),wd(i.return,s,l)}function sm(i,s,l,c,p){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:p}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=p)}function mx(i,s,l){var c=s.pendingProps,p=c.revealOrder,v=c.tail;if(Ln(i,s,c.children,l),c=wn.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&dx(i,l,s);else if(i.tag===19)dx(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}c&=1}switch(W(wn,c),p){case"forwards":for(l=s.child,p=null;l!==null;)i=l.alternate,i!==null&&qf(i)===null&&(p=l),l=l.sibling;l=p,l===null?(p=s.child,s.child=null):(p=l.sibling,l.sibling=null),sm(s,!1,p,l,v);break;case"backwards":for(l=null,p=s.child,s.child=null;p!==null;){if(i=p.alternate,i!==null&&qf(i)===null){s.child=p;break}i=p.sibling,p.sibling=l,l=p,p=i}sm(s,!0,l,null,v);break;case"together":sm(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function ga(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),es|=s.lanes,(l&s.childLanes)===0)if(i!==null){if(Su(i,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,l=ua(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=ua(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function om(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Nf(i)))}function XS(i,s,l){switch(s.tag){case 3:Fe(s,s.stateNode.containerInfo),Ha(s,Tn,i.memoizedState.cache),wu();break;case 27:case 5:Me(s);break;case 4:Fe(s,s.stateNode.containerInfo);break;case 10:Ha(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(Xa(s),s.flags|=128,null):(l&s.child.childLanes)!==0?hx(i,s,l):(Xa(s),i=ga(i,s,l),i!==null?i.sibling:null);Xa(s);break;case 19:var p=(i.flags&128)!==0;if(c=(l&s.childLanes)!==0,c||(Su(i,s,l,!1),c=(l&s.childLanes)!==0),p){if(c)return mx(i,s,l);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),W(wn,wn.current),c)break;return null;case 22:case 23:return s.lanes=0,ox(i,s,l);case 24:Ha(s,Tn,i.memoizedState.cache)}return ga(i,s,l)}function px(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps)Nn=!0;else{if(!om(i,l)&&(s.flags&128)===0)return Nn=!1,XS(i,s,l);Nn=(i.flags&131072)!==0}else Nn=!1,At&&(s.flags&1048576)!==0&&q1(s,Rf,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var c=s.elementType,p=c._init;if(c=p(c._payload),s.type=c,typeof c=="function")gd(c)?(i=uo(c,i),s.tag=1,s=cx(null,s,c,i,l)):(s.tag=0,s=em(null,s,c,i,l));else{if(c!=null){if(p=c.$$typeof,p===ee){s.tag=11,s=ix(null,s,c,i,l);break e}else if(p===D){s.tag=14,s=ax(null,s,c,i,l);break e}}throw s=Je(c)||c,Error(r(306,s,""))}}return s;case 0:return em(i,s,s.type,s.pendingProps,l);case 1:return c=s.type,p=uo(c,s.pendingProps),cx(i,s,c,p,l);case 3:e:{if(Fe(s,s.stateNode.containerInfo),i===null)throw Error(r(387));c=s.pendingProps;var v=s.memoizedState;p=v.element,Id(i,s),Ou(s,c,null,l);var S=s.memoizedState;if(c=S.cache,Ha(s,Tn,c),c!==v.cache&&Ad(s,[Tn],l,!0),Du(),c=S.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=fx(i,s,c,l);break e}else if(c!==p){p=$r(Error(r(424)),s),Au(p),s=fx(i,s,c,l);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(en=ci(i.firstChild),cr=s,At=!0,ro=null,Mi=!0,l=Yv(s,null,c,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(wu(),c===p){s=ga(i,s,l);break e}Ln(i,s,c,l)}s=s.child}return s;case 26:return Xf(i,s),i===null?(l=yy(s.type,null,s.pendingProps,null))?s.memoizedState=l:At||(l=s.type,i=s.pendingProps,c=uh(ce.current).createElement(l),c[sn]=s,c[Xt]=i,Bn(c,l,i),ne(c),s.stateNode=c):s.memoizedState=yy(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Me(s),i===null&&At&&(c=s.stateNode=gy(s.type,s.pendingProps,ce.current),cr=s,Mi=!0,p=en,is(s.type)?(jm=p,en=ci(c.firstChild)):en=p),Ln(i,s,s.pendingProps.children,l),Xf(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&At&&((p=c=en)&&(c=T4(c,s.type,s.pendingProps,Mi),c!==null?(s.stateNode=c,cr=s,en=ci(c.firstChild),Mi=!1,p=!0):p=!1),p||io(s)),Me(s),p=s.type,v=s.pendingProps,S=i!==null?i.memoizedProps:null,c=v.children,Lm(p,v)?c=null:S!==null&&Lm(p,S)&&(s.flags|=32),s.memoizedState!==null&&(p=kd(i,s,US,null,null,l),ec._currentValue=p),Xf(i,s),Ln(i,s,c,l),s.child;case 6:return i===null&&At&&((i=l=en)&&(l=w4(l,s.pendingProps,Mi),l!==null?(s.stateNode=l,cr=s,en=null,i=!0):i=!1),i||io(s)),null;case 13:return hx(i,s,l);case 4:return Fe(s,s.stateNode.containerInfo),c=s.pendingProps,i===null?s.child=dl(s,null,c,l):Ln(i,s,c,l),s.child;case 11:return ix(i,s,s.type,s.pendingProps,l);case 7:return Ln(i,s,s.pendingProps,l),s.child;case 8:return Ln(i,s,s.pendingProps.children,l),s.child;case 12:return Ln(i,s,s.pendingProps.children,l),s.child;case 10:return c=s.pendingProps,Ha(s,s.type,c.value),Ln(i,s,c.children,l),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,so(s),p=Qn(p),c=c(p),s.flags|=1,Ln(i,s,c,l),s.child;case 14:return ax(i,s,s.type,s.pendingProps,l);case 15:return sx(i,s,s.type,s.pendingProps,l);case 19:return mx(i,s,l);case 31:return c=s.pendingProps,l=s.mode,c={mode:c.mode,children:c.children},i===null?(l=Wf(c,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=ua(i.child,c),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return ox(i,s,l);case 24:return so(s),c=Qn(Tn),i===null?(p=Cd(),p===null&&(p=qt,v=Sd(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=l),p=v),s.memoizedState={parent:c,cache:p},Nd(s),Ha(s,Tn,p)):((i.lanes&l)!==0&&(Id(i,s),Ou(s,null,null,l),Du()),p=i.memoizedState,v=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),Ha(s,Tn,c)):(c=v.cache,Ha(s,Tn,c),c!==p.cache&&Ad(s,[Tn],l,!0))),Ln(i,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function va(i){i.flags|=4}function gx(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!Ay(s)){if(s=Kr.current,s!==null&&((vt&4194048)===vt?Pi!==null:(vt&62914560)!==vt&&(vt&536870912)===0||s!==Pi))throw Nu=Rd,J1;i.flags|=8192}}function Kf(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Ba():536870912,i.lanes|=s,vl|=s)}function Bu(i,s){if(!At)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function Qt(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,c=0;if(s)for(var p=i.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=c,i.childLanes=l,s}function WS(i,s,l){var c=s.pendingProps;switch(_d(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qt(s),null;case 1:return Qt(s),null;case 3:return l=s.stateNode,c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),da(Tn),Be(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(Tu(s)?va(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,X1())),Qt(s),null;case 26:return l=s.memoizedState,i===null?(va(s),l!==null?(Qt(s),gx(s,l)):(Qt(s),s.flags&=-16777217)):l?l!==i.memoizedState?(va(s),Qt(s),gx(s,l)):(Qt(s),s.flags&=-16777217):(i.memoizedProps!==c&&va(s),Qt(s),s.flags&=-16777217),null;case 27:ut(s),l=ce.current;var p=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==c&&va(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Qt(s),null}i=K.current,Tu(s)?$1(s):(i=gy(p,c,l),s.stateNode=i,va(s))}return Qt(s),null;case 5:if(ut(s),l=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==c&&va(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Qt(s),null}if(i=K.current,Tu(s))$1(s);else{switch(p=uh(ce.current),i){case 1:i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=p.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof c.is=="string"?p.createElement("select",{is:c.is}):p.createElement("select"),c.multiple?i.multiple=!0:c.size&&(i.size=c.size);break;default:i=typeof c.is=="string"?p.createElement(l,{is:c.is}):p.createElement(l)}}i[sn]=s,i[Xt]=c;e:for(p=s.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===s)break e;for(;p.sibling===null;){if(p.return===null||p.return===s)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}s.stateNode=i;e:switch(Bn(i,l,c),l){case"button":case"input":case"select":case"textarea":i=!!c.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&va(s)}}return Qt(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==c&&va(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(r(166));if(i=ce.current,Tu(s)){if(i=s.stateNode,l=s.memoizedProps,c=null,p=cr,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}i[sn]=s,i=!!(i.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||uy(i.nodeValue,l)),i||io(s)}else i=uh(i).createTextNode(c),i[sn]=s,s.stateNode=i}return Qt(s),null;case 13:if(c=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=Tu(s),c!==null&&c.dehydrated!==null){if(i===null){if(!p)throw Error(r(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[sn]=s}else wu(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Qt(s),p=!1}else p=X1(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(pa(s),s):(pa(s),null)}if(pa(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=c!==null,i=i!==null&&i.memoizedState!==null,l){c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool);var v=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==p&&(c.flags|=2048)}return l!==i&&l&&(s.child.flags|=8192),Kf(s,s.updateQueue),Qt(s),null;case 4:return Be(),i===null&&Om(s.stateNode.containerInfo),Qt(s),null;case 10:return da(s.type),Qt(s),null;case 19:if(U(wn),p=s.memoizedState,p===null)return Qt(s),null;if(c=(s.flags&128)!==0,v=p.rendering,v===null)if(c)Bu(p,!1);else{if(tn!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(v=qf(i),v!==null){for(s.flags|=128,Bu(p,!1),i=v.updateQueue,s.updateQueue=i,Kf(s,i),s.subtreeFlags=0,i=l,l=s.child;l!==null;)G1(l,i),l=l.sibling;return W(wn,wn.current&1|2),s.child}i=i.sibling}p.tail!==null&&Ve()>Jf&&(s.flags|=128,c=!0,Bu(p,!1),s.lanes=4194304)}else{if(!c)if(i=qf(v),i!==null){if(s.flags|=128,c=!0,i=i.updateQueue,s.updateQueue=i,Kf(s,i),Bu(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!At)return Qt(s),null}else 2*Ve()-p.renderingStartTime>Jf&&l!==536870912&&(s.flags|=128,c=!0,Bu(p,!1),s.lanes=4194304);p.isBackwards?(v.sibling=s.child,s.child=v):(i=p.last,i!==null?i.sibling=v:s.child=v,p.last=v)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=Ve(),s.sibling=null,i=wn.current,W(wn,c?i&1|2:i&1),s):(Qt(s),null);case 22:case 23:return pa(s),Md(),c=s.memoizedState!==null,i!==null?i.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(l&536870912)!==0&&(s.flags&128)===0&&(Qt(s),s.subtreeFlags&6&&(s.flags|=8192)):Qt(s),l=s.updateQueue,l!==null&&Kf(s,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==l&&(s.flags|=2048),i!==null&&U(oo),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),da(Tn),Qt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function KS(i,s){switch(_d(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return da(Tn),Be(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return ut(s),null;case 13:if(pa(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));wu()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return U(wn),null;case 4:return Be(),null;case 10:return da(s.type),null;case 22:case 23:return pa(s),Md(),i!==null&&U(oo),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return da(Tn),null;case 25:return null;default:return null}}function vx(i,s){switch(_d(s),s.tag){case 3:da(Tn),Be();break;case 26:case 27:case 5:ut(s);break;case 4:Be();break;case 13:pa(s);break;case 19:U(wn);break;case 10:da(s.type);break;case 22:case 23:pa(s),Md(),i!==null&&U(oo);break;case 24:da(Tn)}}function Uu(i,s){try{var l=s.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var p=c.next;l=p;do{if((l.tag&i)===i){c=void 0;var v=l.create,S=l.inst;c=v(),S.destroy=c}l=l.next}while(l!==p)}}catch(O){jt(s,s.return,O)}}function Ka(i,s,l){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var v=p.next;c=v;do{if((c.tag&i)===i){var S=c.inst,O=S.destroy;if(O!==void 0){S.destroy=void 0,p=s;var X=l,se=O;try{se()}catch(ye){jt(p,X,ye)}}}c=c.next}while(c!==v)}}catch(ye){jt(s,s.return,ye)}}function xx(i){var s=i.updateQueue;if(s!==null){var l=i.stateNode;try{av(s,l)}catch(c){jt(i,i.return,c)}}}function yx(i,s,l){l.props=uo(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(c){jt(i,s,c)}}function ju(i,s){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var c=i.stateNode;break;case 30:c=i.stateNode;break;default:c=i.stateNode}typeof l=="function"?i.refCleanup=l(c):l.current=c}}catch(p){jt(i,s,p)}}function ki(i,s){var l=i.ref,c=i.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(p){jt(i,s,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){jt(i,s,p)}else l.current=null}function _x(i){var s=i.type,l=i.memoizedProps,c=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(p){jt(i,i.return,p)}}function lm(i,s,l){try{var c=i.stateNode;v4(c,i.type,l,s),c[Xt]=s}catch(p){jt(i,i.return,p)}}function Ex(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&is(i.type)||i.tag===4}function um(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||Ex(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&is(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function cm(i,s,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(i),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=lh));else if(c!==4&&(c===27&&is(i.type)&&(l=i.stateNode,s=null),i=i.child,i!==null))for(cm(i,s,l),i=i.sibling;i!==null;)cm(i,s,l),i=i.sibling}function Qf(i,s,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(c!==4&&(c===27&&is(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Qf(i,s,l),i=i.sibling;i!==null;)Qf(i,s,l),i=i.sibling}function Tx(i){var s=i.stateNode,l=i.memoizedProps;try{for(var c=i.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);Bn(s,c,l),s[sn]=i,s[Xt]=l}catch(v){jt(i,i.return,v)}}var xa=!1,ln=!1,fm=!1,wx=typeof WeakSet=="function"?WeakSet:Set,In=null;function QS(i,s){if(i=i.containerInfo,Pm=ph,i=M1(i),ud(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var p=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var S=0,O=-1,X=-1,se=0,ye=0,Te=i,ue=null;t:for(;;){for(var fe;Te!==l||p!==0&&Te.nodeType!==3||(O=S+p),Te!==v||c!==0&&Te.nodeType!==3||(X=S+c),Te.nodeType===3&&(S+=Te.nodeValue.length),(fe=Te.firstChild)!==null;)ue=Te,Te=fe;for(;;){if(Te===i)break t;if(ue===l&&++se===p&&(O=S),ue===v&&++ye===c&&(X=S),(fe=Te.nextSibling)!==null)break;Te=ue,ue=Te.parentNode}Te=fe}l=O===-1||X===-1?null:{start:O,end:X}}else l=null}l=l||{start:0,end:0}}else l=null;for(km={focusedElem:i,selectionRange:l},ph=!1,In=s;In!==null;)if(s=In,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,In=i;else for(;In!==null;){switch(s=In,v=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,l=s,p=v.memoizedProps,v=v.memoizedState,c=l.stateNode;try{var Ze=uo(l.type,p,l.elementType===l.type);i=c.getSnapshotBeforeUpdate(Ze,v),c.__reactInternalSnapshotBeforeUpdate=i}catch(Ye){jt(l,l.return,Ye)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,l=i.nodeType,l===9)Bm(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Bm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,In=i;break}In=s.return}}function Ax(i,s,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:Qa(i,l),c&4&&Uu(5,l);break;case 1:if(Qa(i,l),c&4)if(i=l.stateNode,s===null)try{i.componentDidMount()}catch(S){jt(l,l.return,S)}else{var p=uo(l.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(p,s,i.__reactInternalSnapshotBeforeUpdate)}catch(S){jt(l,l.return,S)}}c&64&&xx(l),c&512&&ju(l,l.return);break;case 3:if(Qa(i,l),c&64&&(i=l.updateQueue,i!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{av(i,s)}catch(S){jt(l,l.return,S)}}break;case 27:s===null&&c&4&&Tx(l);case 26:case 5:Qa(i,l),s===null&&c&4&&_x(l),c&512&&ju(l,l.return);break;case 12:Qa(i,l);break;case 13:Qa(i,l),c&4&&Cx(i,l),c&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=s4.bind(null,l),A4(i,l))));break;case 22:if(c=l.memoizedState!==null||xa,!c){s=s!==null&&s.memoizedState!==null||ln,p=xa;var v=ln;xa=c,(ln=s)&&!v?Za(i,l,(l.subtreeFlags&8772)!==0):Qa(i,l),xa=p,ln=v}break;case 30:break;default:Qa(i,l)}}function Sx(i){var s=i.alternate;s!==null&&(i.alternate=null,Sx(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&L(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Wt=null,_r=!1;function ya(i,s,l){for(l=l.child;l!==null;)bx(i,s,l),l=l.sibling}function bx(i,s,l){if(_t&&typeof _t.onCommitFiberUnmount=="function")try{_t.onCommitFiberUnmount(Ht,l)}catch{}switch(l.tag){case 26:ln||ki(l,s),ya(i,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:ln||ki(l,s);var c=Wt,p=_r;is(l.type)&&(Wt=l.stateNode,_r=!1),ya(i,s,l),Ku(l.stateNode),Wt=c,_r=p;break;case 5:ln||ki(l,s);case 6:if(c=Wt,p=_r,Wt=null,ya(i,s,l),Wt=c,_r=p,Wt!==null)if(_r)try{(Wt.nodeType===9?Wt.body:Wt.nodeName==="HTML"?Wt.ownerDocument.body:Wt).removeChild(l.stateNode)}catch(v){jt(l,s,v)}else try{Wt.removeChild(l.stateNode)}catch(v){jt(l,s,v)}break;case 18:Wt!==null&&(_r?(i=Wt,my(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),ic(i)):my(Wt,l.stateNode));break;case 4:c=Wt,p=_r,Wt=l.stateNode.containerInfo,_r=!0,ya(i,s,l),Wt=c,_r=p;break;case 0:case 11:case 14:case 15:ln||Ka(2,l,s),ln||Ka(4,l,s),ya(i,s,l);break;case 1:ln||(ki(l,s),c=l.stateNode,typeof c.componentWillUnmount=="function"&&yx(l,s,c)),ya(i,s,l);break;case 21:ya(i,s,l);break;case 22:ln=(c=ln)||l.memoizedState!==null,ya(i,s,l),ln=c;break;default:ya(i,s,l)}}function Cx(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{ic(i)}catch(l){jt(s,s.return,l)}}function ZS(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new wx),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new wx),s;default:throw Error(r(435,i.tag))}}function hm(i,s){var l=ZS(i);s.forEach(function(c){var p=o4.bind(null,i,c);l.has(c)||(l.add(c),c.then(p,p))})}function Dr(i,s){var l=s.deletions;if(l!==null)for(var c=0;c<l.length;c++){var p=l[c],v=i,S=s,O=S;e:for(;O!==null;){switch(O.tag){case 27:if(is(O.type)){Wt=O.stateNode,_r=!1;break e}break;case 5:Wt=O.stateNode,_r=!1;break e;case 3:case 4:Wt=O.stateNode.containerInfo,_r=!0;break e}O=O.return}if(Wt===null)throw Error(r(160));bx(v,S,p),Wt=null,_r=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)Rx(s,i),s=s.sibling}var ui=null;function Rx(i,s){var l=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Dr(s,i),Or(i),c&4&&(Ka(3,i,i.return),Uu(3,i),Ka(5,i,i.return));break;case 1:Dr(s,i),Or(i),c&512&&(ln||l===null||ki(l,l.return)),c&64&&xa&&(i=i.updateQueue,i!==null&&(c=i.callbacks,c!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var p=ui;if(Dr(s,i),Or(i),c&512&&(ln||l===null||ki(l,l.return)),c&4){var v=l!==null?l.memoizedState:null;if(c=i.memoizedState,l===null)if(c===null)if(i.stateNode===null){e:{c=i.type,l=i.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":v=p.getElementsByTagName("title")[0],(!v||v[M]||v[sn]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(c),p.head.insertBefore(v,p.querySelector("head > title"))),Bn(v,c,l),v[sn]=i,ne(v),c=v;break e;case"link":var S=Ty("link","href",p).get(c+(l.href||""));if(S){for(var O=0;O<S.length;O++)if(v=S[O],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(O,1);break t}}v=p.createElement(c),Bn(v,c,l),p.head.appendChild(v);break;case"meta":if(S=Ty("meta","content",p).get(c+(l.content||""))){for(O=0;O<S.length;O++)if(v=S[O],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(O,1);break t}}v=p.createElement(c),Bn(v,c,l),p.head.appendChild(v);break;default:throw Error(r(468,c))}v[sn]=i,ne(v),c=v}i.stateNode=c}else wy(p,i.type,i.stateNode);else i.stateNode=Ey(p,c,i.memoizedProps);else v!==c?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,c===null?wy(p,i.type,i.stateNode):Ey(p,c,i.memoizedProps)):c===null&&i.stateNode!==null&&lm(i,i.memoizedProps,l.memoizedProps)}break;case 27:Dr(s,i),Or(i),c&512&&(ln||l===null||ki(l,l.return)),l!==null&&c&4&&lm(i,i.memoizedProps,l.memoizedProps);break;case 5:if(Dr(s,i),Or(i),c&512&&(ln||l===null||ki(l,l.return)),i.flags&32){p=i.stateNode;try{zr(p,"")}catch(fe){jt(i,i.return,fe)}}c&4&&i.stateNode!=null&&(p=i.memoizedProps,lm(i,p,l!==null?l.memoizedProps:p)),c&1024&&(fm=!0);break;case 6:if(Dr(s,i),Or(i),c&4){if(i.stateNode===null)throw Error(r(162));c=i.memoizedProps,l=i.stateNode;try{l.nodeValue=c}catch(fe){jt(i,i.return,fe)}}break;case 3:if(hh=null,p=ui,ui=ch(s.containerInfo),Dr(s,i),ui=p,Or(i),c&4&&l!==null&&l.memoizedState.isDehydrated)try{ic(s.containerInfo)}catch(fe){jt(i,i.return,fe)}fm&&(fm=!1,Nx(i));break;case 4:c=ui,ui=ch(i.stateNode.containerInfo),Dr(s,i),Or(i),ui=c;break;case 12:Dr(s,i),Or(i);break;case 13:Dr(s,i),Or(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(xm=Ve()),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,hm(i,c)));break;case 22:p=i.memoizedState!==null;var X=l!==null&&l.memoizedState!==null,se=xa,ye=ln;if(xa=se||p,ln=ye||X,Dr(s,i),ln=ye,xa=se,Or(i),c&8192)e:for(s=i.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(l===null||X||xa||ln||co(i)),l=null,s=i;;){if(s.tag===5||s.tag===26){if(l===null){X=l=s;try{if(v=X.stateNode,p)S=v.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{O=X.stateNode;var Te=X.memoizedProps.style,ue=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;O.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(fe){jt(X,X.return,fe)}}}else if(s.tag===6){if(l===null){X=s;try{X.stateNode.nodeValue=p?"":X.memoizedProps}catch(fe){jt(X,X.return,fe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=i.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,hm(i,l))));break;case 19:Dr(s,i),Or(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,hm(i,c)));break;case 30:break;case 21:break;default:Dr(s,i),Or(i)}}function Or(i){var s=i.flags;if(s&2){try{for(var l,c=i.return;c!==null;){if(Ex(c)){l=c;break}c=c.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var p=l.stateNode,v=um(i);Qf(i,v,p);break;case 5:var S=l.stateNode;l.flags&32&&(zr(S,""),l.flags&=-33);var O=um(i);Qf(i,O,S);break;case 3:case 4:var X=l.stateNode.containerInfo,se=um(i);cm(i,se,X);break;default:throw Error(r(161))}}catch(ye){jt(i,i.return,ye)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function Nx(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;Nx(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Qa(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)Ax(i,s.alternate,s),s=s.sibling}function co(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Ka(4,s,s.return),co(s);break;case 1:ki(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&yx(s,s.return,l),co(s);break;case 27:Ku(s.stateNode);case 26:case 5:ki(s,s.return),co(s);break;case 22:s.memoizedState===null&&co(s);break;case 30:co(s);break;default:co(s)}i=i.sibling}}function Za(i,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=i,v=s,S=v.flags;switch(v.tag){case 0:case 11:case 15:Za(p,v,l),Uu(4,v);break;case 1:if(Za(p,v,l),c=v,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){jt(c,c.return,se)}if(c=v,p=c.updateQueue,p!==null){var O=c.stateNode;try{var X=p.shared.hiddenCallbacks;if(X!==null)for(p.shared.hiddenCallbacks=null,p=0;p<X.length;p++)iv(X[p],O)}catch(se){jt(c,c.return,se)}}l&&S&64&&xx(v),ju(v,v.return);break;case 27:Tx(v);case 26:case 5:Za(p,v,l),l&&c===null&&S&4&&_x(v),ju(v,v.return);break;case 12:Za(p,v,l);break;case 13:Za(p,v,l),l&&S&4&&Cx(p,v);break;case 22:v.memoizedState===null&&Za(p,v,l),ju(v,v.return);break;case 30:break;default:Za(p,v,l)}s=s.sibling}}function dm(i,s){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&bu(l))}function mm(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&bu(i))}function Li(i,s,l,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)Ix(i,s,l,c),s=s.sibling}function Ix(i,s,l,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Li(i,s,l,c),p&2048&&Uu(9,s);break;case 1:Li(i,s,l,c);break;case 3:Li(i,s,l,c),p&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&bu(i)));break;case 12:if(p&2048){Li(i,s,l,c),i=s.stateNode;try{var v=s.memoizedProps,S=v.id,O=v.onPostCommit;typeof O=="function"&&O(S,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(X){jt(s,s.return,X)}}else Li(i,s,l,c);break;case 13:Li(i,s,l,c);break;case 23:break;case 22:v=s.stateNode,S=s.alternate,s.memoizedState!==null?v._visibility&2?Li(i,s,l,c):zu(i,s):v._visibility&2?Li(i,s,l,c):(v._visibility|=2,ml(i,s,l,c,(s.subtreeFlags&10256)!==0)),p&2048&&dm(S,s);break;case 24:Li(i,s,l,c),p&2048&&mm(s.alternate,s);break;default:Li(i,s,l,c)}}function ml(i,s,l,c,p){for(p=p&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=i,S=s,O=l,X=c,se=S.flags;switch(S.tag){case 0:case 11:case 15:ml(v,S,O,X,p),Uu(8,S);break;case 23:break;case 22:var ye=S.stateNode;S.memoizedState!==null?ye._visibility&2?ml(v,S,O,X,p):zu(v,S):(ye._visibility|=2,ml(v,S,O,X,p)),p&&se&2048&&dm(S.alternate,S);break;case 24:ml(v,S,O,X,p),p&&se&2048&&mm(S.alternate,S);break;default:ml(v,S,O,X,p)}s=s.sibling}}function zu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=i,c=s,p=c.flags;switch(c.tag){case 22:zu(l,c),p&2048&&dm(c.alternate,c);break;case 24:zu(l,c),p&2048&&mm(c.alternate,c);break;default:zu(l,c)}s=s.sibling}}var Hu=8192;function pl(i){if(i.subtreeFlags&Hu)for(i=i.child;i!==null;)Dx(i),i=i.sibling}function Dx(i){switch(i.tag){case 26:pl(i),i.flags&Hu&&i.memoizedState!==null&&L4(ui,i.memoizedState,i.memoizedProps);break;case 5:pl(i);break;case 3:case 4:var s=ui;ui=ch(i.stateNode.containerInfo),pl(i),ui=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=Hu,Hu=16777216,pl(i),Hu=s):pl(i));break;default:pl(i)}}function Ox(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function Gu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];In=c,Mx(c,i)}Ox(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)Fx(i),i=i.sibling}function Fx(i){switch(i.tag){case 0:case 11:case 15:Gu(i),i.flags&2048&&Ka(9,i,i.return);break;case 3:Gu(i);break;case 12:Gu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Zf(i)):Gu(i);break;default:Gu(i)}}function Zf(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];In=c,Mx(c,i)}Ox(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Ka(8,s,s.return),Zf(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Zf(s));break;default:Zf(s)}i=i.sibling}}function Mx(i,s){for(;In!==null;){var l=In;switch(l.tag){case 0:case 11:case 15:Ka(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:bu(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,In=c;else e:for(l=i;In!==null;){c=In;var p=c.sibling,v=c.return;if(Sx(c),c===l){In=null;break e}if(p!==null){p.return=v,In=p;break e}In=v}}}var JS={getCacheForType:function(i){var s=Qn(Tn),l=s.data.get(i);return l===void 0&&(l=i(),s.data.set(i,l)),l}},e4=typeof WeakMap=="function"?WeakMap:Map,Rt=0,qt=null,ct=null,vt=0,Nt=0,Fr=null,Ja=!1,gl=!1,pm=!1,_a=0,tn=0,es=0,fo=0,gm=0,Qr=0,vl=0,qu=null,Er=null,vm=!1,xm=0,Jf=1/0,eh=null,ts=null,Vn=0,ns=null,xl=null,yl=0,ym=0,_m=null,Px=null,$u=0,Em=null;function Mr(){if((Rt&2)!==0&&vt!==0)return vt&-vt;if(de.T!==null){var i=sl;return i!==0?i:Rm()}return Ai()}function kx(){Qr===0&&(Qr=(vt&536870912)===0||At?Va():536870912);var i=Kr.current;return i!==null&&(i.flags|=32),Qr}function Pr(i,s,l){(i===qt&&(Nt===2||Nt===9)||i.cancelPendingCommit!==null)&&(_l(i,0),rs(i,vt,Qr,!1)),si(i,l),((Rt&2)===0||i!==qt)&&(i===qt&&((Rt&2)===0&&(fo|=l),tn===4&&rs(i,vt,Qr,!1)),Vi(i))}function Lx(i,s,l){if((Rt&6)!==0)throw Error(r(327));var c=!l&&(s&124)===0&&(s&i.expiredLanes)===0||ta(i,s),p=c?r4(i,s):Am(i,s,!0),v=c;do{if(p===0){gl&&!c&&rs(i,s,0,!1);break}else{if(l=i.current.alternate,v&&!t4(l)){p=Am(i,s,!1),v=!1;continue}if(p===2){if(v=s,i.errorRecoveryDisabledLanes&v)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var O=i;p=qu;var X=O.current.memoizedState.isDehydrated;if(X&&(_l(O,S).flags|=256),S=Am(O,S,!1),S!==2){if(pm&&!X){O.errorRecoveryDisabledLanes|=v,fo|=v,p=4;break e}v=Er,Er=p,v!==null&&(Er===null?Er=v:Er.push.apply(Er,v))}p=S}if(v=!1,p!==2)continue}}if(p===1){_l(i,0),rs(i,s,0,!0);break}e:{switch(c=i,v=p,v){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:rs(c,s,Qr,!Ja);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(p=xm+300-Ve(),10<p)){if(rs(c,s,Qr,!Ja),ka(c,0,!0)!==0)break e;c.timeoutHandle=hy(Vx.bind(null,c,l,Er,eh,vm,s,Qr,fo,vl,Ja,v,2,-0,0),p);break e}Vx(c,l,Er,eh,vm,s,Qr,fo,vl,Ja,v,0,-0,0)}}break}while(!0);Vi(i)}function Vx(i,s,l,c,p,v,S,O,X,se,ye,Te,ue,fe){if(i.timeoutHandle=-1,Te=s.subtreeFlags,(Te&8192||(Te&16785408)===16785408)&&(Ju={stylesheets:null,count:0,unsuspend:k4},Dx(s),Te=V4(),Te!==null)){i.cancelPendingCommit=Te(qx.bind(null,i,s,v,l,c,p,S,O,X,ye,1,ue,fe)),rs(i,v,S,!se);return}qx(i,s,v,l,c,p,S,O,X)}function t4(i){for(var s=i;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var p=l[c],v=p.getSnapshot;p=p.value;try{if(!Nr(v(),p))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function rs(i,s,l,c){s&=~gm,s&=~fo,i.suspendedLanes|=s,i.pingedLanes&=~s,c&&(i.warmLanes|=s),c=i.expirationTimes;for(var p=s;0<p;){var v=31-bn(p),S=1<<v;c[v]=-1,p&=~S}l!==0&&jr(i,l,s)}function th(){return(Rt&6)===0?(Yu(0),!1):!0}function Tm(){if(ct!==null){if(Nt===0)var i=ct.return;else i=ct,ha=ao=null,Bd(i),hl=null,Lu=0,i=ct;for(;i!==null;)vx(i.alternate,i),i=i.return;ct=null}}function _l(i,s){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,y4(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),Tm(),qt=i,ct=l=ua(i.current,null),vt=s,Nt=0,Fr=null,Ja=!1,gl=ta(i,s),pm=!1,vl=Qr=gm=fo=es=tn=0,Er=qu=null,vm=!1,(s&8)!==0&&(s|=s&32);var c=i.entangledLanes;if(c!==0)for(i=i.entanglements,c&=s;0<c;){var p=31-bn(c),v=1<<p;s|=i[p],c&=~v}return _a=s,wf(),l}function Bx(i,s){at=null,de.H=zf,s===Ru||s===Of?(s=nv(),Nt=3):s===J1?(s=nv(),Nt=4):Nt=s===rx?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Fr=s,ct===null&&(tn=1,Yf(i,$r(s,i.current)))}function Ux(){var i=de.H;return de.H=zf,i===null?zf:i}function jx(){var i=de.A;return de.A=JS,i}function wm(){tn=4,Ja||(vt&4194048)!==vt&&Kr.current!==null||(gl=!0),(es&134217727)===0&&(fo&134217727)===0||qt===null||rs(qt,vt,Qr,!1)}function Am(i,s,l){var c=Rt;Rt|=2;var p=Ux(),v=jx();(qt!==i||vt!==s)&&(eh=null,_l(i,s)),s=!1;var S=tn;e:do try{if(Nt!==0&&ct!==null){var O=ct,X=Fr;switch(Nt){case 8:Tm(),S=6;break e;case 3:case 2:case 9:case 6:Kr.current===null&&(s=!0);var se=Nt;if(Nt=0,Fr=null,El(i,O,X,se),l&&gl){S=0;break e}break;default:se=Nt,Nt=0,Fr=null,El(i,O,X,se)}}n4(),S=tn;break}catch(ye){Bx(i,ye)}while(!0);return s&&i.shellSuspendCounter++,ha=ao=null,Rt=c,de.H=p,de.A=v,ct===null&&(qt=null,vt=0,wf()),S}function n4(){for(;ct!==null;)zx(ct)}function r4(i,s){var l=Rt;Rt|=2;var c=Ux(),p=jx();qt!==i||vt!==s?(eh=null,Jf=Ve()+500,_l(i,s)):gl=ta(i,s);e:do try{if(Nt!==0&&ct!==null){s=ct;var v=Fr;t:switch(Nt){case 1:Nt=0,Fr=null,El(i,s,v,1);break;case 2:case 9:if(ev(v)){Nt=0,Fr=null,Hx(s);break}s=function(){Nt!==2&&Nt!==9||qt!==i||(Nt=7),Vi(i)},v.then(s,s);break e;case 3:Nt=7;break e;case 4:Nt=5;break e;case 7:ev(v)?(Nt=0,Fr=null,Hx(s)):(Nt=0,Fr=null,El(i,s,v,7));break;case 5:var S=null;switch(ct.tag){case 26:S=ct.memoizedState;case 5:case 27:var O=ct;if(!S||Ay(S)){Nt=0,Fr=null;var X=O.sibling;if(X!==null)ct=X;else{var se=O.return;se!==null?(ct=se,nh(se)):ct=null}break t}}Nt=0,Fr=null,El(i,s,v,5);break;case 6:Nt=0,Fr=null,El(i,s,v,6);break;case 8:Tm(),tn=6;break e;default:throw Error(r(462))}}i4();break}catch(ye){Bx(i,ye)}while(!0);return ha=ao=null,de.H=c,de.A=p,Rt=l,ct!==null?0:(qt=null,vt=0,wf(),tn)}function i4(){for(;ct!==null&&!ir();)zx(ct)}function zx(i){var s=px(i.alternate,i,_a);i.memoizedProps=i.pendingProps,s===null?nh(i):ct=s}function Hx(i){var s=i,l=s.alternate;switch(s.tag){case 15:case 0:s=ux(l,s,s.pendingProps,s.type,void 0,vt);break;case 11:s=ux(l,s,s.pendingProps,s.type.render,s.ref,vt);break;case 5:Bd(s);default:vx(l,s),s=ct=G1(s,_a),s=px(l,s,_a)}i.memoizedProps=i.pendingProps,s===null?nh(i):ct=s}function El(i,s,l,c){ha=ao=null,Bd(s),hl=null,Lu=0;var p=s.return;try{if(YS(i,p,s,l,vt)){tn=1,Yf(i,$r(l,i.current)),ct=null;return}}catch(v){if(p!==null)throw ct=p,v;tn=1,Yf(i,$r(l,i.current)),ct=null;return}s.flags&32768?(At||c===1?i=!0:gl||(vt&536870912)!==0?i=!1:(Ja=i=!0,(c===2||c===9||c===3||c===6)&&(c=Kr.current,c!==null&&c.tag===13&&(c.flags|=16384))),Gx(s,i)):nh(s)}function nh(i){var s=i;do{if((s.flags&32768)!==0){Gx(s,Ja);return}i=s.return;var l=WS(s.alternate,s,_a);if(l!==null){ct=l;return}if(s=s.sibling,s!==null){ct=s;return}ct=s=i}while(s!==null);tn===0&&(tn=5)}function Gx(i,s){do{var l=KS(i.alternate,i);if(l!==null){l.flags&=32767,ct=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(i=i.sibling,i!==null)){ct=i;return}ct=i=l}while(i!==null);tn=6,ct=null}function qx(i,s,l,c,p,v,S,O,X){i.cancelPendingCommit=null;do rh();while(Vn!==0);if((Rt&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(v=s.lanes|s.childLanes,v|=md,Ti(i,l,v,S,O,X),i===qt&&(ct=qt=null,vt=0),xl=s,ns=i,yl=l,ym=v,_m=p,Px=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,l4(pr,function(){return Kx(),null})):(i.callbackNode=null,i.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=de.T,de.T=null,p=Ce.p,Ce.p=2,S=Rt,Rt|=4;try{QS(i,s,l)}finally{Rt=S,Ce.p=p,de.T=c}}Vn=1,$x(),Yx(),Xx()}}function $x(){if(Vn===1){Vn=0;var i=ns,s=xl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=de.T,de.T=null;var c=Ce.p;Ce.p=2;var p=Rt;Rt|=4;try{Rx(s,i);var v=km,S=M1(i.containerInfo),O=v.focusedElem,X=v.selectionRange;if(S!==O&&O&&O.ownerDocument&&F1(O.ownerDocument.documentElement,O)){if(X!==null&&ud(O)){var se=X.start,ye=X.end;if(ye===void 0&&(ye=se),"selectionStart"in O)O.selectionStart=se,O.selectionEnd=Math.min(ye,O.value.length);else{var Te=O.ownerDocument||document,ue=Te&&Te.defaultView||window;if(ue.getSelection){var fe=ue.getSelection(),Ze=O.textContent.length,Ye=Math.min(X.start,Ze),Lt=X.end===void 0?Ye:Math.min(X.end,Ze);!fe.extend&&Ye>Lt&&(S=Lt,Lt=Ye,Ye=S);var te=O1(O,Ye),J=O1(O,Lt);if(te&&J&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==J.node||fe.focusOffset!==J.offset)){var ie=Te.createRange();ie.setStart(te.node,te.offset),fe.removeAllRanges(),Ye>Lt?(fe.addRange(ie),fe.extend(J.node,J.offset)):(ie.setEnd(J.node,J.offset),fe.addRange(ie))}}}}for(Te=[],fe=O;fe=fe.parentNode;)fe.nodeType===1&&Te.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof O.focus=="function"&&O.focus(),O=0;O<Te.length;O++){var Ee=Te[O];Ee.element.scrollLeft=Ee.left,Ee.element.scrollTop=Ee.top}}ph=!!Pm,km=Pm=null}finally{Rt=p,Ce.p=c,de.T=l}}i.current=s,Vn=2}}function Yx(){if(Vn===2){Vn=0;var i=ns,s=xl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=de.T,de.T=null;var c=Ce.p;Ce.p=2;var p=Rt;Rt|=4;try{Ax(i,s.alternate,s)}finally{Rt=p,Ce.p=c,de.T=l}}Vn=3}}function Xx(){if(Vn===4||Vn===3){Vn=0,Ut();var i=ns,s=xl,l=yl,c=Px;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Vn=5:(Vn=0,xl=ns=null,Wx(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(ts=null),Ua(l),s=s.stateNode,_t&&typeof _t.onCommitFiberRoot=="function")try{_t.onCommitFiberRoot(Ht,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=de.T,p=Ce.p,Ce.p=2,de.T=null;try{for(var v=i.onRecoverableError,S=0;S<c.length;S++){var O=c[S];v(O.value,{componentStack:O.stack})}}finally{de.T=s,Ce.p=p}}(yl&3)!==0&&rh(),Vi(i),p=i.pendingLanes,(l&4194090)!==0&&(p&42)!==0?i===Em?$u++:($u=0,Em=i):$u=0,Yu(0)}}function Wx(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,bu(s)))}function rh(i){return $x(),Yx(),Xx(),Kx()}function Kx(){if(Vn!==5)return!1;var i=ns,s=ym;ym=0;var l=Ua(yl),c=de.T,p=Ce.p;try{Ce.p=32>l?32:l,de.T=null,l=_m,_m=null;var v=ns,S=yl;if(Vn=0,xl=ns=null,yl=0,(Rt&6)!==0)throw Error(r(331));var O=Rt;if(Rt|=4,Fx(v.current),Ix(v,v.current,S,l),Rt=O,Yu(0,!1),_t&&typeof _t.onPostCommitFiberRoot=="function")try{_t.onPostCommitFiberRoot(Ht,v)}catch{}return!0}finally{Ce.p=p,de.T=c,Wx(i,s)}}function Qx(i,s,l){s=$r(l,s),s=Jd(i.stateNode,s,2),i=$a(i,s,2),i!==null&&(si(i,2),Vi(i))}function jt(i,s,l){if(i.tag===3)Qx(i,i,l);else for(;s!==null;){if(s.tag===3){Qx(s,i,l);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(ts===null||!ts.has(c))){i=$r(l,i),l=tx(2),c=$a(s,l,2),c!==null&&(nx(l,c,s,i),si(c,2),Vi(c));break}}s=s.return}}function Sm(i,s,l){var c=i.pingCache;if(c===null){c=i.pingCache=new e4;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(l)||(pm=!0,p.add(l),i=a4.bind(null,i,s,l),s.then(i,i))}function a4(i,s,l){var c=i.pingCache;c!==null&&c.delete(s),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,qt===i&&(vt&l)===l&&(tn===4||tn===3&&(vt&62914560)===vt&&300>Ve()-xm?(Rt&2)===0&&_l(i,0):gm|=l,vl===vt&&(vl=0)),Vi(i)}function Zx(i,s){s===0&&(s=Ba()),i=nl(i,s),i!==null&&(si(i,s),Vi(i))}function s4(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),Zx(i,l)}function o4(i,s){var l=0;switch(i.tag){case 13:var c=i.stateNode,p=i.memoizedState;p!==null&&(l=p.retryLane);break;case 19:c=i.stateNode;break;case 22:c=i.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(s),Zx(i,l)}function l4(i,s){return Kt(i,s)}var ih=null,Tl=null,bm=!1,ah=!1,Cm=!1,ho=0;function Vi(i){i!==Tl&&i.next===null&&(Tl===null?ih=Tl=i:Tl=Tl.next=i),ah=!0,bm||(bm=!0,c4())}function Yu(i,s){if(!Cm&&ah){Cm=!0;do for(var l=!1,c=ih;c!==null;){if(i!==0){var p=c.pendingLanes;if(p===0)var v=0;else{var S=c.suspendedLanes,O=c.pingedLanes;v=(1<<31-bn(42|i)+1)-1,v&=p&~(S&~O),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,ny(c,v))}else v=vt,v=ka(c,c===qt?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||ta(c,v)||(l=!0,ny(c,v));c=c.next}while(l);Cm=!1}}function u4(){Jx()}function Jx(){ah=bm=!1;var i=0;ho!==0&&(x4()&&(i=ho),ho=0);for(var s=Ve(),l=null,c=ih;c!==null;){var p=c.next,v=ey(c,s);v===0?(c.next=null,l===null?ih=p:l.next=p,p===null&&(Tl=l)):(l=c,(i!==0||(v&3)!==0)&&(ah=!0)),c=p}Yu(i)}function ey(i,s){for(var l=i.suspendedLanes,c=i.pingedLanes,p=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var S=31-bn(v),O=1<<S,X=p[S];X===-1?((O&l)===0||(O&c)!==0)&&(p[S]=La(O,s)):X<=s&&(i.expiredLanes|=O),v&=~O}if(s=qt,l=vt,l=ka(i,i===s?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c=i.callbackNode,l===0||i===s&&(Nt===2||Nt===9)||i.cancelPendingCommit!==null)return c!==null&&c!==null&&ot(c),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||ta(i,l)){if(s=l&-l,s===i.callbackPriority)return s;switch(c!==null&&ot(c),Ua(l)){case 2:case 8:l=mr;break;case 32:l=pr;break;case 268435456:l=xi;break;default:l=pr}return c=ty.bind(null,i),l=Kt(l,c),i.callbackPriority=s,i.callbackNode=l,s}return c!==null&&c!==null&&ot(c),i.callbackPriority=2,i.callbackNode=null,2}function ty(i,s){if(Vn!==0&&Vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(rh()&&i.callbackNode!==l)return null;var c=vt;return c=ka(i,i===qt?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c===0?null:(Lx(i,c,s),ey(i,Ve()),i.callbackNode!=null&&i.callbackNode===l?ty.bind(null,i):null)}function ny(i,s){if(rh())return null;Lx(i,s,!0)}function c4(){_4(function(){(Rt&6)!==0?Kt(ar,u4):Jx()})}function Rm(){return ho===0&&(ho=Va()),ho}function ry(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Go(""+i)}function iy(i,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,i.id&&l.setAttribute("form",i.id),s.parentNode.insertBefore(l,s),i=new FormData(i),l.parentNode.removeChild(l),i}function f4(i,s,l,c,p){if(s==="submit"&&l&&l.stateNode===p){var v=ry((p[Xt]||null).action),S=c.submitter;S&&(s=(s=S[Xt]||null)?ry(s.formAction):S.getAttribute("formAction"),s!==null&&(v=s,S=null));var O=new qo("action","action",null,c,p);i.push({event:O,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(ho!==0){var X=S?iy(p,S):new FormData(p);Xd(l,{pending:!0,data:X,method:p.method,action:v},null,X)}}else typeof v=="function"&&(O.preventDefault(),X=S?iy(p,S):new FormData(p),Xd(l,{pending:!0,data:X,method:p.method,action:v},v,X))},currentTarget:p}]})}}for(var Nm=0;Nm<dd.length;Nm++){var Im=dd[Nm],h4=Im.toLowerCase(),d4=Im[0].toUpperCase()+Im.slice(1);li(h4,"on"+d4)}li(L1,"onAnimationEnd"),li(V1,"onAnimationIteration"),li(B1,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(IS,"onTransitionRun"),li(DS,"onTransitionStart"),li(OS,"onTransitionCancel"),li(U1,"onTransitionEnd"),Ne("onMouseEnter",["mouseout","mouseover"]),Ne("onMouseLeave",["mouseout","mouseover"]),Ne("onPointerEnter",["pointerout","pointerover"]),Ne("onPointerLeave",["pointerout","pointerover"]),be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),be("onBeforeInput",["compositionend","keypress","textInput","paste"]),be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Xu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),m4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Xu));function ay(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var c=i[l],p=c.event;c=c.listeners;e:{var v=void 0;if(s)for(var S=c.length-1;0<=S;S--){var O=c[S],X=O.instance,se=O.currentTarget;if(O=O.listener,X!==v&&p.isPropagationStopped())break e;v=O,p.currentTarget=se;try{v(p)}catch(ye){$f(ye)}p.currentTarget=null,v=X}else for(S=0;S<c.length;S++){if(O=c[S],X=O.instance,se=O.currentTarget,O=O.listener,X!==v&&p.isPropagationStopped())break e;v=O,p.currentTarget=se;try{v(p)}catch(ye){$f(ye)}p.currentTarget=null,v=X}}}}function ft(i,s){var l=s[Us];l===void 0&&(l=s[Us]=new Set);var c=i+"__bubble";l.has(c)||(sy(s,i,2,!1),l.add(c))}function Dm(i,s,l){var c=0;s&&(c|=4),sy(l,i,c,s)}var sh="_reactListening"+Math.random().toString(36).slice(2);function Om(i){if(!i[sh]){i[sh]=!0,oe.forEach(function(l){l!=="selectionchange"&&(m4.has(l)||Dm(l,!1,i),Dm(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[sh]||(s[sh]=!0,Dm("selectionchange",!1,s))}}function sy(i,s,l,c){switch(Iy(s)){case 2:var p=j4;break;case 8:p=z4;break;default:p=$m}l=p.bind(null,s,l,i),p=void 0,!Gr||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?i.addEventListener(s,l,{capture:!0,passive:p}):i.addEventListener(s,l,!0):p!==void 0?i.addEventListener(s,l,{passive:p}):i.addEventListener(s,l,!1)}function Fm(i,s,l,c,p){var v=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var O=c.stateNode.containerInfo;if(O===p)break;if(S===4)for(S=c.return;S!==null;){var X=S.tag;if((X===3||X===4)&&S.stateNode.containerInfo===p)return;S=S.return}for(;O!==null;){if(S=j(O),S===null)return;if(X=S.tag,X===5||X===6||X===26||X===27){c=v=S;continue e}O=O.parentNode}}c=c.return}lf(function(){var se=v,ye=Hr(l),Te=[];e:{var ue=j1.get(i);if(ue!==void 0){var fe=qo,Ze=i;switch(i){case"keypress":if(Ni(l)===0)break e;case"keydown":case"keyup":fe=Qo;break;case"focusin":Ze="focus",fe=Xo;break;case"focusout":Ze="blur",fe=Xo;break;case"beforeblur":case"afterblur":fe=Xo;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=qr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=ad;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=gf;break;case L1:case V1:case B1:fe=Wo;break;case U1:fe=xf;break;case"scroll":case"scrollend":fe=uf;break;case"wheel":fe=Zo;break;case"copy":case"cut":case"paste":fe=Ko;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=xu;break;case"toggle":case"beforetoggle":fe=_f}var Ye=(s&4)!==0,Lt=!Ye&&(i==="scroll"||i==="scrollend"),te=Ye?ue!==null?ue+"Capture":null:ue;Ye=[];for(var J=se,ie;J!==null;){var Ee=J;if(ie=Ee.stateNode,Ee=Ee.tag,Ee!==5&&Ee!==26&&Ee!==27||ie===null||te===null||(Ee=qs(J,te),Ee!=null&&Ye.push(Wu(J,Ee,ie))),Lt)break;J=J.return}0<Ye.length&&(ue=new fe(ue,Ze,null,l,ye),Te.push({event:ue,listeners:Ye}))}}if((s&7)===0){e:{if(ue=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",ue&&l!==ra&&(Ze=l.relatedTarget||l.fromElement)&&(j(Ze)||Ze[vr]))break e;if((fe||ue)&&(ue=ye.window===ye?ye:(ue=ye.ownerDocument)?ue.defaultView||ue.parentWindow:window,fe?(Ze=l.relatedTarget||l.toElement,fe=se,Ze=Ze?j(Ze):null,Ze!==null&&(Lt=o(Ze),Ye=Ze.tag,Ze!==Lt||Ye!==5&&Ye!==27&&Ye!==6)&&(Ze=null)):(fe=null,Ze=se),fe!==Ze)){if(Ye=qr,Ee="onMouseLeave",te="onMouseEnter",J="mouse",(i==="pointerout"||i==="pointerover")&&(Ye=xu,Ee="onPointerLeave",te="onPointerEnter",J="pointer"),Lt=fe==null?ue:ae(fe),ie=Ze==null?ue:ae(Ze),ue=new Ye(Ee,J+"leave",fe,l,ye),ue.target=Lt,ue.relatedTarget=ie,Ee=null,j(ye)===se&&(Ye=new Ye(te,J+"enter",Ze,l,ye),Ye.target=ie,Ye.relatedTarget=Lt,Ee=Ye),Lt=Ee,fe&&Ze)t:{for(Ye=fe,te=Ze,J=0,ie=Ye;ie;ie=wl(ie))J++;for(ie=0,Ee=te;Ee;Ee=wl(Ee))ie++;for(;0<J-ie;)Ye=wl(Ye),J--;for(;0<ie-J;)te=wl(te),ie--;for(;J--;){if(Ye===te||te!==null&&Ye===te.alternate)break t;Ye=wl(Ye),te=wl(te)}Ye=null}else Ye=null;fe!==null&&oy(Te,ue,fe,Ye,!1),Ze!==null&&Lt!==null&&oy(Te,Lt,Ze,Ye,!0)}}e:{if(ue=se?ae(se):window,fe=ue.nodeName&&ue.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ue.type==="file")var Ge=b1;else if(En(ue))if(C1)Ge=CS;else{Ge=SS;var lt=AS}else fe=ue.nodeName,!fe||fe.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?se&&fu(se.elementType)&&(Ge=b1):Ge=bS;if(Ge&&(Ge=Ge(i,se))){la(Te,Ge,l,ye);break e}lt&&lt(i,ue,se),i==="focusout"&&se&&ue.type==="number"&&se.memoizedProps.value!=null&&ja(ue,"number",ue.value)}switch(lt=se?ae(se):window,i){case"focusin":(En(lt)||lt.contentEditable==="true")&&(Jo=lt,cd=se,Eu=null);break;case"focusout":Eu=cd=Jo=null;break;case"mousedown":fd=!0;break;case"contextmenu":case"mouseup":case"dragend":fd=!1,P1(Te,l,ye);break;case"selectionchange":if(NS)break;case"keydown":case"keyup":P1(Te,l,ye)}var qe;if(Oi)e:{switch(i){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else pt?pe(i,l)&&(We="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(A&&l.locale!=="ko"&&(pt||We!=="onCompositionStart"?We==="onCompositionEnd"&&pt&&(qe=du()):(Ri=ye,za="value"in Ri?Ri.value:Ri.textContent,pt=!0)),lt=oh(se,We),0<lt.length&&(We=new gu(We,i,null,l,ye),Te.push({event:We,listeners:lt}),qe?We.data=qe:(qe=De(l),qe!==null&&(We.data=qe)))),(qe=_?_n(i,l):gt(i,l))&&(We=oh(se,"onBeforeInput"),0<We.length&&(lt=new gu("onBeforeInput","beforeinput",null,l,ye),Te.push({event:lt,listeners:We}),lt.data=qe)),f4(Te,i,se,l,ye)}ay(Te,s)})}function Wu(i,s,l){return{instance:i,listener:s,currentTarget:l}}function oh(i,s){for(var l=s+"Capture",c=[];i!==null;){var p=i,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=qs(i,l),p!=null&&c.unshift(Wu(i,p,v)),p=qs(i,s),p!=null&&c.push(Wu(i,p,v))),i.tag===3)return c;i=i.return}return[]}function wl(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function oy(i,s,l,c,p){for(var v=s._reactName,S=[];l!==null&&l!==c;){var O=l,X=O.alternate,se=O.stateNode;if(O=O.tag,X!==null&&X===c)break;O!==5&&O!==26&&O!==27||se===null||(X=se,p?(se=qs(l,v),se!=null&&S.unshift(Wu(l,se,X))):p||(se=qs(l,v),se!=null&&S.push(Wu(l,se,X)))),l=l.return}S.length!==0&&i.push({event:s,listeners:S})}var p4=/\r\n?/g,g4=/\u0000|\uFFFD/g;function ly(i){return(typeof i=="string"?i:""+i).replace(p4,`
`).replace(g4,"")}function uy(i,s){return s=ly(s),ly(i)===s}function lh(){}function kt(i,s,l,c,p,v){switch(l){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||zr(i,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&zr(i,""+c);break;case"className":dt(i,"class",c);break;case"tabIndex":dt(i,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(i,l,c);break;case"style":cu(i,c,v);break;case"data":if(s!=="object"){dt(i,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||l!=="href")){i.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Go(""+c),i.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&kt(i,s,"name",p.name,p,null),kt(i,s,"formEncType",p.formEncType,p,null),kt(i,s,"formMethod",p.formMethod,p,null),kt(i,s,"formTarget",p.formTarget,p,null)):(kt(i,s,"encType",p.encType,p,null),kt(i,s,"method",p.method,p,null),kt(i,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Go(""+c),i.setAttribute(l,c);break;case"onClick":c!=null&&(i.onclick=lh);break;case"onScroll":c!=null&&ft("scroll",i);break;case"onScrollEnd":c!=null&&ft("scrollend",i);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"multiple":i.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":i.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){i.removeAttribute("xlink:href");break}l=Go(""+c),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""+c):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":c===!0?i.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,c):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?i.setAttribute(l,c):i.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?i.removeAttribute(l):i.setAttribute(l,c);break;case"popover":ft("beforetoggle",i),ft("toggle",i),Et(i,"popover",c);break;case"xlinkActuate":mt(i,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":mt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":mt(i,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":mt(i,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":mt(i,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":mt(i,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":mt(i,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":mt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":mt(i,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Et(i,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=rd.get(l)||l,Et(i,l,c))}}function Mm(i,s,l,c,p,v){switch(l){case"style":cu(i,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"children":typeof c=="string"?zr(i,c):(typeof c=="number"||typeof c=="bigint")&&zr(i,""+c);break;case"onScroll":c!=null&&ft("scroll",i);break;case"onScrollEnd":c!=null&&ft("scrollend",i);break;case"onClick":c!=null&&(i.onclick=lh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!le.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),s=l.slice(2,p?l.length-7:void 0),v=i[Xt]||null,v=v!=null?v[l]:null,typeof v=="function"&&i.removeEventListener(s,v,p),typeof c=="function")){typeof v!="function"&&v!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(s,c,p);break e}l in i?i[l]=c:c===!0?i.setAttribute(l,""):Et(i,l,c)}}}function Bn(i,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",i),ft("load",i);var c=!1,p=!1,v;for(v in l)if(l.hasOwnProperty(v)){var S=l[v];if(S!=null)switch(v){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:kt(i,s,v,S,l,null)}}p&&kt(i,s,"srcSet",l.srcSet,l,null),c&&kt(i,s,"src",l.src,l,null);return;case"input":ft("invalid",i);var O=v=S=p=null,X=null,se=null;for(c in l)if(l.hasOwnProperty(c)){var ye=l[c];if(ye!=null)switch(c){case"name":p=ye;break;case"type":S=ye;break;case"checked":X=ye;break;case"defaultChecked":se=ye;break;case"value":v=ye;break;case"defaultValue":O=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(r(137,s));break;default:kt(i,s,c,ye,l,null)}}zs(i,v,O,X,se,S,p,!1),Ho(i);return;case"select":ft("invalid",i),c=S=v=null;for(p in l)if(l.hasOwnProperty(p)&&(O=l[p],O!=null))switch(p){case"value":v=O;break;case"defaultValue":S=O;break;case"multiple":c=O;default:kt(i,s,p,O,l,null)}s=v,l=S,i.multiple=!!c,s!=null?na(i,!!c,s,!1):l!=null&&na(i,!!c,l,!0);return;case"textarea":ft("invalid",i),v=p=c=null;for(S in l)if(l.hasOwnProperty(S)&&(O=l[S],O!=null))switch(S){case"value":c=O;break;case"defaultValue":p=O;break;case"children":v=O;break;case"dangerouslySetInnerHTML":if(O!=null)throw Error(r(91));break;default:kt(i,s,S,O,l,null)}Hs(i,c,p,v),Ho(i);return;case"option":for(X in l)if(l.hasOwnProperty(X)&&(c=l[X],c!=null))switch(X){case"selected":i.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:kt(i,s,X,c,l,null)}return;case"dialog":ft("beforetoggle",i),ft("toggle",i),ft("cancel",i),ft("close",i);break;case"iframe":case"object":ft("load",i);break;case"video":case"audio":for(c=0;c<Xu.length;c++)ft(Xu[c],i);break;case"image":ft("error",i),ft("load",i);break;case"details":ft("toggle",i);break;case"embed":case"source":case"link":ft("error",i),ft("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in l)if(l.hasOwnProperty(se)&&(c=l[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:kt(i,s,se,c,l,null)}return;default:if(fu(s)){for(ye in l)l.hasOwnProperty(ye)&&(c=l[ye],c!==void 0&&Mm(i,s,ye,c,l,void 0));return}}for(O in l)l.hasOwnProperty(O)&&(c=l[O],c!=null&&kt(i,s,O,c,l,null))}function v4(i,s,l,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,S=null,O=null,X=null,se=null,ye=null;for(fe in l){var Te=l[fe];if(l.hasOwnProperty(fe)&&Te!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":X=Te;default:c.hasOwnProperty(fe)||kt(i,s,fe,null,c,Te)}}for(var ue in c){var fe=c[ue];if(Te=l[ue],c.hasOwnProperty(ue)&&(fe!=null||Te!=null))switch(ue){case"type":v=fe;break;case"name":p=fe;break;case"checked":se=fe;break;case"defaultChecked":ye=fe;break;case"value":S=fe;break;case"defaultValue":O=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,s));break;default:fe!==Te&&kt(i,s,ue,fe,c,Te)}}Rr(i,S,O,X,se,ye,v,p);return;case"select":fe=S=O=ue=null;for(v in l)if(X=l[v],l.hasOwnProperty(v)&&X!=null)switch(v){case"value":break;case"multiple":fe=X;default:c.hasOwnProperty(v)||kt(i,s,v,null,c,X)}for(p in c)if(v=c[p],X=l[p],c.hasOwnProperty(p)&&(v!=null||X!=null))switch(p){case"value":ue=v;break;case"defaultValue":O=v;break;case"multiple":S=v;default:v!==X&&kt(i,s,p,v,c,X)}s=O,l=S,c=fe,ue!=null?na(i,!!l,ue,!1):!!c!=!!l&&(s!=null?na(i,!!l,s,!0):na(i,!!l,l?[]:"",!1));return;case"textarea":fe=ue=null;for(O in l)if(p=l[O],l.hasOwnProperty(O)&&p!=null&&!c.hasOwnProperty(O))switch(O){case"value":break;case"children":break;default:kt(i,s,O,null,c,p)}for(S in c)if(p=c[S],v=l[S],c.hasOwnProperty(S)&&(p!=null||v!=null))switch(S){case"value":ue=p;break;case"defaultValue":fe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==v&&kt(i,s,S,p,c,v)}Mt(i,ue,fe);return;case"option":for(var Ze in l)if(ue=l[Ze],l.hasOwnProperty(Ze)&&ue!=null&&!c.hasOwnProperty(Ze))switch(Ze){case"selected":i.selected=!1;break;default:kt(i,s,Ze,null,c,ue)}for(X in c)if(ue=c[X],fe=l[X],c.hasOwnProperty(X)&&ue!==fe&&(ue!=null||fe!=null))switch(X){case"selected":i.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:kt(i,s,X,ue,c,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ye in l)ue=l[Ye],l.hasOwnProperty(Ye)&&ue!=null&&!c.hasOwnProperty(Ye)&&kt(i,s,Ye,null,c,ue);for(se in c)if(ue=c[se],fe=l[se],c.hasOwnProperty(se)&&ue!==fe&&(ue!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,s));break;default:kt(i,s,se,ue,c,fe)}return;default:if(fu(s)){for(var Lt in l)ue=l[Lt],l.hasOwnProperty(Lt)&&ue!==void 0&&!c.hasOwnProperty(Lt)&&Mm(i,s,Lt,void 0,c,ue);for(ye in c)ue=c[ye],fe=l[ye],!c.hasOwnProperty(ye)||ue===fe||ue===void 0&&fe===void 0||Mm(i,s,ye,ue,c,fe);return}}for(var te in l)ue=l[te],l.hasOwnProperty(te)&&ue!=null&&!c.hasOwnProperty(te)&&kt(i,s,te,null,c,ue);for(Te in c)ue=c[Te],fe=l[Te],!c.hasOwnProperty(Te)||ue===fe||ue==null&&fe==null||kt(i,s,Te,ue,c,fe)}var Pm=null,km=null;function uh(i){return i.nodeType===9?i:i.ownerDocument}function cy(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function fy(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Lm(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Vm=null;function x4(){var i=window.event;return i&&i.type==="popstate"?i===Vm?!1:(Vm=i,!0):(Vm=null,!1)}var hy=typeof setTimeout=="function"?setTimeout:void 0,y4=typeof clearTimeout=="function"?clearTimeout:void 0,dy=typeof Promise=="function"?Promise:void 0,_4=typeof queueMicrotask=="function"?queueMicrotask:typeof dy<"u"?function(i){return dy.resolve(null).then(i).catch(E4)}:hy;function E4(i){setTimeout(function(){throw i})}function is(i){return i==="head"}function my(i,s){var l=s,c=0,p=0;do{var v=l.nextSibling;if(i.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<c&&8>c){l=c;var S=i.ownerDocument;if(l&1&&Ku(S.documentElement),l&2&&Ku(S.body),l&4)for(l=S.head,Ku(l),S=l.firstChild;S;){var O=S.nextSibling,X=S.nodeName;S[M]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&S.rel.toLowerCase()==="stylesheet"||l.removeChild(S),S=O}}if(p===0){i.removeChild(v),ic(s);return}p--}else l==="$"||l==="$?"||l==="$!"?p++:c=l.charCodeAt(0)-48;else c=0;l=v}while(l);ic(s)}function Bm(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Bm(l),L(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function T4(i,s,l,c){for(;i.nodeType===1;){var p=l;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(c){if(!i[M])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=ci(i.nextSibling),i===null)break}return null}function w4(i,s,l){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ci(i.nextSibling),i===null))return null;return i}function Um(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function A4(i,s){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")s();else{var c=function(){s(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),i._reactRetry=c}}function ci(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var jm=null;function py(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}function gy(i,s,l){switch(s=uh(l),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Ku(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);L(i)}var Zr=new Map,vy=new Set;function ch(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var Ea=Ce.d;Ce.d={f:S4,r:b4,D:C4,C:R4,L:N4,m:I4,X:O4,S:D4,M:F4};function S4(){var i=Ea.f(),s=th();return i||s}function b4(i){var s=G(i);s!==null&&s.tag===5&&s.type==="form"?Lv(s):Ea.r(i)}var Al=typeof document>"u"?null:document;function xy(i,s,l){var c=Al;if(c&&typeof s=="string"&&s){var p=cn(s);p='link[rel="'+i+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),vy.has(p)||(vy.add(p),i={rel:i,crossOrigin:l,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),Bn(s,"link",i),ne(s),c.head.appendChild(s)))}}function C4(i){Ea.D(i),xy("dns-prefetch",i,null)}function R4(i,s){Ea.C(i,s),xy("preconnect",i,s)}function N4(i,s,l){Ea.L(i,s,l);var c=Al;if(c&&i&&s){var p='link[rel="preload"][as="'+cn(s)+'"]';s==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+cn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+cn(l.imageSizes)+'"]')):p+='[href="'+cn(i)+'"]';var v=p;switch(s){case"style":v=Sl(i);break;case"script":v=bl(i)}Zr.has(v)||(i=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:i,as:s},l),Zr.set(v,i),c.querySelector(p)!==null||s==="style"&&c.querySelector(Qu(v))||s==="script"&&c.querySelector(Zu(v))||(s=c.createElement("link"),Bn(s,"link",i),ne(s),c.head.appendChild(s)))}}function I4(i,s){Ea.m(i,s);var l=Al;if(l&&i){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+cn(c)+'"][href="'+cn(i)+'"]',v=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=bl(i)}if(!Zr.has(v)&&(i=g({rel:"modulepreload",href:i},s),Zr.set(v,i),l.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Zu(v)))return}c=l.createElement("link"),Bn(c,"link",i),ne(c),l.head.appendChild(c)}}}function D4(i,s,l){Ea.S(i,s,l);var c=Al;if(c&&i){var p=me(c).hoistableStyles,v=Sl(i);s=s||"default";var S=p.get(v);if(!S){var O={loading:0,preload:null};if(S=c.querySelector(Qu(v)))O.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":s},l),(l=Zr.get(v))&&zm(i,l);var X=S=c.createElement("link");ne(X),Bn(X,"link",i),X._p=new Promise(function(se,ye){X.onload=se,X.onerror=ye}),X.addEventListener("load",function(){O.loading|=1}),X.addEventListener("error",function(){O.loading|=2}),O.loading|=4,fh(S,s,c)}S={type:"stylesheet",instance:S,count:1,state:O},p.set(v,S)}}}function O4(i,s){Ea.X(i,s);var l=Al;if(l&&i){var c=me(l).hoistableScripts,p=bl(i),v=c.get(p);v||(v=l.querySelector(Zu(p)),v||(i=g({src:i,async:!0},s),(s=Zr.get(p))&&Hm(i,s),v=l.createElement("script"),ne(v),Bn(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(p,v))}}function F4(i,s){Ea.M(i,s);var l=Al;if(l&&i){var c=me(l).hoistableScripts,p=bl(i),v=c.get(p);v||(v=l.querySelector(Zu(p)),v||(i=g({src:i,async:!0,type:"module"},s),(s=Zr.get(p))&&Hm(i,s),v=l.createElement("script"),ne(v),Bn(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(p,v))}}function yy(i,s,l,c){var p=(p=ce.current)?ch(p):null;if(!p)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=Sl(l.href),l=me(p).hoistableStyles,c=l.get(s),c||(c={type:"style",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=Sl(l.href);var v=me(p).hoistableStyles,S=v.get(i);if(S||(p=p.ownerDocument||p,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,S),(v=p.querySelector(Qu(i)))&&!v._p&&(S.instance=v,S.state.loading=5),Zr.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Zr.set(i,l),v||M4(p,i,l,S.state))),s&&c===null)throw Error(r(528,""));return S}if(s&&c!==null)throw Error(r(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=bl(l),l=me(p).hoistableScripts,c=l.get(s),c||(c={type:"script",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function Sl(i){return'href="'+cn(i)+'"'}function Qu(i){return'link[rel="stylesheet"]['+i+"]"}function _y(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function M4(i,s,l,c){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=i.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),Bn(s,"link",l),ne(s),i.head.appendChild(s))}function bl(i){return'[src="'+cn(i)+'"]'}function Zu(i){return"script[async]"+i}function Ey(i,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var c=i.querySelector('style[data-href~="'+cn(l.href)+'"]');if(c)return s.instance=c,ne(c),c;var p=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(i.ownerDocument||i).createElement("style"),ne(c),Bn(c,"style",p),fh(c,l.precedence,i),s.instance=c;case"stylesheet":p=Sl(l.href);var v=i.querySelector(Qu(p));if(v)return s.state.loading|=4,s.instance=v,ne(v),v;c=_y(l),(p=Zr.get(p))&&zm(c,p),v=(i.ownerDocument||i).createElement("link"),ne(v);var S=v;return S._p=new Promise(function(O,X){S.onload=O,S.onerror=X}),Bn(v,"link",c),s.state.loading|=4,fh(v,l.precedence,i),s.instance=v;case"script":return v=bl(l.src),(p=i.querySelector(Zu(v)))?(s.instance=p,ne(p),p):(c=l,(p=Zr.get(v))&&(c=g({},l),Hm(c,p)),i=i.ownerDocument||i,p=i.createElement("script"),ne(p),Bn(p,"link",c),i.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,fh(c,l.precedence,i));return s.instance}function fh(i,s,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,v=p,S=0;S<c.length;S++){var O=c[S];if(O.dataset.precedence===s)v=O;else if(v!==p)break}v?v.parentNode.insertBefore(i,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(i,s.firstChild))}function zm(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Hm(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var hh=null;function Ty(i,s,l){if(hh===null){var c=new Map,p=hh=new Map;p.set(l,c)}else p=hh,c=p.get(l),c||(c=new Map,p.set(l,c));if(c.has(i))return c;for(c.set(i,null),l=l.getElementsByTagName(i),p=0;p<l.length;p++){var v=l[p];if(!(v[M]||v[sn]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var S=v.getAttribute(s)||"";S=i+S;var O=c.get(S);O?O.push(v):c.set(S,[v])}}return c}function wy(i,s,l){i=i.ownerDocument||i,i.head.insertBefore(l,s==="title"?i.querySelector("head > title"):null)}function P4(i,s,l){if(l===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function Ay(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Ju=null;function k4(){}function L4(i,s,l){if(Ju===null)throw Error(r(475));var c=Ju;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var p=Sl(l.href),v=i.querySelector(Qu(p));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(c.count++,c=dh.bind(c),i.then(c,c)),s.state.loading|=4,s.instance=v,ne(v);return}v=i.ownerDocument||i,l=_y(l),(p=Zr.get(p))&&zm(l,p),v=v.createElement("link"),ne(v);var S=v;S._p=new Promise(function(O,X){S.onload=O,S.onerror=X}),Bn(v,"link",l),s.instance=v}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=dh.bind(c),i.addEventListener("load",s),i.addEventListener("error",s))}}function V4(){if(Ju===null)throw Error(r(475));var i=Ju;return i.stylesheets&&i.count===0&&Gm(i,i.stylesheets),0<i.count?function(s){var l=setTimeout(function(){if(i.stylesheets&&Gm(i,i.stylesheets),i.unsuspend){var c=i.unsuspend;i.unsuspend=null,c()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(l)}}:null}function dh(){if(this.count--,this.count===0){if(this.stylesheets)Gm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var mh=null;function Gm(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,mh=new Map,s.forEach(B4,i),mh=null,dh.call(i))}function B4(i,s){if(!(s.state.loading&4)){var l=mh.get(i);if(l)var c=l.get(null);else{l=new Map,mh.set(i,l);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var S=p[v];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),c=S)}c&&l.set(null,c)}p=s.instance,S=p.getAttribute("data-precedence"),v=l.get(S)||c,v===c&&l.set(null,p),l.set(S,p),this.count++,c=dh.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),v?v.parentNode.insertBefore(p,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),s.state.loading|=4}}var ec={$$typeof:Y,Provider:null,Consumer:null,_currentValue:ze,_currentValue2:ze,_threadCount:0};function U4(i,s,l,c,p,v,S,O){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ai(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ai(0),this.hiddenUpdates=ai(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=O,this.incompleteTransitions=new Map}function Sy(i,s,l,c,p,v,S,O,X,se,ye,Te){return i=new U4(i,s,l,S,O,X,se,Te),s=1,v===!0&&(s|=24),v=Ir(3,null,null,s),i.current=v,v.stateNode=i,s=Sd(),s.refCount++,i.pooledCache=s,s.refCount++,v.memoizedState={element:c,isDehydrated:l,cache:s},Nd(v),i}function by(i){return i?(i=rl,i):rl}function Cy(i,s,l,c,p,v){p=by(p),c.context===null?c.context=p:c.pendingContext=p,c=qa(s),c.payload={element:l},v=v===void 0?null:v,v!==null&&(c.callback=v),l=$a(i,c,s),l!==null&&(Pr(l,i,s),Iu(l,i,s))}function Ry(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function qm(i,s){Ry(i,s),(i=i.alternate)&&Ry(i,s)}function Ny(i){if(i.tag===13){var s=nl(i,67108864);s!==null&&Pr(s,i,67108864),qm(i,67108864)}}var ph=!0;function j4(i,s,l,c){var p=de.T;de.T=null;var v=Ce.p;try{Ce.p=2,$m(i,s,l,c)}finally{Ce.p=v,de.T=p}}function z4(i,s,l,c){var p=de.T;de.T=null;var v=Ce.p;try{Ce.p=8,$m(i,s,l,c)}finally{Ce.p=v,de.T=p}}function $m(i,s,l,c){if(ph){var p=Ym(c);if(p===null)Fm(i,s,c,gh,l),Dy(i,c);else if(G4(p,i,s,l,c))c.stopPropagation();else if(Dy(i,c),s&4&&-1<H4.indexOf(i)){for(;p!==null;){var v=G(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var S=gr(v.pendingLanes);if(S!==0){var O=v;for(O.pendingLanes|=2,O.entangledLanes|=2;S;){var X=1<<31-bn(S);O.entanglements[1]|=X,S&=~X}Vi(v),(Rt&6)===0&&(Jf=Ve()+500,Yu(0))}}break;case 13:O=nl(v,2),O!==null&&Pr(O,v,2),th(),qm(v,2)}if(v=Ym(c),v===null&&Fm(i,s,c,gh,l),v===p)break;p=v}p!==null&&c.stopPropagation()}else Fm(i,s,c,null,l)}}function Ym(i){return i=Hr(i),Xm(i)}var gh=null;function Xm(i){if(gh=null,i=j(i),i!==null){var s=o(i);if(s===null)i=null;else{var l=s.tag;if(l===13){if(i=u(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return gh=i,null}function Iy(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wn()){case ar:return 2;case mr:return 8;case pr:case Bo:return 32;case xi:return 268435456;default:return 32}default:return 32}}var Wm=!1,as=null,ss=null,os=null,tc=new Map,nc=new Map,ls=[],H4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Dy(i,s){switch(i){case"focusin":case"focusout":as=null;break;case"dragenter":case"dragleave":ss=null;break;case"mouseover":case"mouseout":os=null;break;case"pointerover":case"pointerout":tc.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":nc.delete(s.pointerId)}}function rc(i,s,l,c,p,v){return i===null||i.nativeEvent!==v?(i={blockedOn:s,domEventName:l,eventSystemFlags:c,nativeEvent:v,targetContainers:[p]},s!==null&&(s=G(s),s!==null&&Ny(s)),i):(i.eventSystemFlags|=c,s=i.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),i)}function G4(i,s,l,c,p){switch(s){case"focusin":return as=rc(as,i,s,l,c,p),!0;case"dragenter":return ss=rc(ss,i,s,l,c,p),!0;case"mouseover":return os=rc(os,i,s,l,c,p),!0;case"pointerover":var v=p.pointerId;return tc.set(v,rc(tc.get(v)||null,i,s,l,c,p)),!0;case"gotpointercapture":return v=p.pointerId,nc.set(v,rc(nc.get(v)||null,i,s,l,c,p)),!0}return!1}function Oy(i){var s=j(i.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=u(l),s!==null){i.blockedOn=s,jo(i.priority,function(){if(l.tag===13){var c=Mr();c=wi(c);var p=nl(l,c);p!==null&&Pr(p,l,c),qm(l,c)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function vh(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=Ym(i.nativeEvent);if(l===null){l=i.nativeEvent;var c=new l.constructor(l.type,l);ra=c,l.target.dispatchEvent(c),ra=null}else return s=G(l),s!==null&&Ny(s),i.blockedOn=l,!1;s.shift()}return!0}function Fy(i,s,l){vh(i)&&l.delete(s)}function q4(){Wm=!1,as!==null&&vh(as)&&(as=null),ss!==null&&vh(ss)&&(ss=null),os!==null&&vh(os)&&(os=null),tc.forEach(Fy),nc.forEach(Fy)}function xh(i,s){i.blockedOn===s&&(i.blockedOn=null,Wm||(Wm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,q4)))}var yh=null;function My(i){yh!==i&&(yh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){yh===i&&(yh=null);for(var s=0;s<i.length;s+=3){var l=i[s],c=i[s+1],p=i[s+2];if(typeof c!="function"){if(Xm(c||l)===null)continue;break}var v=G(l);v!==null&&(i.splice(s,3),s-=3,Xd(v,{pending:!0,data:p,method:l.method,action:c},c,p))}}))}function ic(i){function s(X){return xh(X,i)}as!==null&&xh(as,i),ss!==null&&xh(ss,i),os!==null&&xh(os,i),tc.forEach(s),nc.forEach(s);for(var l=0;l<ls.length;l++){var c=ls[l];c.blockedOn===i&&(c.blockedOn=null)}for(;0<ls.length&&(l=ls[0],l.blockedOn===null);)Oy(l),l.blockedOn===null&&ls.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var p=l[c],v=l[c+1],S=p[Xt]||null;if(typeof v=="function")S||My(l);else if(S){var O=null;if(v&&v.hasAttribute("formAction")){if(p=v,S=v[Xt]||null)O=S.formAction;else if(Xm(p)!==null)continue}else O=S.action;typeof O=="function"?l[c+1]=O:(l.splice(c,3),c-=3),My(l)}}}function Km(i){this._internalRoot=i}_h.prototype.render=Km.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var l=s.current,c=Mr();Cy(l,c,i,s,null,null)},_h.prototype.unmount=Km.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;Cy(i.current,2,null,i,null,null),th(),s[vr]=null}};function _h(i){this._internalRoot=i}_h.prototype.unstable_scheduleHydration=function(i){if(i){var s=Ai();i={blockedOn:null,target:i,priority:s};for(var l=0;l<ls.length&&s!==0&&s<ls[l].priority;l++);ls.splice(l,0,i),l===0&&Oy(i)}};var Py=e.version;if(Py!=="19.1.0")throw Error(r(527,Py,"19.1.0"));Ce.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=d(s),i=i!==null?h(i):null,i=i===null?null:i.stateNode,i};var $4={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:de,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Eh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Eh.isDisabled&&Eh.supportsFiber)try{Ht=Eh.inject($4),_t=Eh}catch{}}return sc.createRoot=function(i,s){if(!a(i))throw Error(r(299));var l=!1,c="",p=Qv,v=Zv,S=Jv,O=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(O=s.unstable_transitionCallbacks)),s=Sy(i,1,!1,null,null,l,c,p,v,S,O,null),i[vr]=s.current,Om(i),new Km(s)},sc.hydrateRoot=function(i,s,l){if(!a(i))throw Error(r(299));var c=!1,p="",v=Qv,S=Zv,O=Jv,X=null,se=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(O=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(X=l.unstable_transitionCallbacks),l.formState!==void 0&&(se=l.formState)),s=Sy(i,1,!0,s,l??null,c,p,v,S,O,X,se),s.context=by(null),l=s.current,c=Mr(),c=wi(c),p=qa(c),p.callback=null,$a(l,p,c),l=c,s.current.lanes=l,si(s,l),Vi(s),i[vr]=s.current,Om(i),new _h(s)},sc.version="19.1.0",sc}var qy;function nb(){if(qy)return Jm.exports;qy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Jm.exports=tb(),Jm.exports}var rb=nb(),oc={},$y;function ib(){if($y)return oc;$y=1,Object.defineProperty(oc,"__esModule",{value:!0}),oc.parse=u,oc.serialize=h;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const x=function(){};return x.prototype=Object.create(null),x})();function u(x,E){const w=new o,T=x.length;if(T<2)return w;const b=E?.decode||g;let k=0;do{const q=x.indexOf("=",k);if(q===-1)break;const Y=x.indexOf(";",k),ee=Y===-1?T:Y;if(q>ee){k=x.lastIndexOf(";",q-1)+1;continue}const he=f(x,k,q),Ae=d(x,q,he),D=x.slice(he,Ae);if(w[D]===void 0){let I=f(x,q+1,ee),R=d(x,ee,I);const P=b(x.slice(I,R));w[D]=P}k=ee+1}while(k<T);return w}function f(x,E,w){do{const T=x.charCodeAt(E);if(T!==32&&T!==9)return E}while(++E<w);return w}function d(x,E,w){for(;E>w;){const T=x.charCodeAt(--E);if(T!==32&&T!==9)return E+1}return w}function h(x,E,w){const T=w?.encode||encodeURIComponent;if(!t.test(x))throw new TypeError(`argument name is invalid: ${x}`);const b=T(E);if(!e.test(b))throw new TypeError(`argument val is invalid: ${E}`);let k=x+"="+b;if(!w)return k;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);k+="; Max-Age="+w.maxAge}if(w.domain){if(!n.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);k+="; Domain="+w.domain}if(w.path){if(!r.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);k+="; Path="+w.path}if(w.expires){if(!y(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);k+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(k+="; HttpOnly"),w.secure&&(k+="; Secure"),w.partitioned&&(k+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return k}function g(x){if(x.indexOf("%")===-1)return x;try{return decodeURIComponent(x)}catch{return x}}function y(x){return a.call(x)==="[object Date]"}return oc}ib();var Yy="popstate";function ab(t={}){function e(r,a){let{pathname:o,search:u,hash:f}=r.location;return Cp("",{pathname:o,search:u,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:bc(a)}return ob(e,n,null,t)}function Zt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Wi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function sb(){return Math.random().toString(36).substring(2,10)}function Xy(t,e){return{usr:t.state,key:t.key,idx:e}}function Cp(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Ql(e):e,state:n,key:e&&e.key||r||sb()}}function bc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Ql(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function ob(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,u=a.history,f="POP",d=null,h=g();h==null&&(h=0,u.replaceState({...u.state,idx:h},""));function g(){return(u.state||{idx:null}).idx}function y(){f="POP";let b=g(),k=b==null?null:b-h;h=b,d&&d({action:f,location:T.location,delta:k})}function x(b,k){f="PUSH";let q=Cp(T.location,b,k);h=g()+1;let Y=Xy(q,h),ee=T.createHref(q);try{u.pushState(Y,"",ee)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;a.location.assign(ee)}o&&d&&d({action:f,location:T.location,delta:1})}function E(b,k){f="REPLACE";let q=Cp(T.location,b,k);h=g();let Y=Xy(q,h),ee=T.createHref(q);u.replaceState(Y,"",ee),o&&d&&d({action:f,location:T.location,delta:0})}function w(b){return lb(b)}let T={get action(){return f},get location(){return t(a,u)},listen(b){if(d)throw new Error("A history only accepts one active listener");return a.addEventListener(Yy,y),d=b,()=>{a.removeEventListener(Yy,y),d=null}},createHref(b){return e(a,b)},createURL:w,encodeLocation(b){let k=w(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:x,replace:E,go(b){return u.go(b)}};return T}function lb(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Zt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:bc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function dE(t,e,n="/"){return ub(t,e,n,!1)}function ub(t,e,n,r){let a=typeof e=="string"?Ql(e):e,o=Ca(a.pathname||"/",n);if(o==null)return null;let u=mE(t);cb(u);let f=null;for(let d=0;f==null&&d<u.length;++d){let h=Tb(o);f=_b(u[d],h,r)}return f}function mE(t,e=[],n=[],r=""){let a=(o,u,f)=>{let d={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};d.relativePath.startsWith("/")&&(Zt(d.relativePath.startsWith(r),`Absolute route path "${d.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),d.relativePath=d.relativePath.slice(r.length));let h=Ta([r,d.relativePath]),g=n.concat(d);o.children&&o.children.length>0&&(Zt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${h}".`),mE(o.children,e,g,h)),!(o.path==null&&!o.index)&&e.push({path:h,score:xb(h,o.index),routesMeta:g})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))a(o,u);else for(let f of pE(o.path))a(o,u,f)}),e}function pE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let u=pE(r.join("/")),f=[];return f.push(...u.map(d=>d===""?o:[o,d].join("/"))),a&&f.push(...u),f.map(d=>t.startsWith("/")&&d===""?"/":d)}function cb(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:yb(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var fb=/^:[\w-]+$/,hb=3,mb=2,pb=1,gb=10,vb=-2,Wy=t=>t==="*";function xb(t,e){let n=t.split("/"),r=n.length;return n.some(Wy)&&(r+=vb),e&&(r+=mb),n.filter(a=>!Wy(a)).reduce((a,o)=>a+(fb.test(o)?hb:o===""?pb:gb),r)}function yb(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function _b(t,e,n=!1){let{routesMeta:r}=t,a={},o="/",u=[];for(let f=0;f<r.length;++f){let d=r[f],h=f===r.length-1,g=o==="/"?e:e.slice(o.length)||"/",y=Gh({path:d.relativePath,caseSensitive:d.caseSensitive,end:h},g),x=d.route;if(!y&&h&&n&&!r[r.length-1].route.index&&(y=Gh({path:d.relativePath,caseSensitive:d.caseSensitive,end:!1},g)),!y)return null;Object.assign(a,y.params),u.push({params:a,pathname:Ta([o,y.pathname]),pathnameBase:bb(Ta([o,y.pathnameBase])),route:x}),y.pathnameBase!=="/"&&(o=Ta([o,y.pathnameBase]))}return u}function Gh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=Eb(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let o=a[0],u=o.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((h,{paramName:g,isOptional:y},x)=>{if(g==="*"){let w=f[x]||"";u=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const E=f[x];return y&&!E?h[g]=void 0:h[g]=(E||"").replace(/%2F/g,"/"),h},{}),pathname:o,pathnameBase:u,pattern:t}}function Eb(t,e=!1,n=!0){Wi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,d)=>(r.push({paramName:f,isOptional:d!=null}),d?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function Tb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Wi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Ca(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function wb(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?Ql(t):t;return{pathname:n?n.startsWith("/")?n:Ab(n,e):e,search:Cb(r),hash:Rb(a)}}function Ab(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function rp(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Sb(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function gE(t){let e=Sb(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function vE(t,e,n,r=!1){let a;typeof t=="string"?a=Ql(t):(a={...t},Zt(!a.pathname||!a.pathname.includes("?"),rp("?","pathname","search",a)),Zt(!a.pathname||!a.pathname.includes("#"),rp("#","pathname","hash",a)),Zt(!a.search||!a.search.includes("#"),rp("#","search","hash",a)));let o=t===""||a.pathname==="",u=o?"/":a.pathname,f;if(u==null)f=n;else{let y=e.length-1;if(!r&&u.startsWith("..")){let x=u.split("/");for(;x[0]==="..";)x.shift(),y-=1;a.pathname=x.join("/")}f=y>=0?e[y]:"/"}let d=wb(a,f),h=u&&u!=="/"&&u.endsWith("/"),g=(o||u===".")&&n.endsWith("/");return!d.pathname.endsWith("/")&&(h||g)&&(d.pathname+="/"),d}var Ta=t=>t.join("/").replace(/\/\/+/g,"/"),bb=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),Cb=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Rb=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Nb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var xE=["POST","PUT","PATCH","DELETE"];new Set(xE);var Ib=["GET",...xE];new Set(Ib);var Zl=ve.createContext(null);Zl.displayName="DataRouter";var T0=ve.createContext(null);T0.displayName="DataRouterState";var yE=ve.createContext({isTransitioning:!1});yE.displayName="ViewTransition";var Db=ve.createContext(new Map);Db.displayName="Fetchers";var Ob=ve.createContext(null);Ob.displayName="Await";var Zi=ve.createContext(null);Zi.displayName="Navigation";var zc=ve.createContext(null);zc.displayName="Location";var Ji=ve.createContext({outlet:null,matches:[],isDataRoute:!1});Ji.displayName="Route";var ig=ve.createContext(null);ig.displayName="RouteError";function Fb(t,{relative:e}={}){Zt(Hc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=ve.useContext(Zi),{hash:a,pathname:o,search:u}=Gc(t,{relative:e}),f=o;return n!=="/"&&(f=o==="/"?n:Ta([n,o])),r.createHref({pathname:f,search:u,hash:a})}function Hc(){return ve.useContext(zc)!=null}function Ps(){return Zt(Hc(),"useLocation() may be used only in the context of a <Router> component."),ve.useContext(zc).location}var _E="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function EE(t){ve.useContext(Zi).static||ve.useLayoutEffect(t)}function Mb(){let{isDataRoute:t}=ve.useContext(Ji);return t?Yb():Pb()}function Pb(){Zt(Hc(),"useNavigate() may be used only in the context of a <Router> component.");let t=ve.useContext(Zl),{basename:e,navigator:n}=ve.useContext(Zi),{matches:r}=ve.useContext(Ji),{pathname:a}=Ps(),o=JSON.stringify(gE(r)),u=ve.useRef(!1);return EE(()=>{u.current=!0}),ve.useCallback((d,h={})=>{if(Wi(u.current,_E),!u.current)return;if(typeof d=="number"){n.go(d);return}let g=vE(d,JSON.parse(o),a,h.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Ta([e,g.pathname])),(h.replace?n.replace:n.push)(g,h.state,h)},[e,n,o,a,t])}ve.createContext(null);function TE(){let{matches:t}=ve.useContext(Ji),e=t[t.length-1];return e?e.params:{}}function Gc(t,{relative:e}={}){let{matches:n}=ve.useContext(Ji),{pathname:r}=Ps(),a=JSON.stringify(gE(n));return ve.useMemo(()=>vE(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function kb(t,e){return wE(t,e)}function wE(t,e,n,r){Zt(Hc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ve.useContext(Zi),{matches:o}=ve.useContext(Ji),u=o[o.length-1],f=u?u.params:{},d=u?u.pathname:"/",h=u?u.pathnameBase:"/",g=u&&u.route;{let k=g&&g.path||"";AE(d,!g||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${d}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let y=Ps(),x;if(e){let k=typeof e=="string"?Ql(e):e;Zt(h==="/"||k.pathname?.startsWith(h),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${h}" but pathname "${k.pathname}" was given in the \`location\` prop.`),x=k}else x=y;let E=x.pathname||"/",w=E;if(h!=="/"){let k=h.replace(/^\//,"").split("/");w="/"+E.replace(/^\//,"").split("/").slice(k.length).join("/")}let T=dE(t,{pathname:w});Wi(g||T!=null,`No routes matched location "${x.pathname}${x.search}${x.hash}" `),Wi(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${x.pathname}${x.search}${x.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=jb(T&&T.map(k=>Object.assign({},k,{params:Object.assign({},f,k.params),pathname:Ta([h,a.encodeLocation?a.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?h:Ta([h,a.encodeLocation?a.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),o,n,r);return e&&b?ve.createElement(zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...x},navigationType:"POP"}},b):b}function Lb(){let t=$b(),e=Nb(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=ve.createElement(ve.Fragment,null,ve.createElement("p",null," Hey developer "),ve.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ve.createElement("code",{style:o},"ErrorBoundary")," or"," ",ve.createElement("code",{style:o},"errorElement")," prop on your route.")),ve.createElement(ve.Fragment,null,ve.createElement("h2",null,"Unexpected Application Error!"),ve.createElement("h3",{style:{fontStyle:"italic"}},e),n?ve.createElement("pre",{style:a},n):null,u)}var Vb=ve.createElement(Lb,null),Bb=class extends ve.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?ve.createElement(Ji.Provider,{value:this.props.routeContext},ve.createElement(ig.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ub({routeContext:t,match:e,children:n}){let r=ve.useContext(Zl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),ve.createElement(Ji.Provider,{value:t},n)}function jb(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let d=a.findIndex(h=>h.route.id&&o?.[h.route.id]!==void 0);Zt(d>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,d+1))}let u=!1,f=-1;if(n)for(let d=0;d<a.length;d++){let h=a[d];if((h.route.HydrateFallback||h.route.hydrateFallbackElement)&&(f=d),h.route.id){let{loaderData:g,errors:y}=n,x=h.route.loader&&!g.hasOwnProperty(h.route.id)&&(!y||y[h.route.id]===void 0);if(h.route.lazy||x){u=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((d,h,g)=>{let y,x=!1,E=null,w=null;n&&(y=o&&h.route.id?o[h.route.id]:void 0,E=h.route.errorElement||Vb,u&&(f<0&&g===0?(AE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),x=!0,w=null):f===g&&(x=!0,w=h.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,g+1)),b=()=>{let k;return y?k=E:x?k=w:h.route.Component?k=ve.createElement(h.route.Component,null):h.route.element?k=h.route.element:k=d,ve.createElement(Ub,{match:h,routeContext:{outlet:d,matches:T,isDataRoute:n!=null},children:k})};return n&&(h.route.ErrorBoundary||h.route.errorElement||g===0)?ve.createElement(Bb,{location:n.location,revalidation:n.revalidation,component:E,error:y,children:b(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):b()},null)}function ag(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zb(t){let e=ve.useContext(Zl);return Zt(e,ag(t)),e}function Hb(t){let e=ve.useContext(T0);return Zt(e,ag(t)),e}function Gb(t){let e=ve.useContext(Ji);return Zt(e,ag(t)),e}function sg(t){let e=Gb(t),n=e.matches[e.matches.length-1];return Zt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function qb(){return sg("useRouteId")}function $b(){let t=ve.useContext(ig),e=Hb("useRouteError"),n=sg("useRouteError");return t!==void 0?t:e.errors?.[n]}function Yb(){let{router:t}=zb("useNavigate"),e=sg("useNavigate"),n=ve.useRef(!1);return EE(()=>{n.current=!0}),ve.useCallback(async(a,o={})=>{Wi(n.current,_E),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var Ky={};function AE(t,e,n){!e&&!Ky[t]&&(Ky[t]=!0,Wi(!1,n))}ve.memo(Xb);function Xb({routes:t,future:e,state:n}){return wE(t,void 0,n,e)}function Il(t){Zt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Wb({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Zt(!Hc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=ve.useMemo(()=>({basename:u,navigator:a,static:o,future:{}}),[u,a,o]);typeof n=="string"&&(n=Ql(n));let{pathname:d="/",search:h="",hash:g="",state:y=null,key:x="default"}=n,E=ve.useMemo(()=>{let w=Ca(d,u);return w==null?null:{location:{pathname:w,search:h,hash:g,state:y,key:x},navigationType:r}},[u,d,h,g,y,x,r]);return Wi(E!=null,`<Router basename="${u}"> is not able to match the URL "${d}${h}${g}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:ve.createElement(Zi.Provider,{value:f},ve.createElement(zc.Provider,{children:e,value:E}))}function Kb({children:t,location:e}){return kb(Rp(t),e)}function Rp(t,e=[]){let n=[];return ve.Children.forEach(t,(r,a)=>{if(!ve.isValidElement(r))return;let o=[...e,a];if(r.type===ve.Fragment){n.push.apply(n,Rp(r.props.children,o));return}Zt(r.type===Il,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Zt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=Rp(r.props.children,o)),n.push(u)}),n}var kh="get",Lh="application/x-www-form-urlencoded";function w0(t){return t!=null&&typeof t.tagName=="string"}function Qb(t){return w0(t)&&t.tagName.toLowerCase()==="button"}function Zb(t){return w0(t)&&t.tagName.toLowerCase()==="form"}function Jb(t){return w0(t)&&t.tagName.toLowerCase()==="input"}function e3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function t3(t,e){return t.button===0&&(!e||e==="_self")&&!e3(t)}var Th=null;function n3(){if(Th===null)try{new FormData(document.createElement("form"),0),Th=!1}catch{Th=!0}return Th}var r3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function ip(t){return t!=null&&!r3.has(t)?(Wi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Lh}"`),null):t}function i3(t,e){let n,r,a,o,u;if(Zb(t)){let f=t.getAttribute("action");r=f?Ca(f,e):null,n=t.getAttribute("method")||kh,a=ip(t.getAttribute("enctype"))||Lh,o=new FormData(t)}else if(Qb(t)||Jb(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let d=t.getAttribute("formaction")||f.getAttribute("action");if(r=d?Ca(d,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||kh,a=ip(t.getAttribute("formenctype"))||ip(f.getAttribute("enctype"))||Lh,o=new FormData(f,t),!n3()){let{name:h,type:g,value:y}=t;if(g==="image"){let x=h?`${h}.`:"";o.append(`${x}x`,"0"),o.append(`${x}y`,"0")}else h&&o.append(h,y)}}else{if(w0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=kh,r=null,a=Lh,u=t}return o&&a==="text/plain"&&(u=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:u}}function og(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function a3(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function s3(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function o3(t,e,n){let r=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let u=await a3(o,n);return u.links?u.links():[]}return[]}));return f3(r.flat(1).filter(s3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Qy(t,e,n,r,a,o){let u=(d,h)=>n[h]?d.route.id!==n[h].route.id:!0,f=(d,h)=>n[h].pathname!==d.pathname||n[h].route.path?.endsWith("*")&&n[h].params["*"]!==d.params["*"];return o==="assets"?e.filter((d,h)=>u(d,h)||f(d,h)):o==="data"?e.filter((d,h)=>{let g=r.routes[d.route.id];if(!g||!g.hasLoader)return!1;if(u(d,h)||f(d,h))return!0;if(d.route.shouldRevalidate){let y=d.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:d.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function l3(t,e,{includeHydrateFallback:n}={}){return u3(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function u3(t){return[...new Set(t)]}function c3(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function f3(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let o=JSON.stringify(c3(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var h3=new Set([100,101,204,205]);function d3(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&Ca(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function SE(){let t=ve.useContext(Zl);return og(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function m3(){let t=ve.useContext(T0);return og(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var lg=ve.createContext(void 0);lg.displayName="FrameworkContext";function bE(){let t=ve.useContext(lg);return og(t,"You must render this element inside a <HydratedRouter> element"),t}function p3(t,e){let n=ve.useContext(lg),[r,a]=ve.useState(!1),[o,u]=ve.useState(!1),{onFocus:f,onBlur:d,onMouseEnter:h,onMouseLeave:g,onTouchStart:y}=e,x=ve.useRef(null);ve.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let T=k=>{k.forEach(q=>{u(q.isIntersecting)})},b=new IntersectionObserver(T,{threshold:.5});return x.current&&b.observe(x.current),()=>{b.disconnect()}}},[t]),ve.useEffect(()=>{if(r){let T=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(T)}}},[r]);let E=()=>{a(!0)},w=()=>{a(!1),u(!1)};return n?t!=="intent"?[o,x,{}]:[o,x,{onFocus:lc(f,E),onBlur:lc(d,w),onMouseEnter:lc(h,E),onMouseLeave:lc(g,w),onTouchStart:lc(y,E)}]:[!1,x,{}]}function lc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function g3({page:t,...e}){let{router:n}=SE(),r=ve.useMemo(()=>dE(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?ve.createElement(x3,{page:t,matches:r,...e}):null}function v3(t){let{manifest:e,routeModules:n}=bE(),[r,a]=ve.useState([]);return ve.useEffect(()=>{let o=!1;return o3(t,e,n).then(u=>{o||a(u)}),()=>{o=!0}},[t,e,n]),r}function x3({page:t,matches:e,...n}){let r=Ps(),{manifest:a,routeModules:o}=bE(),{basename:u}=SE(),{loaderData:f,matches:d}=m3(),h=ve.useMemo(()=>Qy(t,e,d,a,r,"data"),[t,e,d,a,r]),g=ve.useMemo(()=>Qy(t,e,d,a,r,"assets"),[t,e,d,a,r]),y=ve.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let w=new Set,T=!1;if(e.forEach(k=>{let q=a.routes[k.route.id];!q||!q.hasLoader||(!h.some(Y=>Y.route.id===k.route.id)&&k.route.id in f&&o[k.route.id]?.shouldRevalidate||q.hasClientLoader?T=!0:w.add(k.route.id))}),w.size===0)return[];let b=d3(t,u);return T&&w.size>0&&b.searchParams.set("_routes",e.filter(k=>w.has(k.route.id)).map(k=>k.route.id).join(",")),[b.pathname+b.search]},[u,f,r,a,h,e,t,o]),x=ve.useMemo(()=>l3(g,a),[g,a]),E=v3(g);return ve.createElement(ve.Fragment,null,y.map(w=>ve.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),x.map(w=>ve.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),E.map(({key:w,link:T})=>ve.createElement("link",{key:w,...T})))}function y3(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var CE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{CE&&(window.__reactRouterVersion="7.6.3")}catch{}function _3({basename:t,children:e,window:n}){let r=ve.useRef();r.current==null&&(r.current=ab({window:n,v5Compat:!0}));let a=r.current,[o,u]=ve.useState({action:a.action,location:a.location}),f=ve.useCallback(d=>{ve.startTransition(()=>u(d))},[u]);return ve.useLayoutEffect(()=>a.listen(f),[a,f]),ve.createElement(Wb,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}var RE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,xo=ve.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:o,replace:u,state:f,target:d,to:h,preventScrollReset:g,viewTransition:y,...x},E){let{basename:w}=ve.useContext(Zi),T=typeof h=="string"&&RE.test(h),b,k=!1;if(typeof h=="string"&&T&&(b=h,CE))try{let R=new URL(window.location.href),P=h.startsWith("//")?new URL(R.protocol+h):new URL(h),B=Ca(P.pathname,w);P.origin===R.origin&&B!=null?h=B+P.search+P.hash:k=!0}catch{Wi(!1,`<Link to="${h}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=Fb(h,{relative:a}),[Y,ee,he]=p3(r,x),Ae=A3(h,{replace:u,state:f,target:d,preventScrollReset:g,relative:a,viewTransition:y});function D(R){e&&e(R),R.defaultPrevented||Ae(R)}let I=ve.createElement("a",{...x,...he,href:b||q,onClick:k||o?e:D,ref:y3(E,ee),target:d,"data-discover":!T&&n==="render"?"true":void 0});return Y&&!T?ve.createElement(ve.Fragment,null,I,ve.createElement(g3,{page:q})):I});xo.displayName="Link";var E3=ve.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:o,to:u,viewTransition:f,children:d,...h},g){let y=Gc(u,{relative:h.relative}),x=Ps(),E=ve.useContext(T0),{navigator:w,basename:T}=ve.useContext(Zi),b=E!=null&&N3(y)&&f===!0,k=w.encodeLocation?w.encodeLocation(y).pathname:y.pathname,q=x.pathname,Y=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;n||(q=q.toLowerCase(),Y=Y?Y.toLowerCase():null,k=k.toLowerCase()),Y&&T&&(Y=Ca(Y,T)||Y);const ee=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let he=q===k||!a&&q.startsWith(k)&&q.charAt(ee)==="/",Ae=Y!=null&&(Y===k||!a&&Y.startsWith(k)&&Y.charAt(k.length)==="/"),D={isActive:he,isPending:Ae,isTransitioning:b},I=he?e:void 0,R;typeof r=="function"?R=r(D):R=[r,he?"active":null,Ae?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let P=typeof o=="function"?o(D):o;return ve.createElement(xo,{...h,"aria-current":I,className:R,ref:g,style:P,to:u,viewTransition:f},typeof d=="function"?d(D):d)});E3.displayName="NavLink";var T3=ve.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:o,method:u=kh,action:f,onSubmit:d,relative:h,preventScrollReset:g,viewTransition:y,...x},E)=>{let w=C3(),T=R3(f,{relative:h}),b=u.toLowerCase()==="get"?"get":"post",k=typeof f=="string"&&RE.test(f),q=Y=>{if(d&&d(Y),Y.defaultPrevented)return;Y.preventDefault();let ee=Y.nativeEvent.submitter,he=ee?.getAttribute("formmethod")||u;w(ee||Y.currentTarget,{fetcherKey:e,method:he,navigate:n,replace:a,state:o,relative:h,preventScrollReset:g,viewTransition:y})};return ve.createElement("form",{ref:E,method:b,action:T,onSubmit:r?d:q,...x,"data-discover":!k&&t==="render"?"true":void 0})});T3.displayName="Form";function w3(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function NE(t){let e=ve.useContext(Zl);return Zt(e,w3(t)),e}function A3(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:u}={}){let f=Mb(),d=Ps(),h=Gc(t,{relative:o});return ve.useCallback(g=>{if(t3(g,e)){g.preventDefault();let y=n!==void 0?n:bc(d)===bc(h);f(t,{replace:y,state:r,preventScrollReset:a,relative:o,viewTransition:u})}},[d,f,h,n,r,e,t,a,o,u])}var S3=0,b3=()=>`__${String(++S3)}__`;function C3(){let{router:t}=NE("useSubmit"),{basename:e}=ve.useContext(Zi),n=qb();return ve.useCallback(async(r,a={})=>{let{action:o,method:u,encType:f,formData:d,body:h}=i3(r,e);if(a.navigate===!1){let g=a.fetcherKey||b3();await t.fetch(g,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:h,formMethod:a.method||u,formEncType:a.encType||f,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:d,body:h,formMethod:a.method||u,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function R3(t,{relative:e}={}){let{basename:n}=ve.useContext(Zi),r=ve.useContext(Ji);Zt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...Gc(t||".",{relative:e})},u=Ps();if(t==null){o.search=u.search;let f=new URLSearchParams(o.search),d=f.getAll("index");if(d.some(g=>g==="")){f.delete("index"),d.filter(y=>y).forEach(y=>f.append("index",y));let g=f.toString();o.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Ta([n,o.pathname])),bc(o)}function N3(t,e={}){let n=ve.useContext(yE);Zt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=NE("useViewTransitionState"),a=Gc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=Ca(n.currentLocation.pathname,r)||n.currentLocation.pathname,u=Ca(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Gh(a.pathname,u)!=null||Gh(a.pathname,o)!=null}[...h3];/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),D3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),Zy=t=>{const e=D3(t);return e.charAt(0).toUpperCase()+e.slice(1)},IE=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),O3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var F3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=ve.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:u,...f},d)=>ve.createElement("svg",{ref:d,...F3,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:IE("lucide",a),...!o&&!O3(f)&&{"aria-hidden":"true"},...f},[...u.map(([h,g])=>ve.createElement(h,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=(t,e)=>{const n=ve.forwardRef(({className:r,...a},o)=>ve.createElement(M3,{ref:o,iconNode:e,className:IE(`lucide-${I3(Zy(t))}`,`lucide-${t}`,r),...a}));return n.displayName=Zy(t),n};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],k3=qc("copy",P3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],ys=qc("download",L3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],A0=qc("file-text",V3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],S0=qc("plus",B3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],$c=qc("trash-2",U3),b0="/dra-invoice/logo.svg",j3=()=>{};var Jy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const DE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},z3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[n++];e[r++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[n++],u=t[n++],f=t[n++],d=((a&7)<<18|(o&63)<<12|(u&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(d>>10)),e[r++]=String.fromCharCode(56320+(d&1023))}else{const o=t[n++],u=t[n++];e[r++]=String.fromCharCode((a&15)<<12|(o&63)<<6|u&63)}}return e.join("")},OE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const o=t[a],u=a+1<t.length,f=u?t[a+1]:0,d=a+2<t.length,h=d?t[a+2]:0,g=o>>2,y=(o&3)<<4|f>>4;let x=(f&15)<<2|h>>6,E=h&63;d||(E=64,u||(x=64)),r.push(n[g],n[y],n[x],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(DE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):z3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const o=n[t.charAt(a++)],f=a<t.length?n[t.charAt(a)]:0;++a;const h=a<t.length?n[t.charAt(a)]:64;++a;const y=a<t.length?n[t.charAt(a)]:64;if(++a,o==null||f==null||h==null||y==null)throw new H3;const x=o<<2|f>>4;if(r.push(x),h!==64){const E=f<<4&240|h>>2;if(r.push(E),y!==64){const w=h<<6&192|y;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class H3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const G3=function(t){const e=DE(t);return OE.encodeByteArray(e,!0)},qh=function(t){return G3(t).replace(/\./g,"")},q3=function(t){try{return OE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3=()=>$3().__FIREBASE_DEFAULTS__,X3=()=>{if(typeof process>"u"||typeof Jy>"u")return;const t=Jy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},W3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q3(t[1]);return e&&JSON.parse(e)},ug=()=>{try{return j3()||Y3()||X3()||W3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},K3=t=>{var e,n;return(n=(e=ug())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Q3=t=>{const e=K3(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},FE=()=>{var t;return(t=ug())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cg(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function J3(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eC(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[qh(JSON.stringify(n)),qh(JSON.stringify(u)),""].join(".")}const pc={};function tC(){const t={prod:[],emulator:[]};for(const e of Object.keys(pc))pc[e]?t.emulator.push(e):t.prod.push(e);return t}function nC(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let e_=!1;function rC(t,e){if(typeof window>"u"||typeof document>"u"||!cg(window.location.host)||pc[t]===e||pc[t]||e_)return;pc[t]=e;function n(x){return`__firebase__banner__${x}`}const r="__firebase__banner",o=tC().prod.length>0;function u(){const x=document.getElementById(r);x&&x.remove()}function f(x){x.style.display="flex",x.style.background="#7faaf0",x.style.position="fixed",x.style.bottom="5px",x.style.left="5px",x.style.padding=".5em",x.style.borderRadius="5px",x.style.alignItems="center"}function d(x,E){x.setAttribute("width","24"),x.setAttribute("id",E),x.setAttribute("height","24"),x.setAttribute("viewBox","0 0 24 24"),x.setAttribute("fill","none"),x.style.marginLeft="-6px"}function h(){const x=document.createElement("span");return x.style.cursor="pointer",x.style.marginLeft="16px",x.style.fontSize="24px",x.innerHTML=" &times;",x.onclick=()=>{e_=!0,u()},x}function g(x,E){x.setAttribute("id",E),x.innerText="Learn more",x.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",x.setAttribute("target","__blank"),x.style.paddingLeft="5px",x.style.textDecoration="underline"}function y(){const x=nC(r),E=n("text"),w=document.getElementById(E)||document.createElement("span"),T=n("learnmore"),b=document.getElementById(T)||document.createElement("a"),k=n("preprendIcon"),q=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(x.created){const Y=x.element;f(Y),g(b,T);const ee=h();d(q,k),Y.append(q,w,b,ee),document.body.appendChild(Y)}o?(w.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iC(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aC(){var t;const e=(t=ug())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sC(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oC(){return!aC()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function ME(){try{return typeof indexedDB=="object"}catch{return!1}}function PE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function lC(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uC="FirebaseError";class ks extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uC,Object.setPrototypeOf(this,ks.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,C0.prototype.create)}}class C0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},a=`${this.service}/${e}`,o=this.errors[e],u=o?cC(o,r):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new ks(a,f,r)}}function cC(t,e){return t.replace(fC,(n,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const fC=/\{\$([^}]+)}/g;function $h(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const o=t[a],u=e[a];if(t_(o)&&t_(u)){if(!$h(o,u))return!1}else if(o!==u)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function t_(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hC=1e3,dC=2,mC=4*60*60*1e3,pC=.5;function n_(t,e=hC,n=dC){const r=e*Math.pow(n,t),a=Math.round(pC*r*(Math.random()-.5)*2);return Math.min(mC,r+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _s(t){return t&&t._delegate?t._delegate:t}class Ra{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mo="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gC{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Z3;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e?.identifier),a=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(xC(e))try{this.getOrInitializeService({instanceIdentifier:mo})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:a});r.resolve(o)}catch{}}}}clearInstance(e=mo){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=mo){return this.instances.has(e)}getOptions(e=mo){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(o);r===f&&u.resolve(a)}return a}onInit(e,n){var r;const a=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(a,o);const u=this.instances.get(a);return u&&e(u,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vC(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=mo){return this.component?this.component.multipleInstances?e:mo:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vC(t){return t===mo?void 0:t}function xC(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yC{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gC(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(yt||(yt={}));const _C={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},EC=yt.INFO,TC={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},wC=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),a=TC[e];if(a)console[a](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class fg{constructor(e){this.name=e,this._logLevel=EC,this._logHandler=wC,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?_C[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const AC=(t,e)=>e.some(n=>t instanceof n);let r_,i_;function SC(){return r_||(r_=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bC(){return i_||(i_=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const kE=new WeakMap,Np=new WeakMap,LE=new WeakMap,ap=new WeakMap,hg=new WeakMap;function CC(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{n(ms(t.result)),a()},u=()=>{r(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&kE.set(n,t)}).catch(()=>{}),hg.set(e,t),e}function RC(t){if(Np.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{n(),a()},u=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});Np.set(t,e)}let Ip={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Np.get(t);if(e==="objectStoreNames")return t.objectStoreNames||LE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ms(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function NC(t){Ip=t(Ip)}function IC(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(sp(this),e,...n);return LE.set(r,e.sort?e.sort():[e]),ms(r)}:bC().includes(t)?function(...e){return t.apply(sp(this),e),ms(kE.get(this))}:function(...e){return ms(t.apply(sp(this),e))}}function DC(t){return typeof t=="function"?IC(t):(t instanceof IDBTransaction&&RC(t),AC(t,SC())?new Proxy(t,Ip):t)}function ms(t){if(t instanceof IDBRequest)return CC(t);if(ap.has(t))return ap.get(t);const e=DC(t);return e!==t&&(ap.set(t,e),hg.set(e,t)),e}const sp=t=>hg.get(t);function OC(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const u=indexedDB.open(t,e),f=ms(u);return r&&u.addEventListener("upgradeneeded",d=>{r(ms(u.result),d.oldVersion,d.newVersion,ms(u.transaction),d)}),n&&u.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),f.then(d=>{o&&d.addEventListener("close",()=>o()),a&&d.addEventListener("versionchange",h=>a(h.oldVersion,h.newVersion,h))}).catch(()=>{}),f}const FC=["get","getKey","getAll","getAllKeys","count"],MC=["put","add","delete","clear"],op=new Map;function a_(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(op.get(e))return op.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=MC.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||FC.includes(n)))return;const o=async function(u,...f){const d=this.transaction(u,a?"readwrite":"readonly");let h=d.store;return r&&(h=h.index(f.shift())),(await Promise.all([h[n](...f),a&&d.done]))[0]};return op.set(e,o),o}NC(t=>({...t,get:(e,n,r)=>a_(e,n)||t.get(e,n,r),has:(e,n)=>!!a_(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PC{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(kC(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function kC(t){const e=t.getComponent();return e?.type==="VERSION"}const Dp="@firebase/app",s_="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Na=new fg("@firebase/app"),LC="@firebase/app-compat",VC="@firebase/analytics-compat",BC="@firebase/analytics",UC="@firebase/app-check-compat",jC="@firebase/app-check",zC="@firebase/auth",HC="@firebase/auth-compat",GC="@firebase/database",qC="@firebase/data-connect",$C="@firebase/database-compat",YC="@firebase/functions",XC="@firebase/functions-compat",WC="@firebase/installations",KC="@firebase/installations-compat",QC="@firebase/messaging",ZC="@firebase/messaging-compat",JC="@firebase/performance",eR="@firebase/performance-compat",tR="@firebase/remote-config",nR="@firebase/remote-config-compat",rR="@firebase/storage",iR="@firebase/storage-compat",aR="@firebase/firestore",sR="@firebase/ai",oR="@firebase/firestore-compat",lR="firebase",uR="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Op="[DEFAULT]",cR={[Dp]:"fire-core",[LC]:"fire-core-compat",[BC]:"fire-analytics",[VC]:"fire-analytics-compat",[jC]:"fire-app-check",[UC]:"fire-app-check-compat",[zC]:"fire-auth",[HC]:"fire-auth-compat",[GC]:"fire-rtdb",[qC]:"fire-data-connect",[$C]:"fire-rtdb-compat",[YC]:"fire-fn",[XC]:"fire-fn-compat",[WC]:"fire-iid",[KC]:"fire-iid-compat",[QC]:"fire-fcm",[ZC]:"fire-fcm-compat",[JC]:"fire-perf",[eR]:"fire-perf-compat",[tR]:"fire-rc",[nR]:"fire-rc-compat",[rR]:"fire-gcs",[iR]:"fire-gcs-compat",[aR]:"fire-fst",[oR]:"fire-fst-compat",[sR]:"fire-vertex","fire-js":"fire-js",[lR]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yh=new Map,fR=new Map,Fp=new Map;function o_(t,e){try{t.container.addComponent(e)}catch(n){Na.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Es(t){const e=t.name;if(Fp.has(e))return Na.debug(`There were multiple attempts to register component ${e}.`),!1;Fp.set(e,t);for(const n of Yh.values())o_(n,t);for(const n of fR.values())o_(n,t);return!0}function dg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function hR(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dR={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ps=new C0("app","Firebase",dR);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mR{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ps.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pR=uR;function VE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Op,automaticDataCollectionEnabled:!0},e),a=r.name;if(typeof a!="string"||!a)throw ps.create("bad-app-name",{appName:String(a)});if(n||(n=FE()),!n)throw ps.create("no-options");const o=Yh.get(a);if(o){if($h(n,o.options)&&$h(r,o.config))return o;throw ps.create("duplicate-app",{appName:a})}const u=new yC(a);for(const d of Fp.values())u.addComponent(d);const f=new mR(n,r,u);return Yh.set(a,f),f}function gR(t=Op){const e=Yh.get(t);if(!e&&t===Op&&FE())return VE();if(!e)throw ps.create("no-app",{appName:t});return e}function zi(t,e,n){var r;let a=(r=cR[t])!==null&&r!==void 0?r:t;n&&(a+=`-${n}`);const o=a.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const f=[`Unable to register library "${a}" with version "${e}":`];o&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&u&&f.push("and"),u&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Na.warn(f.join(" "));return}Es(new Ra(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vR="firebase-heartbeat-database",xR=1,Cc="firebase-heartbeat-store";let lp=null;function BE(){return lp||(lp=OC(vR,xR,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Cc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ps.create("idb-open",{originalErrorMessage:t.message})})),lp}async function yR(t){try{const n=(await BE()).transaction(Cc),r=await n.objectStore(Cc).get(UE(t));return await n.done,r}catch(e){if(e instanceof ks)Na.warn(e.message);else{const n=ps.create("idb-get",{originalErrorMessage:e?.message});Na.warn(n.message)}}}async function l_(t,e){try{const r=(await BE()).transaction(Cc,"readwrite");await r.objectStore(Cc).put(e,UE(t)),await r.done}catch(n){if(n instanceof ks)Na.warn(n.message);else{const r=ps.create("idb-set",{originalErrorMessage:n?.message});Na.warn(r.message)}}}function UE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _R=1024,ER=30;class TR{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AR(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=u_();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>ER){const u=SR(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Na.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=u_(),{heartbeatsToSend:r,unsentEntries:a}=wR(this._heartbeatsCache.heartbeats),o=qh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Na.warn(n),""}}}function u_(){return new Date().toISOString().substring(0,10)}function wR(t,e=_R){const n=[];let r=t.slice();for(const a of t){const o=n.find(u=>u.agent===a.agent);if(o){if(o.dates.push(a.date),c_(n)>e){o.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),c_(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AR{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return ME()?PE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await yR(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return l_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return l_(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function c_(t){return qh(JSON.stringify({version:2,heartbeats:t})).length}function SR(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bR(t){Es(new Ra("platform-logger",e=>new PC(e),"PRIVATE")),Es(new Ra("heartbeat",e=>new TR(e),"PRIVATE")),zi(Dp,s_,t),zi(Dp,s_,"esm2017"),zi("fire-js","")}bR("");var f_=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var gs,jE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(D,I){function R(){}R.prototype=I.prototype,D.D=I.prototype,D.prototype=new R,D.prototype.constructor=D,D.C=function(P,B,H){for(var V=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)V[Je-2]=arguments[Je];return I.prototype[B].apply(P,V)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(D,I,R){R||(R=0);var P=Array(16);if(typeof I=="string")for(var B=0;16>B;++B)P[B]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(B=0;16>B;++B)P[B]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=D.g[0],R=D.g[1],B=D.g[2];var H=D.g[3],V=I+(H^R&(B^H))+P[0]+3614090360&4294967295;I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+P[1]+3905402710&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+P[2]+606105819&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+P[3]+3250441966&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+P[4]+4118548399&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+P[5]+1200080426&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+P[6]+2821735955&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+P[7]+4249261313&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+P[8]+1770035416&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+P[9]+2336552879&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+P[10]+4294925233&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+P[11]+2304563134&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+P[12]+1804603682&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+P[13]+4254626195&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+P[14]+2792965006&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+P[15]+1236535329&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(B^H&(R^B))+P[1]+4129170786&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+P[6]+3225465664&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+P[11]+643717713&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+P[0]+3921069994&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+P[5]+3593408605&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+P[10]+38016083&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+P[15]+3634488961&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+P[4]+3889429448&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+P[9]+568446438&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+P[14]+3275163606&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+P[3]+4107603335&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+P[8]+1163531501&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+P[13]+2850285829&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+P[2]+4243563512&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+P[7]+1735328473&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+P[12]+2368359562&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(R^B^H)+P[5]+4294588738&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+P[8]+2272392833&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+P[11]+1839030562&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+P[14]+4259657740&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+P[1]+2763975236&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+P[4]+1272893353&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+P[7]+4139469664&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+P[10]+3200236656&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+P[13]+681279174&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+P[0]+3936430074&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+P[3]+3572445317&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+P[6]+76029189&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+P[9]+3654602809&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+P[12]+3873151461&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+P[15]+530742520&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+P[2]+3299628645&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(B^(R|~H))+P[0]+4096336452&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+P[7]+1126891415&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+P[14]+2878612391&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+P[5]+4237533241&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+P[12]+1700485571&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+P[3]+2399980690&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+P[10]+4293915773&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+P[1]+2240044497&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+P[8]+1873313359&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+P[15]+4264355552&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+P[6]+2734768916&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+P[13]+1309151649&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+P[4]+4149444226&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+P[11]+3174756917&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+P[2]+718787259&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+P[9]+3951481745&4294967295,D.g[0]=D.g[0]+I&4294967295,D.g[1]=D.g[1]+(B+(V<<21&4294967295|V>>>11))&4294967295,D.g[2]=D.g[2]+B&4294967295,D.g[3]=D.g[3]+H&4294967295}r.prototype.u=function(D,I){I===void 0&&(I=D.length);for(var R=I-this.blockSize,P=this.B,B=this.h,H=0;H<I;){if(B==0)for(;H<=R;)a(this,D,H),H+=this.blockSize;if(typeof D=="string"){for(;H<I;)if(P[B++]=D.charCodeAt(H++),B==this.blockSize){a(this,P),B=0;break}}else for(;H<I;)if(P[B++]=D[H++],B==this.blockSize){a(this,P),B=0;break}}this.h=B,this.o+=I},r.prototype.v=function(){var D=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);D[0]=128;for(var I=1;I<D.length-8;++I)D[I]=0;var R=8*this.o;for(I=D.length-8;I<D.length;++I)D[I]=R&255,R/=256;for(this.u(D),D=Array(16),I=R=0;4>I;++I)for(var P=0;32>P;P+=8)D[R++]=this.g[I]>>>P&255;return D};function o(D,I){var R=f;return Object.prototype.hasOwnProperty.call(R,D)?R[D]:R[D]=I(D)}function u(D,I){this.h=I;for(var R=[],P=!0,B=D.length-1;0<=B;B--){var H=D[B]|0;P&&H==I||(R[B]=H,P=!1)}this.g=R}var f={};function d(D){return-128<=D&&128>D?o(D,function(I){return new u([I|0],0>I?-1:0)}):new u([D|0],0>D?-1:0)}function h(D){if(isNaN(D)||!isFinite(D))return y;if(0>D)return b(h(-D));for(var I=[],R=1,P=0;D>=R;P++)I[P]=D/R|0,R*=4294967296;return new u(I,0)}function g(D,I){if(D.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(D.charAt(0)=="-")return b(g(D.substring(1),I));if(0<=D.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=h(Math.pow(I,8)),P=y,B=0;B<D.length;B+=8){var H=Math.min(8,D.length-B),V=parseInt(D.substring(B,B+H),I);8>H?(H=h(Math.pow(I,H)),P=P.j(H).add(h(V))):(P=P.j(R),P=P.add(h(V)))}return P}var y=d(0),x=d(1),E=d(16777216);t=u.prototype,t.m=function(){if(T(this))return-b(this).m();for(var D=0,I=1,R=0;R<this.g.length;R++){var P=this.i(R);D+=(0<=P?P:4294967296+P)*I,I*=4294967296}return D},t.toString=function(D){if(D=D||10,2>D||36<D)throw Error("radix out of range: "+D);if(w(this))return"0";if(T(this))return"-"+b(this).toString(D);for(var I=h(Math.pow(D,6)),R=this,P="";;){var B=ee(R,I).g;R=k(R,B.j(I));var H=((0<R.g.length?R.g[0]:R.h)>>>0).toString(D);if(R=B,w(R))return H+P;for(;6>H.length;)H="0"+H;P=H+P}},t.i=function(D){return 0>D?0:D<this.g.length?this.g[D]:this.h};function w(D){if(D.h!=0)return!1;for(var I=0;I<D.g.length;I++)if(D.g[I]!=0)return!1;return!0}function T(D){return D.h==-1}t.l=function(D){return D=k(this,D),T(D)?-1:w(D)?0:1};function b(D){for(var I=D.g.length,R=[],P=0;P<I;P++)R[P]=~D.g[P];return new u(R,~D.h).add(x)}t.abs=function(){return T(this)?b(this):this},t.add=function(D){for(var I=Math.max(this.g.length,D.g.length),R=[],P=0,B=0;B<=I;B++){var H=P+(this.i(B)&65535)+(D.i(B)&65535),V=(H>>>16)+(this.i(B)>>>16)+(D.i(B)>>>16);P=V>>>16,H&=65535,V&=65535,R[B]=V<<16|H}return new u(R,R[R.length-1]&-2147483648?-1:0)};function k(D,I){return D.add(b(I))}t.j=function(D){if(w(this)||w(D))return y;if(T(this))return T(D)?b(this).j(b(D)):b(b(this).j(D));if(T(D))return b(this.j(b(D)));if(0>this.l(E)&&0>D.l(E))return h(this.m()*D.m());for(var I=this.g.length+D.g.length,R=[],P=0;P<2*I;P++)R[P]=0;for(P=0;P<this.g.length;P++)for(var B=0;B<D.g.length;B++){var H=this.i(P)>>>16,V=this.i(P)&65535,Je=D.i(B)>>>16,He=D.i(B)&65535;R[2*P+2*B]+=V*He,q(R,2*P+2*B),R[2*P+2*B+1]+=H*He,q(R,2*P+2*B+1),R[2*P+2*B+1]+=V*Je,q(R,2*P+2*B+1),R[2*P+2*B+2]+=H*Je,q(R,2*P+2*B+2)}for(P=0;P<I;P++)R[P]=R[2*P+1]<<16|R[2*P];for(P=I;P<2*I;P++)R[P]=0;return new u(R,0)};function q(D,I){for(;(D[I]&65535)!=D[I];)D[I+1]+=D[I]>>>16,D[I]&=65535,I++}function Y(D,I){this.g=D,this.h=I}function ee(D,I){if(w(I))throw Error("division by zero");if(w(D))return new Y(y,y);if(T(D))return I=ee(b(D),I),new Y(b(I.g),b(I.h));if(T(I))return I=ee(D,b(I)),new Y(b(I.g),I.h);if(30<D.g.length){if(T(D)||T(I))throw Error("slowDivide_ only works with positive integers.");for(var R=x,P=I;0>=P.l(D);)R=he(R),P=he(P);var B=Ae(R,1),H=Ae(P,1);for(P=Ae(P,2),R=Ae(R,2);!w(P);){var V=H.add(P);0>=V.l(D)&&(B=B.add(R),H=V),P=Ae(P,1),R=Ae(R,1)}return I=k(D,B.j(I)),new Y(B,I)}for(B=y;0<=D.l(I);){for(R=Math.max(1,Math.floor(D.m()/I.m())),P=Math.ceil(Math.log(R)/Math.LN2),P=48>=P?1:Math.pow(2,P-48),H=h(R),V=H.j(I);T(V)||0<V.l(D);)R-=P,H=h(R),V=H.j(I);w(H)&&(H=x),B=B.add(H),D=k(D,V)}return new Y(B,D)}t.A=function(D){return ee(this,D).h},t.and=function(D){for(var I=Math.max(this.g.length,D.g.length),R=[],P=0;P<I;P++)R[P]=this.i(P)&D.i(P);return new u(R,this.h&D.h)},t.or=function(D){for(var I=Math.max(this.g.length,D.g.length),R=[],P=0;P<I;P++)R[P]=this.i(P)|D.i(P);return new u(R,this.h|D.h)},t.xor=function(D){for(var I=Math.max(this.g.length,D.g.length),R=[],P=0;P<I;P++)R[P]=this.i(P)^D.i(P);return new u(R,this.h^D.h)};function he(D){for(var I=D.g.length+1,R=[],P=0;P<I;P++)R[P]=D.i(P)<<1|D.i(P-1)>>>31;return new u(R,D.h)}function Ae(D,I){var R=I>>5;I%=32;for(var P=D.g.length-R,B=[],H=0;H<P;H++)B[H]=0<I?D.i(H+R)>>>I|D.i(H+R+1)<<32-I:D.i(H+R);return new u(B,D.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,jE=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=h,u.fromString=g,gs=u}).apply(typeof f_<"u"?f_:typeof self<"u"?self:typeof window<"u"?window:{});var wh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var zE,cc,HE,Vh,Mp,GE,qE,$E;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(m,_,A){return m==Array.prototype||m==Object.prototype||(m[_]=A.value),m};function n(m){m=[typeof globalThis=="object"&&globalThis,m,typeof window=="object"&&window,typeof self=="object"&&self,typeof wh=="object"&&wh];for(var _=0;_<m.length;++_){var A=m[_];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=n(this);function a(m,_){if(_)e:{var A=r;m=m.split(".");for(var F=0;F<m.length-1;F++){var re=m[F];if(!(re in A))break e;A=A[re]}m=m[m.length-1],F=A[m],_=_(F),_!=F&&_!=null&&e(A,m,{configurable:!0,writable:!0,value:_})}}function o(m,_){m instanceof String&&(m+="");var A=0,F=!1,re={next:function(){if(!F&&A<m.length){var pe=A++;return{value:_(pe,m[pe]),done:!1}}return F=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}a("Array.prototype.values",function(m){return m||function(){return o(this,function(_,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},f=this||self;function d(m){var _=typeof m;return _=_!="object"?_:m?Array.isArray(m)?"array":_:"null",_=="array"||_=="object"&&typeof m.length=="number"}function h(m){var _=typeof m;return _=="object"&&m!=null||_=="function"}function g(m,_,A){return m.call.apply(m.bind,arguments)}function y(m,_,A){if(!m)throw Error();if(2<arguments.length){var F=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,F),m.apply(_,re)}}return function(){return m.apply(_,arguments)}}function x(m,_,A){return x=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:y,x.apply(null,arguments)}function E(m,_){var A=Array.prototype.slice.call(arguments,1);return function(){var F=A.slice();return F.push.apply(F,arguments),m.apply(this,F)}}function w(m,_){function A(){}A.prototype=_.prototype,m.aa=_.prototype,m.prototype=new A,m.prototype.constructor=m,m.Qb=function(F,re,pe){for(var De=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)De[pt-2]=arguments[pt];return _.prototype[re].apply(F,De)}}function T(m){const _=m.length;if(0<_){const A=Array(_);for(let F=0;F<_;F++)A[F]=m[F];return A}return[]}function b(m,_){for(let A=1;A<arguments.length;A++){const F=arguments[A];if(d(F)){const re=m.length||0,pe=F.length||0;m.length=re+pe;for(let De=0;De<pe;De++)m[re+De]=F[De]}else m.push(F)}}class k{constructor(_,A){this.i=_,this.j=A,this.h=0,this.g=null}get(){let _;return 0<this.h?(this.h--,_=this.g,this.g=_.next,_.next=null):_=this.i(),_}}function q(m){return/^[\s\xa0]*$/.test(m)}function Y(){var m=f.navigator;return m&&(m=m.userAgent)?m:""}function ee(m){return ee[" "](m),m}ee[" "]=function(){};var he=Y().indexOf("Gecko")!=-1&&!(Y().toLowerCase().indexOf("webkit")!=-1&&Y().indexOf("Edge")==-1)&&!(Y().indexOf("Trident")!=-1||Y().indexOf("MSIE")!=-1)&&Y().indexOf("Edge")==-1;function Ae(m,_,A){for(const F in m)_.call(A,m[F],F,m)}function D(m,_){for(const A in m)_.call(void 0,m[A],A,m)}function I(m){const _={};for(const A in m)_[A]=m[A];return _}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(m,_){let A,F;for(let re=1;re<arguments.length;re++){F=arguments[re];for(A in F)m[A]=F[A];for(let pe=0;pe<R.length;pe++)A=R[pe],Object.prototype.hasOwnProperty.call(F,A)&&(m[A]=F[A])}}function B(m){var _=1;m=m.split(":");const A=[];for(;0<_&&m.length;)A.push(m.shift()),_--;return m.length&&A.push(m.join(":")),A}function H(m){f.setTimeout(()=>{throw m},0)}function V(){var m=Xe;let _=null;return m.g&&(_=m.g,m.g=m.g.next,m.g||(m.h=null),_.next=null),_}class Je{constructor(){this.h=this.g=null}add(_,A){const F=He.get();F.set(_,A),this.h?this.h.next=F:this.g=F,this.h=F}}var He=new k(()=>new de,m=>m.reset());class de{constructor(){this.next=this.g=this.h=null}set(_,A){this.h=_,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let Ce,ze=!1,Xe=new Je,Q=()=>{const m=f.Promise.resolve(void 0);Ce=()=>{m.then(_e)}};var _e=()=>{for(var m;m=V();){try{m.h.call(m.g)}catch(A){H(A)}var _=He;_.j(m),100>_.h&&(_.h++,m.next=_.g,_.g=m)}ze=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(m,_){this.type=m,this.g=this.target=_,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var m=!1,_=Object.defineProperty({},"passive",{get:function(){m=!0}});try{const A=()=>{};f.addEventListener("test",A,_),f.removeEventListener("test",A,_)}catch{}return m}();function Z(m,_){if(W.call(this,m?m.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,m){var A=this.type=m.type,F=m.changedTouches&&m.changedTouches.length?m.changedTouches[0]:null;if(this.target=m.target||m.srcElement,this.g=_,_=m.relatedTarget){if(he){e:{try{ee(_.nodeName);var re=!0;break e}catch{}re=!1}re||(_=null)}}else A=="mouseover"?_=m.fromElement:A=="mouseout"&&(_=m.toElement);this.relatedTarget=_,F?(this.clientX=F.clientX!==void 0?F.clientX:F.pageX,this.clientY=F.clientY!==void 0?F.clientY:F.pageY,this.screenX=F.screenX||0,this.screenY=F.screenY||0):(this.clientX=m.clientX!==void 0?m.clientX:m.pageX,this.clientY=m.clientY!==void 0?m.clientY:m.pageY,this.screenX=m.screenX||0,this.screenY=m.screenY||0),this.button=m.button,this.key=m.key||"",this.ctrlKey=m.ctrlKey,this.altKey=m.altKey,this.shiftKey=m.shiftKey,this.metaKey=m.metaKey,this.pointerId=m.pointerId||0,this.pointerType=typeof m.pointerType=="string"?m.pointerType:ce[m.pointerType]||"",this.state=m.state,this.i=m,m.defaultPrevented&&Z.aa.h.call(this)}}w(Z,W);var ce={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var m=this.i;m.preventDefault?m.preventDefault():m.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Be(m,_,A,F,re){this.listener=m,this.proxy=null,this.src=_,this.type=A,this.capture=!!F,this.ha=re,this.key=++Fe,this.da=this.fa=!1}function Me(m){m.da=!0,m.listener=null,m.proxy=null,m.src=null,m.ha=null}function ut(m){this.src=m,this.g={},this.h=0}ut.prototype.add=function(m,_,A,F,re){var pe=m.toString();m=this.g[pe],m||(m=this.g[pe]=[],this.h++);var De=Kt(m,_,F,re);return-1<De?(_=m[De],A||(_.fa=!1)):(_=new Be(_,this.src,pe,!!F,re),_.fa=A,m.push(_)),_};function nt(m,_){var A=_.type;if(A in m.g){var F=m.g[A],re=Array.prototype.indexOf.call(F,_,void 0),pe;(pe=0<=re)&&Array.prototype.splice.call(F,re,1),pe&&(Me(_),m.g[A].length==0&&(delete m.g[A],m.h--))}}function Kt(m,_,A,F){for(var re=0;re<m.length;++re){var pe=m[re];if(!pe.da&&pe.listener==_&&pe.capture==!!A&&pe.ha==F)return re}return-1}var ot="closure_lm_"+(1e6*Math.random()|0),ir={};function Ut(m,_,A,F,re){if(Array.isArray(_)){for(var pe=0;pe<_.length;pe++)Ut(m,_[pe],A,F,re);return null}return A=ea(A),m&&m[Le]?m.K(_,A,h(F)?!!F.capture:!1,re):Ve(m,_,A,!1,F,re)}function Ve(m,_,A,F,re,pe){if(!_)throw Error("Invalid event type");var De=h(re)?!!re.capture:!!re,pt=xi(m);if(pt||(m[ot]=pt=new ut(m)),A=pt.add(_,A,F,De,pe),A.proxy)return A;if(F=Wn(),A.proxy=F,F.src=m,F.listener=A,m.addEventListener)K||(re=De),re===void 0&&(re=!1),m.addEventListener(_.toString(),F,re);else if(m.attachEvent)m.attachEvent(pr(_.toString()),F);else if(m.addListener&&m.removeListener)m.addListener(F);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Wn(){function m(A){return _.call(m.src,m.listener,A)}const _=Bo;return m}function ar(m,_,A,F,re){if(Array.isArray(_))for(var pe=0;pe<_.length;pe++)ar(m,_[pe],A,F,re);else F=h(F)?!!F.capture:!!F,A=ea(A),m&&m[Le]?(m=m.i,_=String(_).toString(),_ in m.g&&(pe=m.g[_],A=Kt(pe,A,F,re),-1<A&&(Me(pe[A]),Array.prototype.splice.call(pe,A,1),pe.length==0&&(delete m.g[_],m.h--)))):m&&(m=xi(m))&&(_=m.g[_.toString()],m=-1,_&&(m=Kt(_,A,F,re)),(A=-1<m?_[m]:null)&&mr(A))}function mr(m){if(typeof m!="number"&&m&&!m.da){var _=m.src;if(_&&_[Le])nt(_.i,m);else{var A=m.type,F=m.proxy;_.removeEventListener?_.removeEventListener(A,F,m.capture):_.detachEvent?_.detachEvent(pr(A),F):_.addListener&&_.removeListener&&_.removeListener(F),(A=xi(_))?(nt(A,m),A.h==0&&(A.src=null,_[ot]=null)):Me(m)}}}function pr(m){return m in ir?ir[m]:ir[m]="on"+m}function Bo(m,_){if(m.da)m=!0;else{_=new Z(_,this);var A=m.listener,F=m.ha||m.src;m.fa&&mr(m),m=A.call(F,_)}return m}function xi(m){return m=m[ot],m instanceof ut?m:null}var Kn="__closure_events_fn_"+(1e9*Math.random()>>>0);function ea(m){return typeof m=="function"?m:(m[Kn]||(m[Kn]=function(_){return m.handleEvent(_)}),m[Kn])}function Ht(){U.call(this),this.i=new ut(this),this.M=this,this.F=null}w(Ht,U),Ht.prototype[Le]=!0,Ht.prototype.removeEventListener=function(m,_,A,F){ar(this,m,_,A,F)};function _t(m,_){var A,F=m.F;if(F)for(A=[];F;F=F.F)A.push(F);if(m=m.M,F=_.type||_,typeof _=="string")_=new W(_,m);else if(_ instanceof W)_.target=_.target||m;else{var re=_;_=new W(F,m),P(_,re)}if(re=!0,A)for(var pe=A.length-1;0<=pe;pe--){var De=_.g=A[pe];re=an(De,F,!0,_)&&re}if(De=_.g=m,re=an(De,F,!0,_)&&re,re=an(De,F,!1,_)&&re,A)for(pe=0;pe<A.length;pe++)De=_.g=A[pe],re=an(De,F,!1,_)&&re}Ht.prototype.N=function(){if(Ht.aa.N.call(this),this.i){var m=this.i,_;for(_ in m.g){for(var A=m.g[_],F=0;F<A.length;F++)Me(A[F]);delete m.g[_],m.h--}}this.F=null},Ht.prototype.K=function(m,_,A,F){return this.i.add(String(m),_,!1,A,F)},Ht.prototype.L=function(m,_,A,F){return this.i.add(String(m),_,!0,A,F)};function an(m,_,A,F){if(_=m.i.g[String(_)],!_)return!0;_=_.concat();for(var re=!0,pe=0;pe<_.length;++pe){var De=_[pe];if(De&&!De.da&&De.capture==A){var pt=De.listener,_n=De.ha||De.src;De.fa&&nt(m.i,De),re=pt.call(_n,F)!==!1&&re}}return re&&!F.defaultPrevented}function bn(m,_,A){if(typeof m=="function")A&&(m=x(m,A));else if(m&&typeof m.handleEvent=="function")m=x(m.handleEvent,m);else throw Error("Invalid listener argument");return 2147483647<Number(_)?-1:f.setTimeout(m,_||0)}function Vs(m){m.g=bn(()=>{m.g=null,m.i&&(m.i=!1,Vs(m))},m.l);const _=m.h;m.h=null,m.m.apply(null,_)}class Uo extends U{constructor(_,A){super(),this.m=_,this.l=A,this.h=null,this.i=!1,this.g=null}j(_){this.h=arguments,this.g?this.i=!0:Vs(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yi(m){U.call(this),this.h=m,this.g={}}w(yi,U);var _i=[];function Ei(m){Ae(m.g,function(_,A){this.g.hasOwnProperty(A)&&mr(_)},m),m.g={}}yi.prototype.N=function(){yi.aa.N.call(this),Ei(this)},yi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=f.JSON.stringify,ka=f.JSON.parse,ta=class{stringify(m){return f.JSON.stringify(m,void 0)}parse(m){return f.JSON.parse(m,void 0)}};function La(){}La.prototype.h=null;function Va(m){return m.h||(m.h=m.i())}function Ba(){}var ai={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function si(){W.call(this,"d")}w(si,W);function Ti(){W.call(this,"c")}w(Ti,W);var jr={},Bs=null;function wi(){return Bs=Bs||new Ht}jr.La="serverreachability";function Ua(m){W.call(this,jr.La,m)}w(Ua,W);function Ai(m){const _=wi();_t(_,new Ua(_))}jr.STAT_EVENT="statevent";function jo(m,_){W.call(this,jr.STAT_EVENT,m),this.stat=_}w(jo,W);function Gt(m){const _=wi();_t(_,new jo(_,m))}jr.Ma="timingevent";function sn(m,_){W.call(this,jr.Ma,m),this.size=_}w(sn,W);function Xt(m,_){if(typeof m!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){m()},_)}function vr(){this.g=!0}vr.prototype.xa=function(){this.g=!1};function Us(m,_,A,F,re,pe){m.info(function(){if(m.g)if(pe)for(var De="",pt=pe.split("&"),_n=0;_n<pt.length;_n++){var gt=pt[_n].split("=");if(1<gt.length){var Rn=gt[0];gt=gt[1];var En=Rn.split("_");De=2<=En.length&&En[1]=="type"?De+(Rn+"="+gt+"&"):De+(Rn+"=redacted&")}}else De=null;else De=pe;return"XMLHTTP REQ ("+F+") [attempt "+re+"]: "+_+`
`+A+`
`+De})}function ou(m,_,A,F,re,pe,De){m.info(function(){return"XMLHTTP RESP ("+F+") [ attempt "+re+"]: "+_+`
`+A+`
`+pe+" "+De})}function N(m,_,A,F){m.info(function(){return"XMLHTTP TEXT ("+_+"): "+M(m,A)+(F?" "+F:"")})}function z(m,_){m.info(function(){return"TIMEOUT: "+_})}vr.prototype.info=function(){};function M(m,_){if(!m.g)return _;if(!_)return null;try{var A=JSON.parse(_);if(A){for(m=0;m<A.length;m++)if(Array.isArray(A[m])){var F=A[m];if(!(2>F.length)){var re=F[1];if(Array.isArray(re)&&!(1>re.length)){var pe=re[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(var De=1;De<re.length;De++)re[De]=""}}}}return gr(A)}catch{return _}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},j={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},G;function ae(){}w(ae,La),ae.prototype.g=function(){return new XMLHttpRequest},ae.prototype.i=function(){return{}},G=new ae;function me(m,_,A,F){this.j=m,this.i=_,this.l=A,this.R=F||1,this.U=new yi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ne}function ne(){this.i=null,this.g="",this.h=!1}var oe={},le={};function be(m,_,A){m.L=1,m.v=Hs(Rr(_)),m.m=A,m.P=!0,Ne(m,null)}function Ne(m,_){m.F=Date.now(),Pe(m),m.A=Rr(m.v);var A=m.A,F=m.R;Array.isArray(F)||(F=[String(F)]),hu(A.i,"t",F),m.C=0,A=m.j.J,m.h=new ne,m.g=xf(m.j,A?_:null,!m.m),0<m.O&&(m.M=new Uo(x(m.Y,m,m.g),m.O)),_=m.U,A=m.g,F=m.ca;var re="readystatechange";Array.isArray(re)||(re&&(_i[0]=re.toString()),re=_i);for(var pe=0;pe<re.length;pe++){var De=Ut(A,re[pe],F||_.handleEvent,!1,_.h||_);if(!De)break;_.g[De.key]=De}_=m.H?I(m.H):{},m.m?(m.u||(m.u="POST"),_["Content-Type"]="application/x-www-form-urlencoded",m.g.ea(m.A,m.u,m.m,_)):(m.u="GET",m.g.ea(m.A,m.u,null,_)),Ai(),Us(m.i,m.u,m.A,m.l,m.R,m.m)}me.prototype.ca=function(m){m=m.target;const _=this.M;_&&qr(m)==3?_.j():this.Y(m)},me.prototype.Y=function(m){try{if(m==this.g)e:{const En=qr(this.g);var _=this.g.Ba();const la=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||cf(this.g)))){this.J||En!=4||_==7||(_==8||0>=la?Ai(3):Ai(2)),Et(this);var A=this.g.Z();this.X=A;t:if(Ue(this)){var F=cf(this.g);m="";var re=F.length,pe=qr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),dt(this);var De="";break t}this.h.i=new f.TextDecoder}for(_=0;_<re;_++)this.h.h=!0,m+=this.h.i.decode(F[_],{stream:!(pe&&_==re-1)});F.length=0,this.h.g+=m,this.C=0,De=this.h.g}else De=this.g.oa();if(this.o=A==200,ou(this.i,this.u,this.A,this.l,this.R,En,A),this.o){if(this.T&&!this.K){t:{if(this.g){var pt,_n=this.g;if((pt=_n.g?_n.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(pt)){var gt=pt;break t}}gt=null}if(A=gt)N(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Cr(this,A);else{this.o=!1,this.s=3,Gt(12),mt(this),dt(this);break e}}if(this.P){A=!0;let kn;for(;!this.J&&this.C<De.length;)if(kn=Re(this,De),kn==le){En==4&&(this.s=4,Gt(14),A=!1),N(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==oe){this.s=4,Gt(15),N(this.i,this.l,De,"[Invalid Chunk]"),A=!1;break}else N(this.i,this.l,kn,null),Cr(this,kn);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||De.length!=0||this.h.h||(this.s=1,Gt(16),A=!1),this.o=this.o&&A,!A)N(this.i,this.l,De,"[Invalid Chunked Response]"),mt(this),dt(this);else if(0<De.length&&!this.W){this.W=!0;var Rn=this.j;Rn.g==this&&Rn.ba&&!Rn.M&&(Rn.j.info("Great, no buffering proxy detected. Bytes received: "+De.length),Qs(Rn),Rn.M=!0,Gt(11))}}else N(this.i,this.l,De,null),Cr(this,De);En==4&&mt(this),this.o&&!this.J&&(En==4?pf(this.j,this):(this.o=!1,Pe(this)))}else ad(this.g),A==400&&0<De.indexOf("Unknown SID")?(this.s=3,Gt(12)):(this.s=0,Gt(13)),mt(this),dt(this)}}}catch{}finally{}};function Ue(m){return m.g?m.u=="GET"&&m.L!=2&&m.j.Ca:!1}function Re(m,_){var A=m.C,F=_.indexOf(`
`,A);return F==-1?le:(A=Number(_.substring(A,F)),isNaN(A)?oe:(F+=1,F+A>_.length?le:(_=_.slice(F,F+A),m.C=F+A,_)))}me.prototype.cancel=function(){this.J=!0,mt(this)};function Pe(m){m.S=Date.now()+m.I,Qe(m,m.I)}function Qe(m,_){if(m.B!=null)throw Error("WatchDog timer not null");m.B=Xt(x(m.ba,m),_)}function Et(m){m.B&&(f.clearTimeout(m.B),m.B=null)}me.prototype.ba=function(){this.B=null;const m=Date.now();0<=m-this.S?(z(this.i,this.A),this.L!=2&&(Ai(),Gt(17)),mt(this),this.s=2,dt(this)):Qe(this,this.S-m)};function dt(m){m.j.G==0||m.J||pf(m.j,m)}function mt(m){Et(m);var _=m.M;_&&typeof _.ma=="function"&&_.ma(),m.M=null,Ei(m.U),m.g&&(_=m.g,m.g=null,_.abort(),_.ma())}function Cr(m,_){try{var A=m.j;if(A.G!=0&&(A.g==m||or(A.h,m))){if(!m.K&&or(A.h,m)&&A.G==3){try{var F=A.Da.g.parse(_)}catch{F=null}if(Array.isArray(F)&&F.length==3){var re=F;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<m.F)Qo(A),Wo(A);else break e;vu(A),Gt(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=Xt(x(A.Za,A),6e3));if(1>=bi(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else oa(A,11)}else if((m.K||A.g==m)&&Qo(A),!q(_))for(re=A.Da.g.parse(_),_=0;_<re.length;_++){let gt=re[_];if(A.T=gt[0],gt=gt[1],A.G==2)if(gt[0]=="c"){A.K=gt[1],A.ia=gt[2];const Rn=gt[3];Rn!=null&&(A.la=Rn,A.j.info("VER="+A.la));const En=gt[4];En!=null&&(A.Aa=En,A.j.info("SVER="+A.Aa));const la=gt[5];la!=null&&typeof la=="number"&&0<la&&(F=1.5*la,A.L=F,A.j.info("backChannelRequestTimeoutMs_="+F)),F=A;const kn=m.g;if(kn){const Fi=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fi){var pe=F.h;pe.g||Fi.indexOf("spdy")==-1&&Fi.indexOf("quic")==-1&&Fi.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(zo(pe,pe.h),pe.h=null))}if(F.D){const yu=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;yu&&(F.ya=yu,Mt(F.I,F.D,yu))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-m.F,A.j.info("Handshake RTT: "+A.R+"ms")),F=A;var De=m;if(F.qa=vf(F,F.J?F.ia:null,F.W),De.K){lr(F.h,De);var pt=De,_n=F.L;_n&&(pt.I=_n),pt.B&&(Et(pt),Pe(pt)),F.g=De}else df(F);0<A.i.length&&Ko(A)}else gt[0]!="stop"&&gt[0]!="close"||oa(A,7);else A.G==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?oa(A,7):pu(A):gt[0]!="noop"&&A.l&&A.l.ta(gt),A.v=0)}}Ai(4)}catch{}}var Si=class{constructor(m,_){this.g=m,this.map=_}};function sr(m){this.l=m||10,f.PerformanceNavigationTiming?(m=f.performance.getEntriesByType("navigation"),m=0<m.length&&(m[0].nextHopProtocol=="hq"||m[0].nextHopProtocol=="h2")):m=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=m?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function xr(m){return m.h?!0:m.g?m.g.size>=m.j:!1}function bi(m){return m.h?1:m.g?m.g.size:0}function or(m,_){return m.h?m.h==_:m.g?m.g.has(_):!1}function zo(m,_){m.g?m.g.add(_):m.h=_}function lr(m,_){m.h&&m.h==_?m.h=null:m.g&&m.g.has(_)&&m.g.delete(_)}sr.prototype.cancel=function(){if(this.i=lu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const m of this.g.values())m.cancel();this.g.clear()}};function lu(m){if(m.h!=null)return m.i.concat(m.h.D);if(m.g!=null&&m.g.size!==0){let _=m.i;for(const A of m.g.values())_=_.concat(A.D);return _}return T(m.i)}function td(m){if(m.V&&typeof m.V=="function")return m.V();if(typeof Map<"u"&&m instanceof Map||typeof Set<"u"&&m instanceof Set)return Array.from(m.values());if(typeof m=="string")return m.split("");if(d(m)){for(var _=[],A=m.length,F=0;F<A;F++)_.push(m[F]);return _}_=[],A=0;for(F in m)_[A++]=m[F];return _}function Ho(m){if(m.na&&typeof m.na=="function")return m.na();if(!m.V||typeof m.V!="function"){if(typeof Map<"u"&&m instanceof Map)return Array.from(m.keys());if(!(typeof Set<"u"&&m instanceof Set)){if(d(m)||typeof m=="string"){var _=[];m=m.length;for(var A=0;A<m;A++)_.push(A);return _}_=[],A=0;for(const F in m)_[A++]=F;return _}}}function uu(m,_){if(m.forEach&&typeof m.forEach=="function")m.forEach(_,void 0);else if(d(m)||typeof m=="string")Array.prototype.forEach.call(m,_,void 0);else for(var A=Ho(m),F=td(m),re=F.length,pe=0;pe<re;pe++)_.call(void 0,F[pe],A&&A[pe],m)}var js=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function nd(m,_){if(m){m=m.split("&");for(var A=0;A<m.length;A++){var F=m[A].indexOf("="),re=null;if(0<=F){var pe=m[A].substring(0,F);re=m[A].substring(F+1)}else pe=m[A];_(pe,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function cn(m){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,m instanceof cn){this.h=m.h,zs(this,m.j),this.o=m.o,this.g=m.g,ja(this,m.s),this.l=m.l;var _=m.i,A=new ra;A.i=_.i,_.g&&(A.g=new Map(_.g),A.h=_.h),na(this,A),this.m=m.m}else m&&(_=String(m).match(js))?(this.h=!1,zs(this,_[1]||"",!0),this.o=zr(_[2]||""),this.g=zr(_[3]||"",!0),ja(this,_[4]),this.l=zr(_[5]||"",!0),na(this,_[6]||"",!0),this.m=zr(_[7]||"")):(this.h=!1,this.i=new ra(null,this.h))}cn.prototype.toString=function(){var m=[],_=this.j;_&&m.push(Gs(_,cu,!0),":");var A=this.g;return(A||_=="file")&&(m.push("//"),(_=this.o)&&m.push(Gs(_,cu,!0),"@"),m.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&m.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&m.push("/"),m.push(Gs(A,A.charAt(0)=="/"?rd:fu,!0))),(A=this.i.toString())&&m.push("?",A),(A=this.m)&&m.push("#",Gs(A,Go)),m.join("")};function Rr(m){return new cn(m)}function zs(m,_,A){m.j=A?zr(_,!0):_,m.j&&(m.j=m.j.replace(/:$/,""))}function ja(m,_){if(_){if(_=Number(_),isNaN(_)||0>_)throw Error("Bad port number "+_);m.s=_}else m.s=null}function na(m,_,A){_ instanceof ra?(m.i=_,lf(m.i,m.h)):(A||(_=Gs(_,id)),m.i=new ra(_,m.h))}function Mt(m,_,A){m.i.set(_,A)}function Hs(m){return Mt(m,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),m}function zr(m,_){return m?_?decodeURI(m.replace(/%25/g,"%2525")):decodeURIComponent(m):""}function Gs(m,_,A){return typeof m=="string"?(m=encodeURI(m).replace(_,of),A&&(m=m.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m):null}function of(m){return m=m.charCodeAt(0),"%"+(m>>4&15).toString(16)+(m&15).toString(16)}var cu=/[#\/\?@]/g,fu=/[#\?:]/g,rd=/[#\?]/g,id=/[#\?@]/g,Go=/#/g;function ra(m,_){this.h=this.g=null,this.i=m||null,this.j=!!_}function Hr(m){m.g||(m.g=new Map,m.h=0,m.i&&nd(m.i,function(_,A){m.add(decodeURIComponent(_.replace(/\+/g," ")),A)}))}t=ra.prototype,t.add=function(m,_){Hr(this),this.i=null,m=Ci(this,m);var A=this.g.get(m);return A||this.g.set(m,A=[]),A.push(_),this.h+=1,this};function ia(m,_){Hr(m),_=Ci(m,_),m.g.has(_)&&(m.i=null,m.h-=m.g.get(_).length,m.g.delete(_))}function aa(m,_){return Hr(m),_=Ci(m,_),m.g.has(_)}t.forEach=function(m,_){Hr(this),this.g.forEach(function(A,F){A.forEach(function(re){m.call(_,re,F,this)},this)},this)},t.na=function(){Hr(this);const m=Array.from(this.g.values()),_=Array.from(this.g.keys()),A=[];for(let F=0;F<_.length;F++){const re=m[F];for(let pe=0;pe<re.length;pe++)A.push(_[F])}return A},t.V=function(m){Hr(this);let _=[];if(typeof m=="string")aa(this,m)&&(_=_.concat(this.g.get(Ci(this,m))));else{m=Array.from(this.g.values());for(let A=0;A<m.length;A++)_=_.concat(m[A])}return _},t.set=function(m,_){return Hr(this),this.i=null,m=Ci(this,m),aa(this,m)&&(this.h-=this.g.get(m).length),this.g.set(m,[_]),this.h+=1,this},t.get=function(m,_){return m?(m=this.V(m),0<m.length?String(m[0]):_):_};function hu(m,_,A){ia(m,_),0<A.length&&(m.i=null,m.g.set(Ci(m,_),T(A)),m.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const m=[],_=Array.from(this.g.keys());for(var A=0;A<_.length;A++){var F=_[A];const pe=encodeURIComponent(String(F)),De=this.V(F);for(F=0;F<De.length;F++){var re=pe;De[F]!==""&&(re+="="+encodeURIComponent(String(De[F]))),m.push(re)}}return this.i=m.join("&")};function Ci(m,_){return _=String(_),m.j&&(_=_.toLowerCase()),_}function lf(m,_){_&&!m.j&&(Hr(m),m.i=null,m.g.forEach(function(A,F){var re=F.toLowerCase();F!=re&&(ia(this,F),hu(this,re,A))},m)),m.j=_}function qs(m,_){const A=new vr;if(f.Image){const F=new Image;F.onload=E(Gr,A,"TestLoadImage: loaded",!0,_,F),F.onerror=E(Gr,A,"TestLoadImage: error",!1,_,F),F.onabort=E(Gr,A,"TestLoadImage: abort",!1,_,F),F.ontimeout=E(Gr,A,"TestLoadImage: timeout",!1,_,F),f.setTimeout(function(){F.ontimeout&&F.ontimeout()},1e4),F.src=m}else _(!1)}function oi(m,_){const A=new vr,F=new AbortController,re=setTimeout(()=>{F.abort(),Gr(A,"TestPingServer: timeout",!1,_)},1e4);fetch(m,{signal:F.signal}).then(pe=>{clearTimeout(re),pe.ok?Gr(A,"TestPingServer: ok",!0,_):Gr(A,"TestPingServer: server error",!1,_)}).catch(()=>{clearTimeout(re),Gr(A,"TestPingServer: error",!1,_)})}function Gr(m,_,A,F,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),F(A)}catch{}}function $s(){this.g=new ta}function Ri(m,_,A){const F=A||"";try{uu(m,function(re,pe){let De=re;h(re)&&(De=gr(re)),_.push(F+pe+"="+encodeURIComponent(De))})}catch(re){throw _.push(F+"type="+encodeURIComponent("_badmap")),re}}function za(m){this.l=m.Ub||null,this.j=m.eb||!1}w(za,La),za.prototype.g=function(){return new sa(this.l,this.j)},za.prototype.i=function(m){return function(){return m}}({});function sa(m,_){Ht.call(this),this.D=m,this.o=_,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(sa,Ht),t=sa.prototype,t.open=function(m,_){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=m,this.A=_,this.readyState=1,Ii(this)},t.send=function(m){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const _={headers:this.u,method:this.B,credentials:this.m,cache:void 0};m&&(_.body=m),(this.D||f).fetch(new Request(this.A,_)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ni(this)),this.readyState=0},t.Sa=function(m){if(this.g&&(this.l=m,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=m.headers,this.readyState=2,Ii(this)),this.g&&(this.readyState=3,Ii(this),this.g)))if(this.responseType==="arraybuffer")m.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in m){if(this.j=m.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;du(this)}else m.text().then(this.Ra.bind(this),this.ga.bind(this))};function du(m){m.j.read().then(m.Pa.bind(m)).catch(m.ga.bind(m))}t.Pa=function(m){if(this.g){if(this.o&&m.value)this.response.push(m.value);else if(!this.o){var _=m.value?m.value:new Uint8Array(0);(_=this.v.decode(_,{stream:!m.done}))&&(this.response=this.responseText+=_)}m.done?Ni(this):Ii(this),this.readyState==3&&du(this)}},t.Ra=function(m){this.g&&(this.response=this.responseText=m,Ni(this))},t.Qa=function(m){this.g&&(this.response=m,Ni(this))},t.ga=function(){this.g&&Ni(this)};function Ni(m){m.readyState=4,m.l=null,m.j=null,m.v=null,Ii(m)}t.setRequestHeader=function(m,_){this.u.append(m,_)},t.getResponseHeader=function(m){return this.h&&this.h.get(m.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const m=[],_=this.h.entries();for(var A=_.next();!A.done;)A=A.value,m.push(A[0]+": "+A[1]),A=_.next();return m.join(`\r
`)};function Ii(m){m.onreadystatechange&&m.onreadystatechange.call(m)}Object.defineProperty(sa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(m){this.m=m?"include":"same-origin"}});function mu(m){let _="";return Ae(m,function(A,F){_+=F,_+=":",_+=A,_+=`\r
`}),_}function Cn(m,_,A){e:{for(F in A){var F=!1;break e}F=!0}F||(A=mu(A),typeof m=="string"?A!=null&&encodeURIComponent(String(A)):Mt(m,_,A))}function bt(m){Ht.call(this),this.headers=new Map,this.o=m||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(bt,Ht);var qo=/^https?$/i,Ys=["POST","PUT"];t=bt.prototype,t.Ha=function(m){this.J=m},t.ea=function(m,_,A,F){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+m);_=_?_.toUpperCase():"GET",this.D=m,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():G.g(),this.v=this.o?Va(this.o):Va(G),this.g.onreadystatechange=x(this.Ea,this);try{this.B=!0,this.g.open(_,String(m),!0),this.B=!1}catch(pe){uf(this,pe);return}if(m=A||"",A=new Map(this.headers),F)if(Object.getPrototypeOf(F)===Object.prototype)for(var re in F)A.set(re,F[re]);else if(typeof F.keys=="function"&&typeof F.get=="function")for(const pe of F.keys())A.set(pe,F.get(pe));else throw Error("Unknown input type for opt_headers: "+String(F));F=Array.from(A.keys()).find(pe=>pe.toLowerCase()=="content-type"),re=f.FormData&&m instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Ys,_,void 0))||F||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,De]of A)this.g.setRequestHeader(pe,De);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{Xs(this),this.u=!0,this.g.send(m),this.u=!1}catch(pe){uf(this,pe)}};function uf(m,_){m.h=!1,m.g&&(m.j=!0,m.g.abort(),m.j=!1),m.l=_,m.m=5,$o(m),Di(m)}function $o(m){m.A||(m.A=!0,_t(m,"complete"),_t(m,"error"))}t.abort=function(m){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=m||7,_t(this,"complete"),_t(this,"abort"),Di(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Di(this,!0)),bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Yo(this):this.bb())},t.bb=function(){Yo(this)};function Yo(m){if(m.h&&typeof u<"u"&&(!m.v[1]||qr(m)!=4||m.Z()!=2)){if(m.u&&qr(m)==4)bn(m.Ea,0,m);else if(_t(m,"readystatechange"),qr(m)==4){m.h=!1;try{const De=m.Z();e:switch(De){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var _=!0;break e;default:_=!1}var A;if(!(A=_)){var F;if(F=De===0){var re=String(m.D).match(js)[1]||null;!re&&f.self&&f.self.location&&(re=f.self.location.protocol.slice(0,-1)),F=!qo.test(re?re.toLowerCase():"")}A=F}if(A)_t(m,"complete"),_t(m,"success");else{m.m=6;try{var pe=2<qr(m)?m.g.statusText:""}catch{pe=""}m.l=pe+" ["+m.Z()+"]",$o(m)}}finally{Di(m)}}}}function Di(m,_){if(m.g){Xs(m);const A=m.g,F=m.v[0]?()=>{}:null;m.g=null,m.v=null,_||_t(m,"ready");try{A.onreadystatechange=F}catch{}}}function Xs(m){m.I&&(f.clearTimeout(m.I),m.I=null)}t.isActive=function(){return!!this.g};function qr(m){return m.g?m.g.readyState:0}t.Z=function(){try{return 2<qr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(m){if(this.g){var _=this.g.responseText;return m&&_.indexOf(m)==0&&(_=_.substring(m.length)),ka(_)}};function cf(m){try{if(!m.g)return null;if("response"in m.g)return m.g.response;switch(m.H){case"":case"text":return m.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in m.g)return m.g.mozResponseArrayBuffer}return null}catch{return null}}function ad(m){const _={};m=(m.g&&2<=qr(m)&&m.g.getAllResponseHeaders()||"").split(`\r
`);for(let F=0;F<m.length;F++){if(q(m[F]))continue;var A=B(m[F]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const pe=_[re]||[];_[re]=pe,pe.push(A)}D(_,function(F){return F.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ws(m,_,A){return A&&A.internalChannelParams&&A.internalChannelParams[m]||_}function Xo(m){this.Aa=0,this.i=[],this.j=new vr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ws("failFast",!1,m),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ws("baseRetryDelayMs",5e3,m),this.cb=Ws("retryDelaySeedMs",1e4,m),this.Wa=Ws("forwardChannelMaxRetries",2,m),this.wa=Ws("forwardChannelRequestTimeoutMs",2e4,m),this.pa=m&&m.xmlHttpFactory||void 0,this.Xa=m&&m.Tb||void 0,this.Ca=m&&m.useFetchStreams||!1,this.L=void 0,this.J=m&&m.supportsCrossDomainXhr||!1,this.K="",this.h=new sr(m&&m.concurrentRequestLimit),this.Da=new $s,this.P=m&&m.fastHandshake||!1,this.O=m&&m.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=m&&m.Rb||!1,m&&m.xa&&this.j.xa(),m&&m.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&m&&m.detectBufferingProxy||!1,this.ja=void 0,m&&m.longPollingTimeout&&0<m.longPollingTimeout&&(this.ja=m.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Xo.prototype,t.la=8,t.G=1,t.connect=function(m,_,A,F){Gt(0),this.W=m,this.H=_||{},A&&F!==void 0&&(this.H.OSID=A,this.H.OAID=F),this.F=this.X,this.I=vf(this,null,this.W),Ko(this)};function pu(m){if(ff(m),m.G==3){var _=m.U++,A=Rr(m.I);if(Mt(A,"SID",m.K),Mt(A,"RID",_),Mt(A,"TYPE","terminate"),Ks(m,A),_=new me(m,m.j,_),_.L=2,_.v=Hs(Rr(A)),A=!1,f.navigator&&f.navigator.sendBeacon)try{A=f.navigator.sendBeacon(_.v.toString(),"")}catch{}!A&&f.Image&&(new Image().src=_.v,A=!0),A||(_.g=xf(_.j,null),_.g.ea(_.v)),_.F=Date.now(),Pe(_)}gf(m)}function Wo(m){m.g&&(Qs(m),m.g.cancel(),m.g=null)}function ff(m){Wo(m),m.u&&(f.clearTimeout(m.u),m.u=null),Qo(m),m.h.cancel(),m.s&&(typeof m.s=="number"&&f.clearTimeout(m.s),m.s=null)}function Ko(m){if(!xr(m.h)&&!m.s){m.s=!0;var _=m.Ga;Ce||Q(),ze||(Ce(),ze=!0),Xe.add(_,m),m.B=0}}function sd(m,_){return bi(m.h)>=m.h.j-(m.s?1:0)?!1:m.s?(m.i=_.D.concat(m.i),!0):m.G==1||m.G==2||m.B>=(m.Va?0:m.Wa)?!1:(m.s=Xt(x(m.Ga,m,_),xu(m,m.B)),m.B++,!0)}t.Ga=function(m){if(this.s)if(this.s=null,this.G==1){if(!m){this.U=Math.floor(1e5*Math.random()),m=this.U++;const re=new me(this,this.j,m);let pe=this.o;if(this.S&&(pe?(pe=I(pe),P(pe,this.S)):pe=this.S),this.m!==null||this.O||(re.H=pe,pe=null),this.P)e:{for(var _=0,A=0;A<this.i.length;A++){t:{var F=this.i[A];if("__data__"in F.map&&(F=F.map.__data__,typeof F=="string")){F=F.length;break t}F=void 0}if(F===void 0)break;if(_+=F,4096<_){_=A;break e}if(_===4096||A===this.i.length-1){_=A+1;break e}}_=1e3}else _=1e3;_=hf(this,re,_),A=Rr(this.I),Mt(A,"RID",m),Mt(A,"CVER",22),this.D&&Mt(A,"X-HTTP-Session-Id",this.D),Ks(this,A),pe&&(this.O?_="headers="+encodeURIComponent(String(mu(pe)))+"&"+_:this.m&&Cn(A,this.m,pe)),zo(this.h,re),this.Ua&&Mt(A,"TYPE","init"),this.P?(Mt(A,"$req",_),Mt(A,"SID","null"),re.T=!0,be(re,A,null)):be(re,A,_),this.G=2}}else this.G==3&&(m?gu(this,m):this.i.length==0||xr(this.h)||gu(this))};function gu(m,_){var A;_?A=_.l:A=m.U++;const F=Rr(m.I);Mt(F,"SID",m.K),Mt(F,"RID",A),Mt(F,"AID",m.T),Ks(m,F),m.m&&m.o&&Cn(F,m.m,m.o),A=new me(m,m.j,A,m.B+1),m.m===null&&(A.H=m.o),_&&(m.i=_.D.concat(m.i)),_=hf(m,A,1e3),A.I=Math.round(.5*m.wa)+Math.round(.5*m.wa*Math.random()),zo(m.h,A),be(A,F,_)}function Ks(m,_){m.H&&Ae(m.H,function(A,F){Mt(_,F,A)}),m.l&&uu({},function(A,F){Mt(_,F,A)})}function hf(m,_,A){A=Math.min(m.i.length,A);var F=m.l?x(m.l.Na,m.l,m):null;e:{var re=m.i;let pe=-1;for(;;){const De=["count="+A];pe==-1?0<A?(pe=re[0].g,De.push("ofs="+pe)):pe=0:De.push("ofs="+pe);let pt=!0;for(let _n=0;_n<A;_n++){let gt=re[_n].g;const Rn=re[_n].map;if(gt-=pe,0>gt)pe=Math.max(0,re[_n].g-100),pt=!1;else try{Ri(Rn,De,"req"+gt+"_")}catch{F&&F(Rn)}}if(pt){F=De.join("&");break e}}}return m=m.i.splice(0,A),_.D=m,F}function df(m){if(!m.g&&!m.u){m.Y=1;var _=m.Fa;Ce||Q(),ze||(Ce(),ze=!0),Xe.add(_,m),m.v=0}}function vu(m){return m.g||m.u||3<=m.v?!1:(m.Y++,m.u=Xt(x(m.Fa,m),xu(m,m.v)),m.v++,!0)}t.Fa=function(){if(this.u=null,mf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var m=2*this.R;this.j.info("BP detection timer enabled: "+m),this.A=Xt(x(this.ab,this),m)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Gt(10),Wo(this),mf(this))};function Qs(m){m.A!=null&&(f.clearTimeout(m.A),m.A=null)}function mf(m){m.g=new me(m,m.j,"rpc",m.Y),m.m===null&&(m.g.H=m.o),m.g.O=0;var _=Rr(m.qa);Mt(_,"RID","rpc"),Mt(_,"SID",m.K),Mt(_,"AID",m.T),Mt(_,"CI",m.F?"0":"1"),!m.F&&m.ja&&Mt(_,"TO",m.ja),Mt(_,"TYPE","xmlhttp"),Ks(m,_),m.m&&m.o&&Cn(_,m.m,m.o),m.L&&(m.g.I=m.L);var A=m.g;m=m.ia,A.L=1,A.v=Hs(Rr(_)),A.m=null,A.P=!0,Ne(A,m)}t.Za=function(){this.C!=null&&(this.C=null,Wo(this),vu(this),Gt(19))};function Qo(m){m.C!=null&&(f.clearTimeout(m.C),m.C=null)}function pf(m,_){var A=null;if(m.g==_){Qo(m),Qs(m),m.g=null;var F=2}else if(or(m.h,_))A=_.D,lr(m.h,_),F=1;else return;if(m.G!=0){if(_.o)if(F==1){A=_.m?_.m.length:0,_=Date.now()-_.F;var re=m.B;F=wi(),_t(F,new sn(F,A)),Ko(m)}else df(m);else if(re=_.s,re==3||re==0&&0<_.X||!(F==1&&sd(m,_)||F==2&&vu(m)))switch(A&&0<A.length&&(_=m.h,_.i=_.i.concat(A)),re){case 1:oa(m,5);break;case 4:oa(m,10);break;case 3:oa(m,6);break;default:oa(m,2)}}}function xu(m,_){let A=m.Ta+Math.floor(Math.random()*m.cb);return m.isActive()||(A*=2),A*_}function oa(m,_){if(m.j.info("Error code "+_),_==2){var A=x(m.fb,m),F=m.Xa;const re=!F;F=new cn(F||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||zs(F,"https"),Hs(F),re?qs(F.toString(),A):oi(F.toString(),A)}else Gt(2);m.G=0,m.l&&m.l.sa(_),gf(m),ff(m)}t.fb=function(m){m?(this.j.info("Successfully pinged google.com"),Gt(2)):(this.j.info("Failed to ping google.com"),Gt(1))};function gf(m){if(m.G=0,m.ka=[],m.l){const _=lu(m.h);(_.length!=0||m.i.length!=0)&&(b(m.ka,_),b(m.ka,m.i),m.h.i.length=0,T(m.i),m.i.length=0),m.l.ra()}}function vf(m,_,A){var F=A instanceof cn?Rr(A):new cn(A);if(F.g!="")_&&(F.g=_+"."+F.g),ja(F,F.s);else{var re=f.location;F=re.protocol,_=_?_+"."+re.hostname:re.hostname,re=+re.port;var pe=new cn(null);F&&zs(pe,F),_&&(pe.g=_),re&&ja(pe,re),A&&(pe.l=A),F=pe}return A=m.D,_=m.ya,A&&_&&Mt(F,A,_),Mt(F,"VER",m.la),Ks(m,F),F}function xf(m,_,A){if(_&&!m.J)throw Error("Can't create secondary domain capable XhrIo object.");return _=m.Ca&&!m.pa?new bt(new za({eb:A})):new bt(m.pa),_.Ha(m.J),_}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function yf(){}t=yf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Zo(){}Zo.prototype.g=function(m,_){return new ur(m,_)};function ur(m,_){Ht.call(this),this.g=new Xo(_),this.l=m,this.h=_&&_.messageUrlParams||null,m=_&&_.messageHeaders||null,_&&_.clientProtocolHeaderRequired&&(m?m["X-Client-Protocol"]="webchannel":m={"X-Client-Protocol":"webchannel"}),this.g.o=m,m=_&&_.initMessageHeaders||null,_&&_.messageContentType&&(m?m["X-WebChannel-Content-Type"]=_.messageContentType:m={"X-WebChannel-Content-Type":_.messageContentType}),_&&_.va&&(m?m["X-WebChannel-Client-Profile"]=_.va:m={"X-WebChannel-Client-Profile":_.va}),this.g.S=m,(m=_&&_.Sb)&&!q(m)&&(this.g.m=m),this.v=_&&_.supportsCrossDomainXhr||!1,this.u=_&&_.sendRawJson||!1,(_=_&&_.httpSessionIdParam)&&!q(_)&&(this.g.D=_,m=this.h,m!==null&&_ in m&&(m=this.h,_ in m&&delete m[_])),this.j=new Oi(this)}w(ur,Ht),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){pu(this.g)},ur.prototype.o=function(m){var _=this.g;if(typeof m=="string"){var A={};A.__data__=m,m=A}else this.u&&(A={},A.__data__=gr(m),m=A);_.i.push(new Si(_.Ya++,m)),_.G==3&&Ko(_)},ur.prototype.N=function(){this.g.l=null,delete this.j,pu(this.g),delete this.g,ur.aa.N.call(this)};function _f(m){si.call(this),m.__headers__&&(this.headers=m.__headers__,this.statusCode=m.__status__,delete m.__headers__,delete m.__status__);var _=m.__sm__;if(_){e:{for(const A in _){m=A;break e}m=void 0}(this.i=m)&&(m=this.i,_=_!==null&&m in _?_[m]:void 0),this.data=_}else this.data=m}w(_f,si);function Ef(){Ti.call(this),this.status=1}w(Ef,Ti);function Oi(m){this.g=m}w(Oi,yf),Oi.prototype.ua=function(){_t(this.g,"a")},Oi.prototype.ta=function(m){_t(this.g,new _f(m))},Oi.prototype.sa=function(m){_t(this.g,new Ef)},Oi.prototype.ra=function(){_t(this.g,"b")},Zo.prototype.createWebChannel=Zo.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,$E=function(){return new Zo},qE=function(){return wi()},GE=jr,Mp={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,Vh=L,j.COMPLETE="complete",HE=j,Ba.EventType=ai,ai.OPEN="a",ai.CLOSE="b",ai.ERROR="c",ai.MESSAGE="d",Ht.prototype.listen=Ht.prototype.K,cc=Ba,bt.prototype.listenOnce=bt.prototype.L,bt.prototype.getLastError=bt.prototype.Ka,bt.prototype.getLastErrorCode=bt.prototype.Ba,bt.prototype.getStatus=bt.prototype.Z,bt.prototype.getResponseJson=bt.prototype.Oa,bt.prototype.getResponseText=bt.prototype.oa,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Ha,zE=bt}).apply(typeof wh<"u"?wh:typeof self<"u"?self:typeof window<"u"?window:{});const h_="@firebase/firestore",d_="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Jl="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Eo=new fg("@firebase/firestore");function Dl(){return Eo.logLevel}function je(t,...e){if(Eo.logLevel<=yt.DEBUG){const n=e.map(mg);Eo.debug(`Firestore (${Jl}): ${t}`,...n)}}function Ia(t,...e){if(Eo.logLevel<=yt.ERROR){const n=e.map(mg);Eo.error(`Firestore (${Jl}): ${t}`,...n)}}function Ts(t,...e){if(Eo.logLevel<=yt.WARN){const n=e.map(mg);Eo.warn(`Firestore (${Jl}): ${t}`,...n)}}function mg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,YE(t,r,n)}function YE(t,e,n){let r=`FIRESTORE (${Jl}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ia(r),new Error(r)}function Ct(t,e,n,r){let a="Unexpected state";typeof n=="string"?a=n:r=n,t||YE(e,a,r)}function tt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xe={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends ks{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wa{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XE{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class CR{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(er.UNAUTHENTICATED))}shutdown(){}}class RR{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class NR{constructor(e){this.t=e,this.currentUser=er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ct(this.o===void 0,42304);let r=this.i;const a=d=>this.i!==r?(r=this.i,n(d)):Promise.resolve();let o=new wa;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new wa,e.enqueueRetryable(()=>a(this.currentUser))};const u=()=>{const d=o;e.enqueueRetryable(async()=>{await d.promise,await a(this.currentUser)})},f=d=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=d,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(d=>f(d)),setTimeout(()=>{if(!this.auth){const d=this.t.getImmediate({optional:!0});d?f(d):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new wa)}},0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ct(typeof r.accessToken=="string",31837,{l:r}),new XE(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ct(e===null||typeof e=="string",2055,{h:e}),new er(e)}}class IR{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=er.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class DR{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new IR(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class m_{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OR{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,hR(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ct(this.o===void 0,3512);const r=o=>{o.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,je("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const a=o=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new m_(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ct(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new m_(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FR(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=FR(40);for(let o=0;o<a.length;++o)r.length<20&&a[o]<n&&(r+=e.charAt(a[o]%62))}return r}}function st(t,e){return t<e?-1:t>e?1:0}function Pp(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),a=e.codePointAt(n);if(r!==a){if(r<128&&a<128)return st(r,a);{const o=WE(),u=MR(o.encode(p_(t,n)),o.encode(p_(e,n)));return u!==0?u:st(r,a)}}n+=r>65535?2:1}return st(t.length,e.length)}function p_(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function MR(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return st(t[n],e[n]);return st(t.length,e.length)}function Gl(t,e,n){return t.length===e.length&&t.every((r,a)=>n(r,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const g_="__name__";class ji{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ke(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ke(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ji.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ji?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let a=0;a<r;a++){const o=ji.compareSegments(e.get(a),n.get(a));if(o!==0)return o}return st(e.length,n.length)}static compareSegments(e,n){const r=ji.isNumericId(e),a=ji.isNumericId(n);return r&&!a?-1:!r&&a?1:r&&a?ji.extractNumericId(e).compare(ji.extractNumericId(n)):Pp(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return gs.fromString(e.substring(4,e.length-2))}}class zt extends ji{construct(e,n,r){return new zt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ke(xe.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(a=>a.length>0))}return new zt(n)}static emptyPath(){return new zt([])}}const PR=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hn extends ji{construct(e,n,r){return new Hn(e,n,r)}static isValidIdentifier(e){return PR.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===g_}static keyField(){return new Hn([g_])}static fromServerFormat(e){const n=[];let r="",a=0;const o=()=>{if(r.length===0)throw new ke(xe.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new ke(xe.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const d=e[a+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new ke(xe.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=d,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(r+=f,a++):(o(),a++)}if(o(),u)throw new ke(xe.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hn(n)}static emptyPath(){return new Hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(zt.fromString(e))}static fromName(e){return new $e(zt.fromString(e).popFirst(5))}static empty(){return new $e(zt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&zt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return zt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new zt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KE(t,e,n){if(!n)throw new ke(xe.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function kR(t,e,n,r){if(e===!0&&r===!0)throw new ke(xe.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function v_(t){if(!$e.isDocumentKey(t))throw new ke(xe.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function x_(t){if($e.isDocumentKey(t))throw new ke(xe.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function QE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function R0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ke(12329,{type:typeof t})}function ws(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ke(xe.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=R0(t);throw new ke(xe.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(t,e){const n={typeString:t};return e&&(n.value=e),n}function Yc(t,e){if(!QE(t))throw new ke(xe.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const a=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const u=t[r];if(a&&typeof u!==a){n=`JSON field '${r}' must be a ${a}.`;break}if(o!==void 0&&u!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new ke(xe.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y_=-62135596800,__=1e6;class $t{static now(){return $t.fromMillis(Date.now())}static fromDate(e){return $t.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*__);return new $t(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ke(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ke(xe.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<y_)throw new ke(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(xe.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/__}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:$t._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(Yc(e,$t._jsonSchema))return new $t(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-y_;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}$t._jsonSchemaVersion="firestore/timestamp/1.0",$t._jsonSchema={type:gn("string",$t._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new $t(0,0))}static max(){return new et(new $t(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc=-1;function LR(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=et.fromTimestamp(r===1e9?new $t(n+1,0):new $t(n,r));return new As(a,$e.empty(),e)}function VR(t){return new As(t.readTime,t.key,Rc)}class As{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new As(et.min(),$e.empty(),Rc)}static max(){return new As(et.max(),$e.empty(),Rc)}}function BR(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=$e.comparator(t.documentKey,e.documentKey),n!==0?n:st(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UR="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jR{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function eu(t){if(t.code!==xe.FAILED_PRECONDITION||t.message!==UR)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we((r,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,a)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):we.reject(n)}static resolve(e){return new we((n,r)=>{n(e)})}static reject(e){return new we((n,r)=>{r(e)})}static waitFor(e){return new we((n,r)=>{let a=0,o=0,u=!1;e.forEach(f=>{++a,f.next(()=>{++o,u&&o===a&&n()},d=>r(d))}),u=!0,o===a&&n()})}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next(a=>a?we.resolve(a):r());return n}static forEach(e,n){const r=[];return e.forEach((a,o)=>{r.push(n.call(this,a,o))}),this.waitFor(r)}static mapArray(e,n){return new we((r,a)=>{const o=e.length,u=new Array(o);let f=0;for(let d=0;d<o;d++){const h=d;n(e[h]).next(g=>{u[h]=g,++f,f===o&&r(u)},g=>a(g))}})}static doWhile(e,n){return new we((r,a)=>{const o=()=>{e()===!0?n().next(()=>{o()},a):r()};o()})}}function zR(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function tu(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class N0{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}N0.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gg=-1;function I0(t){return t==null}function Xh(t){return t===0&&1/t==-1/0}function HR(t){return typeof t=="number"&&Number.isInteger(t)&&!Xh(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZE="";function GR(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=E_(e)),e=qR(t.get(n),e);return E_(e)}function qR(t,e){let n=e;const r=t.length;for(let a=0;a<r;a++){const o=t.charAt(a);switch(o){case"\0":n+="";break;case ZE:n+="";break;default:n+=o}}return n}function E_(t){return t+ZE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T_(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function No(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function JE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Jt{constructor(e,n){this.comparator=e,this.root=n||zn.EMPTY}insert(e,n){return new Jt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zn.BLACK,null,null))}remove(e){return new Jt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Ah(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Ah(this.root,e,this.comparator,!1)}getReverseIterator(){return new Ah(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Ah(this.root,e,this.comparator,!0)}}class Ah{constructor(e,n,r,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zn{constructor(e,n,r,a,o){this.key=e,this.value=n,this.color=r??zn.RED,this.left=a??zn.EMPTY,this.right=o??zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,a,o){return new zn(e??this.key,n??this.value,r??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let a=this;const o=r(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,n,r),null):o===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return zn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}zn.EMPTY=null,zn.RED=!0,zn.BLACK=!1;zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,n,r,a,o){return this}insert(e,n,r){return new zn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.comparator=e,this.data=new Jt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new w_(this.data.getIterator())}getIteratorFrom(e){return new w_(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Sn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Sn(this.comparator);return n.data=e,n}}class w_{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.fields=e,e.sort(Hn.comparator)}static empty(){return new mi([])}unionWith(e){let n=new Sn(Hn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new mi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Gl(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eT extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new eT("Invalid base64 string: "+o):o}}(e);return new Yn(n)}static fromUint8Array(e){const n=function(a){let o="";for(let u=0;u<a.length;++u)o+=String.fromCharCode(a[u]);return o}(e);return new Yn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Yn.EMPTY_BYTE_STRING=new Yn("");const $R=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Ss(t){if(Ct(!!t,39018),typeof t=="string"){let e=0;const n=$R.exec(t);if(Ct(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:un(t.seconds),nanos:un(t.nanos)}}function un(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function bs(t){return typeof t=="string"?Yn.fromBase64String(t):Yn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tT="server_timestamp",nT="__type__",rT="__previous_value__",iT="__local_write_time__";function D0(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[nT])===null||n===void 0?void 0:n.stringValue)===tT}function O0(t){const e=t.mapValue.fields[rT];return D0(e)?O0(e):e}function Nc(t){const e=Ss(t.mapValue.fields[iT].timestampValue);return new $t(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YR{constructor(e,n,r,a,o,u,f,d,h,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=d,this.useFetchStreams=h,this.isUsingEmulator=g}}const Wh="(default)";class Ic{constructor(e,n){this.projectId=e,this.database=n||Wh}static empty(){return new Ic("","")}get isDefaultDatabase(){return this.database===Wh}isEqual(e){return e instanceof Ic&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const aT="__type__",XR="__max__",Sh={mapValue:{}},sT="__vector__",Kh="value";function Cs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?D0(t)?4:KR(t)?9007199254740991:WR(t)?10:11:Ke(28295,{value:t})}function Ki(t,e){if(t===e)return!0;const n=Cs(t);if(n!==Cs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Nc(t).isEqual(Nc(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const u=Ss(a.timestampValue),f=Ss(o.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return bs(a.bytesValue).isEqual(bs(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return un(a.geoPointValue.latitude)===un(o.geoPointValue.latitude)&&un(a.geoPointValue.longitude)===un(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return un(a.integerValue)===un(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const u=un(a.doubleValue),f=un(o.doubleValue);return u===f?Xh(u)===Xh(f):isNaN(u)&&isNaN(f)}return!1}(t,e);case 9:return Gl(t.arrayValue.values||[],e.arrayValue.values||[],Ki);case 10:case 11:return function(a,o){const u=a.mapValue.fields||{},f=o.mapValue.fields||{};if(T_(u)!==T_(f))return!1;for(const d in u)if(u.hasOwnProperty(d)&&(f[d]===void 0||!Ki(u[d],f[d])))return!1;return!0}(t,e);default:return Ke(52216,{left:t})}}function Dc(t,e){return(t.values||[]).find(n=>Ki(n,e))!==void 0}function ql(t,e){if(t===e)return 0;const n=Cs(t),r=Cs(e);if(n!==r)return st(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(o,u){const f=un(o.integerValue||o.doubleValue),d=un(u.integerValue||u.doubleValue);return f<d?-1:f>d?1:f===d?0:isNaN(f)?isNaN(d)?0:-1:1}(t,e);case 3:return A_(t.timestampValue,e.timestampValue);case 4:return A_(Nc(t),Nc(e));case 5:return Pp(t.stringValue,e.stringValue);case 6:return function(o,u){const f=bs(o),d=bs(u);return f.compareTo(d)}(t.bytesValue,e.bytesValue);case 7:return function(o,u){const f=o.split("/"),d=u.split("/");for(let h=0;h<f.length&&h<d.length;h++){const g=st(f[h],d[h]);if(g!==0)return g}return st(f.length,d.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,u){const f=st(un(o.latitude),un(u.latitude));return f!==0?f:st(un(o.longitude),un(u.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return S_(t.arrayValue,e.arrayValue);case 10:return function(o,u){var f,d,h,g;const y=o.fields||{},x=u.fields||{},E=(f=y[Kh])===null||f===void 0?void 0:f.arrayValue,w=(d=x[Kh])===null||d===void 0?void 0:d.arrayValue,T=st(((h=E?.values)===null||h===void 0?void 0:h.length)||0,((g=w?.values)===null||g===void 0?void 0:g.length)||0);return T!==0?T:S_(E,w)}(t.mapValue,e.mapValue);case 11:return function(o,u){if(o===Sh.mapValue&&u===Sh.mapValue)return 0;if(o===Sh.mapValue)return 1;if(u===Sh.mapValue)return-1;const f=o.fields||{},d=Object.keys(f),h=u.fields||{},g=Object.keys(h);d.sort(),g.sort();for(let y=0;y<d.length&&y<g.length;++y){const x=Pp(d[y],g[y]);if(x!==0)return x;const E=ql(f[d[y]],h[g[y]]);if(E!==0)return E}return st(d.length,g.length)}(t.mapValue,e.mapValue);default:throw Ke(23264,{le:n})}}function A_(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return st(t,e);const n=Ss(t),r=Ss(e),a=st(n.seconds,r.seconds);return a!==0?a:st(n.nanos,r.nanos)}function S_(t,e){const n=t.values||[],r=e.values||[];for(let a=0;a<n.length&&a<r.length;++a){const o=ql(n[a],r[a]);if(o)return o}return st(n.length,r.length)}function $l(t){return kp(t)}function kp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Ss(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return bs(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return $e.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",a=!0;for(const o of n.values||[])a?a=!1:r+=",",r+=kp(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let a="{",o=!0;for(const u of r)o?o=!1:a+=",",a+=`${u}:${kp(n.fields[u])}`;return a+"}"}(t.mapValue):Ke(61005,{value:t})}function Bh(t){switch(Cs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=O0(t);return e?16+Bh(e):16;case 5:return 2*t.stringValue.length;case 6:return bs(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((a,o)=>a+Bh(o),0)}(t.arrayValue);case 10:case 11:return function(r){let a=0;return No(r.fields,(o,u)=>{a+=o.length+Bh(u)}),a}(t.mapValue);default:throw Ke(13486,{value:t})}}function Qh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Lp(t){return!!t&&"integerValue"in t}function vg(t){return!!t&&"arrayValue"in t}function b_(t){return!!t&&"nullValue"in t}function C_(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Uh(t){return!!t&&"mapValue"in t}function WR(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[aT])===null||n===void 0?void 0:n.stringValue)===sT}function gc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return No(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=gc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=gc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function KR(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===XR}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.value=e}static empty(){return new ti({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Uh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=gc(n)}setAll(e){let n=Hn.emptyPath(),r={},a=[];e.forEach((u,f)=>{if(!n.isImmediateParentOf(f)){const d=this.getFieldsMap(n);this.applyChanges(d,r,a),r={},a=[],n=f.popLast()}u?r[f.lastSegment()]=gc(u):a.push(f.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,a)}delete(e){const n=this.field(e.popLast());Uh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Ki(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=n.mapValue.fields[e.get(r)];Uh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,r){No(n,(a,o)=>e[a]=o);for(const a of r)delete e[a]}clone(){return new ti(gc(this.value))}}function oT(t){const e=[];return No(t.fields,(n,r)=>{const a=new Hn([n]);if(Uh(r)){const o=oT(r.mapValue).fields;if(o.length===0)e.push(a);else for(const u of o)e.push(a.child(u))}else e.push(a)}),new mi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,r,a,o,u,f){this.key=e,this.documentType=n,this.version=r,this.readTime=a,this.createTime=o,this.data=u,this.documentState=f}static newInvalidDocument(e){return new tr(e,0,et.min(),et.min(),et.min(),ti.empty(),0)}static newFoundDocument(e,n,r,a){return new tr(e,1,n,et.min(),r,a,0)}static newNoDocument(e,n){return new tr(e,2,n,et.min(),et.min(),ti.empty(),0)}static newUnknownDocument(e,n){return new tr(e,3,n,et.min(),et.min(),ti.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ti.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ti.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yl{constructor(e,n){this.position=e,this.inclusive=n}}function R_(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const o=e[a],u=t.position[a];if(o.field.isKeyField()?r=$e.comparator($e.fromName(u.referenceValue),n.key):r=ql(u,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function N_(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Ki(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oc{constructor(e,n="asc"){this.field=e,this.dir=n}}function QR(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lT{}class pn extends lT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new JR(e,n,r):n==="array-contains"?new nN(e,r):n==="in"?new rN(e,r):n==="not-in"?new iN(e,r):n==="array-contains-any"?new aN(e,r):new pn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new eN(e,r):new tN(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(ql(n,this.value)):n!==null&&Cs(this.value)===Cs(n)&&this.matchesComparison(ql(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vi extends lT{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new vi(e,n)}matches(e){return uT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function uT(t){return t.op==="and"}function cT(t){return ZR(t)&&uT(t)}function ZR(t){for(const e of t.filters)if(e instanceof vi)return!1;return!0}function Vp(t){if(t instanceof pn)return t.field.canonicalString()+t.op.toString()+$l(t.value);if(cT(t))return t.filters.map(e=>Vp(e)).join(",");{const e=t.filters.map(n=>Vp(n)).join(",");return`${t.op}(${e})`}}function fT(t,e){return t instanceof pn?function(r,a){return a instanceof pn&&r.op===a.op&&r.field.isEqual(a.field)&&Ki(r.value,a.value)}(t,e):t instanceof vi?function(r,a){return a instanceof vi&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce((o,u,f)=>o&&fT(u,a.filters[f]),!0):!1}(t,e):void Ke(19439)}function hT(t){return t instanceof pn?function(n){return`${n.field.canonicalString()} ${n.op} ${$l(n.value)}`}(t):t instanceof vi?function(n){return n.op.toString()+" {"+n.getFilters().map(hT).join(" ,")+"}"}(t):"Filter"}class JR extends pn{constructor(e,n,r){super(e,n,r),this.key=$e.fromName(r.referenceValue)}matches(e){const n=$e.comparator(e.key,this.key);return this.matchesComparison(n)}}class eN extends pn{constructor(e,n){super(e,"in",n),this.keys=dT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class tN extends pn{constructor(e,n){super(e,"not-in",n),this.keys=dT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function dT(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>$e.fromName(r.referenceValue))}class nN extends pn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return vg(n)&&Dc(n.arrayValue,this.value)}}class rN extends pn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Dc(this.value.arrayValue,n)}}class iN extends pn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Dc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Dc(this.value.arrayValue,n)}}class aN extends pn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!vg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Dc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(e,n=null,r=[],a=[],o=null,u=null,f=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=o,this.startAt=u,this.endAt=f,this.Pe=null}}function I_(t,e=null,n=[],r=[],a=null,o=null,u=null){return new sN(t,e,n,r,a,o,u)}function xg(t){const e=tt(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Vp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),I0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>$l(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>$l(r)).join(",")),e.Pe=n}return e.Pe}function yg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!QR(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!fT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!N_(t.startAt,e.startAt)&&N_(t.endAt,e.endAt)}function Bp(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Io{constructor(e,n=null,r=[],a=[],o=null,u="F",f=null,d=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=o,this.limitType=u,this.startAt=f,this.endAt=d,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function oN(t,e,n,r,a,o,u,f){return new Io(t,e,n,r,a,o,u,f)}function _g(t){return new Io(t)}function D_(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Eg(t){return t.collectionGroup!==null}function Ll(t){const e=tt(t);if(e.Te===null){e.Te=[];const n=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new Sn(Hn.comparator);return u.filters.forEach(d=>{d.getFlattenedFilters().forEach(h=>{h.isInequality()&&(f=f.add(h.field))})}),f})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Oc(o,r))}),n.has(Hn.keyField().canonicalString())||e.Te.push(new Oc(Hn.keyField(),r))}return e.Te}function Hi(t){const e=tt(t);return e.Ie||(e.Ie=lN(e,Ll(t))),e.Ie}function lN(t,e){if(t.limitType==="F")return I_(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Oc(a.field,o)});const n=t.endAt?new Yl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Yl(t.startAt.position,t.startAt.inclusive):null;return I_(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Up(t,e){const n=t.filters.concat([e]);return new Io(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Zh(t,e,n){return new Io(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function F0(t,e){return yg(Hi(t),Hi(e))&&t.limitType===e.limitType}function mT(t){return`${xg(Hi(t))}|lt:${t.limitType}`}function Ol(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(a=>hT(a)).join(", ")}]`),I0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(a=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(a)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(a=>$l(a)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(a=>$l(a)).join(",")),`Target(${r})`}(Hi(t))}; limitType=${t.limitType})`}function M0(t,e){return e.isFoundDocument()&&function(r,a){const o=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):$e.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,a){for(const o of Ll(r))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,a){for(const o of r.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(r,a){return!(r.startAt&&!function(u,f,d){const h=R_(u,f,d);return u.inclusive?h<=0:h<0}(r.startAt,Ll(r),a)||r.endAt&&!function(u,f,d){const h=R_(u,f,d);return u.inclusive?h>=0:h>0}(r.endAt,Ll(r),a))}(t,e)}function uN(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function pT(t){return(e,n)=>{let r=!1;for(const a of Ll(t)){const o=cN(a,e,n);if(o!==0)return o;r=r||a.field.isKeyField()}return 0}}function cN(t,e,n){const r=t.field.isKeyField()?$e.comparator(e.key,n.key):function(o,u,f){const d=u.data.field(o),h=f.data.field(o);return d!==null&&h!==null?ql(d,h):Ke(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ke(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Do{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[a,o]of r)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){No(this.inner,(n,r)=>{for(const[a,o]of r)e(a,o)})}isEmpty(){return JE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fN=new Jt($e.comparator);function Da(){return fN}const gT=new Jt($e.comparator);function fc(...t){let e=gT;for(const n of t)e=e.insert(n.key,n);return e}function vT(t){let e=gT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function go(){return vc()}function xT(){return vc()}function vc(){return new Do(t=>t.toString(),(t,e)=>t.isEqual(e))}const hN=new Jt($e.comparator),dN=new Sn($e.comparator);function ht(...t){let e=dN;for(const n of t)e=e.add(n);return e}const mN=new Sn(st);function pN(){return mN}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Tg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:Xh(e)?"-0":e}}function yT(t){return{integerValue:""+t}}function gN(t,e){return HR(e)?yT(e):Tg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class P0{constructor(){this._=void 0}}function vN(t,e,n){return t instanceof Jh?function(a,o){const u={fields:{[nT]:{stringValue:tT},[iT]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&D0(o)&&(o=O0(o)),o&&(u.fields[rT]=o),{mapValue:u}}(n,e):t instanceof Fc?ET(t,e):t instanceof Mc?TT(t,e):function(a,o){const u=_T(a,o),f=O_(u)+O_(a.Ee);return Lp(u)&&Lp(a.Ee)?yT(f):Tg(a.serializer,f)}(t,e)}function xN(t,e,n){return t instanceof Fc?ET(t,e):t instanceof Mc?TT(t,e):n}function _T(t,e){return t instanceof e0?function(r){return Lp(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Jh extends P0{}class Fc extends P0{constructor(e){super(),this.elements=e}}function ET(t,e){const n=wT(e);for(const r of t.elements)n.some(a=>Ki(a,r))||n.push(r);return{arrayValue:{values:n}}}class Mc extends P0{constructor(e){super(),this.elements=e}}function TT(t,e){let n=wT(e);for(const r of t.elements)n=n.filter(a=>!Ki(a,r));return{arrayValue:{values:n}}}class e0 extends P0{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function O_(t){return un(t.integerValue||t.doubleValue)}function wT(t){return vg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yN(t,e){return t.field.isEqual(e.field)&&function(r,a){return r instanceof Fc&&a instanceof Fc||r instanceof Mc&&a instanceof Mc?Gl(r.elements,a.elements,Ki):r instanceof e0&&a instanceof e0?Ki(r.Ee,a.Ee):r instanceof Jh&&a instanceof Jh}(t.transform,e.transform)}class _N{constructor(e,n){this.version=e,this.transformResults=n}}class Gi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Gi}static exists(e){return new Gi(void 0,e)}static updateTime(e){return new Gi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function jh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class k0{}function AT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new wg(t.key,Gi.none()):new Xc(t.key,t.data,Gi.none());{const n=t.data,r=ti.empty();let a=new Sn(Hn.comparator);for(let o of e.fields)if(!a.has(o)){let u=n.field(o);u===null&&o.length>1&&(o=o.popLast(),u=n.field(o)),u===null?r.delete(o):r.set(o,u),a=a.add(o)}return new Oo(t.key,r,new mi(a.toArray()),Gi.none())}}function EN(t,e,n){t instanceof Xc?function(a,o,u){const f=a.value.clone(),d=M_(a.fieldTransforms,o,u.transformResults);f.setAll(d),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(t,e,n):t instanceof Oo?function(a,o,u){if(!jh(a.precondition,o))return void o.convertToUnknownDocument(u.version);const f=M_(a.fieldTransforms,o,u.transformResults),d=o.data;d.setAll(ST(a)),d.setAll(f),o.convertToFoundDocument(u.version,d).setHasCommittedMutations()}(t,e,n):function(a,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,n)}function xc(t,e,n,r){return t instanceof Xc?function(o,u,f,d){if(!jh(o.precondition,u))return f;const h=o.value.clone(),g=P_(o.fieldTransforms,d,u);return h.setAll(g),u.convertToFoundDocument(u.version,h).setHasLocalMutations(),null}(t,e,n,r):t instanceof Oo?function(o,u,f,d){if(!jh(o.precondition,u))return f;const h=P_(o.fieldTransforms,d,u),g=u.data;return g.setAll(ST(o)),g.setAll(h),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),f===null?null:f.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(o,u,f){return jh(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f}(t,e,n)}function TN(t,e){let n=null;for(const r of t.fieldTransforms){const a=e.data.field(r.field),o=_T(r.transform,a||null);o!=null&&(n===null&&(n=ti.empty()),n.set(r.field,o))}return n||null}function F_(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Gl(r,a,(o,u)=>yN(o,u))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xc extends k0{constructor(e,n,r,a=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Oo extends k0{constructor(e,n,r,a,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function ST(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function M_(t,e,n){const r=new Map;Ct(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let a=0;a<n.length;a++){const o=t[a],u=o.transform,f=e.data.field(o.field);r.set(o.field,xN(u,f,n[a]))}return r}function P_(t,e,n){const r=new Map;for(const a of t){const o=a.transform,u=n.data.field(a.field);r.set(a.field,vN(o,u,e))}return r}class wg extends k0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wN extends k0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AN{constructor(e,n,r,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&EN(o,e,r[a])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=xc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=xc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=xT();return this.mutations.forEach(a=>{const o=e.get(a.key),u=o.overlayedDocument;let f=this.applyToLocalView(u,o.mutatedFields);f=n.has(a.key)?null:f;const d=AT(u,f);d!==null&&r.set(a.key,d),u.isValidDocument()||u.convertToNoDocument(et.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ht())}isEqual(e){return this.batchId===e.batchId&&Gl(this.mutations,e.mutations,(n,r)=>F_(n,r))&&Gl(this.baseMutations,e.baseMutations,(n,r)=>F_(n,r))}}class Ag{constructor(e,n,r,a){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(e,n,r){Ct(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let a=function(){return hN}();const o=e.mutations;for(let u=0;u<o.length;u++)a=a.insert(o[u].key,r[u].version);return new Ag(e,n,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bN{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,xt;function CN(t){switch(t){case xe.OK:return Ke(64938);case xe.CANCELLED:case xe.UNKNOWN:case xe.DEADLINE_EXCEEDED:case xe.RESOURCE_EXHAUSTED:case xe.INTERNAL:case xe.UNAVAILABLE:case xe.UNAUTHENTICATED:return!1;case xe.INVALID_ARGUMENT:case xe.NOT_FOUND:case xe.ALREADY_EXISTS:case xe.PERMISSION_DENIED:case xe.FAILED_PRECONDITION:case xe.ABORTED:case xe.OUT_OF_RANGE:case xe.UNIMPLEMENTED:case xe.DATA_LOSS:return!0;default:return Ke(15467,{code:t})}}function bT(t){if(t===void 0)return Ia("GRPC error has no .code"),xe.UNKNOWN;switch(t){case mn.OK:return xe.OK;case mn.CANCELLED:return xe.CANCELLED;case mn.UNKNOWN:return xe.UNKNOWN;case mn.DEADLINE_EXCEEDED:return xe.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return xe.RESOURCE_EXHAUSTED;case mn.INTERNAL:return xe.INTERNAL;case mn.UNAVAILABLE:return xe.UNAVAILABLE;case mn.UNAUTHENTICATED:return xe.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return xe.INVALID_ARGUMENT;case mn.NOT_FOUND:return xe.NOT_FOUND;case mn.ALREADY_EXISTS:return xe.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return xe.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return xe.FAILED_PRECONDITION;case mn.ABORTED:return xe.ABORTED;case mn.OUT_OF_RANGE:return xe.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return xe.UNIMPLEMENTED;case mn.DATA_LOSS:return xe.DATA_LOSS;default:return Ke(39323,{code:t})}}(xt=mn||(mn={}))[xt.OK=0]="OK",xt[xt.CANCELLED=1]="CANCELLED",xt[xt.UNKNOWN=2]="UNKNOWN",xt[xt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",xt[xt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",xt[xt.NOT_FOUND=5]="NOT_FOUND",xt[xt.ALREADY_EXISTS=6]="ALREADY_EXISTS",xt[xt.PERMISSION_DENIED=7]="PERMISSION_DENIED",xt[xt.UNAUTHENTICATED=16]="UNAUTHENTICATED",xt[xt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",xt[xt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",xt[xt.ABORTED=10]="ABORTED",xt[xt.OUT_OF_RANGE=11]="OUT_OF_RANGE",xt[xt.UNIMPLEMENTED=12]="UNIMPLEMENTED",xt[xt.INTERNAL=13]="INTERNAL",xt[xt.UNAVAILABLE=14]="UNAVAILABLE",xt[xt.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RN=new gs([4294967295,4294967295],0);function k_(t){const e=WE().encode(t),n=new jE;return n.update(e),new Uint8Array(n.digest())}function L_(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new gs([n,r],0),new gs([a,o],0)]}class Sg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new hc(`Invalid padding: ${n}`);if(r<0)throw new hc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new hc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new hc(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=gs.fromNumber(this.fe)}pe(e,n,r){let a=e.add(n.multiply(gs.fromNumber(r)));return a.compare(RN)===1&&(a=new gs([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=k_(e),[r,a]=L_(n);for(let o=0;o<this.hashCount;o++){const u=this.pe(r,a,o);if(!this.ye(u))return!1}return!0}static create(e,n,r){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new Sg(o,a,n);return r.forEach(f=>u.insert(f)),u}insert(e){if(this.fe===0)return;const n=k_(e),[r,a]=L_(n);for(let o=0;o<this.hashCount;o++){const u=this.pe(r,a,o);this.we(u)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class hc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L0{constructor(e,n,r,a,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const a=new Map;return a.set(e,Wc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new L0(et.min(),a,new Jt(st),Da(),ht())}}class Wc{constructor(e,n,r,a,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Wc(r,n,ht(),ht(),ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class zh{constructor(e,n,r,a){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=a}}class CT{constructor(e,n){this.targetId=e,this.De=n}}class RT{constructor(e,n,r=Yn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=a}}class V_{constructor(){this.ve=0,this.Ce=B_(),this.Fe=Yn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ht(),n=ht(),r=ht();return this.Ce.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:Ke(38017,{changeType:o})}}),new Wc(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=B_()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Ct(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class NN{constructor(e){this.We=e,this.Ge=new Map,this.ze=Da(),this.je=bh(),this.Je=bh(),this.He=new Jt(st)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:Ke(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,a)=>{this.nt(a)&&n(a)})}it(e){const n=e.targetId,r=e.De.count,a=this.st(n);if(a){const o=a.target;if(Bp(o))if(r===0){const u=new $e(o.path);this.Xe(n,u,tr.newNoDocument(u,et.min()))}else Ct(r===1,20013,{expectedCount:r});else{const u=this.ot(n);if(u!==r){const f=this._t(e),d=f?this.ut(f,e,u):1;if(d!==0){this.rt(n);const h=d===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,h)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:o=0}=n;let u,f;try{u=bs(r).toUint8Array()}catch(d){if(d instanceof eT)return Ts("Decoding the base64 bloom filter in existence filter failed ("+d.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw d}try{f=new Sg(u,a,o)}catch(d){return Ts(d instanceof hc?"BloomFilter error: ":"Applying bloom filter failed: ",d),null}return f.fe===0?null:f}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let a=0;return r.forEach(o=>{const u=this.We.lt(),f=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(f)||(this.Xe(n,o,null),a++)}),a}Pt(e){const n=new Map;this.Ge.forEach((o,u)=>{const f=this.st(u);if(f){if(o.current&&Bp(f.target)){const d=new $e(f.target.path);this.Tt(d).has(u)||this.It(u,d)||this.Xe(u,d,tr.newNoDocument(d,e))}o.Ne&&(n.set(u,o.Le()),o.ke())}});let r=ht();this.Je.forEach((o,u)=>{let f=!0;u.forEachWhile(d=>{const h=this.st(d);return!h||h.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(r=r.add(o))}),this.ze.forEach((o,u)=>u.setReadTime(e));const a=new L0(e,n,this.He,this.ze,r);return this.ze=Da(),this.je=bh(),this.Je=bh(),this.He=new Jt(st),a}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const a=this.tt(e);this.It(e,n)?a.qe(n,1):a.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new V_,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new Sn(st),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new Sn(st),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||je("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new V_),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function bh(){return new Jt($e.comparator)}function B_(){return new Jt($e.comparator)}const IN={asc:"ASCENDING",desc:"DESCENDING"},DN={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},ON={and:"AND",or:"OR"};class FN{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function jp(t,e){return t.useProto3Json||I0(e)?e:{value:e}}function t0(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function NT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MN(t,e){return t0(t,e.toTimestamp())}function qi(t){return Ct(!!t,49232),et.fromTimestamp(function(n){const r=Ss(n);return new $t(r.seconds,r.nanos)}(t))}function bg(t,e){return zp(t,e).canonicalString()}function zp(t,e){const n=function(a){return new zt(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?n:n.child(e)}function IT(t){const e=zt.fromString(t);return Ct(PT(e),10190,{key:e.toString()}),e}function Hp(t,e){return bg(t.databaseId,e.path)}function up(t,e){const n=IT(e);if(n.get(1)!==t.databaseId.projectId)throw new ke(xe.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ke(xe.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $e(OT(n))}function DT(t,e){return bg(t.databaseId,e)}function PN(t){const e=IT(t);return e.length===4?zt.emptyPath():OT(e)}function Gp(t){return new zt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function OT(t){return Ct(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function U_(t,e,n){return{name:Hp(t,e),fields:n.value.mapValue.fields}}function kN(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(h){return h==="NO_CHANGE"?0:h==="ADD"?1:h==="REMOVE"?2:h==="CURRENT"?3:h==="RESET"?4:Ke(39313,{state:h})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(h,g){return h.useProto3Json?(Ct(g===void 0||typeof g=="string",58123),Yn.fromBase64String(g||"")):(Ct(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Yn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&function(h){const g=h.code===void 0?xe.UNKNOWN:bT(h.code);return new ke(g,h.message||"")}(u);n=new RT(r,a,o,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=up(t,r.document.name),o=qi(r.document.updateTime),u=r.document.createTime?qi(r.document.createTime):et.min(),f=new ti({mapValue:{fields:r.document.fields}}),d=tr.newFoundDocument(a,o,u,f),h=r.targetIds||[],g=r.removedTargetIds||[];n=new zh(h,g,d.key,d)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=up(t,r.document),o=r.readTime?qi(r.readTime):et.min(),u=tr.newNoDocument(a,o),f=r.removedTargetIds||[];n=new zh([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=up(t,r.document),o=r.removedTargetIds||[];n=new zh([],o,a,null)}else{if(!("filter"in e))return Ke(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:o}=r,u=new bN(a,o),f=r.targetId;n=new CT(f,u)}}return n}function LN(t,e){let n;if(e instanceof Xc)n={update:U_(t,e.key,e.value)};else if(e instanceof wg)n={delete:Hp(t,e.key)};else if(e instanceof Oo)n={update:U_(t,e.key,e.data),updateMask:$N(e.fieldMask)};else{if(!(e instanceof wN))return Ke(16599,{Rt:e.type});n={verify:Hp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,u){const f=u.transform;if(f instanceof Jh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Fc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Mc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof e0)return{fieldPath:u.field.canonicalString(),increment:f.Ee};throw Ke(20930,{transform:u.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:MN(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ke(27497)}(t,e.precondition)),n}function VN(t,e){return t&&t.length>0?(Ct(e!==void 0,14353),t.map(n=>function(a,o){let u=a.updateTime?qi(a.updateTime):qi(o);return u.isEqual(et.min())&&(u=qi(o)),new _N(u,a.transformResults||[])}(n,e))):[]}function BN(t,e){return{documents:[DT(t,e.path)]}}function UN(t,e){const n={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=DT(t,a);const o=function(h){if(h.length!==0)return MT(vi.create(h,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const u=function(h){if(h.length!==0)return h.map(g=>function(x){return{field:Fl(x.field),direction:HN(x.dir)}}(g))}(e.orderBy);u&&(n.structuredQuery.orderBy=u);const f=jp(t,e.limit);return f!==null&&(n.structuredQuery.limit=f),e.startAt&&(n.structuredQuery.startAt=function(h){return{before:h.inclusive,values:h.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(h){return{before:!h.inclusive,values:h.position}}(e.endAt)),{Vt:n,parent:a}}function jN(t){let e=PN(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){Ct(r===1,65062);const g=n.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let o=[];n.where&&(o=function(y){const x=FT(y);return x instanceof vi&&cT(x)?x.getFilters():[x]}(n.where));let u=[];n.orderBy&&(u=function(y){return y.map(x=>function(w){return new Oc(Ml(w.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(x))}(n.orderBy));let f=null;n.limit&&(f=function(y){let x;return x=typeof y=="object"?y.value:y,I0(x)?null:x}(n.limit));let d=null;n.startAt&&(d=function(y){const x=!!y.before,E=y.values||[];return new Yl(E,x)}(n.startAt));let h=null;return n.endAt&&(h=function(y){const x=!y.before,E=y.values||[];return new Yl(E,x)}(n.endAt)),oN(e,a,u,o,f,"F",d,h)}function zN(t,e){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:a})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function FT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Ml(n.unaryFilter.field);return pn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Ml(n.unaryFilter.field);return pn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Ml(n.unaryFilter.field);return pn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Ml(n.unaryFilter.field);return pn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}}(t):t.fieldFilter!==void 0?function(n){return pn.create(Ml(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return vi.create(n.compositeFilter.filters.map(r=>FT(r)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}}(n.compositeFilter.op))}(t):Ke(30097,{filter:t})}function HN(t){return IN[t]}function GN(t){return DN[t]}function qN(t){return ON[t]}function Fl(t){return{fieldPath:t.canonicalString()}}function Ml(t){return Hn.fromServerFormat(t.fieldPath)}function MT(t){return t instanceof pn?function(n){if(n.op==="=="){if(C_(n.value))return{unaryFilter:{field:Fl(n.field),op:"IS_NAN"}};if(b_(n.value))return{unaryFilter:{field:Fl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(C_(n.value))return{unaryFilter:{field:Fl(n.field),op:"IS_NOT_NAN"}};if(b_(n.value))return{unaryFilter:{field:Fl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Fl(n.field),op:GN(n.op),value:n.value}}}(t):t instanceof vi?function(n){const r=n.getFilters().map(a=>MT(a));return r.length===1?r[0]:{compositeFilter:{op:qN(n.op),filters:r}}}(t):Ke(54877,{filter:t})}function $N(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function PT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fs{constructor(e,n,r,a,o=et.min(),u=et.min(),f=Yn.EMPTY_BYTE_STRING,d=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=d}withSequenceNumber(e){return new fs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new fs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YN{constructor(e){this.gt=e}}function XN(t){const e=jN({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Zh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WN{constructor(){this.Dn=new KN}addToCollectionParentIndex(e,n){return this.Dn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(As.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(As.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class KN{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n]||new Sn(zt.comparator),o=!a.has(r);return this.index[n]=a.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(e){return(this.index[e]||new Sn(zt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j_={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},kT=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(kT,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xl{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Xl(0)}static ur(){return new Xl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const z_="LruGarbageCollector",QN=1048576;function H_([t,e],[n,r]){const a=st(t,n);return a===0?st(e,r):a}class ZN{constructor(e){this.Tr=e,this.buffer=new Sn(H_),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();H_(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class JN{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){je(z_,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){tu(n)?je(z_,"Ignoring IndexedDB error during garbage collection: ",n):await eu(n)}await this.Rr(3e5)})}}class eI{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return we.resolve(N0.ue);const r=new ZN(n);return this.Vr.forEachTarget(e,a=>r.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>r.Er(a))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(j_)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),j_):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,a,o,u,f,d,h;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),a=this.params.maximumSequenceNumbersToCollect):a=y,u=Date.now(),this.nthSequenceNumber(e,a))).next(y=>(r=y,f=Date.now(),this.removeTargets(e,r,n))).next(y=>(o=y,d=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(h=Date.now(),Dl()<=yt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-g}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${o} targets in `+(d-f)+`ms
	Removed ${y} documents in `+(h-d)+`ms
Total Duration: ${h-g}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:y})))}}function tI(t,e){return new eI(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nI{constructor(){this.changes=new Do(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rI{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iI{constructor(e,n,r,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(r!==null&&xc(r.mutation,a,mi.empty(),$t.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ht()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ht()){const a=go();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,r).next(o=>{let u=fc();return o.forEach((f,d)=>{u=u.insert(f,d.overlayedDocument)}),u}))}getOverlayedDocuments(e,n){const r=go();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ht()))}populateOverlays(e,n,r){const a=[];return r.forEach(o=>{n.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((u,f)=>{n.set(u,f)})})}computeViews(e,n,r,a){let o=Da();const u=vc(),f=function(){return vc()}();return n.forEach((d,h)=>{const g=r.get(h.key);a.has(h.key)&&(g===void 0||g.mutation instanceof Oo)?o=o.insert(h.key,h):g!==void 0?(u.set(h.key,g.mutation.getFieldMask()),xc(g.mutation,h,g.mutation.getFieldMask(),$t.now())):u.set(h.key,mi.empty())}),this.recalculateAndSaveOverlays(e,o).next(d=>(d.forEach((h,g)=>u.set(h,g)),n.forEach((h,g)=>{var y;return f.set(h,new rI(g,(y=u.get(h))!==null&&y!==void 0?y:null))}),f))}recalculateAndSaveOverlays(e,n){const r=vc();let a=new Jt((u,f)=>u-f),o=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(u=>{for(const f of u)f.keys().forEach(d=>{const h=n.get(d);if(h===null)return;let g=r.get(d)||mi.empty();g=f.applyToLocalView(h,g),r.set(d,g);const y=(a.get(f.batchId)||ht()).add(d);a=a.insert(f.batchId,y)})}).next(()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const d=f.getNext(),h=d.key,g=d.value,y=xT();g.forEach(x=>{if(!o.has(x)){const E=AT(n.get(x),r.get(x));E!==null&&y.set(x,E),o=o.add(x)}}),u.push(this.documentOverlayCache.saveOverlays(e,h,y))}return we.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,a){return function(u){return $e.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Eg(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,a):this.getDocumentsMatchingCollectionQuery(e,n,r,a)}getNextDocuments(e,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,a).next(o=>{const u=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,a-o.size):we.resolve(go());let f=Rc,d=o;return u.next(h=>we.forEach(h,(g,y)=>(f<y.largestBatchId&&(f=y.largestBatchId),o.get(g)?we.resolve():this.remoteDocumentCache.getEntry(e,g).next(x=>{d=d.insert(g,x)}))).next(()=>this.populateOverlays(e,h,o)).next(()=>this.computeViews(e,d,h,ht())).next(g=>({batchId:f,changes:vT(g)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new $e(n)).next(r=>{let a=fc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,r,a){const o=n.collectionGroup;let u=fc();return this.indexManager.getCollectionParents(e,o).next(f=>we.forEach(f,d=>{const h=function(y,x){return new Io(x,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,d.child(o));return this.getDocumentsMatchingCollectionQuery(e,h,r,a).next(g=>{g.forEach((y,x)=>{u=u.insert(y,x)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,n,r,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,a))).next(u=>{o.forEach((d,h)=>{const g=h.getKey();u.get(g)===null&&(u=u.insert(g,tr.newInvalidDocument(g)))});let f=fc();return u.forEach((d,h)=>{const g=o.get(d);g!==void 0&&xc(g.mutation,h,mi.empty(),$t.now()),M0(n,h)&&(f=f.insert(d,h))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aI{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return we.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(a){return{id:a.id,version:a.version,createTime:qi(a.createTime)}}(n)),we.resolve()}getNamedQuery(e,n){return we.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(a){return{name:a.name,query:XN(a.bundledQuery),readTime:qi(a.readTime)}}(n)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(){this.overlays=new Jt($e.comparator),this.kr=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=go();return we.forEach(n,a=>this.getOverlay(e,a).next(o=>{o!==null&&r.set(a,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((a,o)=>{this.wt(e,n,o)}),we.resolve()}removeOverlaysForBatchId(e,n,r){const a=this.kr.get(r);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const a=go(),o=n.length+1,u=new $e(n.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const d=f.getNext().value,h=d.getKey();if(!n.isPrefixOf(h.path))break;h.path.length===o&&d.largestBatchId>r&&a.set(d.getKey(),d)}return we.resolve(a)}getOverlaysForCollectionGroup(e,n,r,a){let o=new Jt((h,g)=>h-g);const u=this.overlays.getIterator();for(;u.hasNext();){const h=u.getNext().value;if(h.getKey().getCollectionGroup()===n&&h.largestBatchId>r){let g=o.get(h.largestBatchId);g===null&&(g=go(),o=o.insert(h.largestBatchId,g)),g.set(h.getKey(),h)}}const f=go(),d=o.getIterator();for(;d.hasNext()&&(d.getNext().value.forEach((h,g)=>f.set(h,g)),!(f.size()>=a)););return we.resolve(f)}wt(e,n,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.kr.get(a.largestBatchId).delete(r.key);this.kr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new SN(n,r));let o=this.kr.get(n);o===void 0&&(o=ht(),this.kr.set(n,o)),this.kr.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oI{constructor(){this.sessionToken=Yn.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Cg{constructor(){this.qr=new Sn(On.Qr),this.$r=new Sn(On.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new On(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new On(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new $e(new zt([])),r=new On(n,e),a=new On(n,e+1),o=[];return this.$r.forEachInRange([r,a],u=>{this.Wr(u),o.push(u.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new $e(new zt([])),r=new On(n,e),a=new On(n,e+1);let o=ht();return this.$r.forEachInRange([r,a],u=>{o=o.add(u.key)}),o}containsKey(e){const n=new On(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class On{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return $e.comparator(e.key,n.key)||st(e.Hr,n.Hr)}static Ur(e,n){return st(e.Hr,n.Hr)||$e.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lI{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Sn(On.Qr)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,a){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new AN(o,n,r,a);this.mutationQueue.push(u);for(const f of a)this.Yr=this.Yr.add(new On(f.key,o)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return we.resolve(u)}lookupMutationBatch(e,n){return we.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,a=this.Xr(r),o=a<0?0:a;return we.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?gg:this.er-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new On(n,0),a=new On(n,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,a],u=>{const f=this.Zr(u.Hr);o.push(f)}),we.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Sn(st);return n.forEach(a=>{const o=new On(a,0),u=new On(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,u],f=>{r=r.add(f.Hr)})}),we.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,a=r.length+1;let o=r;$e.isDocumentKey(o)||(o=o.child(""));const u=new On(new $e(o),0);let f=new Sn(st);return this.Yr.forEachWhile(d=>{const h=d.key.path;return!!r.isPrefixOf(h)&&(h.length===a&&(f=f.add(d.Hr)),!0)},u),we.resolve(this.ei(f))}ei(e){const n=[];return e.forEach(r=>{const a=this.Zr(r);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){Ct(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return we.forEach(n.mutations,a=>{const o=new On(a.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new On(n,0),a=this.Yr.firstAfterOrEqual(r);return we.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uI{constructor(e){this.ni=e,this.docs=function(){return new Jt($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,a=this.docs.get(r),o=a?a.size:0,u=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():tr.newInvalidDocument(n))}getEntries(e,n){let r=Da();return n.forEach(a=>{const o=this.docs.get(a);r=r.insert(a,o?o.document.mutableCopy():tr.newInvalidDocument(a))}),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,a){let o=Da();const u=n.path,f=new $e(u.child("__id-9223372036854775808__")),d=this.docs.getIteratorFrom(f);for(;d.hasNext();){const{key:h,value:{document:g}}=d.getNext();if(!u.isPrefixOf(h.path))break;h.path.length>u.length+1||BR(VR(g),r)<=0||(a.has(g.key)||M0(n,g))&&(o=o.insert(g.key,g.mutableCopy()))}return we.resolve(o)}getAllFromCollectionGroup(e,n,r,a){Ke(9500)}ri(e,n){return we.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cI(this)}getSize(e){return we.resolve(this.size)}}class cI extends nI{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?n.push(this.Or.addEntry(e,a)):this.Or.removeEntry(r)}),we.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fI{constructor(e){this.persistence=e,this.ii=new Do(n=>xg(n),yg),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.si=0,this.oi=new Cg,this.targetCount=0,this._i=Xl.ar()}forEachTarget(e,n){return this.ii.forEach((r,a)=>n(a)),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),we.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new Xl(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.hr(n),we.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let a=0;const o=[];return this.ii.forEach((u,f)=>{f.sequenceNumber<=n&&r.get(f.targetId)===null&&(this.ii.delete(u),o.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)}),we.waitFor(o).next(()=>a)}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),we.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const a=this.persistence.referenceDelegate,o=[];return a&&n.forEach(u=>{o.push(a.markPotentiallyOrphaned(e,u))}),we.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LT{constructor(e,n){this.ai={},this.overlays={},this.ui=new N0(0),this.ci=!1,this.ci=!0,this.li=new oI,this.referenceDelegate=e(this),this.hi=new fI(this),this.indexManager=new WN,this.remoteDocumentCache=function(a){return new uI(a)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new YN(n),this.Ti=new aI(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sI,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new lI(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){je("MemoryPersistence","Starting transaction:",e);const a=new hI(this.ui.next());return this.referenceDelegate.Ii(),r(a).next(o=>this.referenceDelegate.di(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}Ei(e,n){return we.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class hI extends jR{constructor(e){super(),this.currentSequenceNumber=e}}class Rg{constructor(e){this.persistence=e,this.Ai=new Cg,this.Ri=null}static Vi(e){return new Rg(e)}get mi(){if(this.Ri)return this.Ri;throw Ke(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),we.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(a=>this.mi.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.mi,r=>{const a=$e.fromPath(r);return this.fi(e,a).next(o=>{o||n.removeEntry(a,et.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return we.or([()=>we.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class n0{constructor(e,n){this.persistence=e,this.gi=new Do(r=>GR(r.path),(r,a)=>r.isEqual(a)),this.garbageCollector=tI(this,n)}static Vi(e,n){return new n0(e,n)}Ii(){}di(e){return we.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(a=>r+a))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return we.forEach(this.gi,(r,a)=>this.Sr(e,r,a).next(o=>o?we.resolve():n(a)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ri(e,u=>this.Sr(e,u,n).next(f=>{f||(r++,o.removeEntry(u,et.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),we.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),we.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),we.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Bh(e.data.value)),n}Sr(e,n,r){return we.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.gi.get(n);return we.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ng{constructor(e,n,r,a){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=a}static Es(e,n){let r=ht(),a=ht();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new Ng(e,n.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dI{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mI{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return oC()?8:zR(iC())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,a){const o={result:null};return this.ps(e,n).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.ys(e,n,a,r).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new dI;return this.ws(e,n,u).next(f=>{if(o.result=f,this.Rs)return this.Ss(e,n,u,f.size)})}).next(()=>o.result)}Ss(e,n,r,a){return r.documentReadCount<this.Vs?(Dl()<=yt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",Ol(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),we.resolve()):(Dl()<=yt.DEBUG&&je("QueryEngine","Query:",Ol(n),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.fs*a?(Dl()<=yt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",Ol(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hi(n))):we.resolve())}ps(e,n){if(D_(n))return we.resolve(null);let r=Hi(n);return this.indexManager.getIndexType(e,r).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=Zh(n,null,"F"),r=Hi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const u=ht(...o);return this.gs.getDocuments(e,u).next(f=>this.indexManager.getMinOffset(e,r).next(d=>{const h=this.bs(n,f);return this.Ds(n,h,u,d.readTime)?this.ps(e,Zh(n,null,"F")):this.vs(e,h,n,d)}))})))}ys(e,n,r,a){return D_(n)||a.isEqual(et.min())?we.resolve(null):this.gs.getDocuments(e,r).next(o=>{const u=this.bs(n,o);return this.Ds(n,u,r,a)?we.resolve(null):(Dl()<=yt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),Ol(n)),this.vs(e,u,n,LR(a,Rc)).next(f=>f))})}bs(e,n){let r=new Sn(pT(e));return n.forEach((a,o)=>{M0(e,o)&&(r=r.add(o))}),r}Ds(e,n,r,a){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}ws(e,n,r){return Dl()<=yt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",Ol(n)),this.gs.getDocumentsMatchingQuery(e,n,As.min(),r)}vs(e,n,r,a){return this.gs.getDocumentsMatchingQuery(e,r,a).next(o=>(n.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ig="LocalStore",pI=3e8;class gI{constructor(e,n,r,a){this.persistence=e,this.Cs=n,this.serializer=a,this.Fs=new Jt(st),this.Ms=new Do(o=>xg(o),yg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iI(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function vI(t,e,n,r){return new gI(t,e,n,r)}async function VT(t,e){const n=tt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next(o=>(a=o,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const u=[],f=[];let d=ht();for(const h of a){u.push(h.batchId);for(const g of h.mutations)d=d.add(g.key)}for(const h of o){f.push(h.batchId);for(const g of h.mutations)d=d.add(g.key)}return n.localDocuments.getDocuments(r,d).next(h=>({Bs:h,removedBatchIds:u,addedBatchIds:f}))})})}function xI(t,e){const n=tt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=e.batch.keys(),o=n.Os.newChangeBuffer({trackRemovals:!0});return function(f,d,h,g){const y=h.batch,x=y.keys();let E=we.resolve();return x.forEach(w=>{E=E.next(()=>g.getEntry(d,w)).next(T=>{const b=h.docVersions.get(w);Ct(b!==null,48541),T.version.compareTo(b)<0&&(y.applyToRemoteDocument(T,h),T.isValidDocument()&&(T.setReadTime(h.commitVersion),g.addEntry(T)))})}),E.next(()=>f.mutationQueue.removeMutationBatch(d,y))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(f){let d=ht();for(let h=0;h<f.mutationResults.length;++h)f.mutationResults[h].transformResults.length>0&&(d=d.add(f.batch.mutations[h].key));return d}(e))).next(()=>n.localDocuments.getDocuments(r,a))})}function BT(t){const e=tt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function yI(t,e){const n=tt(t),r=e.snapshotVersion;let a=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=n.Os.newChangeBuffer({trackRemovals:!0});a=n.Fs;const f=[];e.targetChanges.forEach((g,y)=>{const x=a.get(y);if(!x)return;f.push(n.hi.removeMatchingKeys(o,g.removedDocuments,y).next(()=>n.hi.addMatchingKeys(o,g.addedDocuments,y)));let E=x.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?E=E.withResumeToken(Yn.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):g.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(g.resumeToken,r)),a=a.insert(y,E),function(T,b,k){return T.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=pI?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(x,E,g)&&f.push(n.hi.updateTargetData(o,E))});let d=Da(),h=ht();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&f.push(n.persistence.referenceDelegate.updateLimboDocument(o,g))}),f.push(_I(o,u,e.documentUpdates).next(g=>{d=g.Ls,h=g.ks})),!r.isEqual(et.min())){const g=n.hi.getLastRemoteSnapshotVersion(o).next(y=>n.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));f.push(g)}return we.waitFor(f).next(()=>u.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,d,h)).next(()=>d)}).then(o=>(n.Fs=a,o))}function _I(t,e,n){let r=ht(),a=ht();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let u=Da();return n.forEach((f,d)=>{const h=o.get(f);d.isFoundDocument()!==h.isFoundDocument()&&(a=a.add(f)),d.isNoDocument()&&d.version.isEqual(et.min())?(e.removeEntry(f,d.readTime),u=u.insert(f,d)):!h.isValidDocument()||d.version.compareTo(h.version)>0||d.version.compareTo(h.version)===0&&h.hasPendingWrites?(e.addEntry(d),u=u.insert(f,d)):je(Ig,"Ignoring outdated watch update for ",f,". Current version:",h.version," Watch version:",d.version)}),{Ls:u,ks:a}})}function EI(t,e){const n=tt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=gg),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function TI(t,e){const n=tt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return n.hi.getTargetData(r,e).next(o=>o?(a=o,we.resolve(a)):n.hi.allocateTargetId(r).next(u=>(a=new fs(e,u,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=n.Fs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function qp(t,e,n){const r=tt(t),a=r.Fs.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,u=>r.persistence.referenceDelegate.removeTarget(u,a))}catch(u){if(!tu(u))throw u;je(Ig,`Failed to update sequence numbers for target ${e}: ${u}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(a.target)}function G_(t,e,n){const r=tt(t);let a=et.min(),o=ht();return r.persistence.runTransaction("Execute query","readwrite",u=>function(d,h,g){const y=tt(d),x=y.Ms.get(g);return x!==void 0?we.resolve(y.Fs.get(x)):y.hi.getTargetData(h,g)}(r,u,Hi(e)).next(f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(u,f.targetId).next(d=>{o=d})}).next(()=>r.Cs.getDocumentsMatchingQuery(u,e,n?a:et.min(),n?o:ht())).next(f=>(wI(r,uN(e),f),{documents:f,qs:o})))}function wI(t,e,n){let r=t.xs.get(e)||et.min();n.forEach((a,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.xs.set(e,r)}class q_{constructor(){this.activeTargetIds=pN()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AI{constructor(){this.Fo=new q_,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new q_,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $_="ConnectivityMonitor";class Y_{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){je($_,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){je($_,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ch=null;function $p(){return Ch===null?Ch=function(){return 268435456+Math.round(2147483648*Math.random())}():Ch++,"0x"+Ch.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cp="RestConnection",bI={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class CI{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.Ko=this.databaseId.database===Wh?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,n,r,a,o){const u=$p(),f=this.Go(e,n.toUriEncodedString());je(cp,`Sending RPC '${e}' ${u}:`,f,r);const d={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(d,a,o);const{host:h}=new URL(f),g=cg(h);return this.jo(e,f,d,r,g).then(y=>(je(cp,`Received RPC '${e}' ${u}: `,y),y),y=>{throw Ts(cp,`RPC '${e}' ${u} failed with error: `,y,"url: ",f,"request:",r),y})}Jo(e,n,r,a,o,u){return this.Wo(e,n,r,a,o)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Jl}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>e[o]=a),r&&r.headers.forEach((a,o)=>e[o]=a)}Go(e,n){const r=bI[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class RI{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn="WebChannelConnection";class NI extends CI{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,a,o){const u=$p();return new Promise((f,d)=>{const h=new zE;h.setWithCredentials(!0),h.listenOnce(HE.COMPLETE,()=>{try{switch(h.getLastErrorCode()){case Vh.NO_ERROR:const y=h.getResponseJson();je(Jn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(y)),f(y);break;case Vh.TIMEOUT:je(Jn,`RPC '${e}' ${u} timed out`),d(new ke(xe.DEADLINE_EXCEEDED,"Request time out"));break;case Vh.HTTP_ERROR:const x=h.getStatus();if(je(Jn,`RPC '${e}' ${u} failed with status:`,x,"response text:",h.getResponseText()),x>0){let E=h.getResponseJson();Array.isArray(E)&&(E=E[0]);const w=E?.error;if(w&&w.status&&w.message){const T=function(k){const q=k.toLowerCase().replace(/_/g,"-");return Object.values(xe).indexOf(q)>=0?q:xe.UNKNOWN}(w.status);d(new ke(T,w.message))}else d(new ke(xe.UNKNOWN,"Server responded with status "+h.getStatus()))}else d(new ke(xe.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{c_:e,streamId:u,l_:h.getLastErrorCode(),h_:h.getLastError()})}}finally{je(Jn,`RPC '${e}' ${u} completed.`)}});const g=JSON.stringify(a);je(Jn,`RPC '${e}' ${u} sending request:`,a),h.send(n,"POST",g,r,15)})}P_(e,n,r){const a=$p(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=$E(),f=qE(),d={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},h=this.longPollingOptions.timeoutSeconds;h!==void 0&&(d.longPollingTimeout=Math.round(1e3*h)),this.useFetchStreams&&(d.useFetchStreams=!0),this.zo(d.initMessageHeaders,n,r),d.encodeInitMessageHeaders=!0;const g=o.join("");je(Jn,`Creating RPC '${e}' stream ${a}: ${g}`,d);const y=u.createWebChannel(g,d);this.T_(y);let x=!1,E=!1;const w=new RI({Ho:b=>{E?je(Jn,`Not sending because RPC '${e}' stream ${a} is closed:`,b):(x||(je(Jn,`Opening RPC '${e}' stream ${a} transport.`),y.open(),x=!0),je(Jn,`RPC '${e}' stream ${a} sending:`,b),y.send(b))},Yo:()=>y.close()}),T=(b,k,q)=>{b.listen(k,Y=>{try{q(Y)}catch(ee){setTimeout(()=>{throw ee},0)}})};return T(y,cc.EventType.OPEN,()=>{E||(je(Jn,`RPC '${e}' stream ${a} transport opened.`),w.s_())}),T(y,cc.EventType.CLOSE,()=>{E||(E=!0,je(Jn,`RPC '${e}' stream ${a} transport closed`),w.__(),this.I_(y))}),T(y,cc.EventType.ERROR,b=>{E||(E=!0,Ts(Jn,`RPC '${e}' stream ${a} transport errored. Name:`,b.name,"Message:",b.message),w.__(new ke(xe.UNAVAILABLE,"The operation could not be completed")))}),T(y,cc.EventType.MESSAGE,b=>{var k;if(!E){const q=b.data[0];Ct(!!q,16349);const Y=q,ee=Y?.error||((k=Y[0])===null||k===void 0?void 0:k.error);if(ee){je(Jn,`RPC '${e}' stream ${a} received error:`,ee);const he=ee.status;let Ae=function(R){const P=mn[R];if(P!==void 0)return bT(P)}(he),D=ee.message;Ae===void 0&&(Ae=xe.INTERNAL,D="Unknown error status: "+he+" with message "+ee.message),E=!0,w.__(new ke(Ae,D)),y.close()}else je(Jn,`RPC '${e}' stream ${a} received:`,q),w.a_(q)}}),T(f,GE.STAT_EVENT,b=>{b.stat===Mp.PROXY?je(Jn,`RPC '${e}' stream ${a} detected buffering proxy`):b.stat===Mp.NOPROXY&&je(Jn,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function fp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function V0(t){return new FN(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class UT{constructor(e,n,r=1e3,a=1.5,o=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=a,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),a=Math.max(0,n-r);a>0&&je("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X_="PersistentStream";class jT{constructor(e,n,r,a,o,u,f,d){this.Fi=e,this.w_=r,this.S_=a,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=d,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new UT(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===xe.RESOURCE_EXHAUSTED?(Ia(n.toString()),Ia("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===xe.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.b_===n&&this.W_(r,a)},r=>{e(()=>{const a=new ke(xe.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(a)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{r(()=>this.G_(a))}),this.stream.onMessage(a=>{r(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return je(X_,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(je(X_,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class II extends jT{constructor(e,n,r,a,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=kN(this.serializer,e),r=function(o){if(!("targetChange"in o))return et.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?et.min():u.readTime?qi(u.readTime):et.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=Gp(this.serializer),n.addTarget=function(o,u){let f;const d=u.target;if(f=Bp(d)?{documents:BN(o,d)}:{query:UN(o,d).Vt},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=NT(o,u.resumeToken);const h=jp(o,u.expectedCount);h!==null&&(f.expectedCount=h)}else if(u.snapshotVersion.compareTo(et.min())>0){f.readTime=t0(o,u.snapshotVersion.toTimestamp());const h=jp(o,u.expectedCount);h!==null&&(f.expectedCount=h)}return f}(this.serializer,e);const r=zN(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=Gp(this.serializer),n.removeTarget=e,this.k_(n)}}class DI extends jT{constructor(e,n,r,a,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Ct(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ct(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Ct(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=VN(e.writeResults,e.commitTime),r=qi(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=Gp(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>LN(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OI{}class FI extends OI{constructor(e,n,r,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new ke(xe.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Wo(e,zp(n,r),a,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ke(xe.UNKNOWN,o.toString())})}Jo(e,n,r,a,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,f])=>this.connection.Jo(e,zp(n,r),a,u,f,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===xe.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ke(xe.UNKNOWN,u.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class MI{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ia(n),this._a=!1):je("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const To="RemoteStore";class PI{constructor(e,n,r,a,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(u=>{r.enqueueAndForget(async()=>{Fo(this)&&(je(To,"Restarting streams for network reachability change."),await async function(d){const h=tt(d);h.Ia.add(4),await Kc(h),h.Aa.set("Unknown"),h.Ia.delete(4),await B0(h)}(this))})}),this.Aa=new MI(r,a)}}async function B0(t){if(Fo(t))for(const e of t.da)await e(!0)}async function Kc(t){for(const e of t.da)await e(!1)}function zT(t,e){const n=tt(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Mg(n)?Fg(n):nu(n).x_()&&Og(n,e))}function Dg(t,e){const n=tt(t),r=nu(n);n.Ta.delete(e),r.x_()&&HT(n,e),n.Ta.size===0&&(r.x_()?r.B_():Fo(n)&&n.Aa.set("Unknown"))}function Og(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(et.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}nu(t).H_(e)}function HT(t,e){t.Ra.$e(e),nu(t).Y_(e)}function Fg(t){t.Ra=new NN({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),nu(t).start(),t.Aa.aa()}function Mg(t){return Fo(t)&&!nu(t).M_()&&t.Ta.size>0}function Fo(t){return tt(t).Ia.size===0}function GT(t){t.Ra=void 0}async function kI(t){t.Aa.set("Online")}async function LI(t){t.Ta.forEach((e,n)=>{Og(t,e)})}async function VI(t,e){GT(t),Mg(t)?(t.Aa.la(e),Fg(t)):t.Aa.set("Unknown")}async function BI(t,e,n){if(t.Aa.set("Online"),e instanceof RT&&e.state===2&&e.cause)try{await async function(a,o){const u=o.cause;for(const f of o.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ta.delete(f),a.Ra.removeTarget(f))}(t,e)}catch(r){je(To,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await r0(t,r)}else if(e instanceof zh?t.Ra.Ye(e):e instanceof CT?t.Ra.it(e):t.Ra.et(e),!n.isEqual(et.min()))try{const r=await BT(t.localStore);n.compareTo(r)>=0&&await function(o,u){const f=o.Ra.Pt(u);return f.targetChanges.forEach((d,h)=>{if(d.resumeToken.approximateByteSize()>0){const g=o.Ta.get(h);g&&o.Ta.set(h,g.withResumeToken(d.resumeToken,u))}}),f.targetMismatches.forEach((d,h)=>{const g=o.Ta.get(d);if(!g)return;o.Ta.set(d,g.withResumeToken(Yn.EMPTY_BYTE_STRING,g.snapshotVersion)),HT(o,d);const y=new fs(g.target,d,h,g.sequenceNumber);Og(o,y)}),o.remoteSyncer.applyRemoteEvent(f)}(t,n)}catch(r){je(To,"Failed to raise snapshot:",r),await r0(t,r)}}async function r0(t,e,n){if(!tu(e))throw e;t.Ia.add(1),await Kc(t),t.Aa.set("Offline"),n||(n=()=>BT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je(To,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await B0(t)})}function qT(t,e){return e().catch(n=>r0(t,n,e))}async function U0(t){const e=tt(t),n=Rs(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:gg;for(;UI(e);)try{const a=await EI(e.localStore,r);if(a===null){e.Pa.length===0&&n.B_();break}r=a.batchId,jI(e,a)}catch(a){await r0(e,a)}$T(e)&&YT(e)}function UI(t){return Fo(t)&&t.Pa.length<10}function jI(t,e){t.Pa.push(e);const n=Rs(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function $T(t){return Fo(t)&&!Rs(t).M_()&&t.Pa.length>0}function YT(t){Rs(t).start()}async function zI(t){Rs(t).na()}async function HI(t){const e=Rs(t);for(const n of t.Pa)e.X_(n.mutations)}async function GI(t,e,n){const r=t.Pa.shift(),a=Ag.from(r,e,n);await qT(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await U0(t)}async function qI(t,e){e&&Rs(t).Z_&&await async function(r,a){if(function(u){return CN(u)&&u!==xe.ABORTED}(a.code)){const o=r.Pa.shift();Rs(r).N_(),await qT(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,a)),await U0(r)}}(t,e),$T(t)&&YT(t)}async function W_(t,e){const n=tt(t);n.asyncQueue.verifyOperationInProgress(),je(To,"RemoteStore received new credentials");const r=Fo(n);n.Ia.add(3),await Kc(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await B0(n)}async function $I(t,e){const n=tt(t);e?(n.Ia.delete(2),await B0(n)):e||(n.Ia.add(2),await Kc(n),n.Aa.set("Unknown"))}function nu(t){return t.Va||(t.Va=function(n,r,a){const o=tt(n);return o.ia(),new II(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:kI.bind(null,t),e_:LI.bind(null,t),n_:VI.bind(null,t),J_:BI.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Mg(t)?Fg(t):t.Aa.set("Unknown")):(await t.Va.stop(),GT(t))})),t.Va}function Rs(t){return t.ma||(t.ma=function(n,r,a){const o=tt(n);return o.ia(),new DI(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:zI.bind(null,t),n_:qI.bind(null,t),ea:HI.bind(null,t),ta:GI.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await U0(t)):(await t.ma.stop(),t.Pa.length>0&&(je(To,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pg{constructor(e,n,r,a,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=o,this.deferred=new wa,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,a,o){const u=Date.now()+r,f=new Pg(e,n,u,a,o);return f.start(r),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(xe.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function kg(t,e){if(Ia("AsyncQueue",`${e}: ${t}`),tu(t))return new ke(xe.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vl{static emptySet(e){return new Vl(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||$e.comparator(n.key,r.key):(n,r)=>$e.comparator(n.key,r.key),this.keyedMap=fc(),this.sortedSet=new Jt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Vl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Vl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class K_{constructor(){this.fa=new Jt($e.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):Ke(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class Wl{constructor(e,n,r,a,o,u,f,d,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=d,this.hasCachedResults=h}static fromInitialDocuments(e,n,r,a,o){const u=[];return n.forEach(f=>{u.push({type:0,doc:f})}),new Wl(e,n,Vl.emptySet(n),u,r,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&F0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class XI{constructor(){this.queries=Q_(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const a=tt(n),o=a.queries;a.queries=Q_(),o.forEach((u,f)=>{for(const d of f.wa)d.onError(r)})})(this,new ke(xe.ABORTED,"Firestore shutting down"))}}function Q_(){return new Do(t=>mT(t),F0)}async function XT(t,e){const n=tt(t);let r=3;const a=e.query;let o=n.queries.get(a);o?!o.Sa()&&e.ba()&&(r=2):(o=new YI,r=e.ba()?0:1);try{switch(r){case 0:o.ya=await n.onListen(a,!0);break;case 1:o.ya=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const f=kg(u,`Initialization of query '${Ol(e.query)}' failed`);return void e.onError(f)}n.queries.set(a,o),o.wa.push(e),e.va(n.onlineState),o.ya&&e.Ca(o.ya)&&Lg(n)}async function WT(t,e){const n=tt(t),r=e.query;let a=3;const o=n.queries.get(r);if(o){const u=o.wa.indexOf(e);u>=0&&(o.wa.splice(u,1),o.wa.length===0?a=e.ba()?0:1:!o.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function WI(t,e){const n=tt(t);let r=!1;for(const a of e){const o=a.query,u=n.queries.get(o);if(u){for(const f of u.wa)f.Ca(a)&&(r=!0);u.ya=a}}r&&Lg(n)}function KI(t,e,n){const r=tt(t),a=r.queries.get(e);if(a)for(const o of a.wa)o.onError(n);r.queries.delete(e)}function Lg(t){t.Da.forEach(e=>{e.next()})}var Yp,Z_;(Z_=Yp||(Yp={})).Fa="default",Z_.Cache="cache";class KT{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new Wl(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=Wl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==Yp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QT{constructor(e){this.key=e}}class ZT{constructor(e){this.key=e}}class QI{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ht(),this.mutatedKeys=ht(),this.Xa=pT(e),this.eu=new Vl(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new K_,a=n?n.eu:this.eu;let o=n?n.mutatedKeys:this.mutatedKeys,u=a,f=!1;const d=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,h=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((g,y)=>{const x=a.get(g),E=M0(this.query,y)?y:null,w=!!x&&this.mutatedKeys.has(x.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let b=!1;x&&E?x.data.isEqual(E.data)?w!==T&&(r.track({type:3,doc:E}),b=!0):this.iu(x,E)||(r.track({type:2,doc:E}),b=!0,(d&&this.Xa(E,d)>0||h&&this.Xa(E,h)<0)&&(f=!0)):!x&&E?(r.track({type:0,doc:E}),b=!0):x&&!E&&(r.track({type:1,doc:x}),b=!0,(d||h)&&(f=!0)),b&&(E?(u=u.add(E),o=T?o.add(g):o.delete(g)):(u=u.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const g=this.query.limitType==="F"?u.last():u.first();u=u.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{eu:u,ru:r,Ds:f,mutatedKeys:o}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,a){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort((g,y)=>function(E,w){const T=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{At:b})}};return T(E)-T(w)}(g.type,y.type)||this.Xa(g.doc,y.doc)),this.su(r),a=a!=null&&a;const f=n&&!a?this.ou():[],d=this.Za.size===0&&this.current&&!a?1:0,h=d!==this.Ya;return this.Ya=d,u.length!==0||h?{snapshot:new Wl(this.query,e.eu,o,u,e.mutatedKeys,d===0,h,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new K_,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ht(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new ZT(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new QT(r))}),n}uu(e){this.Ha=e.qs,this.Za=ht();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return Wl.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const Vg="SyncEngine";class ZI{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JI{constructor(e){this.key=e,this.lu=!1}}class eD{constructor(e,n,r,a,o,u){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new Do(f=>mT(f),F0),this.Tu=new Map,this.Iu=new Set,this.du=new Jt($e.comparator),this.Eu=new Map,this.Au=new Cg,this.Ru={},this.Vu=new Map,this.mu=Xl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function tD(t,e,n=!0){const r=iw(t);let a;const o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.cu()):a=await JT(r,e,n,!0),a}async function nD(t,e){const n=iw(t);await JT(n,e,!0,!1)}async function JT(t,e,n,r){const a=await TI(t.localStore,Hi(e)),o=a.targetId,u=t.sharedClientState.addLocalQueryTarget(o,n);let f;return r&&(f=await rD(t,e,o,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&zT(t.remoteStore,a),f}async function rD(t,e,n,r,a){t.gu=(y,x,E)=>async function(T,b,k,q){let Y=b.view.nu(k);Y.Ds&&(Y=await G_(T.localStore,b.query,!1).then(({documents:D})=>b.view.nu(D,Y)));const ee=q&&q.targetChanges.get(b.targetId),he=q&&q.targetMismatches.get(b.targetId)!=null,Ae=b.view.applyChanges(Y,T.isPrimaryClient,ee,he);return e2(T,b.targetId,Ae._u),Ae.snapshot}(t,y,x,E);const o=await G_(t.localStore,e,!0),u=new QI(e,o.qs),f=u.nu(o.documents),d=Wc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",a),h=u.applyChanges(f,t.isPrimaryClient,d);e2(t,n,h._u);const g=new ZI(e,n,u);return t.Pu.set(e,g),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),h.snapshot}async function iD(t,e,n){const r=tt(t),a=r.Pu.get(e),o=r.Tu.get(a.targetId);if(o.length>1)return r.Tu.set(a.targetId,o.filter(u=>!F0(u,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await qp(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Dg(r.remoteStore,a.targetId),Xp(r,a.targetId)}).catch(eu)):(Xp(r,a.targetId),await qp(r.localStore,a.targetId,!0))}async function aD(t,e){const n=tt(t),r=n.Pu.get(e),a=n.Tu.get(r.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Dg(n.remoteStore,r.targetId))}async function sD(t,e,n){const r=dD(t);try{const a=await function(u,f){const d=tt(u),h=$t.now(),g=f.reduce((E,w)=>E.add(w.key),ht());let y,x;return d.persistence.runTransaction("Locally write mutations","readwrite",E=>{let w=Da(),T=ht();return d.Os.getEntries(E,g).next(b=>{w=b,w.forEach((k,q)=>{q.isValidDocument()||(T=T.add(k))})}).next(()=>d.localDocuments.getOverlayedDocuments(E,w)).next(b=>{y=b;const k=[];for(const q of f){const Y=TN(q,y.get(q.key).overlayedDocument);Y!=null&&k.push(new Oo(q.key,Y,oT(Y.value.mapValue),Gi.exists(!0)))}return d.mutationQueue.addMutationBatch(E,h,k,f)}).next(b=>{x=b;const k=b.applyToLocalDocumentSet(y,T);return d.documentOverlayCache.saveOverlays(E,b.batchId,k)})}).then(()=>({batchId:x.batchId,changes:vT(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),function(u,f,d){let h=u.Ru[u.currentUser.toKey()];h||(h=new Jt(st)),h=h.insert(f,d),u.Ru[u.currentUser.toKey()]=h}(r,a.batchId,n),await Qc(r,a.changes),await U0(r.remoteStore)}catch(a){const o=kg(a,"Failed to persist write");n.reject(o)}}async function ew(t,e){const n=tt(t);try{const r=await yI(n.localStore,e);e.targetChanges.forEach((a,o)=>{const u=n.Eu.get(o);u&&(Ct(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.lu=!0:a.modifiedDocuments.size>0?Ct(u.lu,14607):a.removedDocuments.size>0&&(Ct(u.lu,42227),u.lu=!1))}),await Qc(n,r,e)}catch(r){await eu(r)}}function J_(t,e,n){const r=tt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.Pu.forEach((o,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)}),function(u,f){const d=tt(u);d.onlineState=f;let h=!1;d.queries.forEach((g,y)=>{for(const x of y.wa)x.va(f)&&(h=!0)}),h&&Lg(d)}(r.eventManager,e),a.length&&r.hu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function oD(t,e,n){const r=tt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.Eu.get(e),o=a&&a.key;if(o){let u=new Jt($e.comparator);u=u.insert(o,tr.newNoDocument(o,et.min()));const f=ht().add(o),d=new L0(et.min(),new Map,new Jt(st),u,f);await ew(r,d),r.du=r.du.remove(o),r.Eu.delete(e),Bg(r)}else await qp(r.localStore,e,!1).then(()=>Xp(r,e,n)).catch(eu)}async function lD(t,e){const n=tt(t),r=e.batch.batchId;try{const a=await xI(n.localStore,e);nw(n,r,null),tw(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Qc(n,a)}catch(a){await eu(a)}}async function uD(t,e,n){const r=tt(t);try{const a=await function(u,f){const d=tt(u);return d.persistence.runTransaction("Reject batch","readwrite-primary",h=>{let g;return d.mutationQueue.lookupMutationBatch(h,f).next(y=>(Ct(y!==null,37113),g=y.keys(),d.mutationQueue.removeMutationBatch(h,y))).next(()=>d.mutationQueue.performConsistencyCheck(h)).next(()=>d.documentOverlayCache.removeOverlaysForBatchId(h,g,f)).next(()=>d.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(h,g)).next(()=>d.localDocuments.getDocuments(h,g))})}(r.localStore,e);nw(r,e,n),tw(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Qc(r,a)}catch(a){await eu(a)}}function tw(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function nw(t,e,n){const r=tt(t);let a=r.Ru[r.currentUser.toKey()];if(a){const o=a.get(e);o&&(n?o.reject(n):o.resolve(),a=a.remove(e)),r.Ru[r.currentUser.toKey()]=a}}function Xp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||rw(t,r)})}function rw(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Dg(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Bg(t))}function e2(t,e,n){for(const r of n)r instanceof QT?(t.Au.addReference(r.key,e),cD(t,r)):r instanceof ZT?(je(Vg,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||rw(t,r.key)):Ke(19791,{yu:r})}function cD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(je(Vg,"New document in limbo: "+n),t.Iu.add(r),Bg(t))}function Bg(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new $e(zt.fromString(e)),r=t.mu.next();t.Eu.set(r,new JI(n)),t.du=t.du.insert(n,r),zT(t.remoteStore,new fs(Hi(_g(n.path)),r,"TargetPurposeLimboResolution",N0.ue))}}async function Qc(t,e,n){const r=tt(t),a=[],o=[],u=[];r.Pu.isEmpty()||(r.Pu.forEach((f,d)=>{u.push(r.gu(d,e,n).then(h=>{var g;if((h||n)&&r.isPrimaryClient){const y=h?!h.fromCache:(g=n?.targetChanges.get(d.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(d.targetId,y?"current":"not-current")}if(h){a.push(h);const y=Ng.Es(d.targetId,h);o.push(y)}}))}),await Promise.all(u),r.hu.J_(a),await async function(d,h){const g=tt(d);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>we.forEach(h,x=>we.forEach(x.Is,E=>g.persistence.referenceDelegate.addReference(y,x.targetId,E)).next(()=>we.forEach(x.ds,E=>g.persistence.referenceDelegate.removeReference(y,x.targetId,E)))))}catch(y){if(!tu(y))throw y;je(Ig,"Failed to update sequence numbers: "+y)}for(const y of h){const x=y.targetId;if(!y.fromCache){const E=g.Fs.get(x),w=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(w);g.Fs=g.Fs.insert(x,T)}}}(r.localStore,o))}async function fD(t,e){const n=tt(t);if(!n.currentUser.isEqual(e)){je(Vg,"User change. New user:",e.toKey());const r=await VT(n.localStore,e);n.currentUser=e,function(o,u){o.Vu.forEach(f=>{f.forEach(d=>{d.reject(new ke(xe.CANCELLED,u))})}),o.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Qc(n,r.Bs)}}function hD(t,e){const n=tt(t),r=n.Eu.get(e);if(r&&r.lu)return ht().add(r.key);{let a=ht();const o=n.Tu.get(e);if(!o)return a;for(const u of o){const f=n.Pu.get(u);a=a.unionWith(f.view.tu)}return a}}function iw(t){const e=tt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ew.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oD.bind(null,e),e.hu.J_=WI.bind(null,e.eventManager),e.hu.pu=KI.bind(null,e.eventManager),e}function dD(t){const e=tt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uD.bind(null,e),e}class i0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=V0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return vI(this.persistence,new mI,e.initialUser,this.serializer)}Du(e){return new LT(Rg.Vi,this.serializer)}bu(e){return new AI}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}i0.provider={build:()=>new i0};class mD extends i0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Ct(this.persistence.referenceDelegate instanceof n0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new JN(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new LT(r=>n0.Vi(r,n),this.serializer)}}class Wp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>J_(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fD.bind(null,this.syncEngine),await $I(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new XI}()}createDatastore(e){const n=V0(e.databaseInfo.databaseId),r=function(o){return new NI(o)}(e.databaseInfo);return function(o,u,f,d){return new FI(o,u,f,d)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,a,o,u,f){return new PI(r,a,o,u,f)}(this.localStore,this.datastore,e.asyncQueue,n=>J_(this.syncEngine,n,0),function(){return Y_.C()?new Y_:new SI}())}createSyncEngine(e,n){return function(a,o,u,f,d,h,g){const y=new eD(a,o,u,f,d,h);return g&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(a){const o=tt(a);je(To,"RemoteStore shutting down."),o.Ia.add(5),await Kc(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Wp.provider={build:()=>new Wp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ia("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ns="FirestoreClient";class pD{constructor(e,n,r,a,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=er.UNAUTHENTICATED,this.clientId=pg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async u=>{je(Ns,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(r,u=>(je(Ns,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new wa;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=kg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function hp(t,e){t.asyncQueue.verifyOperationInProgress(),je(Ns,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async a=>{r.isEqual(a)||(await VT(e.localStore,a),r=a)}),e.persistence.setDatabaseDeletedListener(()=>{Ts("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{je("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{Ts("Terminating Firestore due to IndexedDb database deletion failed",a)})}),t._offlineComponents=e}async function t2(t,e){t.asyncQueue.verifyOperationInProgress();const n=await gD(t);je(Ns,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>W_(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,a)=>W_(e.remoteStore,a)),t._onlineComponents=e}async function gD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(Ns,"Using user provided OfflineComponentProvider");try{await hp(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(a){return a.name==="FirebaseError"?a.code===xe.FAILED_PRECONDITION||a.code===xe.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(n))throw n;Ts("Error using user provided cache. Falling back to memory cache: "+n),await hp(t,new i0)}}else je(Ns,"Using default OfflineComponentProvider"),await hp(t,new mD(void 0));return t._offlineComponents}async function sw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(Ns,"Using user provided OnlineComponentProvider"),await t2(t,t._uninitializedComponentsProvider._online)):(je(Ns,"Using default OnlineComponentProvider"),await t2(t,new Wp))),t._onlineComponents}function vD(t){return sw(t).then(e=>e.syncEngine)}async function ow(t){const e=await sw(t),n=e.eventManager;return n.onListen=tD.bind(null,e.syncEngine),n.onUnlisten=iD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=nD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aD.bind(null,e.syncEngine),n}function xD(t,e,n={}){const r=new wa;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,f,d,h){const g=new aw({next:x=>{g.Ou(),u.enqueueAndForget(()=>WT(o,y));const E=x.docs.has(f);!E&&x.fromCache?h.reject(new ke(xe.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&x.fromCache&&d&&d.source==="server"?h.reject(new ke(xe.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):h.resolve(x)},error:x=>h.reject(x)}),y=new KT(_g(f.path),g,{includeMetadataChanges:!0,ka:!0});return XT(o,y)}(await ow(t),t.asyncQueue,e,n,r)),r.promise}function yD(t,e,n={}){const r=new wa;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,f,d,h){const g=new aw({next:x=>{g.Ou(),u.enqueueAndForget(()=>WT(o,y)),x.fromCache&&d.source==="server"?h.reject(new ke(xe.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):h.resolve(x)},error:x=>h.reject(x)}),y=new KT(f,g,{includeMetadataChanges:!0,ka:!0});return XT(o,y)}(await ow(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n2=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uw="firestore.googleapis.com",r2=!0;class i2{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ke(xe.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=uw,this.ssl=r2}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:r2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=kT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QN)throw new ke(xe.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kR("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=lw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ke(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ke(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ke(xe.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,a){return r.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class j0{constructor(e,n,r,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new i2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(xe.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(xe.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new i2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new CR;switch(r.type){case"firstParty":return new DR(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ke(xe.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=n2.get(n);r&&(je("ComponentProvider","Removing Datastore"),n2.delete(n),r.terminate())}(this),Promise.resolve()}}function _D(t,e,n,r={}){var a;t=ws(t,j0);const o=cg(e),u=t._getSettings(),f=Object.assign(Object.assign({},u),{emulatorOptions:t._getEmulatorOptions()}),d=`${e}:${n}`;o&&(J3(`https://${d}`),rC("Firestore",!0)),u.host!==uw&&u.host!==d&&Ts("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const h=Object.assign(Object.assign({},u),{host:d,ssl:o,emulatorOptions:r});if(!$h(h,f)&&(t._setSettings(h),r.mockUserToken)){let g,y;if(typeof r.mockUserToken=="string")g=r.mockUserToken,y=er.MOCK_USER;else{g=eC(r.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const x=r.mockUserToken.sub||r.mockUserToken.user_id;if(!x)throw new ke(xe.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new er(x)}t._authCredentials=new RR(new XE(g,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ma{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Ma(this.firestore,e,this._query)}}class vn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new vs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if(Yc(n,vn._jsonSchema))return new vn(e,r||null,new $e(zt.fromString(n.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:gn("string",vn._jsonSchemaVersion),referencePath:gn("string")};class vs extends Ma{constructor(e,n,r){super(e,n,_g(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new $e(e))}withConverter(e){return new vs(this.firestore,e,this._path)}}function a2(t,e,...n){if(t=_s(t),KE("collection","path",e),t instanceof j0){const r=zt.fromString(e,...n);return x_(r),new vs(t,null,r)}{if(!(t instanceof vn||t instanceof vs))throw new ke(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(zt.fromString(e,...n));return x_(r),new vs(t.firestore,null,r)}}function Is(t,e,...n){if(t=_s(t),arguments.length===1&&(e=pg.newId()),KE("doc","path",e),t instanceof j0){const r=zt.fromString(e,...n);return v_(r),new vn(t,null,new $e(r))}{if(!(t instanceof vn||t instanceof vs))throw new ke(xe.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(zt.fromString(e,...n));return v_(r),new vn(t.firestore,t instanceof vs?t.converter:null,new $e(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const s2="AsyncQueue";class o2{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new UT(this,"async_queue_retry"),this.oc=()=>{const r=fp();r&&je(s2,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=fp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=fp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new wa;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!tu(e))throw e;je(s2,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Ia("INTERNAL UNHANDLED ERROR: ",l2(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const a=Pg.createAndSchedule(this,e,n,r,o=>this.lc(o));return this.ec.push(a),a}ac(){this.tc&&Ke(47125,{hc:l2(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function l2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Zc extends j0{constructor(e,n,r,a){super(e,n,r,a),this.type="firestore",this._queue=new o2,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new o2(e),this._firestoreClient=void 0,await e}}}function ED(t,e){const n=typeof t=="object"?t:gR(),r=typeof t=="string"?t:Wh,a=dg(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const o=Q3("firestore");o&&_D(a,...o)}return a}function Ug(t){if(t._terminated)throw new ke(xe.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||TD(t),t._firestoreClient}function TD(t){var e,n,r;const a=t._freezeSettings(),o=function(f,d,h,g){return new YR(f,d,h,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,lw(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((n=a.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new pD(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(f){const d=f?._online.build();return{_offline:f?._offline.build(d),_online:d}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ni(Yn.fromBase64String(e))}catch(n){throw new ke(xe.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ni(Yn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ni._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(Yc(e,ni._jsonSchema))return ni.fromBase64String(e.bytes)}}ni._jsonSchemaVersion="firestore/bytes/1.0",ni._jsonSchema={type:gn("string",ni._jsonSchemaVersion),bytes:gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jg{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ke(xe.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ke(xe.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ke(xe.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$i._jsonSchemaVersion}}static fromJSON(e){if(Yc(e,$i._jsonSchema))return new $i(e.latitude,e.longitude)}}$i._jsonSchemaVersion="firestore/geoPoint/1.0",$i._jsonSchema={type:gn("string",$i._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Yi{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,a){if(r.length!==a.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==a[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Yi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(Yc(e,Yi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Yi(e.vectorValues);throw new ke(xe.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Yi._jsonSchemaVersion="firestore/vectorValue/1.0",Yi._jsonSchema={type:gn("string",Yi._jsonSchemaVersion),vectorValues:gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=/^__.*__$/;class AD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Oo(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xc(e,this.data,n,this.fieldTransforms)}}function fw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ec:t})}}class zg{constructor(e,n,r,a,o,u){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new zg(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Rc({path:r,mc:!1});return a.fc(e),a}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Rc({path:r,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return a0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(fw(this.Ec)&&wD.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class SD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||V0(e)}Dc(e,n,r,a=!1){return new zg({Ec:e,methodName:n,bc:r,path:Hn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Hg(t){const e=t._freezeSettings(),n=V0(t._databaseId);return new SD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bD(t,e,n,r,a,o={}){const u=t.Dc(o.merge||o.mergeFields?2:0,e,n,a);pw("Data must be an object, but it was:",u,r);const f=dw(r,u);let d,h;if(o.merge)d=new mi(u.fieldMask),h=u.fieldTransforms;else if(o.mergeFields){const g=[];for(const y of o.mergeFields){const x=CD(e,y,n);if(!u.contains(x))throw new ke(xe.INVALID_ARGUMENT,`Field '${x}' is specified in your field mask but missing from your input data.`);ND(g,x)||g.push(x)}d=new mi(g),h=u.fieldTransforms.filter(y=>d.covers(y.field))}else d=null,h=u.fieldTransforms;return new AD(new ti(f),d,h)}function hw(t,e,n,r=!1){return Gg(n,t.Dc(r?4:3,e))}function Gg(t,e){if(mw(t=_s(t)))return pw("Unsupported field value:",e,t),dw(t,e);if(t instanceof cw)return function(r,a){if(!fw(a.Ec))throw a.wc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,a){const o=[];let u=0;for(const f of r){let d=Gg(f,a.yc(u));d==null&&(d={nullValue:"NULL_VALUE"}),o.push(d),u++}return{arrayValue:{values:o}}}(t,e)}return function(r,a){if((r=_s(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gN(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=$t.fromDate(r);return{timestampValue:t0(a.serializer,o)}}if(r instanceof $t){const o=new $t(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:t0(a.serializer,o)}}if(r instanceof $i)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ni)return{bytesValue:NT(a.serializer,r._byteString)};if(r instanceof vn){const o=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(o))throw a.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:bg(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof Yi)return function(u,f){return{mapValue:{fields:{[aT]:{stringValue:sT},[Kh]:{arrayValue:{values:u.toArray().map(h=>{if(typeof h!="number")throw f.wc("VectorValues must only contain numeric values.");return Tg(f.serializer,h)})}}}}}}(r,a);throw a.wc(`Unsupported field value: ${R0(r)}`)}(t,e)}function dw(t,e){const n={};return JE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):No(t,(r,a)=>{const o=Gg(a,e.Vc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function mw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof $t||t instanceof $i||t instanceof ni||t instanceof vn||t instanceof cw||t instanceof Yi)}function pw(t,e,n){if(!mw(n)||!QE(n)){const r=R0(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function CD(t,e,n){if((e=_s(e))instanceof jg)return e._internalPath;if(typeof e=="string")return gw(t,e);throw a0("Field path arguments must be of type string or ",t,!1,void 0,n)}const RD=new RegExp("[~\\*/\\[\\]]");function gw(t,e,n){if(e.search(RD)>=0)throw a0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new jg(...e.split("."))._internalPath}catch{throw a0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function a0(t,e,n,r,a){const o=r&&!r.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;n&&(f+=" (via `toFirestore()`)"),f+=". ";let d="";return(o||u)&&(d+=" (found",o&&(d+=` in field ${r}`),u&&(d+=` in document ${a}`),d+=")"),new ke(xe.INVALID_ARGUMENT,f+t+d)}function ND(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qg{constructor(e,n,r,a,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ID(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field($g("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ID extends qg{data(){return super.data()}}function $g(t,e){return typeof e=="string"?gw(t,e):e instanceof jg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ke(xe.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class Yg{}class z0 extends Yg{}function u2(t,e,...n){let r=[];e instanceof Yg&&r.push(e),r=r.concat(n),function(o){const u=o.filter(d=>d instanceof Wg).length,f=o.filter(d=>d instanceof Xg).length;if(u>1||u>0&&f>0)throw new ke(xe.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)t=a._apply(t);return t}class Xg extends z0{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new Xg(e,n,r)}_apply(e){const n=this._parse(e);return vw(e._query,n),new Ma(e.firestore,e.converter,Up(e._query,n))}_parse(e){const n=Hg(e.firestore);return function(o,u,f,d,h,g,y){let x;if(h.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ke(xe.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){d2(y,g);const w=[];for(const T of y)w.push(h2(d,o,T));x={arrayValue:{values:w}}}else x=h2(d,o,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||d2(y,g),x=hw(f,u,y,g==="in"||g==="not-in");return pn.create(h,g,x)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Wg extends Yg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Wg(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:vi.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(a,o){let u=a;const f=o.getFlattenedFilters();for(const d of f)vw(u,d),u=Up(u,d)}(e._query,n),new Ma(e.firestore,e.converter,Up(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Kg extends z0{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Kg(e,n)}_apply(e){const n=function(a,o,u){if(a.startAt!==null)throw new ke(xe.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ke(xe.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Oc(o,u)}(e._query,this._field,this._direction);return new Ma(e.firestore,e.converter,function(a,o){const u=a.explicitOrderBy.concat([o]);return new Io(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,n))}}function c2(t,e="asc"){const n=e,r=$g("orderBy",t);return Kg._create(r,n)}class Qg extends z0{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Qg(e,n,r)}_apply(e){return new Ma(e.firestore,e.converter,Zh(e._query,this._limit,this._limitType))}}function f2(t){return Qg._create("limit",t,"F")}class Zg extends z0{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Zg(e,n,r)}_apply(e){const n=FD(e,this.type,this._docOrFields,this._inclusive);return new Ma(e.firestore,e.converter,function(a,o){return new Io(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,o,a.endAt)}(e._query,n))}}function OD(...t){return Zg._create("startAfter",t,!1)}function FD(t,e,n,r){if(n[0]=_s(n[0]),n[0]instanceof qg)return function(o,u,f,d,h){if(!d)throw new ke(xe.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const g=[];for(const y of Ll(o))if(y.field.isKeyField())g.push(Qh(u,d.key));else{const x=d.data.field(y.field);if(D0(x))throw new ke(xe.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(x===null){const E=y.field.canonicalString();throw new ke(xe.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}g.push(x)}return new Yl(g,h)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const a=Hg(t.firestore);return function(u,f,d,h,g,y){const x=u.explicitOrderBy;if(g.length>x.length)throw new ke(xe.INVALID_ARGUMENT,`Too many arguments provided to ${h}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let w=0;w<g.length;w++){const T=g[w];if(x[w].field.isKeyField()){if(typeof T!="string")throw new ke(xe.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${h}(), but got a ${typeof T}`);if(!Eg(u)&&T.indexOf("/")!==-1)throw new ke(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${h}() must be a plain document ID, but '${T}' contains a slash.`);const b=u.path.child(zt.fromString(T));if(!$e.isDocumentKey(b))throw new ke(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${h}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const k=new $e(b);E.push(Qh(f,k))}else{const b=hw(d,h,T);E.push(b)}}return new Yl(E,y)}(t._query,t.firestore._databaseId,a,e,n,r)}}function h2(t,e,n){if(typeof(n=_s(n))=="string"){if(n==="")throw new ke(xe.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Eg(e)&&n.indexOf("/")!==-1)throw new ke(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(zt.fromString(n));if(!$e.isDocumentKey(r))throw new ke(xe.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Qh(t,new $e(r))}if(n instanceof vn)return Qh(t,n._key);throw new ke(xe.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${R0(n)}.`)}function d2(t,e){if(!Array.isArray(t)||t.length===0)throw new ke(xe.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function vw(t,e){const n=function(a,o){for(const u of a)for(const f of u.getFlattenedFilters())if(o.indexOf(f.op)>=0)return f.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ke(xe.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(xe.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class MD{convertValue(e,n="none"){switch(Cs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return un(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(bs(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return No(e,(a,o)=>{r[a]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,a;const o=(a=(r=(n=e.fields)===null||n===void 0?void 0:n[Kh].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map(u=>un(u.doubleValue));return new Yi(o)}convertGeoPoint(e){return new $i(un(e.latitude),un(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=O0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Nc(e));default:return null}}convertTimestamp(e){const n=Ss(e);return new $t(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=zt.fromString(e);Ct(PT(r),9688,{name:e});const a=new Ic(r.get(1),r.get(3)),o=new $e(r.popFirst(5));return a.isEqual(n)||Ia(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class dc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class yo extends qg{constructor(e,n,r,a,o,u){super(e,n,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new Hh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field($g("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(xe.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=yo._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}yo._jsonSchemaVersion="firestore/documentSnapshot/1.0",yo._jsonSchema={type:gn("string",yo._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class Hh extends yo{data(e={}){return super.data(e)}}class Bl{constructor(e,n,r,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new dc(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new Hh(this._firestore,this._userDataWriter,r.key,r,new dc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ke(xe.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map(f=>{const d=new Hh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new dc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:d,oldIndex:-1,newIndex:u++}})}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(f=>o||f.type!==3).map(f=>{const d=new Hh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new dc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let h=-1,g=-1;return f.type!==0&&(h=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),g=u.indexOf(f.doc.key)),{type:kD(f.type),doc:d,oldIndex:h,newIndex:g}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(xe.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Bl._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=pg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],a=[];return this.docs.forEach(o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H0(t){t=ws(t,vn);const e=ws(t.firestore,Zc);return xD(Ug(e),t._key).then(n=>VD(e,t,n))}Bl._jsonSchemaVersion="firestore/querySnapshot/1.0",Bl._jsonSchema={type:gn("string",Bl._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};class xw extends MD{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,n)}}function m2(t){t=ws(t,Ma);const e=ws(t.firestore,Zc),n=Ug(e),r=new xw(e);return DD(t._query),yD(n,t._query).then(a=>new Bl(e,r,t,a))}function wo(t,e,n){t=ws(t,vn);const r=ws(t.firestore,Zc),a=PD(t.converter,e,n);return yw(r,[bD(Hg(r),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Gi.none())])}function LD(t){return yw(ws(t.firestore,Zc),[new wg(t._key,Gi.none())])}function yw(t,e){return function(r,a){const o=new wa;return r.asyncQueue.enqueueAndForget(async()=>sD(await vD(r),a,o)),o.promise}(Ug(t),e)}function VD(t,e,n){const r=n.docs.get(e._key),a=new xw(t);return new yo(t,a,e._key,r,new dc(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(a){Jl=a})(pR),Es(new Ra("firestore",(r,{instanceIdentifier:a,options:o})=>{const u=r.getProvider("app").getImmediate(),f=new Zc(new NR(r.getProvider("auth-internal")),new OR(u,r.getProvider("app-check-internal")),function(h,g){if(!Object.prototype.hasOwnProperty.apply(h.options,["projectId"]))throw new ke(xe.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ic(h.options.projectId,g)}(u,a),u);return o=Object.assign({useFetchStreams:n},o),f._setSettings(o),f},"PUBLIC").setMultipleInstances(!0)),zi(h_,d_,e),zi(h_,d_,"esm2017")})();var BD="firebase",UD="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi(BD,UD,"app");const jD=(t,e)=>e.some(n=>t instanceof n);let p2,g2;function zD(){return p2||(p2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HD(){return g2||(g2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const _w=new WeakMap,Kp=new WeakMap,Ew=new WeakMap,dp=new WeakMap,Jg=new WeakMap;function GD(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{n(xs(t.result)),a()},u=()=>{r(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&_w.set(n,t)}).catch(()=>{}),Jg.set(e,t),e}function qD(t){if(Kp.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{n(),a()},u=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});Kp.set(t,e)}let Qp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Kp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||Ew.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return xs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $D(t){Qp=t(Qp)}function YD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(mp(this),e,...n);return Ew.set(r,e.sort?e.sort():[e]),xs(r)}:HD().includes(t)?function(...e){return t.apply(mp(this),e),xs(_w.get(this))}:function(...e){return xs(t.apply(mp(this),e))}}function XD(t){return typeof t=="function"?YD(t):(t instanceof IDBTransaction&&qD(t),jD(t,zD())?new Proxy(t,Qp):t)}function xs(t){if(t instanceof IDBRequest)return GD(t);if(dp.has(t))return dp.get(t);const e=XD(t);return e!==t&&(dp.set(t,e),Jg.set(e,t)),e}const mp=t=>Jg.get(t);function WD(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const u=indexedDB.open(t,e),f=xs(u);return r&&u.addEventListener("upgradeneeded",d=>{r(xs(u.result),d.oldVersion,d.newVersion,xs(u.transaction),d)}),n&&u.addEventListener("blocked",d=>n(d.oldVersion,d.newVersion,d)),f.then(d=>{o&&d.addEventListener("close",()=>o()),a&&d.addEventListener("versionchange",h=>a(h.oldVersion,h.newVersion,h))}).catch(()=>{}),f}const KD=["get","getKey","getAll","getAllKeys","count"],QD=["put","add","delete","clear"],pp=new Map;function v2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(pp.get(e))return pp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=QD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||KD.includes(n)))return;const o=async function(u,...f){const d=this.transaction(u,a?"readwrite":"readonly");let h=d.store;return r&&(h=h.index(f.shift())),(await Promise.all([h[n](...f),a&&d.done]))[0]};return pp.set(e,o),o}$D(t=>({...t,get:(e,n,r)=>v2(e,n)||t.get(e,n,r),has:(e,n)=>!!v2(e,n)||t.has(e,n)}));const Tw="@firebase/installations",e1="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ww=1e4,Aw=`w:${e1}`,Sw="FIS_v2",ZD="https://firebaseinstallations.googleapis.com/v1",JD=60*60*1e3,e6="installations",t6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},Ao=new C0(e6,t6,n6);function bw(t){return t instanceof ks&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cw({projectId:t}){return`${ZD}/projects/${t}/installations`}function Rw(t){return{token:t.token,requestStatus:2,expiresIn:i6(t.expiresIn),creationTime:Date.now()}}async function Nw(t,e){const r=(await e.json()).error;return Ao.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Iw({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function r6(t,{refreshToken:e}){const n=Iw(t);return n.append("Authorization",a6(e)),n}async function Dw(t){const e=await t();return e.status>=500&&e.status<600?t():e}function i6(t){return Number(t.replace("s","000"))}function a6(t){return`${Sw} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s6({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=Cw(t),a=Iw(t),o=e.getImmediate({optional:!0});if(o){const h=await o.getHeartbeatsHeader();h&&a.append("x-firebase-client",h)}const u={fid:n,authVersion:Sw,appId:t.appId,sdkVersion:Aw},f={method:"POST",headers:a,body:JSON.stringify(u)},d=await Dw(()=>fetch(r,f));if(d.ok){const h=await d.json();return{fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:Rw(h.authToken)}}else throw await Nw("Create Installation",d)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ow(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6=/^[cdef][\w-]{21}$/,Zp="";function u6(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=c6(t);return l6.test(n)?n:Zp}catch{return Zp}}function c6(t){return o6(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function G0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Fw=new Map;function Mw(t,e){const n=G0(t);Pw(n,e),f6(n,e)}function Pw(t,e){const n=Fw.get(t);if(n)for(const r of n)r(e)}function f6(t,e){const n=h6();n&&n.postMessage({key:t,fid:e}),d6()}let vo=null;function h6(){return!vo&&"BroadcastChannel"in self&&(vo=new BroadcastChannel("[Firebase] FID Change"),vo.onmessage=t=>{Pw(t.data.key,t.data.fid)}),vo}function d6(){Fw.size===0&&vo&&(vo.close(),vo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6="firebase-installations-database",p6=1,So="firebase-installations-store";let gp=null;function t1(){return gp||(gp=WD(m6,p6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(So)}}})),gp}async function s0(t,e){const n=G0(t),a=(await t1()).transaction(So,"readwrite"),o=a.objectStore(So),u=await o.get(n);return await o.put(e,n),await a.done,(!u||u.fid!==e.fid)&&Mw(t,e.fid),e}async function kw(t){const e=G0(t),r=(await t1()).transaction(So,"readwrite");await r.objectStore(So).delete(e),await r.done}async function q0(t,e){const n=G0(t),a=(await t1()).transaction(So,"readwrite"),o=a.objectStore(So),u=await o.get(n),f=e(u);return f===void 0?await o.delete(n):await o.put(f,n),await a.done,f&&(!u||u.fid!==f.fid)&&Mw(t,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function n1(t){let e;const n=await q0(t.appConfig,r=>{const a=g6(r),o=v6(t,a);return e=o.registrationPromise,o.installationEntry});return n.fid===Zp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function g6(t){const e=t||{fid:u6(),registrationStatus:0};return Lw(e)}function v6(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(Ao.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=x6(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:y6(t)}:{installationEntry:e}}async function x6(t,e){try{const n=await s6(t,e);return s0(t.appConfig,n)}catch(n){throw bw(n)&&n.customData.serverCode===409?await kw(t.appConfig):await s0(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function y6(t){let e=await x2(t.appConfig);for(;e.registrationStatus===1;)await Ow(100),e=await x2(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await n1(t);return r||n}return e}function x2(t){return q0(t,e=>{if(!e)throw Ao.create("installation-not-found");return Lw(e)})}function Lw(t){return _6(t)?{fid:t.fid,registrationStatus:0}:t}function _6(t){return t.registrationStatus===1&&t.registrationTime+ww<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6({appConfig:t,heartbeatServiceProvider:e},n){const r=T6(t,n),a=r6(t,n),o=e.getImmediate({optional:!0});if(o){const h=await o.getHeartbeatsHeader();h&&a.append("x-firebase-client",h)}const u={installation:{sdkVersion:Aw,appId:t.appId}},f={method:"POST",headers:a,body:JSON.stringify(u)},d=await Dw(()=>fetch(r,f));if(d.ok){const h=await d.json();return Rw(h)}else throw await Nw("Generate Auth Token",d)}function T6(t,{fid:e}){return`${Cw(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function r1(t,e=!1){let n;const r=await q0(t.appConfig,o=>{if(!Vw(o))throw Ao.create("not-registered");const u=o.authToken;if(!e&&S6(u))return o;if(u.requestStatus===1)return n=w6(t,e),o;{if(!navigator.onLine)throw Ao.create("app-offline");const f=C6(o);return n=A6(t,f),f}});return n?await n:r.authToken}async function w6(t,e){let n=await y2(t.appConfig);for(;n.authToken.requestStatus===1;)await Ow(100),n=await y2(t.appConfig);const r=n.authToken;return r.requestStatus===0?r1(t,e):r}function y2(t){return q0(t,e=>{if(!Vw(e))throw Ao.create("not-registered");const n=e.authToken;return R6(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function A6(t,e){try{const n=await E6(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await s0(t.appConfig,r),n}catch(n){if(bw(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await kw(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await s0(t.appConfig,r)}throw n}}function Vw(t){return t!==void 0&&t.registrationStatus===2}function S6(t){return t.requestStatus===2&&!b6(t)}function b6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+JD}function C6(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function R6(t){return t.requestStatus===1&&t.requestTime+ww<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(t){const e=t,{installationEntry:n,registrationPromise:r}=await n1(e);return r?r.catch(console.error):r1(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I6(t,e=!1){const n=t;return await D6(n),(await r1(n,e)).token}async function D6(t){const{registrationPromise:e}=await n1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O6(t){if(!t||!t.options)throw vp("App Configuration");if(!t.name)throw vp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw vp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function vp(t){return Ao.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bw="installations",F6="installations-internal",M6=t=>{const e=t.getProvider("app").getImmediate(),n=O6(e),r=dg(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},P6=t=>{const e=t.getProvider("app").getImmediate(),n=dg(e,Bw).getImmediate();return{getId:()=>N6(n),getToken:a=>I6(n,a)}};function k6(){Es(new Ra(Bw,M6,"PUBLIC")),Es(new Ra(F6,P6,"PRIVATE"))}k6();zi(Tw,e1);zi(Tw,e1,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _2="analytics",L6="firebase_id",V6="origin",B6=60*1e3,U6="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",i1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new fg("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ri=new C0("analytics","Analytics",j6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z6(t){if(!t.startsWith(i1)){const e=ri.create("invalid-gtag-resource",{gtagURL:t});return wr.warn(e.message),""}return t}function Uw(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function H6(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function G6(t,e){const n=H6("firebase-js-sdk-policy",{createScriptURL:z6}),r=document.createElement("script"),a=`${i1}?l=${t}&id=${e}`;r.src=n?n?.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function q6(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function $6(t,e,n,r,a,o){const u=r[a];try{if(u)await e[u];else{const d=(await Uw(n)).find(h=>h.measurementId===a);d&&await e[d.appId]}}catch(f){wr.error(f)}t("config",a,o)}async function Y6(t,e,n,r,a){try{let o=[];if(a&&a.send_to){let u=a.send_to;Array.isArray(u)||(u=[u]);const f=await Uw(n);for(const d of u){const h=f.find(y=>y.measurementId===d),g=h&&e[h.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),t("event",r,a||{})}catch(o){wr.error(o)}}function X6(t,e,n,r){async function a(o,...u){try{if(o==="event"){const[f,d]=u;await Y6(t,e,n,f,d)}else if(o==="config"){const[f,d]=u;await $6(t,e,n,r,f,d)}else if(o==="consent"){const[f,d]=u;t("consent",f,d)}else if(o==="get"){const[f,d,h]=u;t("get",f,d,h)}else if(o==="set"){const[f]=u;t("set",f)}else t(o,...u)}catch(f){wr.error(f)}}return a}function W6(t,e,n,r,a){let o=function(...u){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(o=window[a]),window[a]=X6(o,t,e,n),{gtagCore:o,wrappedGtag:window[a]}}function K6(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(i1)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=30,Z6=1e3;class J6{constructor(e={},n=Z6){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const jw=new J6;function eO(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function tO(t){var e;const{appId:n,apiKey:r}=t,a={method:"GET",headers:eO(r)},o=U6.replace("{app-id}",n),u=await fetch(o,a);if(u.status!==200&&u.status!==304){let f="";try{const d=await u.json();!((e=d.error)===null||e===void 0)&&e.message&&(f=d.error.message)}catch{}throw ri.create("config-fetch-failed",{httpStatus:u.status,responseMessage:f})}return u.json()}async function nO(t,e=jw,n){const{appId:r,apiKey:a,measurementId:o}=t.options;if(!r)throw ri.create("no-app-id");if(!a){if(o)return{measurementId:o,appId:r};throw ri.create("no-api-key")}const u=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new aO;return setTimeout(async()=>{f.abort()},B6),zw({appId:r,apiKey:a,measurementId:o},u,f,e)}async function zw(t,{throttleEndTimeMillis:e,backoffCount:n},r,a=jw){var o;const{appId:u,measurementId:f}=t;try{await rO(r,e)}catch(d){if(f)return wr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${d?.message}]`),{appId:u,measurementId:f};throw d}try{const d=await tO(t);return a.deleteThrottleMetadata(u),d}catch(d){const h=d;if(!iO(h)){if(a.deleteThrottleMetadata(u),f)return wr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:u,measurementId:f};throw d}const g=Number((o=h?.customData)===null||o===void 0?void 0:o.httpStatus)===503?n_(n,a.intervalMillis,Q6):n_(n,a.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:n+1};return a.setThrottleMetadata(u,y),wr.debug(`Calling attemptFetch again in ${g} millis`),zw(t,y,r,a)}}function rO(t,e){return new Promise((n,r)=>{const a=Math.max(e-Date.now(),0),o=setTimeout(n,a);t.addEventListener(()=>{clearTimeout(o),r(ri.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function iO(t){if(!(t instanceof ks)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class aO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function sO(t,e,n,r,a){if(a&&a.global){t("event",n,r);return}else{const o=await e,u=Object.assign(Object.assign({},r),{send_to:o});t("event",n,u)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(){if(ME())try{await PE()}catch(t){return wr.warn(ri.create("indexeddb-unavailable",{errorInfo:t?.toString()}).message),!1}else return wr.warn(ri.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function lO(t,e,n,r,a,o,u){var f;const d=nO(t);d.then(E=>{n[E.measurementId]=E.appId,t.options.measurementId&&E.measurementId!==t.options.measurementId&&wr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>wr.error(E)),e.push(d);const h=oO().then(E=>{if(E)return r.getId()}),[g,y]=await Promise.all([d,h]);K6(o)||G6(o,g.measurementId),a("js",new Date);const x=(f=u?.config)!==null&&f!==void 0?f:{};return x[V6]="firebase",x.update=!0,y!=null&&(x[L6]=y),a("config",g.measurementId,x),g.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.app=e}_delete(){return delete yc[this.app.options.appId],Promise.resolve()}}let yc={},E2=[];const T2={};let xp="dataLayer",cO="gtag",w2,Hw,A2=!1;function fO(){const t=[];if(sC()&&t.push("This is a browser extension environment."),lC()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,a)=>`(${a+1}) ${r}`).join(" "),n=ri.create("invalid-analytics-context",{errorInfo:e});wr.warn(n.message)}}function hO(t,e,n){fO();const r=t.options.appId;if(!r)throw ri.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ri.create("no-api-key");if(yc[r]!=null)throw ri.create("already-exists",{id:r});if(!A2){q6(xp);const{wrappedGtag:o,gtagCore:u}=W6(yc,E2,T2,xp,cO);Hw=o,w2=u,A2=!0}return yc[r]=lO(t,E2,T2,e,w2,xp,n),new uO(t)}function dO(t,e,n,r){t=_s(t),sO(Hw,yc[t.app.options.appId],e,n,r).catch(a=>wr.error(a))}const S2="@firebase/analytics",b2="0.10.17";function mO(){Es(new Ra(_2,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return hO(r,a,n)},"PUBLIC")),Es(new Ra("analytics-internal",t,"PRIVATE")),zi(S2,b2),zi(S2,b2,"esm2017");function t(e){try{const n=e.getProvider(_2).getImmediate();return{logEvent:(r,a,o)=>dO(n,r,a,o)}}catch(n){throw ri.create("interop-component-reg-failed",{reason:n})}}}mO();const pO={apiKey:"AIzaSyA0F9MlLg9H36F2FCiclvRDGSrLMV9_f8c",authDomain:"dra-invoice.firebaseapp.com",projectId:"dra-invoice",storageBucket:"dra-invoice.firebasestorage.app",messagingSenderId:"818739283601",appId:"1:818739283601:web:81bf9d917ba9feba76a130",measurementId:"G-Q6S6EQRF86"},gO=VE(pO),Xi=ED(gO);function Jc(){const t=Ps();return C.jsxs("nav",{className:"p-4 bg-yellow-600 text-white flex gap-4",children:[C.jsx(xo,{to:"/",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/"?"bg-gray-600":""}`,children:"Dashboard"}),C.jsx(xo,{to:"/create-new-invoice",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/create-new-invoice"?"bg-gray-600":""}`,children:"Create New Invoice"}),C.jsx(xo,{to:"/brand-invoice",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/brand-invoice"?"bg-gray-600":""}`,children:"Brand Invoice"})]})}const Ds=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],n=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const a=u=>{let f="";if(u>=100&&(f+=e[Math.floor(u/100)]+" Hundred ",u%=100),u>=20)f+=r[Math.floor(u/10)]+" ",u%=10;else if(u>=10)return f+=n[u-10]+" ",f;return u>0&&(f+=e[u]+" "),f};let o="";return t>=1e7&&(o+=a(Math.floor(t/1e7))+"Crore ",t%=1e7),t>=1e5&&(o+=a(Math.floor(t/1e5))+"Lakh ",t%=1e5),t>=1e3&&(o+=a(Math.floor(t/1e3))+"Thousand ",t%=1e3),t>0&&(o+=a(t)),o.trim()};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var o0={};o0.version="0.18.5";var Gw=1252,vO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],qw=function(t){vO.indexOf(t)!=-1&&(Gw=t)};function xO(){qw(1252)}var Pc=function(t){qw(t)};function yO(){Pc(1200),xO()}var Rh=function(e){return String.fromCharCode(e)},C2=function(e){return String.fromCharCode(e)},l0,hs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kc(t){for(var e="",n=0,r=0,a=0,o=0,u=0,f=0,d=0,h=0;h<t.length;)n=t.charCodeAt(h++),o=n>>2,r=t.charCodeAt(h++),u=(n&3)<<4|r>>4,a=t.charCodeAt(h++),f=(r&15)<<2|a>>6,d=a&63,isNaN(r)?f=d=64:isNaN(a)&&(d=64),e+=hs.charAt(o)+hs.charAt(u)+hs.charAt(f)+hs.charAt(d);return e}function Oa(t){var e="",n=0,r=0,a=0,o=0,u=0,f=0,d=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)o=hs.indexOf(t.charAt(h++)),u=hs.indexOf(t.charAt(h++)),n=o<<2|u>>4,e+=String.fromCharCode(n),f=hs.indexOf(t.charAt(h++)),r=(u&15)<<4|f>>2,f!==64&&(e+=String.fromCharCode(r)),d=hs.indexOf(t.charAt(h++)),a=(f&3)<<6|d,d!==64&&(e+=String.fromCharCode(a));return e}var St=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Pa=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function bo(t){return St?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function R2(t){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var di=function(e){return St?Pa(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function $0(t){if(typeof ArrayBuffer>"u")return di(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function ef(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function _O(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Gn=St?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Pa(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function EO(t){for(var e=[],n=0,r=t.length+250,a=bo(t.length+255),o=0;o<t.length;++o){var u=t.charCodeAt(o);if(u<128)a[n++]=u;else if(u<2048)a[n++]=192|u>>6&31,a[n++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var f=t.charCodeAt(++o)&1023;a[n++]=240|u>>8&7,a[n++]=128|u>>2&63,a[n++]=128|f>>6&15|(u&3)<<4,a[n++]=128|f&63}else a[n++]=224|u>>12&15,a[n++]=128|u>>6&63,a[n++]=128|u&63;n>r&&(e.push(a.slice(0,n)),n=0,a=bo(65535),r=65530)}return e.push(a.slice(0,n)),Gn(e)}var _c=/\u0000/g,Nh=/[\u0001-\u0006]/g;function Ul(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function pi(t,e){var n=""+t;return n.length>=e?n:nn("0",e-n.length)+n}function a1(t,e){var n=""+t;return n.length>=e?n:nn(" ",e-n.length)+n}function u0(t,e){var n=""+t;return n.length>=e?n:n+nn(" ",e-n.length)}function TO(t,e){var n=""+Math.round(t);return n.length>=e?n:nn("0",e-n.length)+n}function wO(t,e){var n=""+t;return n.length>=e?n:nn("0",e-n.length)+n}var N2=Math.pow(2,32);function Cl(t,e){if(t>N2||t<-N2)return TO(t,e);var n=Math.round(t);return wO(n,e)}function c0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var I2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],yp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var rn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},D2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function f0(t,e,n){for(var r=t<0?-1:1,a=t*r,o=0,u=1,f=0,d=1,h=0,g=0,y=Math.floor(a);h<e&&(y=Math.floor(a),f=y*u+o,g=y*h+d,!(a-y<5e-8));)a=1/(a-y),o=u,u=f,d=h,h=g;if(g>e&&(h>e?(g=d,f=o):(g=h,f=u)),!n)return[0,r*f,g];var x=Math.floor(r*f/g);return[x,r*f-x*g,g]}function Ih(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),o=0,u=[],f={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),e&&e.date1904&&(r+=1462),f.u>.9999&&(f.u=0,++a==86400&&(f.T=a=0,++r,++f.D)),r===60)u=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)u=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var d=new Date(1900,0,1);d.setDate(d.getDate()+r-1),u=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),r<60&&(o=(o+6)%7),n&&(o=OO(d,u))}return f.y=u[0],f.m=u[1],f.d=u[2],f.S=a%60,a=Math.floor(a/60),f.M=a%60,a=Math.floor(a/60),f.H=a,f.q=o,f}var $w=new Date(1899,11,31,0,0,0),bO=$w.getTime(),CO=new Date(1900,2,1,0,0,0);function Yw(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=CO&&(n+=24*60*60*1e3),(n-(bO+(t.getTimezoneOffset()-$w.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function s1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function RO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function NO(t){var e=t<0?12:11,n=s1(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function IO(t){var e=s1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function DO(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=NO(t):e===10?n=t.toFixed(10).substr(0,12):n=IO(t),s1(RO(n.toUpperCase()))}function Jp(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):DO(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Os(14,Yw(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function OO(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function FO(t,e,n,r){var a="",o=0,u=0,f=n.y,d,h=0;switch(t){case 98:f=n.y+543;case 121:switch(e.length){case 1:case 2:d=f%100,h=2;break;default:d=f%1e4,h=4;break}break;case 109:switch(e.length){case 1:case 2:d=n.m,h=e.length;break;case 3:return yp[n.m-1][1];case 5:return yp[n.m-1][0];default:return yp[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=n.d,h=e.length;break;case 3:return I2[n.q][0];default:return I2[n.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(n.H+11)%12,h=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=n.H,h=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=n.M,h=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?pi(n.S,e.length):(r>=2?u=r===3?1e3:100:u=r===1?10:1,o=Math.round(u*(n.S+n.u)),o>=60*u&&(o=0),e==="s"?o===0?"0":""+o/u:(a=pi(o,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=n.D*24+n.H;break;case"[m]":case"[mm]":d=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":d=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}h=e.length===3?1:2;break;case 101:d=f,h=1;break}var g=h>0?pi(d,h):"";return g}function ds(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var Xw=/%/g;function MO(t,e,n){var r=e.replace(Xw,""),a=e.length-r.length;return Aa(t,r,n*Math.pow(10,2*a))+nn("%",a)}function PO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Aa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function Ww(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Ww(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(e/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),n.indexOf("e")===-1){var u=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(u-n.length+o):n+="E+"+(u-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,g){return d+h+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Kw=/# (\?+)( ?)\/( ?)(\d+)/;function kO(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),o=Math.floor(a/r),u=a-o*r,f=r;return n+(o===0?"":""+o)+" "+(u===0?nn(" ",t[1].length+1+t[4].length):a1(u,t[1].length)+t[2]+"/"+t[3]+pi(f,t[4].length))}function LO(t,e,n){return n+(e===0?"":""+e)+nn(" ",t[1].length+2+t[4].length)}var Qw=/^#*0*\.([0#]+)/,Zw=/\).*[0#]/,Jw=/\(###\) ###\\?-####/;function fr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function O2(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function F2(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function VO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function BO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Jr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Zw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Jr("n",r,n):"("+Jr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return PO(t,e,n);if(e.indexOf("%")!==-1)return MO(t,e,n);if(e.indexOf("E")!==-1)return Ww(e,n);if(e.charCodeAt(0)===36)return"$"+Jr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,o,u,f,d=Math.abs(n),h=n<0?"-":"";if(e.match(/^00+$/))return h+Cl(d,e.length);if(e.match(/^[#?]+$/))return a=Cl(n,0),a==="0"&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(Kw))return kO(o,d,h);if(e.match(/^#+0+$/))return h+Cl(d,e.length-e.indexOf("0"));if(o=e.match(Qw))return a=O2(n,o[1].length).replace(/^([^\.]+)$/,"$1."+fr(o[1])).replace(/\.$/,"."+fr(o[1])).replace(/\.(\d*)$/,function(w,T){return"."+T+nn("0",fr(o[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return h+O2(d,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return h+ds(Cl(d,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Jr(t,e,-n):ds(""+(Math.floor(n)+VO(n,o[1].length)))+"."+pi(F2(n,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Jr(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ul(Jr(t,e.replace(/[\\-]/g,""),n)),u=0,Ul(Ul(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<a.length?a.charAt(u++):w==="0"?"0":""}));if(e.match(Jw))return a=Jr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),f=f0(d,Math.pow(10,u)-1,!1),a=""+h,g=Aa("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=u0(f[2],u),g.length<o[4].length&&(g=fr(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),f=f0(d,Math.pow(10,u)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?a1(f[1],u)+o[2]+"/"+o[3]+u0(f[2],u):nn(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=Cl(n,0),e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=a.indexOf(".");var y=e.indexOf(".")-u,x=e.length-a.length-y;return fr(e.substr(0,y)+a+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return u=F2(n,o[1].length),n<0?"-"+Jr(t,e,-n):ds(BO(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pi(0,3-w.length):"")+w})+"."+pi(u,o[1].length);switch(e){case"###,##0.00":return Jr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var E=ds(Cl(d,0));return E!=="0"?h+E:"";case"###,###.00":return Jr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Jr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function UO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return Aa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function jO(t,e,n){var r=e.replace(Xw,""),a=e.length-r.length;return Aa(t,r,n*Math.pow(10,2*a))+nn("%",a)}function eA(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+eA(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(e/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!n.match(/[Ee]/)){var u=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(u-n.length+o):n+="E+"+(u-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,d,h,g){return d+h+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bi(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Zw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bi("n",r,n):"("+Bi("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return UO(t,e,n);if(e.indexOf("%")!==-1)return jO(t,e,n);if(e.indexOf("E")!==-1)return eA(e,n);if(e.charCodeAt(0)===36)return"$"+Bi(t,e.substr(e.charAt(1)==" "?2:1),n);var a,o,u,f,d=Math.abs(n),h=n<0?"-":"";if(e.match(/^00+$/))return h+pi(d,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(Kw))return LO(o,d,h);if(e.match(/^#+0+$/))return h+pi(d,e.length-e.indexOf("0"));if(o=e.match(Qw))return a=(""+n).replace(/^([^\.]+)$/,"$1."+fr(o[1])).replace(/\.$/,"."+fr(o[1])),a=a.replace(/\.(\d*)$/,function(w,T){return"."+T+nn("0",fr(o[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return h+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return h+ds(""+d);if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bi(t,e,-n):ds(""+n)+"."+nn("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Bi(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Ul(Bi(t,e.replace(/[\\-]/g,""),n)),u=0,Ul(Ul(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<a.length?a.charAt(u++):w==="0"?"0":""}));if(e.match(Jw))return a=Bi(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),f=f0(d,Math.pow(10,u)-1,!1),a=""+h,g=Aa("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=u0(f[2],u),g.length<o[4].length&&(g=fr(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),f=f0(d,Math.pow(10,u)-1,!0),h+(f[0]||(f[1]?"":"0"))+" "+(f[1]?a1(f[1],u)+o[2]+"/"+o[3]+u0(f[2],u):nn(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=a.indexOf(".");var y=e.indexOf(".")-u,x=e.length-a.length-y;return fr(e.substr(0,y)+a+e.substr(e.length-x))}if(o=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bi(t,e,-n):ds(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pi(0,3-w.length):"")+w})+"."+pi(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=ds(""+d);return E!=="0"?h+E:"";default:if(e.match(/\.[0#?]*$/))return Bi(t,e.slice(0,e.lastIndexOf(".")),n)+fr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Aa(t,e,n){return(n|0)===n?Bi(t,e,n):Jr(t,e,n)}function zO(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var tA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function nA(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":c0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(tA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function HO(t,e,n,r){for(var a=[],o="",u=0,f="",d="t",h,g,y,x="H";u<t.length;)switch(f=t.charAt(u)){case"G":if(!c0(t,u))throw new Error("unrecognized character "+f+" in "+t);a[a.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(y=t.charCodeAt(++u))!==34&&u<t.length;)o+=String.fromCharCode(y);a[a.length]={t:"t",v:o},++u;break;case"\\":var E=t.charAt(++u),w=E==="("||E===")"?E:"t";a[a.length]={t:w,v:E},++u;break;case"_":a[a.length]={t:"t",v:" "},u+=2;break;case"@":a[a.length]={t:"T",v:e},++u;break;case"B":case"b":if(t.charAt(u+1)==="1"||t.charAt(u+1)==="2"){if(h==null&&(h=Ih(e,n,t.charAt(u+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(u,2)},d=f,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||h==null&&(h=Ih(e,n),h==null))return"";for(o=f;++u<t.length&&t.charAt(u).toLowerCase()===f;)o+=f;f==="m"&&d.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=x),a[a.length]={t:f,v:o},d=f;break;case"A":case"a":case"":var T={t:f,v:f};if(h==null&&(h=Ih(e,n)),t.substr(u,3).toUpperCase()==="A/P"?(h!=null&&(T.v=h.H>=12?"P":"A"),T.t="T",x="h",u+=3):t.substr(u,5).toUpperCase()==="AM/PM"?(h!=null&&(T.v=h.H>=12?"PM":"AM"),T.t="T",u+=5,x="h"):t.substr(u,5).toUpperCase()==="/"?(h!=null&&(T.v=h.H>=12?"":""),T.t="T",u+=5,x="h"):(T.t="t",++u),h==null&&T.t==="T")return"";a[a.length]=T,d=f;break;case"[":for(o=f;t.charAt(u++)!=="]"&&u<t.length;)o+=t.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(tA)){if(h==null&&(h=Ih(e,n),h==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},d=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",nA(t)||(a[a.length]={t:"t",v:o}));break;case".":if(h!=null){for(o=f;++u<t.length&&(f=t.charAt(u))==="0";)o+=f;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=f;++u<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(u))>-1;)o+=f;a[a.length]={t:"n",v:o};break;case"?":for(o=f;t.charAt(++u)===f;)o+=f;a[a.length]={t:f,v:o},d=f;break;case"*":++u,(t.charAt(u)==" "||t.charAt(u)=="*")&&++u;break;case"(":case")":a[a.length]={t:r===1?"t":f,v:f},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=f;u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1;)o+=t.charAt(u);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:f,v:f},++u;break;case"$":a[a.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+t);a[a.length]={t:"t",v:f},++u;break}var b=0,k=0,q;for(u=a.length-1,d="t";u>=0;--u)switch(a[u].t){case"h":case"H":a[u].t=x,d="h",b<1&&(b=1);break;case"s":(q=a[u].v.match(/\.0+$/))&&(k=Math.max(k,q[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":d=a[u].t;break;case"m":d==="s"&&(a[u].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[u].v.match(/[Hh]/)&&(b=1),b<2&&a[u].v.match(/[Mm]/)&&(b=2),b<3&&a[u].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var Y="",ee;for(u=0;u<a.length;++u)switch(a[u].t){case"t":case"T":case" ":case"D":break;case"X":a[u].v="",a[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[u].v=FO(a[u].t.charCodeAt(0),a[u].v,h,k),a[u].t="t";break;case"n":case"?":for(ee=u+1;a[ee]!=null&&((f=a[ee].t)==="?"||f==="D"||(f===" "||f==="t")&&a[ee+1]!=null&&(a[ee+1].t==="?"||a[ee+1].t==="t"&&a[ee+1].v==="/")||a[u].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(a[ee].v==="/"||a[ee].v===" "&&a[ee+1]!=null&&a[ee+1].t=="?"));)a[u].v+=a[ee].v,a[ee]={v:"",t:";"},++ee;Y+=a[u].v,u=ee-1;break;case"G":a[u].t="t",a[u].v=Jp(e,n);break}var he="",Ae,D;if(Y.length>0){Y.charCodeAt(0)==40?(Ae=e<0&&Y.charCodeAt(0)===45?-e:e,D=Aa("n",Y,Ae)):(Ae=e<0&&r>1?-e:e,D=Aa("n",Y,Ae),Ae<0&&a[0]&&a[0].t=="t"&&(D=D.substr(1),a[0].v="-"+a[0].v)),ee=D.length-1;var I=a.length;for(u=0;u<a.length;++u)if(a[u]!=null&&a[u].t!="t"&&a[u].v.indexOf(".")>-1){I=u;break}var R=a.length;if(I===a.length&&D.indexOf("E")===-1){for(u=a.length-1;u>=0;--u)a[u]==null||"n?".indexOf(a[u].t)===-1||(ee>=a[u].v.length-1?(ee-=a[u].v.length,a[u].v=D.substr(ee+1,a[u].v.length)):ee<0?a[u].v="":(a[u].v=D.substr(0,ee+1),ee=-1),a[u].t="t",R=u);ee>=0&&R<a.length&&(a[R].v=D.substr(0,ee+1)+a[R].v)}else if(I!==a.length&&D.indexOf("E")===-1){for(ee=D.indexOf(".")-1,u=I;u>=0;--u)if(!(a[u]==null||"n?".indexOf(a[u].t)===-1)){for(g=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")-1:a[u].v.length-1,he=a[u].v.substr(g+1);g>=0;--g)ee>=0&&(a[u].v.charAt(g)==="0"||a[u].v.charAt(g)==="#")&&(he=D.charAt(ee--)+he);a[u].v=he,a[u].t="t",R=u}for(ee>=0&&R<a.length&&(a[R].v=D.substr(0,ee+1)+a[R].v),ee=D.indexOf(".")+1,u=I;u<a.length;++u)if(!(a[u]==null||"n?(".indexOf(a[u].t)===-1&&u!==I)){for(g=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")+1:0,he=a[u].v.substr(0,g);g<a[u].v.length;++g)ee<D.length&&(he+=D.charAt(ee++));a[u].v=he,a[u].t="t",R=u}}}for(u=0;u<a.length;++u)a[u]!=null&&"n?".indexOf(a[u].t)>-1&&(Ae=r>1&&e<0&&u>0&&a[u-1].v==="-"?-e:e,a[u].v=Aa(a[u].t,a[u].v,Ae),a[u].t="t");var P="";for(u=0;u!==a.length;++u)a[u]!=null&&(P+=a[u].v);return P}var M2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function P2(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function GO(t,e){var n=zO(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var o=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var u=n[0].match(M2),f=n[1].match(M2);return P2(e,u)?[r,n[0]]:P2(e,f)?[r,n[1]]:[r,n[u!=null&&f!=null?2:1]]}return[r,o]}function Os(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:rn)[t],r==null&&(r=n.table&&n.table[D2[t]]||rn[D2[t]]),r==null&&(r=SO[t]||"General");break}if(c0(r,0))return Jp(e,n);e instanceof Date&&(e=Yw(e,n.date1904));var a=GO(r,e);if(c0(a[1]))return Jp(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return HO(a[1],e,n,a[0])}function rA(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(rn[n]==null){e<0&&(e=n);continue}if(rn[n]==t){e=n;break}}e<0&&(e=391)}return rn[e]=t,e}function Y0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&rA(t[e],e)}function X0(){rn=AO()}var iA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qO(t){var e=typeof t=="number"?rn[t]:t;return e=e.replace(iA,"(\\d+)"),new RegExp("^"+e+"$")}function $O(t,e,n){var r=-1,a=-1,o=-1,u=-1,f=-1,d=-1;(e.match(iA)||[]).forEach(function(y,x){var E=parseInt(n[x+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=E;break;case"d":o=E;break;case"h":u=E;break;case"s":d=E;break;case"m":u>=0?f=E:a=E;break}}),d>=0&&f==-1&&a>=0&&(f=a,a=-1);var h=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var g=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return u==-1&&f==-1&&d==-1?h:r==-1&&a==-1&&o==-1?g:h+"T"+g}var YO=function(){var t={};t.version="1.2.0";function e(){for(var D=0,I=new Array(256),R=0;R!=256;++R)D=R,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,D=D&1?-306674912^D>>>1:D>>>1,I[R]=D;return typeof Int32Array<"u"?new Int32Array(I):I}var n=e();function r(D){var I=0,R=0,P=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)B[P]=D[P];for(P=0;P!=256;++P)for(R=D[P],I=256+P;I<4096;I+=256)R=B[I]=R>>>8^D[R&255];var H=[];for(P=1;P!=16;++P)H[P-1]=typeof Int32Array<"u"?B.subarray(P*256,P*256+256):B.slice(P*256,P*256+256);return H}var a=r(n),o=a[0],u=a[1],f=a[2],d=a[3],h=a[4],g=a[5],y=a[6],x=a[7],E=a[8],w=a[9],T=a[10],b=a[11],k=a[12],q=a[13],Y=a[14];function ee(D,I){for(var R=I^-1,P=0,B=D.length;P<B;)R=R>>>8^n[(R^D.charCodeAt(P++))&255];return~R}function he(D,I){for(var R=I^-1,P=D.length-15,B=0;B<P;)R=Y[D[B++]^R&255]^q[D[B++]^R>>8&255]^k[D[B++]^R>>16&255]^b[D[B++]^R>>>24]^T[D[B++]]^w[D[B++]]^E[D[B++]]^x[D[B++]]^y[D[B++]]^g[D[B++]]^h[D[B++]]^d[D[B++]]^f[D[B++]]^u[D[B++]]^o[D[B++]]^n[D[B++]];for(P+=15;B<P;)R=R>>>8^n[(R^D[B++])&255];return~R}function Ae(D,I){for(var R=I^-1,P=0,B=D.length,H=0,V=0;P<B;)H=D.charCodeAt(P++),H<128?R=R>>>8^n[(R^H)&255]:H<2048?(R=R>>>8^n[(R^(192|H>>6&31))&255],R=R>>>8^n[(R^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,V=D.charCodeAt(P++)&1023,R=R>>>8^n[(R^(240|H>>8&7))&255],R=R>>>8^n[(R^(128|H>>2&63))&255],R=R>>>8^n[(R^(128|V>>6&15|(H&3)<<4))&255],R=R>>>8^n[(R^(128|V&63))&255]):(R=R>>>8^n[(R^(224|H>>12&15))&255],R=R>>>8^n[(R^(128|H>>6&63))&255],R=R>>>8^n[(R^(128|H&63))&255]);return~R}return t.table=n,t.bstr=ee,t.buf=he,t.str=Ae,t}(),Vt=function(){var e={};e.version="1.2.1";function n(N,z){for(var M=N.split("/"),L=z.split("/"),j=0,G=0,ae=Math.min(M.length,L.length);j<ae;++j){if(G=M[j].length-L[j].length)return G;if(M[j]!=L[j])return M[j]<L[j]?-1:1}return M.length-L.length}function r(N){if(N.charAt(N.length-1)=="/")return N.slice(0,-1).indexOf("/")===-1?N:r(N.slice(0,-1));var z=N.lastIndexOf("/");return z===-1?N:N.slice(0,z+1)}function a(N){if(N.charAt(N.length-1)=="/")return a(N.slice(0,-1));var z=N.lastIndexOf("/");return z===-1?N:N.slice(z+1)}function o(N,z){typeof z=="string"&&(z=new Date(z));var M=z.getHours();M=M<<6|z.getMinutes(),M=M<<5|z.getSeconds()>>>1,N.write_shift(2,M);var L=z.getFullYear()-1980;L=L<<4|z.getMonth()+1,L=L<<5|z.getDate(),N.write_shift(2,L)}function u(N){var z=N.read_shift(2)&65535,M=N.read_shift(2)&65535,L=new Date,j=M&31;M>>>=5;var G=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(G-1),L.setDate(j);var ae=z&31;z>>>=5;var me=z&63;return z>>>=6,L.setHours(z),L.setMinutes(me),L.setSeconds(ae<<1),L}function f(N){Lr(N,0);for(var z={},M=0;N.l<=N.length-4;){var L=N.read_shift(2),j=N.read_shift(2),G=N.l+j,ae={};switch(L){case 21589:M=N.read_shift(1),M&1&&(ae.mtime=N.read_shift(4)),j>5&&(M&2&&(ae.atime=N.read_shift(4)),M&4&&(ae.ctime=N.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}N.l=G,z[L]=ae}return z}var d;function h(){return d||(d={})}function g(N,z){if(N[0]==80&&N[1]==75)return Ba(N,z);if((N[0]|32)==109&&(N[1]|32)==105)return jo(N,z);if(N.length<512)throw new Error("CFB file size "+N.length+" < 512");var M=3,L=512,j=0,G=0,ae=0,me=0,ne=0,oe=[],le=N.slice(0,512);Lr(le,0);var be=y(le);switch(M=be[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(be[1]==0)return Ba(N,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(le=N.slice(0,L),Lr(le,28));var Ne=N.slice(0,L);x(le,M);var Ue=le.read_shift(4,"i");if(M===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),me=le.read_shift(4,"i"),j=le.read_shift(4,"i"),ne=le.read_shift(4,"i"),G=le.read_shift(4,"i");for(var Re=-1,Pe=0;Pe<109&&(Re=le.read_shift(4,"i"),!(Re<0));++Pe)oe[Pe]=Re;var Qe=E(N,L);b(ne,G,Qe,L,oe);var Et=q(Qe,ae,oe,L);Et[ae].name="!Directory",j>0&&me!==V&&(Et[me].name="!MiniFAT"),Et[oe[0]].name="!FAT",Et.fat_addrs=oe,Et.ssz=L;var dt={},mt=[],Cr=[],Si=[];Y(ae,Et,Qe,mt,j,dt,Cr,me),w(Cr,Si,mt),mt.shift();var sr={FileIndex:Cr,FullPaths:Si};return z&&z.raw&&(sr.raw={header:Ne,sectors:Qe}),sr}function y(N){if(N[N.l]==80&&N[N.l+1]==75)return[0,0];N.chk(Je,"Header Signature: "),N.l+=16;var z=N.read_shift(2,"u");return[N.read_shift(2,"u"),z]}function x(N,z){var M=9;switch(N.l+=2,M=N.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}N.chk("0600","Mini Sector Shift: "),N.chk("000000000000","Reserved: ")}function E(N,z){for(var M=Math.ceil(N.length/z)-1,L=[],j=1;j<M;++j)L[j-1]=N.slice(j*z,(j+1)*z);return L[M-1]=N.slice(M*z),L}function w(N,z,M){for(var L=0,j=0,G=0,ae=0,me=0,ne=M.length,oe=[],le=[];L<ne;++L)oe[L]=le[L]=L,z[L]=M[L];for(;me<le.length;++me)L=le[me],j=N[L].L,G=N[L].R,ae=N[L].C,oe[L]===L&&(j!==-1&&oe[j]!==j&&(oe[L]=oe[j]),G!==-1&&oe[G]!==G&&(oe[L]=oe[G])),ae!==-1&&(oe[ae]=L),j!==-1&&L!=oe[L]&&(oe[j]=oe[L],le.lastIndexOf(j)<me&&le.push(j)),G!==-1&&L!=oe[L]&&(oe[G]=oe[L],le.lastIndexOf(G)<me&&le.push(G));for(L=1;L<ne;++L)oe[L]===L&&(G!==-1&&oe[G]!==G?oe[L]=oe[G]:j!==-1&&oe[j]!==j&&(oe[L]=oe[j]));for(L=1;L<ne;++L)if(N[L].type!==0){if(me=L,me!=oe[me])do me=oe[me],z[L]=z[me]+"/"+z[L];while(me!==0&&oe[me]!==-1&&me!=oe[me]);oe[L]=-1}for(z[0]+="/",L=1;L<ne;++L)N[L].type!==2&&(z[L]+="/")}function T(N,z,M){for(var L=N.start,j=N.size,G=[],ae=L;M&&j>0&&ae>=0;)G.push(z.slice(ae*H,ae*H+H)),j-=H,ae=po(M,ae*4);return G.length===0?ge(0):Gn(G).slice(0,N.size)}function b(N,z,M,L,j){var G=V;if(N===V){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(N!==-1){var ae=M[N],me=(L>>>2)-1;if(!ae)return;for(var ne=0;ne<me&&(G=po(ae,ne*4))!==V;++ne)j.push(G);b(po(ae,L-4),z-1,M,L,j)}}function k(N,z,M,L,j){var G=[],ae=[];j||(j=[]);var me=L-1,ne=0,oe=0;for(ne=z;ne>=0;){j[ne]=!0,G[G.length]=ne,ae.push(N[ne]);var le=M[Math.floor(ne*4/L)];if(oe=ne*4&me,L<4+oe)throw new Error("FAT boundary crossed: "+ne+" 4 "+L);if(!N[le])break;ne=po(N[le],oe)}return{nodes:G,data:H2([ae])}}function q(N,z,M,L){var j=N.length,G=[],ae=[],me=[],ne=[],oe=L-1,le=0,be=0,Ne=0,Ue=0;for(le=0;le<j;++le)if(me=[],Ne=le+z,Ne>=j&&(Ne-=j),!ae[Ne]){ne=[];var Re=[];for(be=Ne;be>=0;){Re[be]=!0,ae[be]=!0,me[me.length]=be,ne.push(N[be]);var Pe=M[Math.floor(be*4/L)];if(Ue=be*4&oe,L<4+Ue)throw new Error("FAT boundary crossed: "+be+" 4 "+L);if(!N[Pe]||(be=po(N[Pe],Ue),Re[be]))break}G[Ne]={nodes:me,data:H2([ne])}}return G}function Y(N,z,M,L,j,G,ae,me){for(var ne=0,oe=L.length?2:0,le=z[N].data,be=0,Ne=0,Ue;be<le.length;be+=128){var Re=le.slice(be,be+128);Lr(Re,64),Ne=Re.read_shift(2),Ue=f1(Re,0,Ne-oe),L.push(Ue);var Pe={name:Ue,type:Re.read_shift(1),color:Re.read_shift(1),L:Re.read_shift(4,"i"),R:Re.read_shift(4,"i"),C:Re.read_shift(4,"i"),clsid:Re.read_shift(16),state:Re.read_shift(4,"i"),start:0,size:0},Qe=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Qe!==0&&(Pe.ct=ee(Re,Re.l-8));var Et=Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2)+Re.read_shift(2);Et!==0&&(Pe.mt=ee(Re,Re.l-8)),Pe.start=Re.read_shift(4,"i"),Pe.size=Re.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=V,Pe.name=""),Pe.type===5?(ne=Pe.start,j>0&&ne!==V&&(z[ne].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",z[Pe.start]===void 0&&(z[Pe.start]=k(M,Pe.start,z.fat_addrs,z.ssz)),z[Pe.start].name=Pe.name,Pe.content=z[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ne!==V&&Pe.start!==V&&z[ne]&&(Pe.content=T(Pe,z[ne].data,(z[me]||{}).data))),Pe.content&&Lr(Pe.content,0),G[Ue]=Pe,ae.push(Pe)}}function ee(N,z){return new Date((Br(N,z+4)/1e7*Math.pow(2,32)+Br(N,z)/1e7-11644473600)*1e3)}function he(N,z){return h(),g(d.readFileSync(N),z)}function Ae(N,z){var M=z&&z.type;switch(M||St&&Buffer.isBuffer(N)&&(M="buffer"),M||"base64"){case"file":return he(N,z);case"base64":return g(di(Oa(N)),z);case"binary":return g(di(N),z)}return g(N,z)}function D(N,z){var M=z||{},L=M.root||"Root Entry";if(N.FullPaths||(N.FullPaths=[]),N.FileIndex||(N.FileIndex=[]),N.FullPaths.length!==N.FileIndex.length)throw new Error("inconsistent CFB structure");N.FullPaths.length===0&&(N.FullPaths[0]=L+"/",N.FileIndex[0]={name:L,type:5}),M.CLSID&&(N.FileIndex[0].clsid=M.CLSID),I(N)}function I(N){var z="Sh33tJ5";if(!Vt.find(N,"/"+z)){var M=ge(4);M[0]=55,M[1]=M[3]=50,M[2]=54,N.FileIndex.push({name:z,type:2,content:M,size:4,L:69,R:69,C:69}),N.FullPaths.push(N.FullPaths[0]+z),R(N)}}function R(N,z){D(N);for(var M=!1,L=!1,j=N.FullPaths.length-1;j>=0;--j){var G=N.FileIndex[j];switch(G.type){case 0:L?M=!0:(N.FileIndex.pop(),N.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(G.R*G.L*G.C)&&(M=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!z)){var ae=new Date(1987,1,19),me=0,ne=Object.create?Object.create(null):{},oe=[];for(j=0;j<N.FullPaths.length;++j)ne[N.FullPaths[j]]=!0,N.FileIndex[j].type!==0&&oe.push([N.FullPaths[j],N.FileIndex[j]]);for(j=0;j<oe.length;++j){var le=r(oe[j][0]);L=ne[le],L||(oe.push([le,{name:a(le).replace("/",""),type:1,clsid:de,ct:ae,mt:ae,content:null}]),ne[le]=!0)}for(oe.sort(function(Ue,Re){return n(Ue[0],Re[0])}),N.FullPaths=[],N.FileIndex=[],j=0;j<oe.length;++j)N.FullPaths[j]=oe[j][0],N.FileIndex[j]=oe[j][1];for(j=0;j<oe.length;++j){var be=N.FileIndex[j],Ne=N.FullPaths[j];if(be.name=a(Ne).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||de,j===0)be.C=oe.length>1?1:-1,be.size=0,be.type=5;else if(Ne.slice(-1)=="/"){for(me=j+1;me<oe.length&&r(N.FullPaths[me])!=Ne;++me);for(be.C=me>=oe.length?-1:me,me=j+1;me<oe.length&&r(N.FullPaths[me])!=r(Ne);++me);be.R=me>=oe.length?-1:me,be.type=1}else r(N.FullPaths[j+1]||"")==r(Ne)&&(be.R=j+1),be.type=2}}}function P(N,z){var M=z||{};if(M.fileType=="mad")return Gt(N,M);switch(R(N),M.fileType){case"zip":return si(N,M)}var L=function(Ue){for(var Re=0,Pe=0,Qe=0;Qe<Ue.FileIndex.length;++Qe){var Et=Ue.FileIndex[Qe];if(Et.content){var dt=Et.content.length;dt>0&&(dt<4096?Re+=dt+63>>6:Pe+=dt+511>>9)}}for(var mt=Ue.FullPaths.length+3>>2,Cr=Re+7>>3,Si=Re+127>>7,sr=Cr+Pe+mt+Si,xr=sr+127>>7,bi=xr<=109?0:Math.ceil((xr-109)/127);sr+xr+bi+127>>7>xr;)bi=++xr<=109?0:Math.ceil((xr-109)/127);var or=[1,bi,xr,Si,mt,Pe,Re,0];return Ue.FileIndex[0].size=Re<<6,or[7]=(Ue.FileIndex[0].start=or[0]+or[1]+or[2]+or[3]+or[4]+or[5])+(or[6]+7>>3),or}(N),j=ge(L[7]<<9),G=0,ae=0;{for(G=0;G<8;++G)j.write_shift(1,He[G]);for(G=0;G<8;++G)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),G=0;G<3;++G)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,L[2]),j.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:V),j.write_shift(4,L[3]),j.write_shift(-4,L[1]?L[0]-1:V),j.write_shift(4,L[1]),G=0;G<109;++G)j.write_shift(-4,G<L[2]?L[1]+G:-1)}if(L[1])for(ae=0;ae<L[1];++ae){for(;G<236+ae*127;++G)j.write_shift(-4,G<L[2]?L[1]+G:-1);j.write_shift(-4,ae===L[1]-1?V:ae+1)}var me=function(Ue){for(ae+=Ue;G<ae-1;++G)j.write_shift(-4,G+1);Ue&&(++G,j.write_shift(-4,V))};for(ae=G=0,ae+=L[1];G<ae;++G)j.write_shift(-4,Ce.DIFSECT);for(ae+=L[2];G<ae;++G)j.write_shift(-4,Ce.FATSECT);me(L[3]),me(L[4]);for(var ne=0,oe=0,le=N.FileIndex[0];ne<N.FileIndex.length;++ne)le=N.FileIndex[ne],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ae,me(oe+511>>9)));for(me(L[6]+7>>3);j.l&511;)j.write_shift(-4,Ce.ENDOFCHAIN);for(ae=G=0,ne=0;ne<N.FileIndex.length;++ne)le=N.FileIndex[ne],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ae,me(oe+63>>6)));for(;j.l&511;)j.write_shift(-4,Ce.ENDOFCHAIN);for(G=0;G<L[4]<<2;++G){var be=N.FullPaths[G];if(!be||be.length===0){for(ne=0;ne<17;++ne)j.write_shift(4,0);for(ne=0;ne<3;++ne)j.write_shift(4,-1);for(ne=0;ne<12;++ne)j.write_shift(4,0);continue}le=N.FileIndex[G],G===0&&(le.start=le.size?le.start-1:V);var Ne=G===0&&M.root||le.name;if(oe=2*(Ne.length+1),j.write_shift(64,Ne,"utf16le"),j.write_shift(2,oe),j.write_shift(1,le.type),j.write_shift(1,le.color),j.write_shift(-4,le.L),j.write_shift(-4,le.R),j.write_shift(-4,le.C),le.clsid)j.write_shift(16,le.clsid,"hex");else for(ne=0;ne<4;++ne)j.write_shift(4,0);j.write_shift(4,le.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,le.start),j.write_shift(4,le.size),j.write_shift(4,0)}for(G=1;G<N.FileIndex.length;++G)if(le=N.FileIndex[G],le.size>=4096)if(j.l=le.start+1<<9,St&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+511&-512;else{for(ne=0;ne<le.size;++ne)j.write_shift(1,le.content[ne]);for(;ne&511;++ne)j.write_shift(1,0)}for(G=1;G<N.FileIndex.length;++G)if(le=N.FileIndex[G],le.size>0&&le.size<4096)if(St&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+63&-64;else{for(ne=0;ne<le.size;++ne)j.write_shift(1,le.content[ne]);for(;ne&63;++ne)j.write_shift(1,0)}if(St)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function B(N,z){var M=N.FullPaths.map(function(ne){return ne.toUpperCase()}),L=M.map(function(ne){var oe=ne.split("/");return oe[oe.length-(ne.slice(-1)=="/"?2:1)]}),j=!1;z.charCodeAt(0)===47?(j=!0,z=M[0].slice(0,-1)+z):j=z.indexOf("/")!==-1;var G=z.toUpperCase(),ae=j===!0?M.indexOf(G):L.indexOf(G);if(ae!==-1)return N.FileIndex[ae];var me=!G.match(Nh);for(G=G.replace(_c,""),me&&(G=G.replace(Nh,"!")),ae=0;ae<M.length;++ae)if((me?M[ae].replace(Nh,"!"):M[ae]).replace(_c,"")==G||(me?L[ae].replace(Nh,"!"):L[ae]).replace(_c,"")==G)return N.FileIndex[ae];return null}var H=64,V=-2,Je="d0cf11e0a1b11ae1",He=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",Ce={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ze(N,z,M){h();var L=P(N,M);d.writeFileSync(z,L)}function Xe(N){for(var z=new Array(N.length),M=0;M<N.length;++M)z[M]=String.fromCharCode(N[M]);return z.join("")}function Q(N,z){var M=P(N,z);switch(z&&z.type||"buffer"){case"file":return h(),d.writeFileSync(z.filename,M),M;case"binary":return typeof M=="string"?M:Xe(M);case"base64":return kc(typeof M=="string"?M:Xe(M));case"buffer":if(St)return Buffer.isBuffer(M)?M:Pa(M);case"array":return typeof M=="string"?di(M):M}return M}var _e;function U(N){try{var z=N.InflateRaw,M=new z;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)_e=N;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function W(N,z){if(!_e)return La(N,z);var M=_e.InflateRaw,L=new M,j=L._processChunk(N.slice(N.l),L._finishFlushFlag);return N.l+=L.bytesRead,j}function K(N){return _e?_e.deflateRawSync(N):Vs(N)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(N){var z=(N<<1|N<<11)&139536|(N<<5|N<<15)&558144;return(z>>16|z>>8|z)&255}for(var Be=typeof Uint8Array<"u",Me=Be?new Uint8Array(256):[],ut=0;ut<256;++ut)Me[ut]=Fe(ut);function nt(N,z){var M=Me[N&255];return z<=8?M>>>8-z:(M=M<<8|Me[N>>8&255],z<=16?M>>>16-z:(M=M<<8|Me[N>>16&255],M>>>24-z))}function Kt(N,z){var M=z&7,L=z>>>3;return(N[L]|(M<=6?0:N[L+1]<<8))>>>M&3}function ot(N,z){var M=z&7,L=z>>>3;return(N[L]|(M<=5?0:N[L+1]<<8))>>>M&7}function ir(N,z){var M=z&7,L=z>>>3;return(N[L]|(M<=4?0:N[L+1]<<8))>>>M&15}function Ut(N,z){var M=z&7,L=z>>>3;return(N[L]|(M<=3?0:N[L+1]<<8))>>>M&31}function Ve(N,z){var M=z&7,L=z>>>3;return(N[L]|(M<=1?0:N[L+1]<<8))>>>M&127}function Wn(N,z,M){var L=z&7,j=z>>>3,G=(1<<M)-1,ae=N[j]>>>L;return M<8-L||(ae|=N[j+1]<<8-L,M<16-L)||(ae|=N[j+2]<<16-L,M<24-L)||(ae|=N[j+3]<<24-L),ae&G}function ar(N,z,M){var L=z&7,j=z>>>3;return L<=5?N[j]|=(M&7)<<L:(N[j]|=M<<L&255,N[j+1]=(M&7)>>8-L),z+3}function mr(N,z,M){var L=z&7,j=z>>>3;return M=(M&1)<<L,N[j]|=M,z+1}function pr(N,z,M){var L=z&7,j=z>>>3;return M<<=L,N[j]|=M&255,M>>>=8,N[j+1]=M,z+8}function Bo(N,z,M){var L=z&7,j=z>>>3;return M<<=L,N[j]|=M&255,M>>>=8,N[j+1]=M&255,N[j+2]=M>>>8,z+16}function xi(N,z){var M=N.length,L=2*M>z?2*M:z+5,j=0;if(M>=z)return N;if(St){var G=R2(L);if(N.copy)N.copy(G);else for(;j<N.length;++j)G[j]=N[j];return G}else if(Be){var ae=new Uint8Array(L);if(ae.set)ae.set(N);else for(;j<M;++j)ae[j]=N[j];return ae}return N.length=L,N}function Kn(N){for(var z=new Array(N),M=0;M<N;++M)z[M]=0;return z}function ea(N,z,M){var L=1,j=0,G=0,ae=0,me=0,ne=N.length,oe=Be?new Uint16Array(32):Kn(32);for(G=0;G<32;++G)oe[G]=0;for(G=ne;G<M;++G)N[G]=0;ne=N.length;var le=Be?new Uint16Array(ne):Kn(ne);for(G=0;G<ne;++G)oe[j=N[G]]++,L<j&&(L=j),le[G]=0;for(oe[0]=0,G=1;G<=L;++G)oe[G+16]=me=me+oe[G-1]<<1;for(G=0;G<ne;++G)me=N[G],me!=0&&(le[G]=oe[me+16]++);var be=0;for(G=0;G<ne;++G)if(be=N[G],be!=0)for(me=nt(le[G],L)>>L-be,ae=(1<<L+4-be)-1;ae>=0;--ae)z[me|ae<<be]=be&15|G<<4;return L}var Ht=Be?new Uint16Array(512):Kn(512),_t=Be?new Uint16Array(32):Kn(32);if(!Be){for(var an=0;an<512;++an)Ht[an]=0;for(an=0;an<32;++an)_t[an]=0}(function(){for(var N=[],z=0;z<32;z++)N.push(5);ea(N,_t,32);var M=[];for(z=0;z<=143;z++)M.push(8);for(;z<=255;z++)M.push(9);for(;z<=279;z++)M.push(7);for(;z<=287;z++)M.push(8);ea(M,Ht,288)})();var bn=function(){for(var z=Be?new Uint8Array(32768):[],M=0,L=0;M<Le.length-1;++M)for(;L<Le[M+1];++L)z[L]=M;for(;L<32768;++L)z[L]=29;var j=Be?new Uint8Array(259):[];for(M=0,L=0;M<ce.length-1;++M)for(;L<ce[M+1];++L)j[L]=M;function G(me,ne){for(var oe=0;oe<me.length;){var le=Math.min(65535,me.length-oe),be=oe+le==me.length;for(ne.write_shift(1,+be),ne.write_shift(2,le),ne.write_shift(2,~le&65535);le-- >0;)ne[ne.l++]=me[oe++]}return ne.l}function ae(me,ne){for(var oe=0,le=0,be=Be?new Uint16Array(32768):[];le<me.length;){var Ne=Math.min(65535,me.length-le);if(Ne<10){for(oe=ar(ne,oe,+(le+Ne==me.length)),oe&7&&(oe+=8-(oe&7)),ne.l=oe/8|0,ne.write_shift(2,Ne),ne.write_shift(2,~Ne&65535);Ne-- >0;)ne[ne.l++]=me[le++];oe=ne.l*8;continue}oe=ar(ne,oe,+(le+Ne==me.length)+2);for(var Ue=0;Ne-- >0;){var Re=me[le];Ue=(Ue<<5^Re)&32767;var Pe=-1,Qe=0;if((Pe=be[Ue])&&(Pe|=le&-32768,Pe>le&&(Pe-=32768),Pe<le))for(;me[Pe+Qe]==me[le+Qe]&&Qe<250;)++Qe;if(Qe>2){Re=j[Qe],Re<=22?oe=pr(ne,oe,Me[Re+1]>>1)-1:(pr(ne,oe,3),oe+=5,pr(ne,oe,Me[Re-23]>>5),oe+=3);var Et=Re<8?0:Re-4>>2;Et>0&&(Bo(ne,oe,Qe-ce[Re]),oe+=Et),Re=z[le-Pe],oe=pr(ne,oe,Me[Re]>>3),oe-=3;var dt=Re<4?0:Re-2>>1;dt>0&&(Bo(ne,oe,le-Pe-Le[Re]),oe+=dt);for(var mt=0;mt<Qe;++mt)be[Ue]=le&32767,Ue=(Ue<<5^me[le])&32767,++le;Ne-=Qe-1}else Re<=143?Re=Re+48:oe=mr(ne,oe,1),oe=pr(ne,oe,Me[Re]),be[Ue]=le&32767,++le}oe=pr(ne,oe,0)-1}return ne.l=(oe+7)/8|0,ne.l}return function(ne,oe){return ne.length<8?G(ne,oe):ae(ne,oe)}}();function Vs(N){var z=ge(50+Math.floor(N.length*1.1)),M=bn(N,z);return z.slice(0,M)}var Uo=Be?new Uint16Array(32768):Kn(32768),yi=Be?new Uint16Array(32768):Kn(32768),_i=Be?new Uint16Array(128):Kn(128),Ei=1,gr=1;function ka(N,z){var M=Ut(N,z)+257;z+=5;var L=Ut(N,z)+1;z+=5;var j=ir(N,z)+4;z+=4;for(var G=0,ae=Be?new Uint8Array(19):Kn(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,oe=Be?new Uint8Array(8):Kn(8),le=Be?new Uint8Array(8):Kn(8),be=ae.length,Ne=0;Ne<j;++Ne)ae[Z[Ne]]=G=ot(N,z),ne<G&&(ne=G),oe[G]++,z+=3;var Ue=0;for(oe[0]=0,Ne=1;Ne<=ne;++Ne)le[Ne]=Ue=Ue+oe[Ne-1]<<1;for(Ne=0;Ne<be;++Ne)(Ue=ae[Ne])!=0&&(me[Ne]=le[Ue]++);var Re=0;for(Ne=0;Ne<be;++Ne)if(Re=ae[Ne],Re!=0){Ue=Me[me[Ne]]>>8-Re;for(var Pe=(1<<7-Re)-1;Pe>=0;--Pe)_i[Ue|Pe<<Re]=Re&7|Ne<<3}var Qe=[];for(ne=1;Qe.length<M+L;)switch(Ue=_i[Ve(N,z)],z+=Ue&7,Ue>>>=3){case 16:for(G=3+Kt(N,z),z+=2,Ue=Qe[Qe.length-1];G-- >0;)Qe.push(Ue);break;case 17:for(G=3+ot(N,z),z+=3;G-- >0;)Qe.push(0);break;case 18:for(G=11+Ve(N,z),z+=7;G-- >0;)Qe.push(0);break;default:Qe.push(Ue),ne<Ue&&(ne=Ue);break}var Et=Qe.slice(0,M),dt=Qe.slice(M);for(Ne=M;Ne<286;++Ne)Et[Ne]=0;for(Ne=L;Ne<30;++Ne)dt[Ne]=0;return Ei=ea(Et,Uo,286),gr=ea(dt,yi,30),z}function ta(N,z){if(N[0]==3&&!(N[1]&3))return[bo(z),2];for(var M=0,L=0,j=R2(z||1<<18),G=0,ae=j.length>>>0,me=0,ne=0;(L&1)==0;){if(L=ot(N,M),M+=3,L>>>1)L>>1==1?(me=9,ne=5):(M=ka(N,M),me=Ei,ne=gr);else{M&7&&(M+=8-(M&7));var oe=N[M>>>3]|N[(M>>>3)+1]<<8;if(M+=32,oe>0)for(!z&&ae<G+oe&&(j=xi(j,G+oe),ae=j.length);oe-- >0;)j[G++]=N[M>>>3],M+=8;continue}for(;;){!z&&ae<G+32767&&(j=xi(j,G+32767),ae=j.length);var le=Wn(N,M,me),be=L>>>1==1?Ht[le]:Uo[le];if(M+=be&15,be>>>=4,(be>>>8&255)===0)j[G++]=be;else{if(be==256)break;be-=257;var Ne=be<8?0:be-4>>2;Ne>5&&(Ne=0);var Ue=G+ce[be];Ne>0&&(Ue+=Wn(N,M,Ne),M+=Ne),le=Wn(N,M,ne),be=L>>>1==1?_t[le]:yi[le],M+=be&15,be>>>=4;var Re=be<4?0:be-2>>1,Pe=Le[be];for(Re>0&&(Pe+=Wn(N,M,Re),M+=Re),!z&&ae<Ue&&(j=xi(j,Ue+100),ae=j.length);G<Ue;)j[G]=j[G-Pe],++G}}}return z?[j,M+7>>>3]:[j.slice(0,G),M+7>>>3]}function La(N,z){var M=N.slice(N.l||0),L=ta(M,z);return N.l+=L[1],L[0]}function Va(N,z){if(N)typeof console<"u"&&console.error(z);else throw new Error(z)}function Ba(N,z){var M=N;Lr(M,0);var L=[],j=[],G={FileIndex:L,FullPaths:j};D(G,{root:z.root});for(var ae=M.length-4;(M[ae]!=80||M[ae+1]!=75||M[ae+2]!=5||M[ae+3]!=6)&&ae>=0;)--ae;M.l=ae+4,M.l+=4;var me=M.read_shift(2);M.l+=6;var ne=M.read_shift(4);for(M.l=ne,ae=0;ae<me;++ae){M.l+=20;var oe=M.read_shift(4),le=M.read_shift(4),be=M.read_shift(2),Ne=M.read_shift(2),Ue=M.read_shift(2);M.l+=8;var Re=M.read_shift(4),Pe=f(M.slice(M.l+be,M.l+be+Ne));M.l+=be+Ne+Ue;var Qe=M.l;M.l=Re+4,ai(M,oe,le,G,Pe),M.l=Qe}return G}function ai(N,z,M,L,j){N.l+=2;var G=N.read_shift(2),ae=N.read_shift(2),me=u(N);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ne=N.read_shift(4),oe=N.read_shift(4),le=N.read_shift(4),be=N.read_shift(2),Ne=N.read_shift(2),Ue="",Re=0;Re<be;++Re)Ue+=String.fromCharCode(N[N.l++]);if(Ne){var Pe=f(N.slice(N.l,N.l+Ne));(Pe[21589]||{}).mt&&(me=Pe[21589].mt),((j||{})[21589]||{}).mt&&(me=j[21589].mt)}N.l+=Ne;var Qe=N.slice(N.l,N.l+oe);switch(ae){case 8:Qe=W(N,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Et=!1;G&8&&(ne=N.read_shift(4),ne==134695760&&(ne=N.read_shift(4),Et=!0),oe=N.read_shift(4),le=N.read_shift(4)),oe!=z&&Va(Et,"Bad compressed size: "+z+" != "+oe),le!=M&&Va(Et,"Bad uncompressed size: "+M+" != "+le),Xt(L,Ue,Qe,{unsafe:!0,mt:me})}function si(N,z){var M=z||{},L=[],j=[],G=ge(1),ae=M.compression?8:0,me=0,ne=0,oe=0,le=0,be=0,Ne=N.FullPaths[0],Ue=Ne,Re=N.FileIndex[0],Pe=[],Qe=0;for(ne=1;ne<N.FullPaths.length;++ne)if(Ue=N.FullPaths[ne].slice(Ne.length),Re=N.FileIndex[ne],!(!Re.size||!Re.content||Ue=="Sh33tJ5")){var Et=le,dt=ge(Ue.length);for(oe=0;oe<Ue.length;++oe)dt.write_shift(1,Ue.charCodeAt(oe)&127);dt=dt.slice(0,dt.l),Pe[be]=YO.buf(Re.content,0);var mt=Re.content;ae==8&&(mt=K(mt)),G=ge(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,ae),Re.mt?o(G,Re.mt):G.write_shift(4,0),G.write_shift(-4,Pe[be]),G.write_shift(4,mt.length),G.write_shift(4,Re.content.length),G.write_shift(2,dt.length),G.write_shift(2,0),le+=G.length,L.push(G),le+=dt.length,L.push(dt),le+=mt.length,L.push(mt),G=ge(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,ae),G.write_shift(4,0),G.write_shift(-4,Pe[be]),G.write_shift(4,mt.length),G.write_shift(4,Re.content.length),G.write_shift(2,dt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,Et),Qe+=G.l,j.push(G),Qe+=dt.length,j.push(dt),++be}return G=ge(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,be),G.write_shift(2,be),G.write_shift(4,Qe),G.write_shift(4,le),G.write_shift(2,0),Gn([Gn(L),Gn(j),G])}var Ti={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jr(N,z){if(N.ctype)return N.ctype;var M=N.name||"",L=M.match(/\.([^\.]+)$/);return L&&Ti[L[1]]||z&&(L=(M=z).match(/[\.\\]([^\.\\])+$/),L&&Ti[L[1]])?Ti[L[1]]:"application/octet-stream"}function Bs(N){for(var z=kc(N),M=[],L=0;L<z.length;L+=76)M.push(z.slice(L,L+76));return M.join(`\r
`)+`\r
`}function wi(N){var z=N.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=z.split(`\r
`),j=0;j<L.length;++j){var G=L[j];if(G.length==0){M.push("");continue}for(var ae=0;ae<G.length;){var me=76,ne=G.slice(ae,ae+me);ne.charAt(me-1)=="="?me--:ne.charAt(me-2)=="="?me-=2:ne.charAt(me-3)=="="&&(me-=3),ne=G.slice(ae,ae+me),ae+=me,ae<G.length&&(ne+="="),M.push(ne)}}return M.join(`\r
`)}function Ua(N){for(var z=[],M=0;M<N.length;++M){for(var L=N[M];M<=N.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+N[++M];z.push(L)}for(var j=0;j<z.length;++j)z[j]=z[j].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return di(z.join(`\r
`))}function Ai(N,z,M){for(var L="",j="",G="",ae,me=0;me<10;++me){var ne=z[me];if(!ne||ne.match(/^\s*$/))break;var oe=ne.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":L=oe[2].trim();break;case"content-type":G=oe[2].trim();break;case"content-transfer-encoding":j=oe[2].trim();break}}switch(++me,j.toLowerCase()){case"base64":ae=di(Oa(z.slice(me).join("")));break;case"quoted-printable":ae=Ua(z.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var le=Xt(N,L.slice(M.length),ae,{unsafe:!0});G&&(le.ctype=G)}function jo(N,z){if(Xe(N.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=z&&z.root||"",L=(St&&Buffer.isBuffer(N)?N.toString("binary"):Xe(N)).split(`\r
`),j=0,G="";for(j=0;j<L.length;++j)if(G=L[j],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),M||(M=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),G.slice(0,M.length)!=M););var ae=(L[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var me="--"+(ae[1]||""),ne=[],oe=[],le={FileIndex:ne,FullPaths:oe};D(le);var be,Ne=0;for(j=0;j<L.length;++j){var Ue=L[j];Ue!==me&&Ue!==me+"--"||(Ne++&&Ai(le,L.slice(be,j),M),be=j)}return le}function Gt(N,z){var M=z||{},L=M.boundary||"SheetJS";L="------="+L;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],G=N.FullPaths[0],ae=G,me=N.FileIndex[0],ne=1;ne<N.FullPaths.length;++ne)if(ae=N.FullPaths[ne].slice(G.length),me=N.FileIndex[ne],!(!me.size||!me.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var oe=me.content,le=St&&Buffer.isBuffer(oe)?oe.toString("binary"):Xe(oe),be=0,Ne=Math.min(1024,le.length),Ue=0,Re=0;Re<=Ne;++Re)(Ue=le.charCodeAt(Re))>=32&&Ue<128&&++be;var Pe=be>=Ne*4/5;j.push(L),j.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+ae),j.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),j.push("Content-Type: "+jr(me,ae)),j.push(""),j.push(Pe?wi(le):Bs(le))}return j.push(L+`--\r
`),j.join(`\r
`)}function sn(N){var z={};return D(z,N),z}function Xt(N,z,M,L){var j=L&&L.unsafe;j||D(N);var G=!j&&Vt.find(N,z);if(!G){var ae=N.FullPaths[0];z.slice(0,ae.length)==ae?ae=z:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+z).replace("//","/")),G={name:a(z),type:2},N.FileIndex.push(G),N.FullPaths.push(ae),j||Vt.utils.cfb_gc(N)}return G.content=M,G.size=M?M.length:0,L&&(L.CLSID&&(G.clsid=L.CLSID),L.mt&&(G.mt=L.mt),L.ct&&(G.ct=L.ct)),G}function vr(N,z){D(N);var M=Vt.find(N,z);if(M){for(var L=0;L<N.FileIndex.length;++L)if(N.FileIndex[L]==M)return N.FileIndex.splice(L,1),N.FullPaths.splice(L,1),!0}return!1}function Us(N,z,M){D(N);var L=Vt.find(N,z);if(L){for(var j=0;j<N.FileIndex.length;++j)if(N.FileIndex[j]==L)return N.FileIndex[j].name=a(M),N.FullPaths[j]=M,!0}return!1}function ou(N){R(N,!0)}return e.find=B,e.read=Ae,e.parse=g,e.write=Q,e.writeFile=ze,e.utils={cfb_new:sn,cfb_add:Xt,cfb_del:vr,cfb_mov:Us,cfb_gc:ou,ReadShift:Tc,CheckField:TA,prep_blob:Lr,bconcat:Gn,use_zlib:U,_deflateRaw:Vs,_inflateRaw:La,consts:Ce},e}();function XO(t){return typeof t=="string"?$0(t):Array.isArray(t)?_O(t):t}function tf(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=$0(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?Vc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var a=new Blob([XO(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=t,u.href=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(t);return f.open("w"),f.encoding="binary",Array.isArray(e)&&(e=ef(e)),f.write(e),f.close(),e}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+t)}function Xn(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function k2(t,e){for(var n=[],r=Xn(t),a=0;a!==r.length;++a)n[t[r[a]][e]]==null&&(n[t[r[a]][e]]=r[a]);return n}function o1(t){for(var e=[],n=Xn(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function W0(t){for(var e=[],n=Xn(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function WO(t){for(var e=[],n=Xn(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var h0=new Date(1899,11,30,0,0,0);function Sr(t,e){var n=t.getTime(),r=h0.getTime()+(t.getTimezoneOffset()-h0.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var aA=new Date,KO=h0.getTime()+(aA.getTimezoneOffset()-h0.getTimezoneOffset())*6e4,L2=aA.getTimezoneOffset();function sA(t){var e=new Date;return e.setTime(t*24*60*60*1e3+KO),e.getTimezoneOffset()!==L2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-L2)*6e4),e}var V2=new Date("2017-02-19T19:06:09.000Z"),oA=isNaN(V2.getFullYear())?new Date("2/19/17"):V2,QO=oA.getFullYear()==2017;function dr(t,e){var n=new Date(t);if(QO)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(oA.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function K0(t,e){if(St&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function br(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=br(t[n]));return e}function nn(t,e){for(var n="";n.length<e;)n+=t;return n}function Sa(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return n=-n,o}),!isNaN(e=Number(r)))?e/n:e}var ZO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lc(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return n;var u=t.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&ZO.indexOf(u)==-1)return n}else if(u.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||o>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}function it(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return St?r=Pa(n):r=EO(n),Vt.utils.cfb_add(t,e,r)}Vt.utils.cfb_add(t,e,n)}else t.file(e,n)}function l1(){return Vt.utils.cfb_new()}var yn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,JO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},u1=o1(JO),c1=/[&<>'"]/g,e8=/[\u0000-\u0008\u000b-\u001f]/g;function Ot(t){var e=t+"";return e.replace(c1,function(n){return u1[n]}).replace(e8,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function B2(t){return Ot(t).replace(/ /g,"_x0020_")}var lA=/[\u0000-\u001f]/g;function t8(t){var e=t+"";return e.replace(c1,function(n){return u1[n]}).replace(/\n/g,"<br/>").replace(lA,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function n8(t){var e=t+"";return e.replace(c1,function(n){return u1[n]}).replace(lA,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function r8(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function i8(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function _p(t){for(var e="",n=0,r=0,a=0,o=0,u=0,f=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){u=(r&31)<<6,u|=a&63,e+=String.fromCharCode(u);continue}if(o=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}u=t.charCodeAt(n++),f=((r&7)<<18|(a&63)<<12|(o&63)<<6|u&63)-65536,e+=String.fromCharCode(55296+(f>>>10&1023)),e+=String.fromCharCode(56320+(f&1023))}return e}function U2(t){var e=bo(2*t.length),n,r,a=1,o=0,u=0,f;for(r=0;r<t.length;r+=a)a=1,(f=t.charCodeAt(r))<128?n=f:f<224?(n=(f&31)*64+(t.charCodeAt(r+1)&63),a=2):f<240?(n=(f&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(f&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,u=55296+(n>>>10&1023),n=56320+(n&1023)),u!==0&&(e[o++]=u&255,e[o++]=u>>>8,u=0),e[o++]=n%256,e[o++]=n>>>8;return e.slice(0,o).toString("ucs2")}function j2(t){return Pa(t,"binary").toString("utf8")}var Dh="foo bar baz",Ec=St&&(j2(Dh)==_p(Dh)&&j2||U2(Dh)==_p(Dh)&&U2)||_p,Vc=St?function(t){return Pa(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},a8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),uA=/(^\s|\s$|\n)/;function qn(t,e){return"<"+t+(e.match(uA)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Bc(t){return Xn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ie(t,e,n){return"<"+t+(n!=null?Bc(n):"")+(e!=null?(e.match(uA)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function eg(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function s8(t,e){switch(typeof t){case"string":var n=Ie("vt:lpwstr",Ot(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Ie((t|0)==t?"vt:i4":"vt:r8",Ot(String(t)));case"boolean":return Ie("vt:bool",t?"true":"false")}if(t instanceof Date)return Ie("vt:filetime",eg(t));throw new Error("Unable to serialize "+t)}var Fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ru=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function o8(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function l8(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,u=r?-e:e;isFinite(u)?u==0?a=o=0:(a=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var f=0;f<=5;++f,o/=256)t[n+f]=o&255;t[n+6]=(a&15)<<4|o&15,t[n+7]=a>>4|r}var z2=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,o=t[0][r].length;a<o;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},H2=St?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Pa(e)})):z2(t)}:z2,G2=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(mc(t,a)));return r.join("").replace(_c,"")},f1=St?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(_c,""):G2(t,e,n)}:G2,q2=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},cA=St?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):q2(t,e,n)}:q2,$2=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Pl(t,a)));return r.join("")},nf=St?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):$2(e,n,r)}:$2,fA=function(t,e){var n=Br(t,e);return n>0?nf(t,e+4,e+4+n-1):""},hA=fA,dA=function(t,e){var n=Br(t,e);return n>0?nf(t,e+4,e+4+n-1):""},mA=dA,pA=function(t,e){var n=2*Br(t,e);return n>0?nf(t,e+4,e+4+n-1):""},gA=pA,vA=function(e,n){var r=Br(e,n);return r>0?f1(e,n+4,n+4+r):""},xA=vA,yA=function(t,e){var n=Br(t,e);return n>0?nf(t,e+4,e+4+n):""},_A=yA,EA=function(t,e){return o8(t,e)},d0=EA,h1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};St&&(hA=function(e,n){if(!Buffer.isBuffer(e))return fA(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},mA=function(e,n){if(!Buffer.isBuffer(e))return dA(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},gA=function(e,n){if(!Buffer.isBuffer(e))return pA(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},xA=function(e,n){if(!Buffer.isBuffer(e))return vA(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},_A=function(e,n){if(!Buffer.isBuffer(e))return yA(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},d0=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):EA(e,n)},h1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Pl=function(t,e){return t[e]},mc=function(t,e){return t[e+1]*256+t[e]},u8=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Br=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},po=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},c8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Tc(t,e){var n="",r,a,o=[],u,f,d,h;switch(e){case"dbcs":if(h=this.l,St&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(d=0;d<t;++d)n+=String.fromCharCode(mc(this,h)),h+=2;t*=2;break;case"utf8":n=nf(this,this.l,this.l+t);break;case"utf16le":t*=2,n=f1(this,this.l,this.l+t);break;case"wstr":return Tc.call(this,t,"dbcs");case"lpstr-ansi":n=hA(this,this.l),t=4+Br(this,this.l);break;case"lpstr-cp":n=mA(this,this.l),t=4+Br(this,this.l);break;case"lpwstr":n=gA(this,this.l),t=4+2*Br(this,this.l);break;case"lpp4":t=4+Br(this,this.l),n=xA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Br(this,this.l),n=_A(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(u=Pl(this,this.l+t++))!==0;)o.push(Rh(u));n=o.join("");break;case"_wstr":for(t=0,n="";(u=mc(this,this.l+t))!==0;)o.push(Rh(u)),t+=2;t+=2,n=o.join("");break;case"dbcs-cont":for(n="",h=this.l,d=0;d<t;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return u=Pl(this,h),this.l=h+1,f=Tc.call(this,t-d,u?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(Rh(mc(this,h))),h+=2}n=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",h=this.l,d=0;d!=t;++d){if(this.lens&&this.lens.indexOf(h)!==-1)return u=Pl(this,h),this.l=h+1,f=Tc.call(this,t-d,u?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(Rh(Pl(this,h))),h+=1}n=o.join("");break;default:switch(t){case 1:return r=Pl(this,this.l),this.l++,r;case 2:return r=(e==="i"?u8:mc)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?po:c8)(this,this.l),this.l+=4,r):(a=Br(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=d0(this,this.l):a=d0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=cA(this,this.l,t);break}}return this.l+=t,n}var f8=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},h8=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},d8=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function m8(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)d8(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var u=e.charCodeAt(a);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,f8(this,e,this.l);break;case 8:if(r=8,n==="f"){l8(this,e,this.l);break}case 16:break;case-4:r=4,h8(this,e,this.l);break}return this.l+=r,this}function TA(t,e){var n=cA(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Lr(t,e){t.l=e,t.read_shift=Tc,t.chk=TA,t.write_shift=m8}function Qi(t,e){t.l+=e}function ge(t){var e=bo(t);return Lr(e,0),e}function Ar(){var t=[],e=St?256:2048,n=function(h){var g=ge(h);return Lr(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},o=function(h){return r&&h<r.length-r.l?r:(a(),r=n(Math.max(h+1,e)))},u=function(){return a(),Gn(t)},f=function(h){a(),r=h,r.l==null&&(r.l=r.length),o(e)};return{next:o,push:f,end:u,_bufs:t}}function Se(t,e,n,r){var a=+e,o;if(!isNaN(a)){r||(r=ok[a].p||(n||[]).length||0),o=1+(a>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var u=t.next(o);a<=127?u.write_shift(1,a):(u.write_shift(1,(a&127)+128),u.write_shift(1,a>>7));for(var f=0;f!=4;++f)if(r>=128)u.write_shift(1,(r&127)+128),r>>=7;else{u.write_shift(1,r);break}r>0&&h1(n)&&t.push(n)}}function wc(t,e,n){var r=br(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function Y2(t,e,n){var r=br(t);return r.s=wc(r.s,e.s,n),r.e=wc(r.e,e.s,n),r}function Ac(t,e){if(t.cRel&&t.c<0)for(t=br(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=br(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Ft(t);return!t.cRel&&t.cRel!=null&&(n=v8(n)),!t.rRel&&t.rRel!=null&&(n=p8(n)),n}function Ep(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+$n(t.s.r)+":"+(t.e.rRel?"":"$")+$n(t.e.r):Ac(t.s,e.biff)+":"+Ac(t.e,e.biff)}function d1(t){return parseInt(g8(t),10)-1}function $n(t){return""+(t+1)}function p8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function g8(t){return t.replace(/\$(\d+)$/,"$1")}function m1(t){for(var e=x8(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function v8(t){return t.replace(/^([A-Z])/,"$$$1")}function x8(t){return t.replace(/^\$([A-Z])/,"$1")}function y8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mn(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function Ft(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function Ur(t){var e=t.indexOf(":");return e==-1?{s:Mn(t),e:Mn(t)}:{s:Mn(t.slice(0,e)),e:Mn(t.slice(e+1))}}function xn(t,e){return typeof e>"u"||typeof e=="number"?xn(t.s,t.e):(typeof t!="string"&&(t=Ft(t)),typeof e!="string"&&(e=Ft(e)),t==e?t:t+":"+e)}function Yt(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,o=t.length;for(n=0;r<o&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<o&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=o&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=o&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function X2(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Os(t.z,n?Sr(e):e)}catch{}try{return t.w=Os((t.XF||{}).numFmtId||(n?14:0),n?Sr(e):e)}catch{return""+e}}function Fa(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?rf[t.v]||t.v:e==null?X2(t,t.v):X2(t,e))}function Mo(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function wA(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,o=t||(a?[]:{}),u=0,f=0;if(o&&r.origin!=null){if(typeof r.origin=="number")u=r.origin;else{var d=typeof r.origin=="string"?Mn(r.origin):r.origin;u=d.r,f=d.c}o["!ref"]||(o["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=Yt(o["!ref"]);h.s.c=g.s.c,h.s.r=g.s.r,h.e.c=Math.max(h.e.c,g.e.c),h.e.r=Math.max(h.e.r,g.e.r),u==-1&&(h.e.r=u=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var x=0;x!=e[y].length;++x)if(!(typeof e[y][x]>"u")){var E={v:e[y][x]},w=u+y,T=f+x;if(h.s.r>w&&(h.s.r=w),h.s.c>T&&(h.s.c=T),h.e.r<w&&(h.e.r=w),h.e.c<T&&(h.e.c=T),e[y][x]&&typeof e[y][x]=="object"&&!Array.isArray(e[y][x])&&!(e[y][x]instanceof Date))E=e[y][x];else if(Array.isArray(E.v)&&(E.f=e[y][x][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||rn[14],r.cellDates?(E.t="d",E.w=Os(E.z,Sr(E.v))):(E.t="n",E.v=Sr(E.v),E.w=Os(E.z,E.v))):E.t="s";if(a)o[w]||(o[w]=[]),o[w][T]&&o[w][T].z&&(E.z=o[w][T].z),o[w][T]=E;else{var b=Ft({c:T,r:w});o[b]&&o[b].z&&(E.z=o[b].z),o[b]=E}}}return h.s.c<1e7&&(o["!ref"]=xn(h)),o}function iu(t,e){return wA(null,t,e)}function _8(t){return t.read_shift(4,"i")}function gi(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function rr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Pn(t,e){var n=!1;return e==null&&(n=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function E8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function T8(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function p1(t,e){var n=t.l,r=t.read_shift(1),a=rr(t),o=[],u={t:a,h:a};if((r&1)!==0){for(var f=t.read_shift(4),d=0;d!=f;++d)o.push(E8(t));u.r=o}else u.r=[{ich:0,ifnt:0}];return t.l=n+e,u}function w8(t,e){var n=!1;return e==null&&(n=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),Pn(t.t,e),n?e.slice(0,e.l):e}var A8=p1;function S8(t,e){var n=!1;return e==null&&(n=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),Pn(t.t,e),e.write_shift(4,1),T8({},e),n?e.slice(0,e.l):e}function ii(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function Po(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function ko(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Lo(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var b8=rr,AA=Pn;function g1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function m0(t,e){var n=!1;return e==null&&(n=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var C8=rr,tg=g1,v1=m0;function SA(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?d0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):po(e,0)>>2;return n?a/100:a}function bA(t,e){e==null&&(e=ge(4));var n=0,r=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?a:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function CA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function R8(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Vo=CA,au=R8;function su(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Co(t,e){return(e||ge(8)).write_shift(8,t,"f")}function N8(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),u=t.read_shift(1),f=t.read_shift(1),d=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var h=V8[a];h&&(e.rgb=aE(h));break;case 2:e.rgb=aE([u,f,d]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function p0(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function I8(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function D8(t,e){e||(e=ge(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}var RA=2,kr=3,Oh=11,g0=19,Fh=64,O8=65,F8=71,M8=4108,P8=4126,jn=80,W2={1:{n:"CodePage",t:RA},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:kr},5:{n:"LineCount",t:kr},6:{n:"ParagraphCount",t:kr},7:{n:"SlideCount",t:kr},8:{n:"NoteCount",t:kr},9:{n:"HiddenCount",t:kr},10:{n:"MultimediaClipCount",t:kr},11:{n:"ScaleCrop",t:Oh},12:{n:"HeadingPairs",t:M8},13:{n:"TitlesOfParts",t:P8},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:Oh},17:{n:"CharacterCount",t:kr},19:{n:"SharedDoc",t:Oh},22:{n:"HyperlinksChanged",t:Oh},23:{n:"AppVersion",t:kr,p:"version"},24:{n:"DigSig",t:O8},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:g0},2147483651:{n:"Behavior",t:g0},1919054434:{}},K2={1:{n:"CodePage",t:RA},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:Fh},11:{n:"LastPrinted",t:Fh},12:{n:"CreatedDate",t:Fh},13:{n:"ModifiedDate",t:Fh},14:{n:"PageCount",t:kr},15:{n:"WordCount",t:kr},16:{n:"CharCount",t:kr},17:{n:"Thumbnail",t:F8},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:kr},255:{},2147483648:{n:"Locale",t:g0},2147483651:{n:"Behavior",t:g0},1919054434:{}};function k8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var L8=k8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),V8=br(L8),rf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Mh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function NA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IA(t,e){var n=WO(B8),r=[],a;r[r.length]=yn,r[r.length]=Ie("Types",null,{xmlns:Fn.CT,"xmlns:xsd":Fn.xsd,"xmlns:xsi":Fn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ie("Default",null,{Extension:d[0],ContentType:d[1]})}));var o=function(d){t[d]&&t[d].length>0&&(a=t[d][0],r[r.length]=Ie("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Mh[d][e.bookType]||Mh[d].xlsx}))},u=function(d){(t[d]||[]).forEach(function(h){r[r.length]=Ie("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:Mh[d][e.bookType]||Mh[d].xlsx})})},f=function(d){(t[d]||[]).forEach(function(h){r[r.length]=Ie("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:n[d][0]})})};return o("workbooks"),u("sheets"),u("charts"),f("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),u("metadata"),f("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function DA(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function jl(t){var e=[yn,Ie("Relationships",null,{xmlns:Fn.RELS})];return Xn(t["!id"]).forEach(function(n){e[e.length]=Ie("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Dt(t,e,n,r,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=r,a.Target=n,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}function U8(t){var e=[yn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function Q2(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function j8(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function z8(t){var e=[yn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(Q2(t[n][0],t[n][1])),e.push(j8("",t[n][0]));return e.push(Q2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function OA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+o0.version+"</meta:generator></office:meta></office:document-meta>"}var _o=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Tp(t,e,n,r,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Ot(e),r[r.length]=n?Ie(t,e,n):qn(t,e))}function FA(t,e){var n=e||{},r=[yn,Ie("cp:coreProperties",null,{"xmlns:cp":Fn.CORE_PROPS,"xmlns:dc":Fn.dc,"xmlns:dcterms":Fn.dcterms,"xmlns:dcmitype":Fn.dcmitype,"xmlns:xsi":Fn.xsi})],a={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&Tp("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:eg(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),t.ModifiedDate!=null&&Tp("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:eg(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var o=0;o!=_o.length;++o){var u=_o[o],f=n.Props&&n.Props[u[1]]!=null?n.Props[u[1]]:t?t[u[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&Tp(u[0],f,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var zl=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],MA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function PA(t){var e=[],n=Ie;return t||(t={}),t.Application="SheetJS",e[e.length]=yn,e[e.length]=Ie("Properties",null,{xmlns:Fn.EXT_PROPS,"xmlns:vt":Fn.vt}),zl.forEach(function(r){if(t[r[1]]!==void 0){var a;switch(r[2]){case"string":a=Ot(String(t[r[1]]));break;case"bool":a=t[r[1]]?"true":"false";break}a!==void 0&&(e[e.length]=n(r[0],a))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Ot(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function kA(t){var e=[yn,Ie("Properties",null,{xmlns:Fn.CUST_PROPS,"xmlns:vt":Fn.vt})];if(!t)return e.join("");var n=1;return Xn(t).forEach(function(a){++n,e[e.length]=Ie("property",s8(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ot(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Z2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function H8(t,e){var n=[];return Xn(Z2).map(function(r){for(var a=0;a<_o.length;++a)if(_o[a][1]==r)return _o[a];for(a=0;a<zl.length;++a)if(zl[a][1]==r)return zl[a];throw r}).forEach(function(r){if(t[r[1]]!=null){var a=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(qn(Z2[r[1]]||r[1],a))}}),Ie("DocumentProperties",n.join(""),{xmlns:Vr.o})}function G8(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return t&&Xn(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var u=0;u<_o.length;++u)if(o==_o[u][1])return;for(u=0;u<zl.length;++u)if(o==zl[u][1])return;for(u=0;u<n.length;++u)if(o==n[u])return;var f=t[o],d="string";typeof f=="number"?(d="float",f=String(f)):f===!0||f===!1?(d="boolean",f=f?"1":"0"):f=String(f),a.push(Ie(B2(o),f,{"dt:dt":d}))}}),e&&Xn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var u=e[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u instanceof Date?(f="dateTime.tz",u=u.toISOString()):u=String(u),a.push(Ie(B2(o),u,{"dt:dt":f}))}}),"<"+r+' xmlns="'+Vr.o+'">'+a.join("")+"</"+r+">"}function q8(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),a=(n-r)/Math.pow(2,32);r*=1e7,a*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),a+=o);var u=ge(8);return u.write_shift(4,r),u.write_shift(4,a),u}function J2(t,e){var n=ge(4),r=ge(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=ge(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=q8(e);break;case 31:case 80:for(r=ge(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Gn([n,r])}var LA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $8(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function eE(t,e,n){var r=ge(8),a=[],o=[],u=8,f=0,d=ge(8),h=ge(8);if(d.write_shift(4,2),d.write_shift(4,1200),h.write_shift(4,1),o.push(d),a.push(h),u+=8+d.length,!e){h=ge(8),h.write_shift(4,0),a.unshift(h);var g=[ge(4)];for(g[0].write_shift(4,t.length),f=0;f<t.length;++f){var y=t[f][0];for(d=ge(8+2*(y.length+1)+(y.length%2?0:2)),d.write_shift(4,f+2),d.write_shift(4,y.length+1),d.write_shift(0,y,"dbcs");d.l!=d.length;)d.write_shift(1,0);g.push(d)}d=Gn(g),o.unshift(d),u+=8+d.length}for(f=0;f<t.length;++f)if(!(e&&!e[t[f][0]])&&!(LA.indexOf(t[f][0])>-1||MA.indexOf(t[f][0])>-1)&&t[f][1]!=null){var x=t[f][1],E=0;if(e){E=+e[t[f][0]];var w=n[E];if(w.p=="version"&&typeof x=="string"){var T=x.split(".");x=(+T[0]<<16)+(+T[1]||0)}d=J2(w.t,x)}else{var b=$8(x);b==-1&&(b=31,x=String(x)),d=J2(b,x)}o.push(d),h=ge(8),h.write_shift(4,e?E:2+f),a.push(h),u+=8+d.length}var k=8*(o.length+1);for(f=0;f<o.length;++f)a[f].write_shift(4,k),k+=o[f].length;return r.write_shift(4,u),r.write_shift(4,o.length),Gn([r].concat(a).concat(o))}function tE(t,e,n,r,a,o){var u=ge(a?68:48),f=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Vt.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,a?2:1),u.write_shift(16,e,"hex"),u.write_shift(4,a?68:48);var d=eE(t,n,r);if(f.push(d),a){var h=eE(a,null,null);u.write_shift(16,o,"hex"),u.write_shift(4,68+d.length),f.push(h)}return Gn(f)}function Y8(t,e){e||(e=ge(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function X8(t,e){return t.read_shift(e)===1}function hr(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function VA(t){return t.read_shift(2,"u")}function ei(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function BA(t,e,n){return n||(n=ge(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function UA(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var u=r?t.read_shift(r,a):"";return u}function W8(t){var e=t.t||"",n=ge(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=ge(2*e.length);r.write_shift(2*e.length,e,"utf16le");var a=[n,r];return Gn(a)}function K8(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function Q8(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):K8(t,r,n)}function Z8(t,e,n){if(n.biff>5)return Q8(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function jA(t,e,n){return n||(n=ge(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function nE(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function J8(t){var e=ge(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var a=r.indexOf("#"),o=a>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var u=[8,6815827,6619237,4849780,83];for(n=0;n<u.length;++n)e.write_shift(4,u[n]);if(o==28)r=r.slice(1),nE(r,e);else if(o&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<u.length;++n)e.write_shift(1,parseInt(u[n],16));var f=a>-1?r.slice(0,a):r;for(e.write_shift(4,2*(f.length+1)),n=0;n<f.length;++n)e.write_shift(2,f.charCodeAt(n));e.write_shift(2,0),o&8&&nE(a>-1?r.slice(a+1):"",e)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<u.length;++n)e.write_shift(1,parseInt(u[n],16));for(var d=0;r.slice(d*3,d*3+3)=="../"||r.slice(d*3,d*3+3)=="..\\";)++d;for(e.write_shift(2,d),e.write_shift(4,r.length-3*d+1),n=0;n<r.length-3*d;++n)e.write_shift(1,r.charCodeAt(n+3*d)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function Ro(t,e,n,r){return r||(r=ge(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function e5(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),o=t.read_shift(r,"i"),u=t.read_shift(r,"i");return[a,o,u]}function t5(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function zA(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function x1(t,e,n){var r=1536,a=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=ge(a);return o.write_shift(2,r),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function n5(t,e){var n=!e||e.biff==8,r=ge(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function r5(t,e){var n=!e||e.biff>=8?2:1,r=ge(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function i5(t,e){var n=ge(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],a=0;a<t.length;++a)r[a]=W8(t[a]);var o=Gn([n].concat(r));return o.parts=[n.length].concat(r.map(function(u){return u.length})),o}function a5(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function s5(t){var e=ge(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function o5(t,e){var n=t.name||"Arial",r=e&&e.biff==5,a=r?15+n.length:16+2*n.length,o=ge(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),o}function l5(t,e,n,r){var a=ge(10);return Ro(t,e,r,a),a.write_shift(4,n),a}function u5(t,e,n,r,a){var o=!a||a.biff==8,u=ge(8+ +o+(1+o)*n.length);return Ro(t,e,r,u),u.write_shift(2,n.length),o&&u.write_shift(1,1),u.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),u}function c5(t,e,n,r){var a=n&&n.biff==5;r||(r=ge(a?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(a?1:2,e.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}function f5(t,e){var n=e.biff==8||!e.biff?4:2,r=ge(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function rE(t,e,n,r){var a=n&&n.biff==5;r||(r=ge(a?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function h5(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function d5(t,e,n,r,a,o){var u=ge(8);return Ro(t,e,r,u),BA(n,o,u),u}function m5(t,e,n,r){var a=ge(14);return Ro(t,e,r,a),Co(n,a),a}function p5(t,e,n){if(n.biff<8)return g5(t,e,n);for(var r=[],a=t.l+e,o=t.read_shift(n.biff>8?4:2);o--!==0;)r.push(e5(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function g5(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=UA(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function v5(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)zA(t[n],e);return e}function x5(t){var e=ge(24),n=Mn(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(r[a],16));return Gn([e,J8(t[1])])}function y5(t){var e=t[1].Tooltip,n=ge(10+2*(e.length+1));n.write_shift(2,2048);var r=Mn(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function _5(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function E5(t,e,n){if(!n.cellStyles)return Qi(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),o=t.read_shift(r),u=t.read_shift(r),f=t.read_shift(r),d=t.read_shift(2);r==2&&(t.l+=2);var h={s:a,e:o,w:u,ixfe:f,flags:d};return(n.biff>=5||!n.biff)&&(h.level=d>>8&7),h}function T5(t,e){var n=ge(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function w5(t){for(var e=ge(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}function A5(t,e,n){var r=ge(15);return sf(r,t,e),r.write_shift(8,n,"f"),r}function S5(t,e,n){var r=ge(9);return sf(r,t,e),r.write_shift(2,n),r}var b5=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=o1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(f,d){var h=[],g=bo(1);switch(d.type){case"base64":g=di(Oa(f));break;case"binary":g=di(f);break;case"buffer":case"array":g=f;break}Lr(g,0);var y=g.read_shift(1),x=!!(y&136),E=!1,w=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,x=!0;break;case 49:E=!0,x=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var T=0,b=521;y==2&&(T=g.read_shift(2)),g.l+=3,y!=2&&(T=g.read_shift(4)),T>1048576&&(T=1e6),y!=2&&(b=g.read_shift(2));var k=g.read_shift(2),q=d.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(q=t[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var Y=[],ee={},he=Math.min(g.length,y==2?521:b-10-(E?264:0)),Ae=w?32:11;g.l<he&&g[g.l]!=13;)switch(ee={},ee.name=l0.utils.decode(q,g.slice(g.l,g.l+Ae)).replace(/[\u0000\r\n].*$/g,""),g.l+=Ae,ee.type=String.fromCharCode(g.read_shift(1)),y!=2&&!w&&(ee.offset=g.read_shift(4)),ee.len=g.read_shift(1),y==2&&(ee.offset=g.read_shift(2)),ee.dec=g.read_shift(1),ee.name.length&&Y.push(ee),y!=2&&(g.l+=w?13:14),ee.type){case"B":(!E||ee.len!=8)&&d.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ee.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var D=0,I=0;for(h[0]=[],I=0;I!=Y.length;++I)h[0][I]=Y[I].name;for(;T-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,h[++D]=[],I=0,I=0;I!=Y.length;++I){var R=g.slice(g.l,g.l+Y[I].len);g.l+=Y[I].len,Lr(R,0);var P=l0.utils.decode(q,R);switch(Y[I].type){case"C":P.trim().length&&(h[D][I]=P.replace(/\s+$/,""));break;case"D":P.length===8?h[D][I]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):h[D][I]=P;break;case"F":h[D][I]=parseFloat(P.trim());break;case"+":case"I":h[D][I]=w?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":h[D][I]=!0;break;case"N":case"F":h[D][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!x)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));h[D][I]="##MEMO##"+(w?parseInt(P.trim(),10):R.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(h[D][I]=+P||0);break;case"@":h[D][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":h[D][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":h[D][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[D][I]=-R.read_shift(-8,"f");break;case"B":if(E&&Y[I].len==8){h[D][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=Y[I].len;break;case"0":if(Y[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+Y[I].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return d&&d.sheetRows&&(h=h.slice(0,d.sheetRows)),d.DBF=Y,h}function r(f,d){var h=d||{};h.dateNF||(h.dateNF="yyyymmdd");var g=iu(n(f,h),h);return g["!cols"]=h.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete h.DBF,g}function a(f,d){try{return Mo(r(f,d),d)}catch(h){if(d&&d.WTF)throw h}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(f,d){var h=d||{};if(+h.codepage>=0&&Pc(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ar(),y=E0(f,{header:1,raw:!0,cellDates:!0}),x=y[0],E=y.slice(1),w=f["!cols"]||[],T=0,b=0,k=0,q=1;for(T=0;T<x.length;++T){if(((w[T]||{}).DBF||{}).name){x[T]=w[T].DBF.name,++k;continue}if(x[T]!=null){if(++k,typeof x[T]=="number"&&(x[T]=x[T].toString(10)),typeof x[T]!="string")throw new Error("DBF Invalid column name "+x[T]+" |"+typeof x[T]+"|");if(x.indexOf(x[T])!==T){for(b=0;b<1024;++b)if(x.indexOf(x[T]+"_"+b)==-1){x[T]+="_"+b;break}}}}var Y=Yt(f["!ref"]),ee=[],he=[],Ae=[];for(T=0;T<=Y.e.c-Y.s.c;++T){var D="",I="",R=0,P=[];for(b=0;b<E.length;++b)E[b][T]!=null&&P.push(E[b][T]);if(P.length==0||x[T]==null){ee[T]="?";continue}for(b=0;b<P.length;++b){switch(typeof P[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=P[b]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(P[b]).length),D=D&&D!=I?"C":I}R>250&&(R=250),I=((w[T]||{}).DBF||{}).type,I=="C"&&w[T].DBF.len>R&&(R=w[T].DBF.len),D=="B"&&I=="N"&&(D="N",Ae[T]=w[T].DBF.dec,R=w[T].DBF.len),he[T]=D=="C"||I=="N"?R:o[D]||0,q+=he[T],ee[T]=D}var B=g.next(32);for(B.write_shift(4,318902576),B.write_shift(4,E.length),B.write_shift(2,296+32*k),B.write_shift(2,q),T=0;T<4;++T)B.write_shift(4,0);for(B.write_shift(4,0|(+e[Gw]||3)<<8),T=0,b=0;T<x.length;++T)if(x[T]!=null){var H=g.next(32),V=(x[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,V,"sbcs"),H.write_shift(1,ee[T]=="?"?"C":ee[T],"sbcs"),H.write_shift(4,b),H.write_shift(1,he[T]||o[ee[T]]||0),H.write_shift(1,Ae[T]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),b+=he[T]||o[ee[T]]||0}var Je=g.next(264);for(Je.write_shift(4,13),T=0;T<65;++T)Je.write_shift(4,0);for(T=0;T<E.length;++T){var He=g.next(q);for(He.write_shift(1,0),b=0;b<x.length;++b)if(x[b]!=null)switch(ee[b]){case"L":He.write_shift(1,E[T][b]==null?63:E[T][b]?84:70);break;case"B":He.write_shift(8,E[T][b]||0,"f");break;case"N":var de="0";for(typeof E[T][b]=="number"&&(de=E[T][b].toFixed(Ae[b]||0)),k=0;k<he[b]-de.length;++k)He.write_shift(1,32);He.write_shift(1,de,"sbcs");break;case"D":E[T][b]?(He.write_shift(4,("0000"+E[T][b].getFullYear()).slice(-4),"sbcs"),He.write_shift(2,("00"+(E[T][b].getMonth()+1)).slice(-2),"sbcs"),He.write_shift(2,("00"+E[T][b].getDate()).slice(-2),"sbcs")):He.write_shift(8,"00000000","sbcs");break;case"C":var Ce=String(E[T][b]!=null?E[T][b]:"").slice(0,he[b]);for(He.write_shift(1,Ce,"sbcs"),k=0;k<he[b]-Ce.length;++k)He.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:u}}(),C5=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Xn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(x,E){var w=t[E];return typeof w=="number"?C2(w):w},r=function(x,E,w){var T=E.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return T==59?x:C2(T)};t["|"]=254;function a(x,E){switch(E.type){case"base64":return o(Oa(x),E);case"binary":return o(x,E);case"buffer":return o(St&&Buffer.isBuffer(x)?x.toString("binary"):ef(x),E);case"array":return o(K0(x),E)}throw new Error("Unrecognized type "+E.type)}function o(x,E){var w=x.split(/[\n\r]+/),T=-1,b=-1,k=0,q=0,Y=[],ee=[],he=null,Ae={},D=[],I=[],R=[],P=0,B;for(+E.codepage>=0&&Pc(+E.codepage);k!==w.length;++k){P=0;var H=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),V=H.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Je=V[0],He;if(H.length>0)switch(Je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&ee.push(H.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,Ce=!1,ze=!1,Xe=!1,Q=-1,_e=-1;for(q=1;q<V.length;++q)switch(V[q].charAt(0)){case"A":break;case"X":b=parseInt(V[q].slice(1))-1,Ce=!0;break;case"Y":for(T=parseInt(V[q].slice(1))-1,Ce||(b=0),B=Y.length;B<=T;++B)Y[B]=[];break;case"K":He=V[q].slice(1),He.charAt(0)==='"'?He=He.slice(1,He.length-1):He==="TRUE"?He=!0:He==="FALSE"?He=!1:isNaN(Sa(He))?isNaN(Lc(He).getDate())||(He=dr(He)):(He=Sa(He),he!==null&&nA(he)&&(He=sA(He))),de=!0;break;case"E":Xe=!0;var U=SF(V[q].slice(1),{r:T,c:b});Y[T][b]=[Y[T][b],U];break;case"S":ze=!0,Y[T][b]=[Y[T][b],"S5S"];break;case"G":break;case"R":Q=parseInt(V[q].slice(1))-1;break;case"C":_e=parseInt(V[q].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}if(de&&(Y[T][b]&&Y[T][b].length==2?Y[T][b][0]=He:Y[T][b]=He,he=null),ze){if(Xe)throw new Error("SYLK shared formula cannot have own formula");var W=Q>-1&&Y[Q][_e];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");Y[T][b][1]=bF(W[1],{r:T-Q,c:b-_e})}break;case"F":var K=0;for(q=1;q<V.length;++q)switch(V[q].charAt(0)){case"X":b=parseInt(V[q].slice(1))-1,++K;break;case"Y":for(T=parseInt(V[q].slice(1))-1,B=Y.length;B<=T;++B)Y[B]=[];break;case"M":P=parseInt(V[q].slice(1))/20;break;case"F":break;case"G":break;case"P":he=ee[parseInt(V[q].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=V[q].slice(1).split(" "),B=parseInt(R[0],10);B<=parseInt(R[1],10);++B)P=parseInt(R[2],10),I[B-1]=P===0?{hidden:!0}:{wch:P},y1(I[B-1]);break;case"C":b=parseInt(V[q].slice(1))-1,I[b]||(I[b]={});break;case"R":T=parseInt(V[q].slice(1))-1,D[T]||(D[T]={}),P>0?(D[T].hpt=P,D[T].hpx=YA(P)):P===0&&(D[T].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}K<1&&(he=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}}return D.length>0&&(Ae["!rows"]=D),I.length>0&&(Ae["!cols"]=I),E&&E.sheetRows&&(Y=Y.slice(0,E.sheetRows)),[Y,Ae]}function u(x,E){var w=a(x,E),T=w[0],b=w[1],k=iu(T,E);return Xn(b).forEach(function(q){k[q]=b[q]}),k}function f(x,E){return Mo(u(x,E),E)}function d(x,E,w,T){var b="C;Y"+(w+1)+";X"+(T+1)+";K";switch(x.t){case"n":b+=x.v||0,x.f&&!x.F&&(b+=";E"+E1(x.f,{r:w,c:T}));break;case"b":b+=x.v?"TRUE":"FALSE";break;case"e":b+=x.w||x.v;break;case"d":b+='"'+(x.w||x.v)+'"';break;case"s":b+='"'+x.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function h(x,E){E.forEach(function(w,T){var b="F;W"+(T+1)+" "+(T+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=v0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=x0(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&x.push(b)})}function g(x,E){E.forEach(function(w,T){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*y0(w.hpx)+";"),b.length>2&&x.push(b+"R"+(T+1))})}function y(x,E){var w=["ID;PWXL;N;E"],T=[],b=Yt(x["!ref"]),k,q=Array.isArray(x),Y=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),x["!cols"]&&h(w,x["!cols"]),x["!rows"]&&g(w,x["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var ee=b.s.r;ee<=b.e.r;++ee)for(var he=b.s.c;he<=b.e.c;++he){var Ae=Ft({r:ee,c:he});k=q?(x[ee]||[])[he]:x[Ae],!(!k||k.v==null&&(!k.f||k.F))&&T.push(d(k,x,ee,he))}return w.join(Y)+Y+T.join(Y)+Y+"E"+Y}return{to_workbook:f,to_sheet:u,from_sheet:y}}(),R5=function(){function t(o,u){switch(u.type){case"base64":return e(Oa(o),u);case"binary":return e(o,u);case"buffer":return e(St&&Buffer.isBuffer(o)?o.toString("binary"):ef(o),u);case"array":return e(K0(o),u)}throw new Error("Unrecognized type "+u.type)}function e(o,u){for(var f=o.split(`
`),d=-1,h=-1,g=0,y=[];g!==f.length;++g){if(f[g].trim()==="BOT"){y[++d]=[],h=0;continue}if(!(d<0)){var x=f[g].trim().split(","),E=x[0],w=x[1];++g;for(var T=f[g]||"";(T.match(/["]/g)||[]).length&1&&g<f.length-1;)T+=`
`+f[++g];switch(T=T.trim(),+E){case-1:if(T==="BOT"){y[++d]=[],h=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?y[d][h]=!0:T==="FALSE"?y[d][h]=!1:isNaN(Sa(w))?isNaN(Lc(w).getDate())?y[d][h]=w:y[d][h]=dr(w):y[d][h]=Sa(w),++h;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),y[d][h++]=T!==""?T:null;break}if(T==="EOD")break}}return u&&u.sheetRows&&(y=y.slice(0,u.sheetRows)),y}function n(o,u){return iu(t(o,u),u)}function r(o,u){return Mo(n(o,u),u)}var a=function(){var o=function(d,h,g,y,x){d.push(h),d.push(g+","+y),d.push('"'+x.replace(/"/g,'""')+'"')},u=function(d,h,g,y){d.push(h+","+g),d.push(h==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(d){var h=[],g=Yt(d["!ref"]),y,x=Array.isArray(d);o(h,"TABLE",0,1,"sheetjs"),o(h,"VECTORS",0,g.e.r-g.s.r+1,""),o(h,"TUPLES",0,g.e.c-g.s.c+1,""),o(h,"DATA",0,0,"");for(var E=g.s.r;E<=g.e.r;++E){u(h,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var T=Ft({r:E,c:w});if(y=x?(d[E]||[])[w]:d[T],!y){u(h,1,0,"");continue}switch(y.t){case"n":var b=y.w;!b&&y.v!=null&&(b=y.v),b==null?y.f&&!y.F?u(h,1,0,"="+y.f):u(h,1,0,""):u(h,0,b,"V");break;case"b":u(h,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":u(h,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Os(y.z||rn[14],Sr(dr(y.v)))),u(h,0,y.w,"V");break;default:u(h,1,0,"")}}}u(h,-1,0,"EOD");var k=`\r
`,q=h.join(k);return q}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),HA=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,x){for(var E=y.split(`
`),w=-1,T=-1,b=0,k=[];b!==E.length;++b){var q=E[b].trim().split(":");if(q[0]==="cell"){var Y=Mn(q[1]);if(k.length<=Y.r)for(w=k.length;w<=Y.r;++w)k[w]||(k[w]=[]);switch(w=Y.r,T=Y.c,q[2]){case"t":k[w][T]=t(q[3]);break;case"v":k[w][T]=+q[3];break;case"vtf":var ee=q[q.length-1];case"vtc":switch(q[3]){case"nl":k[w][T]=!!+q[4];break;default:k[w][T]=+q[4];break}q[2]=="vtf"&&(k[w][T]=[k[w][T],ee])}}}return x&&x.sheetRows&&(k=k.slice(0,x.sheetRows)),k}function r(y,x){return iu(n(y,x),x)}function a(y,x){return Mo(r(y,x),x)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function h(y){if(!y||!y["!ref"])return"";for(var x=[],E=[],w,T="",b=Ur(y["!ref"]),k=Array.isArray(y),q=b.s.r;q<=b.e.r;++q)for(var Y=b.s.c;Y<=b.e.c;++Y)if(T=Ft({r:q,c:Y}),w=k?(y[q]||[])[Y]:y[T],!(!w||w.v==null||w.t==="z")){switch(E=["cell",T,"t"],w.t){case"s":case"str":E.push(e(w.v));break;case"n":w.f?(E[2]="vtf",E[3]="n",E[4]=w.v,E[5]=e(w.f)):(E[2]="v",E[3]=w.v);break;case"b":E[2]="vt"+(w.f?"f":"c"),E[3]="nl",E[4]=w.v?"1":"0",E[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var ee=Sr(dr(w.v));E[2]="vtc",E[3]="nd",E[4]=""+ee,E[5]=w.w||Os(w.z||rn[14],ee);break;case"e":continue}x.push(E.join(":"))}return x.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),x.push("valueformat:1:text-wiki"),x.join(`
`)}function g(y){return[o,u,f,u,h(y),d].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),N5=function(){function t(g,y,x,E,w){w.raw?y[x][E]=g:g===""||(g==="TRUE"?y[x][E]=!0:g==="FALSE"?y[x][E]=!1:isNaN(Sa(g))?isNaN(Lc(g).getDate())?y[x][E]=g:y[x][E]=dr(g):y[x][E]=Sa(g))}function e(g,y){var x=y||{},E=[];if(!g||g.length===0)return E;for(var w=g.split(/[\r\n]/),T=w.length-1;T>=0&&w[T].length===0;)--T;for(var b=10,k=0,q=0;q<=T;++q)k=w[q].indexOf(" "),k==-1?k=w[q].length:k++,b=Math.max(b,k);for(q=0;q<=T;++q){E[q]=[];var Y=0;for(t(w[q].slice(0,b).trim(),E,q,Y,x),Y=1;Y<=(w[q].length-b)/10+1;++Y)t(w[q].slice(b+(Y-1)*10,b+Y*10).trim(),E,q,Y,x)}return x.sheetRows&&(E=E.slice(0,x.sheetRows)),E}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var y={},x=!1,E=0,w=0;E<g.length;++E)(w=g.charCodeAt(E))==34?x=!x:!x&&w in n&&(y[w]=(y[w]||0)+1);w=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E]);if(!w.length){y=r;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E])}return w.sort(function(T,b){return T[0]-b[0]||r[T[1]]-r[b[1]]}),n[w.pop()[1]]||44}function o(g,y){var x=y||{},E="",w=x.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(E=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(E=g.charAt(4),g=g.slice(6)):E=a(g.slice(0,1024)):x&&x.FS?E=x.FS:E=a(g.slice(0,1024));var b=0,k=0,q=0,Y=0,ee=0,he=E.charCodeAt(0),Ae=!1,D=0,I=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var R=x.dateNF!=null?qO(x.dateNF):null;function P(){var B=g.slice(Y,ee),H={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)H.t="z";else if(x.raw)H.t="s",H.v=B;else if(B.trim().length===0)H.t="s",H.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(H.t="s",H.v=B.slice(2,-1).replace(/""/g,'"')):CF(B)?(H.t="n",H.f=B.slice(1)):(H.t="s",H.v=B);else if(B=="TRUE")H.t="b",H.v=!0;else if(B=="FALSE")H.t="b",H.v=!1;else if(!isNaN(q=Sa(B)))H.t="n",x.cellText!==!1&&(H.w=B),H.v=q;else if(!isNaN(Lc(B).getDate())||R&&B.match(R)){H.z=x.dateNF||rn[14];var V=0;R&&B.match(R)&&(B=$O(B,x.dateNF,B.match(R)||[]),V=1),x.cellDates?(H.t="d",H.v=dr(B,V)):(H.t="n",H.v=Sr(dr(B,V))),x.cellText!==!1&&(H.w=Os(H.z,H.v instanceof Date?Sr(H.v):H.v)),x.cellNF||delete H.z}else H.t="s",H.v=B;if(H.t=="z"||(x.dense?(w[b]||(w[b]=[]),w[b][k]=H):w[Ft({c:k,r:b})]=H),Y=ee+1,I=g.charCodeAt(Y),T.e.c<k&&(T.e.c=k),T.e.r<b&&(T.e.r=b),D==he)++k;else if(k=0,++b,x.sheetRows&&x.sheetRows<=b)return!0}e:for(;ee<g.length;++ee)switch(D=g.charCodeAt(ee)){case 34:I===34&&(Ae=!Ae);break;case he:case 10:case 13:if(!Ae&&P())break e;break}return ee-Y>0&&P(),w["!ref"]=xn(T),w}function u(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,y):iu(e(g,y),y)}function f(g,y){var x="",E=y.type=="string"?[0,0,0,0]:jk(g,y);switch(y.type){case"base64":x=Oa(g);break;case"binary":x=g;break;case"buffer":y.codepage==65001?x=g.toString("utf8"):y.codepage&&typeof l0<"u"||(x=St&&Buffer.isBuffer(g)?g.toString("binary"):ef(g));break;case"array":x=K0(g);break;case"string":x=g;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?x=Ec(x.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?x=Ec(x):y.type=="binary"&&typeof l0<"u",x.slice(0,19)=="socialcalc:version:"?HA.to_sheet(y.type=="string"?x:Ec(x),y):u(x,y)}function d(g,y){return Mo(f(g,y),y)}function h(g){for(var y=[],x=Yt(g["!ref"]),E,w=Array.isArray(g),T=x.s.r;T<=x.e.r;++T){for(var b=[],k=x.s.c;k<=x.e.c;++k){var q=Ft({r:T,c:k});if(E=w?(g[T]||[])[k]:g[q],!E||E.v==null){b.push("          ");continue}for(var Y=(E.w||(Fa(E),E.w)||"").slice(0,10);Y.length<10;)Y+=" ";b.push(Y+(k===0?" ":""))}y.push(b.join(""))}return y.join(`
`)}return{to_workbook:d,to_sheet:f,from_sheet:h}}(),iE=function(){function t(U,W,K){if(U){Lr(U,U.l||0);for(var Z=K.Enum||Q;U.l<U.length;){var ce=U.read_shift(2),Le=Z[ce]||Z[65535],Fe=U.read_shift(2),Be=U.l+Fe,Me=Le.f&&Le.f(U,Fe,K);if(U.l=Be,W(Me,Le,ce))return}}}function e(U,W){switch(W.type){case"base64":return n(di(Oa(U)),W);case"binary":return n(di(U),W);case"buffer":case"array":return n(U,W)}throw"Unsupported type "+W.type}function n(U,W){if(!U)return U;var K=W||{},Z=K.dense?[]:{},ce="Sheet1",Le="",Fe=0,Be={},Me=[],ut=[],nt={s:{r:0,c:0},e:{r:0,c:0}},Kt=K.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)K.Enum=Q,t(U,function(Ve,Wn,ar){switch(ar){case 0:K.vers=Ve,Ve>=4096&&(K.qpro=!0);break;case 6:nt=Ve;break;case 204:Ve&&(Le=Ve);break;case 222:Le=Ve;break;case 15:case 51:K.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:ar==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=K.dateNF||rn[14],K.cellDates&&(Ve[1].t="d",Ve[1].v=sA(Ve[1].v))),K.qpro&&Ve[3]>Fe&&(Z["!ref"]=xn(nt),Be[ce]=Z,Me.push(ce),Z=K.dense?[]:{},nt={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ve[3],ce=Le||"Sheet"+(Fe+1),Le="");var mr=K.dense?(Z[Ve[0].r]||[])[Ve[0].c]:Z[Ft(Ve[0])];if(mr){mr.t=Ve[1].t,mr.v=Ve[1].v,Ve[1].z!=null&&(mr.z=Ve[1].z),Ve[1].f!=null&&(mr.f=Ve[1].f);break}K.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[Ft(Ve[0])]=Ve[1];break}},K);else if(U[2]==26||U[2]==14)K.Enum=_e,U[2]==14&&(K.qpro=!0,U.l=0),t(U,function(Ve,Wn,ar){switch(ar){case 204:ce=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>Fe&&(Z["!ref"]=xn(nt),Be[ce]=Z,Me.push(ce),Z=K.dense?[]:{},nt={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ve[3],ce="Sheet"+(Fe+1)),Kt>0&&Ve[0].r>=Kt)break;K.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[Ft(Ve[0])]=Ve[1],nt.e.c<Ve[0].c&&(nt.e.c=Ve[0].c),nt.e.r<Ve[0].r&&(nt.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(ut[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:ut[Ve[0]]=Ve[1],Ve[0]==Fe&&(ce=Ve[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(Z["!ref"]=xn(nt),Be[Le||ce]=Z,Me.push(Le||ce),!ut.length)return{SheetNames:Me,Sheets:Be};for(var ot={},ir=[],Ut=0;Ut<ut.length;++Ut)Be[Me[Ut]]?(ir.push(ut[Ut]||Me[Ut]),ot[ut[Ut]]=Be[ut[Ut]]||Be[Me[Ut]]):(ir.push(ut[Ut]),ot[ut[Ut]]={"!ref":"A1"});return{SheetNames:ir,Sheets:ot}}function r(U,W){var K=W||{};if(+K.codepage>=0&&Pc(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Ar(),ce=Yt(U["!ref"]),Le=Array.isArray(U),Fe=[];Oe(Z,0,o(1030)),Oe(Z,6,d(ce));for(var Be=Math.min(ce.e.r,8191),Me=ce.s.r;Me<=Be;++Me)for(var ut=$n(Me),nt=ce.s.c;nt<=ce.e.c;++nt){Me===ce.s.r&&(Fe[nt]=nr(nt));var Kt=Fe[nt]+ut,ot=Le?(U[Me]||[])[nt]:U[Kt];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?Oe(Z,13,E(Me,nt,ot.v)):Oe(Z,14,T(Me,nt,ot.v));else{var ir=Fa(ot);Oe(Z,15,y(Me,nt,ir.slice(0,239)))}}return Oe(Z,1),Z.end()}function a(U,W){var K=W||{};if(+K.codepage>=0&&Pc(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Ar();Oe(Z,0,u(U));for(var ce=0,Le=0;ce<U.SheetNames.length;++ce)(U.Sheets[U.SheetNames[ce]]||{})["!ref"]&&Oe(Z,27,Xe(U.SheetNames[ce],Le++));var Fe=0;for(ce=0;ce<U.SheetNames.length;++ce){var Be=U.Sheets[U.SheetNames[ce]];if(!(!Be||!Be["!ref"])){for(var Me=Yt(Be["!ref"]),ut=Array.isArray(Be),nt=[],Kt=Math.min(Me.e.r,8191),ot=Me.s.r;ot<=Kt;++ot)for(var ir=$n(ot),Ut=Me.s.c;Ut<=Me.e.c;++Ut){ot===Me.s.r&&(nt[Ut]=nr(Ut));var Ve=nt[Ut]+ir,Wn=ut?(Be[ot]||[])[Ut]:Be[Ve];if(!(!Wn||Wn.t=="z"))if(Wn.t=="n")Oe(Z,23,P(ot,Ut,Fe,Wn.v));else{var ar=Fa(Wn);Oe(Z,22,D(ot,Ut,Fe,ar.slice(0,239)))}}++Fe}}return Oe(Z,1),Z.end()}function o(U){var W=ge(2);return W.write_shift(2,U),W}function u(U){var W=ge(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var K=0,Z=0,ce=0,Le=0;Le<U.SheetNames.length;++Le){var Fe=U.SheetNames[Le],Be=U.Sheets[Fe];if(!(!Be||!Be["!ref"])){++ce;var Me=Ur(Be["!ref"]);K<Me.e.r&&(K=Me.e.r),Z<Me.e.c&&(Z=Me.e.c)}}return K>8191&&(K=8191),W.write_shift(2,K),W.write_shift(1,ce),W.write_shift(1,Z),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function f(U,W,K){var Z={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&K.qpro?(Z.s.c=U.read_shift(1),U.l++,Z.s.r=U.read_shift(2),Z.e.c=U.read_shift(1),U.l++,Z.e.r=U.read_shift(2),Z):(Z.s.c=U.read_shift(2),Z.s.r=U.read_shift(2),W==12&&K.qpro&&(U.l+=2),Z.e.c=U.read_shift(2),Z.e.r=U.read_shift(2),W==12&&K.qpro&&(U.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function d(U){var W=ge(8);return W.write_shift(2,U.s.c),W.write_shift(2,U.s.r),W.write_shift(2,U.e.c),W.write_shift(2,U.e.r),W}function h(U,W,K){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(Z[0].c=U.read_shift(1),Z[3]=U.read_shift(1),Z[0].r=U.read_shift(2),U.l+=2):(Z[2]=U.read_shift(1),Z[0].c=U.read_shift(2),Z[0].r=U.read_shift(2)),Z}function g(U,W,K){var Z=U.l+W,ce=h(U,W,K);if(ce[1].t="s",K.vers==20768){U.l++;var Le=U.read_shift(1);return ce[1].v=U.read_shift(Le,"utf8"),ce}return K.qpro&&U.l++,ce[1].v=U.read_shift(Z-U.l,"cstr"),ce}function y(U,W,K){var Z=ge(7+K.length);Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(1,39);for(var ce=0;ce<Z.length;++ce){var Le=K.charCodeAt(ce);Z.write_shift(1,Le>=128?95:Le)}return Z.write_shift(1,0),Z}function x(U,W,K){var Z=h(U,W,K);return Z[1].v=U.read_shift(2,"i"),Z}function E(U,W,K){var Z=ge(7);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(2,K,"i"),Z}function w(U,W,K){var Z=h(U,W,K);return Z[1].v=U.read_shift(8,"f"),Z}function T(U,W,K){var Z=ge(13);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(8,K,"f"),Z}function b(U,W,K){var Z=U.l+W,ce=h(U,W,K);if(ce[1].v=U.read_shift(8,"f"),K.qpro)U.l=Z;else{var Le=U.read_shift(2);ee(U.slice(U.l,U.l+Le),ce),U.l+=Le}return ce}function k(U,W,K){var Z=W&32768;return W&=-32769,W=(Z?U:0)+(W>=8192?W-16384:W),(Z?"":"$")+(K?nr(W):$n(W))}var q={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},Y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ee(U,W){Lr(U,0);for(var K=[],Z=0,ce="",Le="",Fe="",Be="";U.l<U.length;){var Me=U[U.l++];switch(Me){case 0:K.push(U.read_shift(8,"f"));break;case 1:Le=k(W[0].c,U.read_shift(2),!0),ce=k(W[0].r,U.read_shift(2),!1),K.push(Le+ce);break;case 2:{var ut=k(W[0].c,U.read_shift(2),!0),nt=k(W[0].r,U.read_shift(2),!1);Le=k(W[0].c,U.read_shift(2),!0),ce=k(W[0].r,U.read_shift(2),!1),K.push(ut+nt+":"+Le+ce)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(U.read_shift(2));break;case 6:{for(var Kt="";Me=U[U.l++];)Kt+=String.fromCharCode(Me);K.push('"'+Kt.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Be=K.pop(),Fe=K.pop(),K.push(["AND","OR"][Me-20]+"("+Fe+","+Be+")");break;default:if(Me<32&&Y[Me])Be=K.pop(),Fe=K.pop(),K.push(Fe+Y[Me]+Be);else if(q[Me]){if(Z=q[Me][1],Z==69&&(Z=U[U.l++]),Z>K.length){console.error("WK1 bad formula parse 0x"+Me.toString(16)+":|"+K.join("|")+"|");return}var ot=K.slice(-Z);K.length-=Z,K.push(q[Me][0]+"("+ot.join(",")+")")}else return Me<=7?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=24?console.error("WK1 unsupported op "+Me.toString(16)):Me<=30?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=115?console.error("WK1 unsupported function opcode "+Me.toString(16)):console.error("WK1 unrecognized opcode "+Me.toString(16))}}K.length==1?W[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function he(U){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=U.read_shift(2),W[3]=U[U.l++],W[0].c=U[U.l++],W}function Ae(U,W){var K=he(U);return K[1].t="s",K[1].v=U.read_shift(W-4,"cstr"),K}function D(U,W,K,Z){var ce=ge(6+Z.length);ce.write_shift(2,U),ce.write_shift(1,K),ce.write_shift(1,W),ce.write_shift(1,39);for(var Le=0;Le<Z.length;++Le){var Fe=Z.charCodeAt(Le);ce.write_shift(1,Fe>=128?95:Fe)}return ce.write_shift(1,0),ce}function I(U,W){var K=he(U);K[1].v=U.read_shift(2);var Z=K[1].v>>1;if(K[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return K[1].v=Z,K}function R(U,W){var K=he(U),Z=U.read_shift(4),ce=U.read_shift(4),Le=U.read_shift(2);if(Le==65535)return Z===0&&ce===3221225472?(K[1].t="e",K[1].v=15):Z===0&&ce===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Fe=Le&32768;return Le=(Le&32767)-16446,K[1].v=(1-Fe*2)*(ce*Math.pow(2,Le+32)+Z*Math.pow(2,Le)),K}function P(U,W,K,Z){var ce=ge(14);if(ce.write_shift(2,U),ce.write_shift(1,K),ce.write_shift(1,W),Z==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Le=0,Fe=0,Be=0,Me=0;return Z<0&&(Le=1,Z=-Z),Fe=Math.log2(Z)|0,Z/=Math.pow(2,Fe-31),Me=Z>>>0,(Me&2147483648)==0&&(Z/=2,++Fe,Me=Z>>>0),Z-=Me,Me|=2147483648,Me>>>=0,Z*=Math.pow(2,32),Be=Z>>>0,ce.write_shift(4,Be),ce.write_shift(4,Me),Fe+=16383+(Le?32768:0),ce.write_shift(2,Fe),ce}function B(U,W){var K=R(U);return U.l+=W-14,K}function H(U,W){var K=he(U),Z=U.read_shift(4);return K[1].v=Z>>6,K}function V(U,W){var K=he(U),Z=U.read_shift(8,"f");return K[1].v=Z,K}function Je(U,W){var K=V(U);return U.l+=W-10,K}function He(U,W){return U[U.l+W-1]==0?U.read_shift(W,"cstr"):""}function de(U,W){var K=U[U.l++];K>W-1&&(K=W-1);for(var Z="";Z.length<K;)Z+=String.fromCharCode(U[U.l++]);return Z}function Ce(U,W,K){if(!(!K.qpro||W<21)){var Z=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ce=U.read_shift(W-21,"cstr");return[Z,ce]}}function ze(U,W){for(var K={},Z=U.l+W;U.l<Z;){var ce=U.read_shift(2);if(ce==14e3){for(K[ce]=[0,""],K[ce][0]=U.read_shift(2);U[U.l];)K[ce][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return K}function Xe(U,W){var K=ge(5+U.length);K.write_shift(2,14e3),K.write_shift(2,W);for(var Z=0;Z<U.length;++Z){var ce=U.charCodeAt(Z);K[K.l++]=ce>127?95:ce}return K[K.l++]=0,K}var Q={0:{n:"BOF",f:VA},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:x},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:He},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Ae},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:He},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ce},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}(),I5=/^\s|\s$|[\t\n\r]/;function GA(t,e){if(!e.bookSST)return"";var n=[yn];n[n.length]=Ie("sst",null,{xmlns:ru[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var a=t[r],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(I5)&&(o+=' xml:space="preserve"'),o+=">"+Ot(a.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function D5(t){return[t.read_shift(4),t.read_shift(4)]}function O5(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var F5=w8;function M5(t){var e=Ar();Se(e,159,O5(t));for(var n=0;n<t.length;++n)Se(e,19,F5(t[n]));return Se(e,160),e.end()}function P5(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function qA(t){var e=0,n,r=P5(t),a=r.length+1,o,u,f,d,h;for(n=bo(a),n[0]=r.length,o=1;o!=a;++o)n[o]=r[o-1];for(o=a-1;o>=0;--o)u=n[o],f=(e&16384)===0?0:1,d=e<<1&32767,h=f|d,e=h^u;return e^52811}var k5=function(){function t(a,o){switch(o.type){case"base64":return e(Oa(a),o);case"binary":return e(a,o);case"buffer":return e(St&&Buffer.isBuffer(a)?a.toString("binary"):ef(a),o);case"array":return e(K0(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var u=o||{},f=u.dense?[]:{},d=a.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(g,y){Array.isArray(f)&&(f[y]=[]);for(var x=/\\\w+\b/g,E=0,w,T=-1;w=x.exec(g);){switch(w[0]){case"\\cell":var b=g.slice(E,x.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++T,b.length){var k={v:b,t:"s"};Array.isArray(f)?f[y][T]=k:f[Ft({r:y,c:T})]=k}break}E=x.lastIndex}T>h.e.c&&(h.e.c=T)}),f["!ref"]=xn(h),f}function n(a,o){return Mo(t(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],u=Yt(a["!ref"]),f,d=Array.isArray(a),h=u.s.r;h<=u.e.r;++h){o.push("\\trowd\\trautofit1");for(var g=u.s.c;g<=u.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=u.s.c;g<=u.e.c;++g){var y=Ft({r:h,c:g});f=d?(a[h]||[])[g]:a[y],!(!f||f.v==null&&(!f.f||f.F))&&(o.push(" "+(f.w||(Fa(f),f.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function aE(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}var L5=6,ba=L5;function v0(t){return Math.floor((t+Math.round(128/ba)/256)*ba)}function x0(t){return Math.floor((t-5)/ba*100+.5)/100}function ng(t){return Math.round((t*ba+5)/ba*256)/256}function y1(t){t.width?(t.wpx=v0(t.width),t.wch=x0(t.wpx),t.MDW=ba):t.wpx?(t.wch=x0(t.wpx),t.width=ng(t.wch),t.MDW=ba):typeof t.wch=="number"&&(t.width=ng(t.wch),t.wpx=v0(t.width),t.MDW=ba),t.customWidth&&delete t.customWidth}var V5=96,$A=V5;function y0(t){return t*96/$A}function YA(t){return t*$A/96}function B5(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=Ie("numFmt",null,{numFmtId:r,formatCode:Ot(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ie("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function U5(t){var e=[];return e[e.length]=Ie("cellXfs",null),t.forEach(function(n){e[e.length]=Ie("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ie("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function XA(t,e){var n=[yn,Ie("styleSheet",null,{xmlns:ru[0],"xmlns:vt":Fn.vt})],r;return t.SSF&&(r=B5(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=U5(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function j5(t,e){var n=t.read_shift(2),r=rr(t);return[n,r]}function z5(t,e,n){n||(n=ge(6+4*e.length)),n.write_shift(2,t),Pn(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function H5(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=I8(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=t.read_shift(2);switch(o===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var u=t.read_shift(1);u!=0&&(r.underline=u);var f=t.read_shift(1);f>0&&(r.family=f);var d=t.read_shift(1);switch(d>0&&(r.charset=d),t.l++,r.color=N8(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=rr(t),r}function G5(t,e){e||(e=ge(25+4*32)),e.write_shift(2,t.sz*20),D8(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),p0(t.color,e);var r=0;return r=2,e.write_shift(1,r),Pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var q5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],wp,$5=Qi;function sE(t,e){e||(e=ge(4*3+8*7+16*1)),wp||(wp=o1(q5));var n=wp[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(p0({auto:1},e),p0({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function Y5(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}function WA(t,e,n){n||(n=ge(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function uc(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var X5=Qi;function W5(t,e){return e||(e=ge(51)),e.write_shift(1,0),uc(null,e),uc(null,e),uc(null,e),uc(null,e),uc(null,e),e.length>e.l?e.slice(0,e.l):e}function K5(t,e){return e||(e=ge(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),m0(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Q5(t,e,n){var r=ge(2052);return r.write_shift(4,t),m0(e,r),m0(n,r),r.length>r.l?r.slice(0,r.l):r}function Z5(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&++n}),n!=0&&(Se(t,615,gi(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Se(t,44,z5(a,e[a]))}),Se(t,616))}}function J5(t){var e=1;Se(t,611,gi(e)),Se(t,43,G5({sz:12,color:{theme:1},name:"Calibri",family:2})),Se(t,612)}function eF(t){var e=2;Se(t,603,gi(e)),Se(t,45,sE({patternType:"none"})),Se(t,45,sE({patternType:"gray125"})),Se(t,604)}function tF(t){var e=1;Se(t,613,gi(e)),Se(t,46,W5()),Se(t,614)}function nF(t){var e=1;Se(t,626,gi(e)),Se(t,47,WA({numFmtId:0},65535)),Se(t,627)}function rF(t,e){Se(t,617,gi(e.length)),e.forEach(function(n){Se(t,47,WA(n,0))}),Se(t,618)}function iF(t){var e=1;Se(t,619,gi(e)),Se(t,48,K5({xfId:0,name:"Normal"})),Se(t,620)}function aF(t){var e=0;Se(t,505,gi(e)),Se(t,506)}function sF(t){var e=0;Se(t,508,Q5(e,"TableStyleMedium9","PivotStyleMedium4")),Se(t,509)}function oF(t,e){var n=Ar();return Se(n,278),Z5(n,t.SSF),J5(n),eF(n),tF(n),nF(n),rF(n,e.cellXfs),iF(n),aF(n),sF(n),Se(n,279),n.end()}function KA(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[yn];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function lF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:rr(t)}}function uF(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Pn(t.name,e),e.slice(0,e.l)}function cF(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function fF(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function hF(t,e){var n=ge(8+2*e.length);return n.write_shift(4,t),Pn(e,n),n.slice(0,n.l)}function dF(t){return t.l+=4,t.read_shift(4)!=0}function mF(t,e){var n=ge(8);return n.write_shift(4,t),n.write_shift(4,1),n}function pF(){var t=Ar();return Se(t,332),Se(t,334,gi(1)),Se(t,335,uF({name:"XLDAPR",version:12e4,flags:3496657072})),Se(t,336),Se(t,339,hF(1,"XLDAPR")),Se(t,52),Se(t,35,gi(514)),Se(t,4096,gi(0)),Se(t,4097,ei(1)),Se(t,36),Se(t,53),Se(t,340),Se(t,337,mF(1)),Se(t,51,fF([[1,0]])),Se(t,338),Se(t,333),t.end()}function QA(){var t=[yn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function gF(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Ft(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var kl=1024;function ZA(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Ie("xml",null,{"xmlns:v":Vr.v,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:mv":Vr.mv}).replace(/\/>/,">"),Ie("o:shapelayout",Ie("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ie("v:shapetype",[Ie("v:stroke",null,{joinstyle:"miter"}),Ie("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];kl<t*1e3;)kl+=1e3;return e.forEach(function(o){var u=Mn(o[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var d=f.type=="gradient"?Ie("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=Ie("v:fill",d,f),g={on:"t",obscured:"t"};++kl,a=a.concat(["<v:shape"+Bc({id:"_x0000_s"+kl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,Ie("v:shadow",null,g),Ie("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qn("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),qn("x:AutoFill","False"),qn("x:Row",String(u.r)),qn("x:Column",String(u.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function JA(t){var e=[yn,Ie("comments",null,{xmlns:ru[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(a){var o=Ot(a.a);n.indexOf(o)==-1&&(n.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&n.indexOf("tc="+a.ID)==-1&&(n.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var a=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?a=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(d){d.a&&(a=n.indexOf(Ot(d.a))),o.push(d.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(qn("t",Ot(o[0]||"")));else{for(var u=`Comment:
    `+o[0]+`
`,f=1;f<o.length;++f)u+=`Reply:
    `+o[f]+`
`;e.push(qn("t",Ot(u)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function vF(t,e,n){var r=[yn,Ie("ThreadedComments",null,{xmlns:Fn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(u,f){if(!u.T){delete u.ID;return}u.a&&e.indexOf(u.a)==-1&&e.push(u.a);var d={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};f==0?o=d.id:d.parentId=o,u.ID=d.id,u.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(u.a)).slice(-12)+"}"),r.push(Ie("threadedComment",qn("text",u.t||""),d))})}),r.push("</ThreadedComments>"),r.join("")}function xF(t){var e=[yn,Ie("personList",null,{xmlns:Fn.TCMNT,"xmlns:x":ru[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(Ie("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function yF(t){var e={};e.iauthor=t.read_shift(4);var n=Vo(t);return e.rfx=n.s,e.ref=Ft(n.s),t.l+=16,e}function _F(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),au(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var EF=rr;function TF(t){return Pn(t.slice(0,54))}function wF(t){var e=Ar(),n=[];return Se(e,628),Se(e,630),t.forEach(function(r){r[1].forEach(function(a){n.indexOf(a.a)>-1||(n.push(a.a.slice(0,54)),Se(e,632,TF(a.a)))})}),Se(e,631),Se(e,633),t.forEach(function(r){r[1].forEach(function(a){a.iauthor=n.indexOf(a.a);var o={s:Mn(r[0]),e:Mn(r[0])};Se(e,635,_F([o,a])),a.t&&a.t.length>0&&Se(e,637,S8(a)),Se(e,636),delete a.iauthor})}),Se(e,634),Se(e,629),e.end()}function AF(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Vt.utils.cfb_add(t,a,e.FileIndex[r].content)}})}var eS=["xlsb","xlsm","xlam","biff8","xla"],SF=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,o,u){var f=!1,d=!1;o.length==0?d=!0:o.charAt(0)=="["&&(d=!0,o=o.slice(1,-1)),u.length==0?f=!0:u.charAt(0)=="["&&(f=!0,u=u.slice(1,-1));var h=o.length>0?parseInt(o,10)|0:0,g=u.length>0?parseInt(u,10)|0:0;return f?g+=e.c:--g,d?h+=e.r:--h,a+(f?"":"$")+nr(g)+(d?"":"$")+$n(h)}return function(a,o){return e=o,a.replace(t,n)}}(),_1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,E1=function(){return function(e,n){return e.replace(_1,function(r,a,o,u,f,d){var h=m1(u)-(o?0:n.c),g=d1(d)-(f?0:n.r),y=g==0?"":f?g+1:"["+g+"]",x=h==0?"":o?h+1:"["+h+"]";return a+"R"+y+"C"+x})}}();function bF(t,e){return t.replace(_1,function(n,r,a,o,u,f){return r+(a=="$"?a+o:nr(m1(o)+e.c))+(u=="$"?u+f:$n(d1(f)+e.r))})}function CF(t){return t.length!=1}function dn(t){t.l+=1}function Fs(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function tS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return nS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),o=t.read_shift(r),u=Fs(t),f=Fs(t);return{s:{r:a,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:f[0],cRel:f[1],rRel:f[2]}}}function nS(t){var e=Fs(t),n=Fs(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function RF(t,e,n){if(n.biff<8)return nS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),o=Fs(t),u=Fs(t);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:u[0],cRel:u[1],rRel:u[2]}}}function rS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return NF(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Fs(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function NF(t){var e=Fs(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function IF(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function DF(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return OF(t);var a=t.read_shift(r>=12?4:2),o=t.read_shift(2),u=(o&16384)>>14,f=(o&32768)>>15;if(o&=16383,f==1)for(;a>524287;)a-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:u,rRel:f}}function OF(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function FF(t,e,n){var r=(t[t.l++]&96)>>5,a=tS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function MF(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var u=tS(t,o,n);return[r,a,u]}function PF(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function kF(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[r,a]}function LF(t,e,n){var r=(t[t.l++]&96)>>5,a=RF(t,e-1,n);return[r,a]}function VF(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function oE(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function BF(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function UF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function jF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function zF(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function HF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function iS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function GF(t){return t.read_shift(2),iS(t)}function qF(t){return t.read_shift(2),iS(t)}function $F(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=rS(t,0,n);return[r,a]}function YF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=DF(t,0,n);return[r,a]}function XF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var o=rS(t,0,n);return[r,a,o]}function WF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[WM[a],oS[a],r]}function KF(t,e,n){var r=t[t.l++],a=t.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:QF(t);return[a,(o[0]===0?oS:XM)[o[1]]]}function QF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function ZF(t,e,n){t.l+=n&&n.biff==2?3:4}function JF(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function eM(t){return t.l++,rf[t.read_shift(1)]}function tM(t){return t.l++,t.read_shift(2)}function nM(t){return t.l++,t.read_shift(1)!==0}function rM(t){return t.l++,su(t)}function iM(t,e,n){return t.l++,UA(t,e-1,n)}function aM(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=X8(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=rf[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=su(t);break;case 2:n[1]=Z8(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function sM(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((n.biff==12?Vo:t5)(t));return a}function oM(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var o=0,u=[];o!=r&&(u[o]=[]);++o)for(var f=0;f!=a;++f)u[o][f]=aM(t,n.biff);return u}function lM(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,o=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,o]}function uM(t,e,n){if(n.biff==5)return cM(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[r,a,o]}function cM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function fM(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function hM(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function dM(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function mM(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[r,a]}var pM=Qi,gM=Qi,vM=Qi;function af(t,e,n){return t.l+=2,[IF(t)]}function T1(t){return t.l+=6,[]}var xM=af,yM=T1,_M=T1,EM=af;function aS(t){return t.l+=2,[VA(t),t.read_shift(2)&1]}var TM=af,wM=aS,AM=T1,SM=af,bM=af,CM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function RM(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),u=CM[n>>2&31];return{ixti:e,coltype:n&3,rt:u,idx:r,c:a,C:o}}function NM(t){return t.l+=2,[t.read_shift(4)]}function IM(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function DM(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function OM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function FM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function MM(t){return t.l+=4,[0,0]}var lE={1:{n:"PtgExp",f:JF},2:{n:"PtgTbl",f:vM},3:{n:"PtgAdd",f:dn},4:{n:"PtgSub",f:dn},5:{n:"PtgMul",f:dn},6:{n:"PtgDiv",f:dn},7:{n:"PtgPower",f:dn},8:{n:"PtgConcat",f:dn},9:{n:"PtgLt",f:dn},10:{n:"PtgLe",f:dn},11:{n:"PtgEq",f:dn},12:{n:"PtgGe",f:dn},13:{n:"PtgGt",f:dn},14:{n:"PtgNe",f:dn},15:{n:"PtgIsect",f:dn},16:{n:"PtgUnion",f:dn},17:{n:"PtgRange",f:dn},18:{n:"PtgUplus",f:dn},19:{n:"PtgUminus",f:dn},20:{n:"PtgPercent",f:dn},21:{n:"PtgParen",f:dn},22:{n:"PtgMissArg",f:dn},23:{n:"PtgStr",f:iM},26:{n:"PtgSheet",f:IM},27:{n:"PtgEndSheet",f:DM},28:{n:"PtgErr",f:eM},29:{n:"PtgBool",f:nM},30:{n:"PtgInt",f:tM},31:{n:"PtgNum",f:rM},32:{n:"PtgArray",f:VF},33:{n:"PtgFunc",f:WF},34:{n:"PtgFuncVar",f:KF},35:{n:"PtgName",f:lM},36:{n:"PtgRef",f:$F},37:{n:"PtgArea",f:FF},38:{n:"PtgMemArea",f:fM},39:{n:"PtgMemErr",f:pM},40:{n:"PtgMemNoMem",f:gM},41:{n:"PtgMemFunc",f:hM},42:{n:"PtgRefErr",f:dM},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:YF},45:{n:"PtgAreaN",f:LF},46:{n:"PtgMemAreaN",f:OM},47:{n:"PtgMemNoMemN",f:FM},57:{n:"PtgNameX",f:uM},58:{n:"PtgRef3d",f:XF},59:{n:"PtgArea3d",f:MF},60:{n:"PtgRefErr3d",f:mM},61:{n:"PtgAreaErr3d",f:kF},255:{}},PM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kM={1:{n:"PtgElfLel",f:aS},2:{n:"PtgElfRw",f:SM},3:{n:"PtgElfCol",f:xM},6:{n:"PtgElfRwV",f:bM},7:{n:"PtgElfColV",f:EM},10:{n:"PtgElfRadical",f:TM},11:{n:"PtgElfRadicalS",f:AM},13:{n:"PtgElfColS",f:yM},15:{n:"PtgElfColSV",f:_M},16:{n:"PtgElfRadicalLel",f:wM},25:{n:"PtgList",f:RM},29:{n:"PtgSxName",f:NM},255:{}},LM={0:{n:"PtgAttrNoop",f:MM},1:{n:"PtgAttrSemi",f:HF},2:{n:"PtgAttrIf",f:jF},4:{n:"PtgAttrChoose",f:BF},8:{n:"PtgAttrGoto",f:UF},16:{n:"PtgAttrSum",f:ZF},32:{n:"PtgAttrBaxcel",f:oE},33:{n:"PtgAttrBaxcel",f:oE},64:{n:"PtgAttrSpace",f:GF},65:{n:"PtgAttrSpaceSemi",f:qF},128:{n:"PtgAttrIfError",f:zF},255:{}};function VM(t,e,n,r){if(r.biff<8)return Qi(t,e);for(var a=t.l+e,o=[],u=0;u!==n.length;++u)switch(n[u][0]){case"PtgArray":n[u][1]=oM(t,0,r),o.push(n[u][1]);break;case"PtgMemArea":n[u][2]=sM(t,n[u][1],r),o.push(n[u][2]);break;case"PtgExp":r&&r.biff==12&&(n[u][1][1]=t.read_shift(4),o.push(n[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[u][0]}return e=a-t.l,e!==0&&o.push(Qi(t,e)),o}function BM(t,e,n){for(var r=t.l+e,a,o,u=[];r!=t.l;)e=r-t.l,o=t[t.l],a=lE[o]||lE[PM[o]],(o===24||o===25)&&(a=(o===24?kM:LM)[t[t.l+1]]),!a||!a.f?Qi(t,e):u.push([a.n,a.f(t,e,n)]);return u}function UM(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],o=0;o<r.length;++o){var u=r[o];if(u)switch(u[0]){case 2:a.push('"'+u[1].replace(/"/g,'""')+'"');break;default:a.push(u[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var jM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zM(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function sS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function uE(t,e,n){var r=sS(t,e,n);return r=="#REF"?r:zM(r,n)}function Kl(t,e,n,r,a){var o=a&&a.biff||8,u={s:{c:0,r:0}},f=[],d,h,g,y=0,x=0,E,w="";if(!t[0]||!t[0][0])return"";for(var T=-1,b="",k=0,q=t[0].length;k<q;++k){var Y=t[0][k];switch(Y[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=f.pop(),h=f.pop(),T>=0){switch(t[0][T][1][0]){case 0:b=nn(" ",t[0][T][1][1]);break;case 1:b=nn("\r",t[0][T][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}h=h+b,T=-1}f.push(h+jM[Y[0]]+d);break;case"PtgIsect":d=f.pop(),h=f.pop(),f.push(h+" "+d);break;case"PtgUnion":d=f.pop(),h=f.pop(),f.push(h+","+d);break;case"PtgRange":d=f.pop(),h=f.pop(),f.push(h+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=wc(Y[1][1],u,a),f.push(Ac(g,o));break;case"PtgRefN":g=n?wc(Y[1][1],n,a):Y[1][1],f.push(Ac(g,o));break;case"PtgRef3d":y=Y[1][1],g=wc(Y[1][2],u,a),w=uE(r,y,a),f.push(w+"!"+Ac(g,o));break;case"PtgFunc":case"PtgFuncVar":var ee=Y[1][0],he=Y[1][1];ee||(ee=0),ee&=127;var Ae=ee==0?[]:f.slice(-ee);f.length-=ee,he==="User"&&(he=Ae.shift()),f.push(he+"("+Ae.join(",")+")");break;case"PtgBool":f.push(Y[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(Y[1]);break;case"PtgNum":f.push(String(Y[1]));break;case"PtgStr":f.push('"'+Y[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(Y[1]);break;case"PtgAreaN":E=Y2(Y[1][1],n?{s:n}:u,a),f.push(Ep(E,a));break;case"PtgArea":E=Y2(Y[1][1],u,a),f.push(Ep(E,a));break;case"PtgArea3d":y=Y[1][1],E=Y[1][2],w=uE(r,y,a),f.push(w+"!"+Ep(E,a));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":x=Y[1][2];var D=(r.names||[])[x-1]||(r[0]||[])[x],I=D?D.Name:"SH33TJSNAME"+String(x);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),f.push(I);break;case"PtgNameX":var R=Y[1][1];x=Y[1][2];var P;if(a.biff<=5)R<0&&(R=-R),r[R]&&(P=r[R][x]);else{var B="";if(((r[R]||[])[0]||[])[0]==14849||(((r[R]||[])[0]||[])[0]==1025?r[R][x]&&r[R][x].itab>0&&(B=r.SheetNames[r[R][x].itab-1]+"!"):B=r.SheetNames[x-1]+"!"),r[R]&&r[R][x])B+=r[R][x].Name;else if(r[0]&&r[0][x])B+=r[0][x].Name;else{var H=(sS(r,R,a)||"").split(";;");H[x-1]?B=H[x-1]:B+="SH33TJSERRX"}f.push(B);break}P||(P={Name:"SH33TJSERRY"}),f.push(P.Name);break;case"PtgParen":var V="(",Je=")";if(T>=0){switch(b="",t[0][T][1][0]){case 2:V=nn(" ",t[0][T][1][1])+V;break;case 3:V=nn("\r",t[0][T][1][1])+V;break;case 4:Je=nn(" ",t[0][T][1][1])+Je;break;case 5:Je=nn("\r",t[0][T][1][1])+Je;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}f.push(V+f.pop()+Je);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":g={c:Y[1][1],r:Y[1][0]};var He={c:n.c,r:n.r};if(r.sharedf[Ft(g)]){var de=r.sharedf[Ft(g)];f.push(Kl(de,u,He,r,a))}else{var Ce=!1;for(d=0;d!=r.arrayf.length;++d)if(h=r.arrayf[d],!(g.c<h[0].s.c||g.c>h[0].e.c)&&!(g.r<h[0].s.r||g.r>h[0].e.r)){f.push(Kl(h[1],u,He,r,a)),Ce=!0;break}Ce||f.push(Y[1])}break;case"PtgArray":f.push("{"+UM(Y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+Y[1].idx+"[#"+Y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(Y));default:throw new Error("Unrecognized Formula Token: "+String(Y))}var ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&ze.indexOf(t[0][k][0])==-1){Y=t[0][T];var Xe=!0;switch(Y[1][0]){case 4:Xe=!1;case 0:b=nn(" ",Y[1][1]);break;case 5:Xe=!1;case 1:b=nn("\r",Y[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+Y[1][0])}f.push((Xe?b:"")+f.pop()+(Xe?"":b)),T=-1}}if(f.length>1&&a.WTF)throw new Error("bad formula stack");return f[0]}function HM(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return Co(t);return Co(0)}function GM(t,e,n,r,a){var o=Ro(e,n,a),u=HM(t.v),f=ge(6),d=33;f.write_shift(2,d),f.write_shift(4,0);for(var h=ge(t.bf.length),g=0;g<t.bf.length;++g)h[g]=t.bf[g];var y=Gn([o,u,f,h]);return y}function Q0(t,e,n){var r=t.read_shift(4),a=BM(t,r,n),o=t.read_shift(4),u=o>0?VM(t,o,a,n):null;return[a,u]}var qM=Q0,Z0=Q0,$M=Q0,YM=Q0,XM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},oS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function KM(t){var e="of:="+t.replace(_1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function QM(t){return t.replace(/\./,"!")}var Sc=typeof Map<"u";function w1(t,e,n){var r=0,a=t.length;if(n){if(Sc?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var o=Sc?n.get(e):n[e];r<o.length;++r)if(t[o[r]].t===e)return t.Count++,o[r]}}else for(;r<a;++r)if(t[r].t===e)return t.Count++,r;return t[a]={t:e},t.Count++,t.Unique++,n&&(Sc?(n.has(e)||n.set(e,[]),n.get(e).push(a)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(a))),a}function J0(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(ba=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=x0(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=ng(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function lS(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function Ls(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(r==null&&n.ssf){for(;a<392;++a)if(n.ssf[a]==null){rA(e.z,a),n.ssf[a]=e.z,n.revssf[e.z]=r=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===r)return a;return t[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function ZM(t,e,n){if(t&&t["!ref"]){var r=Yt(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function JM(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+xn(t[n])+'"/>';return e+"</mergeCells>"}function e9(t,e,n,r,a){var o=!1,u={},f=null;if(r.bookType!=="xlsx"&&e.vbaraw){var d=e.SheetNames[n];try{e.Workbook&&(d=e.Workbook.Sheets[n].CodeName||d)}catch{}o=!0,u.codeName=Vc(Ot(d))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),f=(f||"")+Ie("outlinePr",null,h)}!o&&!f||(a[a.length]=Ie("sheetPr",f,u))}var t9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],n9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function r9(t){var e={sheet:1};return t9.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),n9.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=qA(t.password).toString(16).toUpperCase()),Ie("sheetProtection",null,e)}function i9(t){return lS(t),Ie("pageMargins",null,t)}function a9(t,e){for(var n=["<cols>"],r,a=0;a!=e.length;++a)(r=e[a])&&(n[n.length]=Ie("col",null,J0(a,r)));return n[n.length]="</cols>",n.join("")}function s9(t,e,n,r){var a=typeof t.ref=="string"?t.ref:xn(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,u=Ur(a);u.s.r==u.e.r&&(u.e.r=Ur(e["!ref"]).e.r,a=xn(u));for(var f=0;f<o.length;++f){var d=o[f];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==r){d.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Ie("autoFilter",null,{ref:a})}function o9(t,e,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ie("sheetViews",Ie("sheetView",null,a),{})}function l9(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,u=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=rf[t.v];break;case"d":r&&r.cellDates?a=dr(t.v,-1).toISOString():(t=br(t),t.t="n",a=""+(t.v=Sr(dr(t.v)))),typeof t.z>"u"&&(t.z=rn[14]);break;default:a=t.v;break}var f=qn("v",Ot(a)),d={r:e},h=Ls(r.cellXfs,t,r);switch(h!==0&&(d.s=h),t.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){f=qn("v",""+w1(r.Strings,t.v,r.revStrings)),d.t="s";break}d.t="str";break}if(t.t!=o&&(t.t=o,t.v=u),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;f=Ie("f",Ot(t.f),g)+(t.v!=null?f:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(d.cm=1),Ie("c",f,d)}function u9(t,e,n,r){var a=[],o=[],u=Yt(t["!ref"]),f="",d,h="",g=[],y=0,x=0,E=t["!rows"],w=Array.isArray(t),T={r:h},b,k=-1;for(x=u.s.c;x<=u.e.c;++x)g[x]=nr(x);for(y=u.s.r;y<=u.e.r;++y){for(o=[],h=$n(y),x=u.s.c;x<=u.e.c;++x){d=g[x]+h;var q=w?(t[y]||[])[x]:t[d];q!==void 0&&(f=l9(q,d,t,e))!=null&&o.push(f)}(o.length>0||E&&E[y])&&(T={r:h},E&&E[y]&&(b=E[y],b.hidden&&(T.hidden=1),k=-1,b.hpx?k=y0(b.hpx):b.hpt&&(k=b.hpt),k>-1&&(T.ht=k,T.customHeight=1),b.level&&(T.outlineLevel=b.level)),a[a.length]=Ie("row",o.join(""),T))}if(E)for(;y<E.length;++y)E&&E[y]&&(T={r:y+1},b=E[y],b.hidden&&(T.hidden=1),k=-1,b.hpx?k=y0(b.hpx):b.hpt&&(k=b.hpt),k>-1&&(T.ht=k,T.customHeight=1),b.level&&(T.outlineLevel=b.level),a[a.length]=Ie("row","",T));return a.join("")}function uS(t,e,n,r){var a=[yn,Ie("worksheet",null,{xmlns:ru[0],"xmlns:r":Fn.r})],o=n.SheetNames[t],u=0,f="",d=n.Sheets[o];d==null&&(d={});var h=d["!ref"]||"A1",g=Yt(h);if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),h=xn(g)}r||(r={}),d["!comments"]=[];var y=[];e9(d,n,t,e,a),a[a.length]=Ie("dimension",null,{ref:h}),a[a.length]=o9(d,e,t,n),e.sheetFormat&&(a[a.length]=Ie("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(a[a.length]=a9(d,d["!cols"])),a[u=a.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(f=u9(d,e),f.length>0&&(a[a.length]=f)),a.length>u+1&&(a[a.length]="</sheetData>",a[u]=a[u].replace("/>",">")),d["!protect"]&&(a[a.length]=r9(d["!protect"])),d["!autofilter"]!=null&&(a[a.length]=s9(d["!autofilter"],d,n,t)),d["!merges"]!=null&&d["!merges"].length>0&&(a[a.length]=JM(d["!merges"]));var x=-1,E,w=-1;return d["!links"].length>0&&(a[a.length]="<hyperlinks>",d["!links"].forEach(function(T){T[1].Target&&(E={ref:T[0]},T[1].Target.charAt(0)!="#"&&(w=Dt(r,-1,Ot(T[1].Target).replace(/#.*$/,""),wt.HLINK),E["r:id"]="rId"+w),(x=T[1].Target.indexOf("#"))>-1&&(E.location=Ot(T[1].Target.slice(x+1))),T[1].Tooltip&&(E.tooltip=Ot(T[1].Tooltip)),a[a.length]=Ie("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(a[a.length]=i9(d["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=qn("ignoredErrors",Ie("ignoredError",null,{numberStoredAsText:1,sqref:h}))),y.length>0&&(w=Dt(r,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),a[a.length]=Ie("drawing",null,{"r:id":"rId"+w}),d["!drawing"]=y),d["!comments"].length>0&&(w=Dt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),a[a.length]=Ie("legacyDrawing",null,{"r:id":"rId"+w}),d["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function c9(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=a/20),n}function f9(t,e,n){var r=ge(145),a=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var o=320;a.hpx?o=y0(a.hpx)*20:a.hpt&&(o=a.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var u=0;a.level&&(u|=a.level),a.hidden&&(u|=16),(a.hpx||a.hpt)&&(u|=32),r.write_shift(1,u),r.write_shift(1,0);var f=0,d=r.l;r.l+=4;for(var h={r:t,c:0},g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var y=-1,x=-1,E=g<<10;E<g+1<<10;++E){h.c=E;var w=Array.isArray(n)?(n[h.r]||[])[h.c]:n[Ft(h)];w&&(y<0&&(y=E),x=E)}y<0||(++f,r.write_shift(4,y),r.write_shift(4,x))}var T=r.l;return r.l=d,r.write_shift(4,f),r.l=T,r.length>r.l?r.slice(0,r.l):r}function h9(t,e,n,r){var a=f9(r,n,e);(a.length>17||(e["!rows"]||[])[r])&&Se(t,0,a)}var d9=Vo,m9=au;function p9(){}function g9(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=b8(t),n}function v9(t,e,n){n==null&&(n=ge(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return p0({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),AA(t,n),n.slice(0,n.l)}function x9(t){var e=ii(t);return[e]}function y9(t,e,n){return n==null&&(n=ge(8)),Po(e,n)}function _9(t){var e=ko(t);return[e]}function E9(t,e,n){return n==null&&(n=ge(4)),Lo(e,n)}function T9(t){var e=ii(t),n=t.read_shift(1);return[e,n,"b"]}function w9(t,e,n){return n==null&&(n=ge(9)),Po(e,n),n.write_shift(1,t.v?1:0),n}function A9(t){var e=ko(t),n=t.read_shift(1);return[e,n,"b"]}function S9(t,e,n){return n==null&&(n=ge(5)),Lo(e,n),n.write_shift(1,t.v?1:0),n}function b9(t){var e=ii(t),n=t.read_shift(1);return[e,n,"e"]}function C9(t,e,n){return n==null&&(n=ge(9)),Po(e,n),n.write_shift(1,t.v),n}function R9(t){var e=ko(t),n=t.read_shift(1);return[e,n,"e"]}function N9(t,e,n){return n==null&&(n=ge(8)),Lo(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function I9(t){var e=ii(t),n=t.read_shift(4);return[e,n,"s"]}function D9(t,e,n){return n==null&&(n=ge(12)),Po(e,n),n.write_shift(4,e.v),n}function O9(t){var e=ko(t),n=t.read_shift(4);return[e,n,"s"]}function F9(t,e,n){return n==null&&(n=ge(8)),Lo(e,n),n.write_shift(4,e.v),n}function M9(t){var e=ii(t),n=su(t);return[e,n,"n"]}function P9(t,e,n){return n==null&&(n=ge(16)),Po(e,n),Co(t.v,n),n}function k9(t){var e=ko(t),n=su(t);return[e,n,"n"]}function L9(t,e,n){return n==null&&(n=ge(12)),Lo(e,n),Co(t.v,n),n}function V9(t){var e=ii(t),n=SA(t);return[e,n,"n"]}function B9(t,e,n){return n==null&&(n=ge(12)),Po(e,n),bA(t.v,n),n}function U9(t){var e=ko(t),n=SA(t);return[e,n,"n"]}function j9(t,e,n){return n==null&&(n=ge(8)),Lo(e,n),bA(t.v,n),n}function z9(t){var e=ii(t),n=p1(t);return[e,n,"is"]}function H9(t){var e=ii(t),n=rr(t);return[e,n,"str"]}function G9(t,e,n){return n==null&&(n=ge(12+4*t.v.length)),Po(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function q9(t){var e=ko(t),n=rr(t);return[e,n,"str"]}function $9(t,e,n){return n==null&&(n=ge(8+4*t.v.length)),Lo(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function Y9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=t.read_shift(1),u=[a,o,"b"];if(n.cellFormula){t.l+=2;var f=Z0(t,r-t.l,n);u[3]=Kl(f,null,a,n.supbooks,n)}else t.l=r;return u}function X9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=t.read_shift(1),u=[a,o,"e"];if(n.cellFormula){t.l+=2;var f=Z0(t,r-t.l,n);u[3]=Kl(f,null,a,n.supbooks,n)}else t.l=r;return u}function W9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=su(t),u=[a,o,"n"];if(n.cellFormula){t.l+=2;var f=Z0(t,r-t.l,n);u[3]=Kl(f,null,a,n.supbooks,n)}else t.l=r;return u}function K9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=rr(t),u=[a,o,"str"];if(n.cellFormula){t.l+=2;var f=Z0(t,r-t.l,n);u[3]=Kl(f,null,a,n.supbooks,n)}else t.l=r;return u}var Q9=Vo,Z9=au;function J9(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function eP(t,e){var n=t.l+e,r=Vo(t),a=g1(t),o=rr(t),u=rr(t),f=rr(t);t.l=n;var d={rfx:r,relId:a,loc:o,display:f};return u&&(d.Tooltip=u),d}function tP(t,e){var n=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));au({s:Mn(t[0]),e:Mn(t[0])},n),v1("rId"+e,n);var r=t[1].Target.indexOf("#"),a=r==-1?"":t[1].Target.slice(r+1);return Pn(a||"",n),Pn(t[1].Tooltip||"",n),Pn("",n),n.slice(0,n.l)}function nP(){}function rP(t,e,n){var r=t.l+e,a=CA(t),o=t.read_shift(1),u=[a];if(u[2]=o,n.cellFormula){var f=qM(t,r-t.l,n);u[1]=f}else t.l=r;return u}function iP(t,e,n){var r=t.l+e,a=Vo(t),o=[a];if(n.cellFormula){var u=YM(t,r-t.l,n);o[1]=u,t.l=r}else t.l=r;return o}function aP(t,e,n){n==null&&(n=ge(18));var r=J0(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof r.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),n.write_shift(2,a),n}var cS=["left","right","top","bottom","header","footer"];function sP(t){var e={};return cS.forEach(function(n){e[n]=su(t)}),e}function oP(t,e){return e==null&&(e=ge(6*8)),lS(t),cS.forEach(function(n){Co(t[n],e)}),e}function lP(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function uP(t,e,n){n==null&&(n=ge(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function cP(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),au(t,e),e}function fP(t,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,t.password?qA(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function hP(){}function dP(){}function mP(t,e,n,r,a,o,u){if(e.v===void 0)return!1;var f="";switch(e.t){case"b":f=e.v?"1":"0";break;case"d":e=br(e),e.z=e.z||rn[14],e.v=Sr(dr(e.v)),e.t="n";break;case"n":case"e":f=""+e.v;break;default:f=e.v;break}var d={r:n,c:r};switch(d.s=Ls(a.cellXfs,e,a),e.l&&o["!links"].push([Ft(d),e.l]),e.c&&o["!comments"].push([Ft(d),e.c]),e.t){case"s":case"str":return a.bookSST?(f=w1(a.Strings,e.v,a.revStrings),d.t="s",d.v=f,u?Se(t,18,F9(e,d)):Se(t,7,D9(e,d))):(d.t="str",u?Se(t,17,$9(e,d)):Se(t,6,G9(e,d))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?u?Se(t,13,j9(e,d)):Se(t,2,B9(e,d)):u?Se(t,16,L9(e,d)):Se(t,5,P9(e,d)),!0;case"b":return d.t="b",u?Se(t,15,S9(e,d)):Se(t,4,w9(e,d)),!0;case"e":return d.t="e",u?Se(t,14,N9(e,d)):Se(t,3,C9(e,d)),!0}return u?Se(t,12,E9(e,d)):Se(t,1,y9(e,d)),!0}function pP(t,e,n,r){var a=Yt(e["!ref"]||"A1"),o,u="",f=[];Se(t,145);var d=Array.isArray(e),h=a.e.r;e["!rows"]&&(h=Math.max(a.e.r,e["!rows"].length-1));for(var g=a.s.r;g<=h;++g){u=$n(g),h9(t,e,a,g);var y=!1;if(g<=a.e.r)for(var x=a.s.c;x<=a.e.c;++x){g===a.s.r&&(f[x]=nr(x)),o=f[x]+u;var E=d?(e[g]||[])[x]:e[o];if(!E){y=!1;continue}y=mP(t,E,g,x,r,e,y)}}Se(t,146)}function gP(t,e){!e||!e["!merges"]||(Se(t,177,J9(e["!merges"].length)),e["!merges"].forEach(function(n){Se(t,176,Z9(n))}),Se(t,178))}function vP(t,e){!e||!e["!cols"]||(Se(t,390),e["!cols"].forEach(function(n,r){n&&Se(t,60,aP(r,n))}),Se(t,391))}function xP(t,e){!e||!e["!ref"]||(Se(t,648),Se(t,649,cP(Yt(e["!ref"]))),Se(t,650))}function yP(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var a=Dt(n,-1,r[1].Target.replace(/#.*$/,""),wt.HLINK);Se(t,494,tP(r,a))}}),delete e["!links"]}function _P(t,e,n,r){if(e["!comments"].length>0){var a=Dt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",wt.VML);Se(t,551,v1("rId"+a)),e["!legacy"]=a}}function EP(t,e,n,r){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:xn(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var u=n.Workbook.Names,f=Ur(o);f.s.r==f.e.r&&(f.e.r=Ur(e["!ref"]).e.r,o=xn(f));for(var d=0;d<u.length;++d){var h=u[d];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+n.SheetNames[r]+"'!"+o;break}}d==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),Se(t,161,au(Yt(o))),Se(t,162)}}function TP(t,e,n){Se(t,133),Se(t,137,uP(e,n)),Se(t,138),Se(t,134)}function wP(t,e){e["!protect"]&&Se(t,535,fP(e["!protect"]))}function AP(t,e,n,r){var a=Ar(),o=n.SheetNames[t],u=n.Sheets[o]||{},f=o;try{n&&n.Workbook&&(f=n.Workbook.Sheets[t].CodeName||f)}catch{}var d=Yt(u["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Se(a,129),(n.vbaraw||u["!outline"])&&Se(a,147,v9(f,u["!outline"])),Se(a,148,m9(d)),TP(a,u,n.Workbook),vP(a,u),pP(a,u,t,e),wP(a,u),EP(a,u,n,t),gP(a,u),yP(a,u,r),u["!margins"]&&Se(a,476,oP(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&xP(a,u),_P(a,u,t,r),Se(a,130),a.end()}function SP(t,e){t.l+=10;var n=rr(t);return{name:n}}var bP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function CP(t){return!t.Workbook||!t.Workbook.WBProps?"false":i8(t.Workbook.WBProps.date1904)?"true":"false"}var RP="][*?/\\".split("");function fS(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return RP.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function NP(t,e,n){t.forEach(function(r,a){fS(r);for(var o=0;o<a;++o)if(r==t[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var u=e&&e[a]&&e[a].CodeName||r;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function IP(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];NP(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)ZM(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}function hS(t){var e=[yn];e[e.length]=Ie("workbook",null,{xmlns:ru[0],"xmlns:r":Fn.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(bP.forEach(function(f){t.Workbook.WBProps[f[0]]!=null&&t.Workbook.WBProps[f[0]]!=f[1]&&(r[f[0]]=t.Workbook.WBProps[f[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Ie("workbookPr",null,r);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var u={name:Ot(t.SheetNames[o].slice(0,31))};if(u.sheetId=""+(o+1),u["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}e[e.length]=Ie("sheet",null,u)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(f){var d={name:f.Name};f.Comment&&(d.comment=f.Comment),f.Sheet!=null&&(d.localSheetId=""+f.Sheet),f.Hidden&&(d.hidden="1"),f.Ref&&(e[e.length]=Ie("definedName",Ot(f.Ref),d))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function DP(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=tg(t),n.name=rr(t),n}function OP(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),v1(t.strRelID,e),Pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function FP(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?rr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function MP(t,e){e||(e=ge(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),AA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function PP(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=C8(t),u=$M(t,0,n),f=g1(t);t.l=r;var d={Name:o,Ptg:u};return a<268435455&&(d.Sheet=a),f&&(d.Comment=f),d}function kP(t,e){Se(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,a={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};Se(t,156,OP(a))}Se(t,144)}function LP(t,e){e||(e=ge(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return Pn("SheetJS",e),Pn(o0.version,e),Pn(o0.version,e),Pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function VP(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function BP(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,a=-1,o=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&a==-1?a=r:n[r].Hidden==1&&o==-1&&(o=r);o>a||(Se(t,135),Se(t,158,VP(a)),Se(t,136))}}function UP(t,e){var n=Ar();return Se(n,131),Se(n,128,LP()),Se(n,153,MP(t.Workbook&&t.Workbook.WBProps||null)),BP(n,t),kP(n,t),Se(n,132),n.end()}function jP(t,e,n){return(e.slice(-4)===".bin"?UP:hS)(t)}function zP(t,e,n,r,a){return(e.slice(-4)===".bin"?AP:uS)(t,n,r,a)}function HP(t,e,n){return(e.slice(-4)===".bin"?oF:XA)(t,n)}function GP(t,e,n){return(e.slice(-4)===".bin"?M5:GA)(t,n)}function qP(t,e,n){return(e.slice(-4)===".bin"?wF:JA)(t)}function $P(t){return(t.slice(-4)===".bin"?pF:QA)()}function YP(t,e){var n=[];return t.Props&&n.push(H8(t.Props,e)),t.Custprops&&n.push(G8(t.Props,t.Custprops)),n.join("")}function XP(){return""}function WP(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,a){var o=[];o.push(Ie("NumberFormat",null,{"ss:Format":Ot(rn[r.numFmtId])}));var u={"ss:ID":"s"+(21+a)};n.push(Ie("Style",o.join(""),u))}),Ie("Styles",n.join(""))}function dS(t){return Ie("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+E1(t.Ref,{r:0,c:0})})}function KP(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var a=e[r];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||n.push(dS(a)))}return Ie("Names",n.join(""))}function QP(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,o=[],u=0;u<a.length;++u){var f=a[u];f.Sheet==n&&(f.Name.match(/^_xlfn\./)||o.push(dS(f)))}return o.join("")}function ZP(t,e,n,r){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ie("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ie("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ie("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Ie("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(qn("ProtectContents","True")),t["!protect"].objects&&a.push(qn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(qn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(qn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){t["!protect"][u[0]]&&a.push("<"+u[1]+"/>")})),a.length==0?"":Ie("WorksheetOptions",a.join(""),{xmlns:Vr.x})}function JP(t){return t.map(function(e){var n=r8(e.t||""),r=Ie("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ie("Comment",r,{"ss:Author":e.a})}).join("")}function ek(t,e,n,r,a,o,u){if(!t||t.v==null&&t.f==null)return"";var f={};if(t.f&&(f["ss:Formula"]="="+Ot(E1(t.f,u))),t.F&&t.F.slice(0,e.length)==e){var d=Mn(t.F.slice(e.length+1));f["ss:ArrayRange"]="RC:R"+(d.r==u.r?"":"["+(d.r-u.r)+"]")+"C"+(d.c==u.c?"":"["+(d.c-u.c)+"]")}if(t.l&&t.l.Target&&(f["ss:HRef"]=Ot(t.l.Target),t.l.Tooltip&&(f["x:HRefScreenTip"]=Ot(t.l.Tooltip))),n["!merges"])for(var h=n["!merges"],g=0;g!=h.length;++g)h[g].s.c!=u.c||h[g].s.r!=u.r||(h[g].e.c>h[g].s.c&&(f["ss:MergeAcross"]=h[g].e.c-h[g].s.c),h[g].e.r>h[g].s.r&&(f["ss:MergeDown"]=h[g].e.r-h[g].s.r));var y="",x="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":y="Number",x=String(t.v);break;case"b":y="Boolean",x=t.v?"1":"0";break;case"e":y="Error",x=rf[t.v];break;case"d":y="DateTime",x=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||rn[14]);break;case"s":y="String",x=n8(t.v||"");break}var E=Ls(r.cellXfs,t,r);f["ss:StyleID"]="s"+(21+E),f["ss:Index"]=u.c+1;var w=t.v!=null?x:"",T=t.t=="z"?"":'<Data ss:Type="'+y+'">'+w+"</Data>";return(t.c||[]).length>0&&(T+=JP(t.c)),Ie("Cell",T,f)}function tk(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=YA(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function nk(t,e,n,r){if(!t["!ref"])return"";var a=Yt(t["!ref"]),o=t["!merges"]||[],u=0,f=[];t["!cols"]&&t["!cols"].forEach(function(b,k){y1(b);var q=!!b.width,Y=J0(k,b),ee={"ss:Index":k+1};q&&(ee["ss:Width"]=v0(Y.width)),b.hidden&&(ee["ss:Hidden"]="1"),f.push(Ie("Column",null,ee))});for(var d=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var g=[tk(h,(t["!rows"]||[])[h])],y=a.s.c;y<=a.e.c;++y){var x=!1;for(u=0;u!=o.length;++u)if(!(o[u].s.c>y)&&!(o[u].s.r>h)&&!(o[u].e.c<y)&&!(o[u].e.r<h)){(o[u].s.c!=y||o[u].s.r!=h)&&(x=!0);break}if(!x){var E={r:h,c:y},w=Ft(E),T=d?(t[h]||[])[y]:t[w];g.push(ek(T,w,t,e,n,r,E))}}g.push("</Row>"),g.length>2&&f.push(g.join(""))}return f.join("")}function rk(t,e,n){var r=[],a=n.SheetNames[t],o=n.Sheets[a],u=o?QP(o,e,t,n):"";return u.length>0&&r.push("<Names>"+u+"</Names>"),u=o?nk(o,e,t,n):"",u.length>0&&r.push("<Table>"+u+"</Table>"),r.push(ZP(o,e,t,n)),r.join("")}function ik(t,e){e||(e={}),t.SSF||(t.SSF=br(rn)),t.SSF&&(X0(),Y0(t.SSF),e.revssf=W0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ls(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(YP(t,e)),n.push(XP()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(Ie("Worksheet",rk(r,e,t),{"ss:Name":Ot(t.SheetNames[r])}));return n[2]=WP(t,e),n[3]=KP(t),yn+Ie("Workbook",n.join(""),{xmlns:Vr.ss,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:ss":Vr.ss,"xmlns:dt":Vr.dt,"xmlns:html":Vr.html})}var Ap={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ak(t,e){var n=[],r=[],a=[],o=0,u,f=k2(W2,"n"),d=k2(K2,"n");if(t.Props)for(u=Xn(t.Props),o=0;o<u.length;++o)(Object.prototype.hasOwnProperty.call(f,u[o])?n:Object.prototype.hasOwnProperty.call(d,u[o])?r:a).push([u[o],t.Props[u[o]]]);if(t.Custprops)for(u=Xn(t.Custprops),o=0;o<u.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},u[o])||(Object.prototype.hasOwnProperty.call(f,u[o])?n:Object.prototype.hasOwnProperty.call(d,u[o])?r:a).push([u[o],t.Custprops[u[o]]]);var h=[];for(o=0;o<a.length;++o)LA.indexOf(a[o][0])>-1||MA.indexOf(a[o][0])>-1||a[o][1]!=null&&h.push(a[o]);r.length&&Vt.utils.cfb_add(e,"/SummaryInformation",tE(r,Ap.SI,d,K2)),(n.length||h.length)&&Vt.utils.cfb_add(e,"/DocumentSummaryInformation",tE(n,Ap.DSI,f,W2,h.length?h:null,Ap.UDI))}function sk(t,e){var n=e||{},r=Vt.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Vt.utils.cfb_add(r,a,mS(t,n)),n.biff==8&&(t.Props||t.Custprops)&&ak(t,r),n.biff==8&&t.vbaraw&&AF(r,Vt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var ok={0:{f:c9},1:{f:x9},2:{f:V9},3:{f:b9},4:{f:T9},5:{f:M9},6:{f:H9},7:{f:I9},8:{f:K9},9:{f:W9},10:{f:Y9},11:{f:X9},12:{f:_9},13:{f:U9},14:{f:R9},15:{f:A9},16:{f:k9},17:{f:q9},18:{f:O9},19:{f:p1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PP},40:{},42:{},43:{f:H5},44:{f:j5},45:{f:$5},46:{f:X5},47:{f:Y5},48:{},49:{f:_8},50:{},51:{f:cF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:E5},62:{f:z9},63:{f:gF},64:{f:hP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Qi,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:g9},148:{f:d9,p:16},151:{f:nP},152:{},153:{f:FP},154:{},155:{},156:{f:DP},157:{},158:{},159:{T:1,f:D5},160:{T:-1},161:{T:1,f:Vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lF},336:{T:-1},337:{f:dF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:tg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:p5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rP},427:{f:iP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:p9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:tg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EF},633:{T:1},634:{T:-1},635:{T:1,f:yF},636:{T:-1},637:{f:A8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:SP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Oe(t,e,n,r){var a=e;if(!isNaN(a)){var o=r||(n||[]).length||0,u=t.next(4);u.write_shift(2,a),u.write_shift(2,o),o>0&&h1(n)&&t.push(n)}}function lk(t,e,n,r){var a=(n||[]).length||0;if(a<=8224)return Oe(t,e,n,a);var o=e;if(!isNaN(o)){for(var u=n.parts||[],f=0,d=0,h=0;h+(u[f]||8224)<=8224;)h+=u[f]||8224,f++;var g=t.next(4);for(g.write_shift(2,o),g.write_shift(2,h),t.push(n.slice(d,d+h)),d+=h;d<a;){for(g=t.next(4),g.write_shift(2,60),h=0;h+(u[f]||8224)<=8224;)h+=u[f]||8224,f++;g.write_shift(2,h),t.push(n.slice(d,d+h)),d+=h}}}function sf(t,e,n){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function uk(t,e,n,r){var a=ge(9);return sf(a,t,e),BA(n,r||"b",a),a}function ck(t,e,n){var r=ge(8+2*n.length);return sf(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function fk(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Sr(dr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Oe(t,2,S5(n,r,a)):Oe(t,3,A5(n,r,a));return;case"b":case"e":Oe(t,5,uk(n,r,e.v,e.t));return;case"s":case"str":Oe(t,4,ck(n,r,(e.v||"").slice(0,255)));return}Oe(t,1,sf(null,n,r))}function hk(t,e,n,r){var a=Array.isArray(e),o=Yt(e["!ref"]||"A1"),u,f="",d=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),u=xn(o)}for(var h=o.s.r;h<=o.e.r;++h){f=$n(h);for(var g=o.s.c;g<=o.e.c;++g){h===o.s.r&&(d[g]=nr(g)),u=d[g]+f;var y=a?(e[h]||[])[g]:e[u];y&&fk(t,y,h,g)}}}function dk(t,e){for(var n=e||{},r=Ar(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==n.sheet&&(a=o);if(a==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Oe(r,n.biff==4?1033:n.biff==3?521:9,x1(t,16,n)),hk(r,t.Sheets[t.SheetNames[a]],a,n),Oe(r,10),r.end()}function mk(t,e,n){Oe(t,49,o5({sz:12,name:"Arial"},n))}function pk(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Oe(t,1054,c5(a,e[a],n))})}function gk(t,e){var n=ge(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Oe(t,2151,n),n=ge(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),zA(Yt(e["!ref"]||"A1"),n),n.write_shift(4,4),Oe(t,2152,n)}function vk(t,e){for(var n=0;n<16;++n)Oe(t,224,rE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Oe(t,224,rE(r,0,e))})}function xk(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];Oe(t,440,x5(r)),r[1].Tooltip&&Oe(t,2048,y5(r))}delete e["!links"]}function yk(t,e){if(e){var n=0;e.forEach(function(r,a){++n<=256&&r&&Oe(t,125,T5(J0(a,r),a))})}}function _k(t,e,n,r,a){var o=16+Ls(a.cellXfs,e,a);if(e.v==null&&!e.bf){Oe(t,513,Ro(n,r,o));return}if(e.bf)Oe(t,6,GM(e,n,r,a,o));else switch(e.t){case"d":case"n":var u=e.t=="d"?Sr(dr(e.v)):e.v;Oe(t,515,m5(n,r,u,o));break;case"b":case"e":Oe(t,517,d5(n,r,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var f=w1(a.Strings,e.v,a.revStrings);Oe(t,253,l5(n,r,f,o))}else Oe(t,516,u5(n,r,(e.v||"").slice(0,255),o,a));break;default:Oe(t,513,Ro(n,r,o))}}function Ek(t,e,n){var r=Ar(),a=n.SheetNames[t],o=n.Sheets[a]||{},u=(n||{}).Workbook||{},f=(u.Sheets||[])[t]||{},d=Array.isArray(o),h=e.biff==8,g,y="",x=[],E=Yt(o["!ref"]||"A1"),w=h?65536:16384;if(E.e.c>255||E.e.r>=w){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,w-1)}Oe(r,2057,x1(n,16,e)),Oe(r,13,ei(1)),Oe(r,12,ei(100)),Oe(r,15,hr(!0)),Oe(r,17,hr(!1)),Oe(r,16,Co(.001)),Oe(r,95,hr(!0)),Oe(r,42,hr(!1)),Oe(r,43,hr(!1)),Oe(r,130,ei(1)),Oe(r,128,h5()),Oe(r,131,hr(!1)),Oe(r,132,hr(!1)),h&&yk(r,o["!cols"]),Oe(r,512,f5(E,e)),h&&(o["!links"]=[]);for(var T=E.s.r;T<=E.e.r;++T){y=$n(T);for(var b=E.s.c;b<=E.e.c;++b){T===E.s.r&&(x[b]=nr(b)),g=x[b]+y;var k=d?(o[T]||[])[b]:o[g];k&&(_k(r,k,T,b,e),h&&k.l&&o["!links"].push([g,k.l]))}}var q=f.CodeName||f.name||a;return h&&Oe(r,574,s5((u.Views||[])[0])),h&&(o["!merges"]||[]).length&&Oe(r,229,v5(o["!merges"])),h&&xk(r,o),Oe(r,442,jA(q)),h&&gk(r,o),Oe(r,10),r.end()}function Tk(t,e,n){var r=Ar(),a=(t||{}).Workbook||{},o=a.Sheets||[],u=a.WBProps||{},f=n.biff==8,d=n.biff==5;if(Oe(r,2057,x1(t,5,n)),n.bookType=="xla"&&Oe(r,135),Oe(r,225,f?ei(1200):null),Oe(r,193,Y8(2)),d&&Oe(r,191),d&&Oe(r,192),Oe(r,226),Oe(r,92,n5("SheetJS",n)),Oe(r,66,ei(f?1200:1252)),f&&Oe(r,353,ei(0)),f&&Oe(r,448),Oe(r,317,w5(t.SheetNames.length)),f&&t.vbaraw&&Oe(r,211),f&&t.vbaraw){var h=u.CodeName||"ThisWorkbook";Oe(r,442,jA(h))}Oe(r,156,ei(17)),Oe(r,25,hr(!1)),Oe(r,18,hr(!1)),Oe(r,19,ei(0)),f&&Oe(r,431,hr(!1)),f&&Oe(r,444,ei(0)),Oe(r,61,a5()),Oe(r,64,hr(!1)),Oe(r,141,ei(0)),Oe(r,34,hr(CP(t)=="true")),Oe(r,14,hr(!0)),f&&Oe(r,439,hr(!1)),Oe(r,218,ei(0)),mk(r,t,n),pk(r,t.SSF,n),vk(r,n),f&&Oe(r,352,hr(!1));var g=r.end(),y=Ar();f&&Oe(y,140,_5()),f&&n.Strings&&lk(y,252,i5(n.Strings)),Oe(y,10);var x=y.end(),E=Ar(),w=0,T=0;for(T=0;T<t.SheetNames.length;++T)w+=(f?12:11)+(f?2:1)*t.SheetNames[T].length;var b=g.length+w+x.length;for(T=0;T<t.SheetNames.length;++T){var k=o[T]||{};Oe(E,133,r5({pos:b,hs:k.Hidden||0,dt:0,name:t.SheetNames[T]},n)),b+=e[T].length}var q=E.end();if(w!=q.length)throw new Error("BS8 "+w+" != "+q.length);var Y=[];return g.length&&Y.push(g),q.length&&Y.push(q),x.length&&Y.push(x),Gn(Y)}function wk(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=br(rn)),t&&t.SSF&&(X0(),Y0(t.SSF),n.revssf=W0(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,A1(n),n.cellXfs=[],Ls(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)r[r.length]=Ek(a,n,t);return r.unshift(Tk(t,r,n)),Gn(r)}function mS(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var a=Ur(r["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return wk(t,e);case 4:case 3:case 2:return dk(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Ak(t,e,n,r){for(var a=t["!merges"]||[],o=[],u=e.s.c;u<=e.e.c;++u){for(var f=0,d=0,h=0;h<a.length;++h)if(!(a[h].s.r>n||a[h].s.c>u)&&!(a[h].e.r<n||a[h].e.c<u)){if(a[h].s.r<n||a[h].s.c<u){f=-1;break}f=a[h].e.r-a[h].s.r+1,d=a[h].e.c-a[h].s.c+1;break}if(!(f<0)){var g=Ft({r:n,c:u}),y=r.dense?(t[n]||[])[u]:t[g],x=y&&y.v!=null&&(y.h||t8(y.w||(Fa(y),y.w)||""))||"",E={};f>1&&(E.rowspan=f),d>1&&(E.colspan=d),r.editable?x='<span contenteditable="true">'+x+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(x='<a href="'+y.l.Target+'">'+x+"</a>")),E.id=(r.id||"sjs")+"-"+g,o.push(Ie("td",x,E))}}var w="<tr>";return w+o.join("")+"</tr>"}var Sk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bk="</body></html>";function Ck(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function pS(t,e){var n=e||{},r=n.header!=null?n.header:Sk,a=n.footer!=null?n.footer:bk,o=[r],u=Ur(t["!ref"]);n.dense=Array.isArray(t),o.push(Ck(t,u,n));for(var f=u.s.r;f<=u.e.r;++f)o.push(Ak(t,u,f,n));return o.push("</table>"+a),o.join("")}function gS(t,e,n){var r=n||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mn(r.origin):r.origin;a=u.r,o=u.c}var f=e.getElementsByTagName("tr"),d=Math.min(r.sheetRows||1e7,f.length),h={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var g=Ur(t["!ref"]);h.s.r=Math.min(h.s.r,g.s.r),h.s.c=Math.min(h.s.c,g.s.c),h.e.r=Math.max(h.e.r,g.e.r),h.e.c=Math.max(h.e.c,g.e.c),a==-1&&(h.e.r=a=g.e.r+1)}var y=[],x=0,E=t["!rows"]||(t["!rows"]=[]),w=0,T=0,b=0,k=0,q=0,Y=0;for(t["!cols"]||(t["!cols"]=[]);w<f.length&&T<d;++w){var ee=f[w];if(cE(ee)){if(r.display)continue;E[T]={hidden:!0}}var he=ee.children;for(b=k=0;b<he.length;++b){var Ae=he[b];if(!(r.display&&cE(Ae))){var D=Ae.hasAttribute("data-v")?Ae.getAttribute("data-v"):Ae.hasAttribute("v")?Ae.getAttribute("v"):a8(Ae.innerHTML),I=Ae.getAttribute("data-z")||Ae.getAttribute("z");for(x=0;x<y.length;++x){var R=y[x];R.s.c==k+o&&R.s.r<T+a&&T+a<=R.e.r&&(k=R.e.c+1-o,x=-1)}Y=+Ae.getAttribute("colspan")||1,((q=+Ae.getAttribute("rowspan")||1)>1||Y>1)&&y.push({s:{r:T+a,c:k+o},e:{r:T+a+(q||1)-1,c:k+o+(Y||1)-1}});var P={t:"s",v:D},B=Ae.getAttribute("data-t")||Ae.getAttribute("t")||"";D!=null&&(D.length==0?P.t=B||"z":r.raw||D.trim().length==0||B=="s"||(D==="TRUE"?P={t:"b",v:!0}:D==="FALSE"?P={t:"b",v:!1}:isNaN(Sa(D))?isNaN(Lc(D).getDate())||(P={t:"d",v:dr(D)},r.cellDates||(P={t:"n",v:Sr(P.v)}),P.z=r.dateNF||rn[14]):P={t:"n",v:Sa(D)})),P.z===void 0&&I!=null&&(P.z=I);var H="",V=Ae.getElementsByTagName("A");if(V&&V.length)for(var Je=0;Je<V.length&&!(V[Je].hasAttribute("href")&&(H=V[Je].getAttribute("href"),H.charAt(0)!="#"));++Je);H&&H.charAt(0)!="#"&&(P.l={Target:H}),r.dense?(t[T+a]||(t[T+a]=[]),t[T+a][k+o]=P):t[Ft({c:k+o,r:T+a})]=P,h.e.c<k+o&&(h.e.c=k+o),k+=Y}}++T}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),h.e.r=Math.max(h.e.r,T-1+a),t["!ref"]=xn(h),T>=d&&(t["!fullref"]=xn((h.e.r=f.length-w+T-1+a,h))),t}function vS(t,e){var n=e||{},r=n.dense?[]:{};return gS(r,t,e)}function Rk(t,e){return Mo(vS(t,e),e)}function cE(t){var e="",n=Nk(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Nk(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Ik=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return yn+e}}(),fE=function(){var t=function(o){return Ot(o).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(o,u,f){var d=[];d.push('      <table:table table:name="'+Ot(u.SheetNames[f])+`" table:style-name="ta1">
`);var h=0,g=0,y=Ur(o["!ref"]||"A1"),x=o["!merges"]||[],E=0,w=Array.isArray(o);if(o["!cols"])for(g=0;g<=y.e.c;++g)d.push("        <table:table-column"+(o["!cols"][g]?' table:style-name="co'+o["!cols"][g].ods+'"':"")+`></table:table-column>
`);var T="",b=o["!rows"]||[];for(h=0;h<y.s.r;++h)T=b[h]?' table:style-name="ro'+b[h].ods+'"':"",d.push("        <table:table-row"+T+`></table:table-row>
`);for(;h<=y.e.r;++h){for(T=b[h]?' table:style-name="ro'+b[h].ods+'"':"",d.push("        <table:table-row"+T+`>
`),g=0;g<y.s.c;++g)d.push(e);for(;g<=y.e.c;++g){var k=!1,q={},Y="";for(E=0;E!=x.length;++E)if(!(x[E].s.c>g)&&!(x[E].s.r>h)&&!(x[E].e.c<g)&&!(x[E].e.r<h)){(x[E].s.c!=g||x[E].s.r!=h)&&(k=!0),q["table:number-columns-spanned"]=x[E].e.c-x[E].s.c+1,q["table:number-rows-spanned"]=x[E].e.r-x[E].s.r+1;break}if(k){d.push(n);continue}var ee=Ft({r:h,c:g}),he=w?(o[h]||[])[g]:o[ee];if(he&&he.f&&(q["table:formula"]=Ot(KM(he.f)),he.F&&he.F.slice(0,ee.length)==ee)){var Ae=Ur(he.F);q["table:number-matrix-columns-spanned"]=Ae.e.c-Ae.s.c+1,q["table:number-matrix-rows-spanned"]=Ae.e.r-Ae.s.r+1}if(!he){d.push(e);continue}switch(he.t){case"b":Y=he.v?"TRUE":"FALSE",q["office:value-type"]="boolean",q["office:boolean-value"]=he.v?"true":"false";break;case"n":Y=he.w||String(he.v||0),q["office:value-type"]="float",q["office:value"]=he.v||0;break;case"s":case"str":Y=he.v==null?"":he.v,q["office:value-type"]="string";break;case"d":Y=he.w||dr(he.v).toISOString(),q["office:value-type"]="date",q["office:date-value"]=dr(he.v).toISOString(),q["table:style-name"]="ce1";break;default:d.push(e);continue}var D=t(Y);if(he.l&&he.l.Target){var I=he.l.Target;I=I.charAt(0)=="#"?"#"+QM(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),D=Ie("text:a",D,{"xlink:href":I.replace(/&/g,"&amp;")})}d.push("          "+Ie("table:table-cell",Ie("text:p",D,{}),q)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},a=function(o,u){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var f=0;u.SheetNames.map(function(h){return u.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var g=0;g<h["!cols"].length;++g)if(h["!cols"][g]){var y=h["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;y1(y),y.ods=f;var x=h["!cols"][g].wpx+"px";o.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+x+`"/>
`),o.push(`  </style:style>
`),++f}}});var d=0;u.SheetNames.map(function(h){return u.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var g=0;g<h["!rows"].length;++g)if(h["!rows"][g]){h["!rows"][g].ods=d;var y=h["!rows"][g].hpx+"px";o.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),o.push(`  </style:style>
`),++d}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(u,f){var d=[yn],h=Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Bc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(d.push("<office:document"+h+g+`>
`),d.push(OA().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+h+`>
`),a(d,u),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var y=0;y!=u.SheetNames.length;++y)d.push(r(u.Sheets[u.SheetNames[y]],u,y));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),f.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}}();function xS(t,e){if(e.bookType=="fods")return fE(t,e);var n=l1(),r="",a=[],o=[];return r="mimetype",it(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",it(n,r,fE(t,e)),a.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",it(n,r,Ik(t,e)),a.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",it(n,r,yn+OA()),a.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",it(n,r,z8(o)),a.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",it(n,r,U8(a)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _0(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Dk(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):di(Vc(t))}function Ok(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Ms(t){var e=t.reduce(function(a,o){return a+o.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function Fk(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=n>=0?0:128}function Uc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function It(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function Hl(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function An(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Uc(t,n),o=a&7;a=Math.floor(a/8);var u=0,f;if(a==0)break;switch(o){case 0:{for(var d=n[0];t[n[0]++]>=128;);f=t.slice(d,n[0])}break;case 5:u=4,f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 1:u=8,f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 2:u=Uc(t,n),f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var h={data:f,type:o};e[a]==null?e[a]=[h]:e[a].push(h)}return e}function Un(t){var e=[];return t.forEach(function(n,r){n.forEach(function(a){a.data&&(e.push(It(r*8+a.type)),a.type==2&&e.push(It(a.data.length)),e.push(a.data))})}),Ms(e)}function fi(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Uc(t,r),o=An(t.slice(r[0],r[0]+a));r[0]+=a;var u={id:Hl(o[1][0].data),messages:[]};o[2].forEach(function(f){var d=An(f.data),h=Hl(d[3][0].data);u.messages.push({meta:d,data:t.slice(r[0],r[0]+h)}),r[0]+=h}),(e=o[3])!=null&&e[0]&&(u.merge=Hl(o[3][0].data)>>>0>0),n.push(u)}return n}function Rl(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:It(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:It(+!!n.merge),type:0}]);var a=[];n.messages.forEach(function(u){a.push(u.data),u.meta[3]=[{type:0,data:It(u.data.length)}],r[2].push({data:Un(u.meta),type:2})});var o=Un(r);e.push(It(o.length)),e.push(o),a.forEach(function(u){return e.push(u)})}),Ms(e)}function Mk(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Uc(e,n),a=[];n[0]<e.length;){var o=e[n[0]]&3;if(o==0){var u=e[n[0]++]>>2;if(u<60)++u;else{var f=u-59;u=e[n[0]],f>1&&(u|=e[n[0]+1]<<8),f>2&&(u|=e[n[0]+2]<<16),f>3&&(u|=e[n[0]+3]<<24),u>>>=0,u++,n[0]+=f}a.push(e.slice(n[0],n[0]+u)),n[0]+=u;continue}else{var d=0,h=0;if(o==1?(h=(e[n[0]]>>2&7)+4,d=(e[n[0]++]&224)<<3,d|=e[n[0]++]):(h=(e[n[0]++]>>2)+1,o==2?(d=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(d=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Ms(a)],d==0)throw new Error("Invalid offset 0");if(d>a[0].length)throw new Error("Invalid offset beyond length");if(h>=d)for(a.push(a[0].slice(-d)),h-=d;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-d,-d+h))}}var g=Ms(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function hi(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(Mk(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Ms(e)}function Nl(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),a=new Uint8Array(4);e.push(a);var o=It(r),u=o.length;e.push(o),r<=60?(u++,e.push(new Uint8Array([r-1<<2]))):r<=256?(u+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(u+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(u+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(u+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),u+=r,a[0]=0,a[1]=u&255,a[2]=u>>8&255,a[3]=u>>16&255,n+=r}return Ms(e)}function Sp(t,e){var n=new Uint8Array(32),r=_0(n),a=12,o=0;switch(n[0]=5,t.t){case"n":n[1]=2,Fk(n,a,t.v),o|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,o,!0),n.slice(0,a)}function bp(t,e){var n=new Uint8Array(32),r=_0(n),a=12,o=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,o,!0),n.slice(0,a)}function cs(t){var e=An(t);return Uc(e[1][0].data)}function Pk(t,e,n){var r,a,o,u;if(!((r=t[6])!=null&&r[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var f=((u=(o=t[8])==null?void 0:o[0])==null?void 0:u.data)&&Hl(t[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var d=0,h=_0(t[7][0].data),g=0,y=[],x=_0(t[4][0].data),E=0,w=[],T=0;T<e.length;++T){if(e[T]==null){h.setUint16(T*2,65535,!0),x.setUint16(T*2,65535);continue}h.setUint16(T*2,g,!0),x.setUint16(T*2,E,!0);var b,k;switch(typeof e[T]){case"string":b=Sp({t:"s",v:e[T]},n),k=bp({t:"s",v:e[T]},n);break;case"number":b=Sp({t:"n",v:e[T]},n),k=bp({t:"n",v:e[T]},n);break;case"boolean":b=Sp({t:"b",v:e[T]},n),k=bp({t:"b",v:e[T]},n);break;default:throw new Error("Unsupported value "+e[T])}y.push(b),g+=b.length,w.push(k),E+=k.length,++d}for(t[2][0].data=It(d);T<t[7][0].data.length/2;++T)h.setUint16(T*2,65535,!0),x.setUint16(T*2,65535,!0);return t[6][0].data=Ms(y),t[3][0].data=Ms(w),d}function kk(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Ur(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(xn(r)));var o=E0(n,{range:r,header:1}),u=["~Sh33tJ5~"];o.forEach(function(W){return W.forEach(function(K){typeof K=="string"&&u.push(K)})});var f={},d=[],h=Vt.read(e.numbers,{type:"base64"});h.FileIndex.map(function(W,K){return[W,h.FullPaths[K]]}).forEach(function(W){var K=W[0],Z=W[1];if(K.type==2&&K.name.match(/\.iwa/)){var ce=K.content,Le=hi(ce),Fe=fi(Le);Fe.forEach(function(Be){d.push(Be.id),f[Be.id]={deps:[],location:Z,type:Hl(Be.messages[0].meta[1][0].data)}})}}),d.sort(function(W,K){return W-K});var g=d.filter(function(W){return W>1}).map(function(W){return[W,It(W)]});h.FileIndex.map(function(W,K){return[W,h.FullPaths[K]]}).forEach(function(W){var K=W[0];if(W[1],!!K.name.match(/\.iwa/)){var Z=fi(hi(K.content));Z.forEach(function(ce){ce.messages.forEach(function(Le){g.forEach(function(Fe){ce.messages.some(function(Be){return Hl(Be.meta[1][0].data)!=11006&&Ok(Be.data,Fe[1])})&&f[Fe[0]].deps.push(ce.id)})})})}});for(var y=Vt.find(h,f[1].location),x=fi(hi(y.content)),E,w=0;w<x.length;++w){var T=x[w];T.id==1&&(E=T)}var b=cs(An(E.messages[0].data)[1][0].data);for(y=Vt.find(h,f[b].location),x=fi(hi(y.content)),w=0;w<x.length;++w)T=x[w],T.id==b&&(E=T);for(b=cs(An(E.messages[0].data)[2][0].data),y=Vt.find(h,f[b].location),x=fi(hi(y.content)),w=0;w<x.length;++w)T=x[w],T.id==b&&(E=T);for(b=cs(An(E.messages[0].data)[2][0].data),y=Vt.find(h,f[b].location),x=fi(hi(y.content)),w=0;w<x.length;++w)T=x[w],T.id==b&&(E=T);var k=An(E.messages[0].data);{k[6][0].data=It(r.e.r+1),k[7][0].data=It(r.e.c+1);var q=cs(k[46][0].data),Y=Vt.find(h,f[q].location),ee=fi(hi(Y.content));{for(var he=0;he<ee.length&&ee[he].id!=q;++he);if(ee[he].id!=q)throw"Bad ColumnRowUIDMapArchive";var Ae=An(ee[he].messages[0].data);Ae[1]=[],Ae[2]=[],Ae[3]=[];for(var D=0;D<=r.e.c;++D){var I=[];I[1]=I[2]=[{type:0,data:It(D+420690)}],Ae[1].push({type:2,data:Un(I)}),Ae[2].push({type:0,data:It(D)}),Ae[3].push({type:0,data:It(D)})}Ae[4]=[],Ae[5]=[],Ae[6]=[];for(var R=0;R<=r.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:It(R+726270)}],Ae[4].push({type:2,data:Un(I)}),Ae[5].push({type:0,data:It(R)}),Ae[6].push({type:0,data:It(R)});ee[he].messages[0].data=Un(Ae)}Y.content=Nl(Rl(ee)),Y.size=Y.content.length,delete k[46];var P=An(k[4][0].data);{P[7][0].data=It(r.e.r+1);var B=An(P[1][0].data),H=cs(B[2][0].data);Y=Vt.find(h,f[H].location),ee=fi(hi(Y.content));{if(ee[0].id!=H)throw"Bad HeaderStorageBucket";var V=An(ee[0].messages[0].data);for(R=0;R<o.length;++R){var Je=An(V[2][0].data);Je[1][0].data=It(R),Je[4][0].data=It(o[R].length),V[2][R]={type:V[2][0].type,data:Un(Je)}}ee[0].messages[0].data=Un(V)}Y.content=Nl(Rl(ee)),Y.size=Y.content.length;var He=cs(P[2][0].data);Y=Vt.find(h,f[He].location),ee=fi(hi(Y.content));{if(ee[0].id!=He)throw"Bad HeaderStorageBucket";for(V=An(ee[0].messages[0].data),D=0;D<=r.e.c;++D)Je=An(V[2][0].data),Je[1][0].data=It(D),Je[4][0].data=It(r.e.r+1),V[2][D]={type:V[2][0].type,data:Un(Je)};ee[0].messages[0].data=Un(V)}Y.content=Nl(Rl(ee)),Y.size=Y.content.length;var de=cs(P[4][0].data);(function(){for(var W=Vt.find(h,f[de].location),K=fi(hi(W.content)),Z,ce=0;ce<K.length;++ce){var Le=K[ce];Le.id==de&&(Z=Le)}var Fe=An(Z.messages[0].data);{Fe[3]=[];var Be=[];u.forEach(function(nt,Kt){Be[1]=[{type:0,data:It(Kt)}],Be[2]=[{type:0,data:It(1)}],Be[3]=[{type:2,data:Dk(nt)}],Fe[3].push({type:2,data:Un(Be)})})}Z.messages[0].data=Un(Fe);var Me=Rl(K),ut=Nl(Me);W.content=ut,W.size=W.content.length})();var Ce=An(P[3][0].data);{var ze=Ce[1][0];delete Ce[2];var Xe=An(ze.data);{var Q=cs(Xe[2][0].data);(function(){for(var W=Vt.find(h,f[Q].location),K=fi(hi(W.content)),Z,ce=0;ce<K.length;++ce){var Le=K[ce];Le.id==Q&&(Z=Le)}var Fe=An(Z.messages[0].data);{delete Fe[6],delete Ce[7];var Be=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var Me=0,ut=0;ut<=r.e.r;++ut){var nt=An(Be);Me+=Pk(nt,o[ut],u),nt[1][0].data=It(ut),Fe[5].push({data:Un(nt),type:2})}Fe[1]=[{type:0,data:It(r.e.c+1)}],Fe[2]=[{type:0,data:It(r.e.r+1)}],Fe[3]=[{type:0,data:It(Me)}],Fe[4]=[{type:0,data:It(r.e.r+1)}]}Z.messages[0].data=Un(Fe);var Kt=Rl(K),ot=Nl(Kt);W.content=ot,W.size=W.content.length})()}ze.data=Un(Xe)}P[3][0].data=Un(Ce)}k[4][0].data=Un(P)}E.messages[0].data=Un(k);var _e=Rl(x),U=Nl(_e);return y.content=U,y.size=y.content.length,h}function Lk(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function A1(t){Lk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Vk(t,e){return e.bookType=="ods"?xS(t,e):e.bookType=="numbers"?kk(t,e):e.bookType=="xlsb"?Bk(t,e):Uk(t,e)}function Bk(t,e){kl=1024,t&&!t.SSF&&(t.SSF=br(rn)),t&&t.SSF&&(X0(),Y0(t.SSF),e.revssf=W0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Sc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=eS.indexOf(e.bookType)>-1,a=NA();A1(e=e||{});var o=l1(),u="",f=0;if(e.cellXfs=[],Ls(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",it(o,u,FA(t.Props,e)),a.coreprops.push(u),Dt(e.rels,2,u,wt.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var d=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(t.SheetNames[h]);t.Props.SheetNames=d}for(t.Props.Worksheets=t.Props.SheetNames.length,it(o,u,PA(t.Props)),a.extprops.push(u),Dt(e.rels,3,u,wt.EXT_PROPS),t.Custprops!==t.Props&&Xn(t.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,kA(t.Custprops)),a.custprops.push(u),Dt(e.rels,4,u,wt.CUST_PROPS)),f=1;f<=t.SheetNames.length;++f){var g={"!id":{}},y=t.Sheets[t.SheetNames[f-1]],x=(y||{})["!type"]||"sheet";switch(x){case"chart":default:u="xl/worksheets/sheet"+f+"."+n,it(o,u,zP(f-1,u,e,t,g)),a.sheets.push(u),Dt(e.wbrels,-1,"worksheets/sheet"+f+"."+n,wt.WS[0])}if(y){var E=y["!comments"],w=!1,T="";E&&E.length>0&&(T="xl/comments"+f+"."+n,it(o,T,qP(E,T)),a.comments.push(T),Dt(g,-1,"../comments"+f+"."+n,wt.CMNT),w=!0),y["!legacy"]&&w&&it(o,"xl/drawings/vmlDrawing"+f+".vml",ZA(f,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&it(o,DA(u),jl(g))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+n,it(o,u,GP(e.Strings,u,e)),a.strs.push(u),Dt(e.wbrels,-1,"sharedStrings."+n,wt.SST)),u="xl/workbook."+n,it(o,u,jP(t,u)),a.workbooks.push(u),Dt(e.rels,1,u,wt.WB),u="xl/theme/theme1.xml",it(o,u,KA(t.Themes,e)),a.themes.push(u),Dt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),u="xl/styles."+n,it(o,u,HP(t,u,e)),a.styles.push(u),Dt(e.wbrels,-1,"styles."+n,wt.STY),t.vbaraw&&r&&(u="xl/vbaProject.bin",it(o,u,t.vbaraw),a.vba.push(u),Dt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),u="xl/metadata."+n,it(o,u,$P(u)),a.metadata.push(u),Dt(e.wbrels,-1,"metadata."+n,wt.XLMETA),it(o,"[Content_Types].xml",IA(a,e)),it(o,"_rels/.rels",jl(e.rels)),it(o,"xl/_rels/workbook."+n+".rels",jl(e.wbrels)),delete e.revssf,delete e.ssf,o}function Uk(t,e){kl=1024,t&&!t.SSF&&(t.SSF=br(rn)),t&&t.SSF&&(X0(),Y0(t.SSF),e.revssf=W0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Sc?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=eS.indexOf(e.bookType)>-1,a=NA();A1(e=e||{});var o=l1(),u="",f=0;if(e.cellXfs=[],Ls(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",it(o,u,FA(t.Props,e)),a.coreprops.push(u),Dt(e.rels,2,u,wt.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var d=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&d.push(t.SheetNames[h]);t.Props.SheetNames=d}t.Props.Worksheets=t.Props.SheetNames.length,it(o,u,PA(t.Props)),a.extprops.push(u),Dt(e.rels,3,u,wt.EXT_PROPS),t.Custprops!==t.Props&&Xn(t.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,kA(t.Custprops)),a.custprops.push(u),Dt(e.rels,4,u,wt.CUST_PROPS));var g=["SheetJ5"];for(e.tcid=0,f=1;f<=t.SheetNames.length;++f){var y={"!id":{}},x=t.Sheets[t.SheetNames[f-1]],E=(x||{})["!type"]||"sheet";switch(E){case"chart":default:u="xl/worksheets/sheet"+f+"."+n,it(o,u,uS(f-1,e,t,y)),a.sheets.push(u),Dt(e.wbrels,-1,"worksheets/sheet"+f+"."+n,wt.WS[0])}if(x){var w=x["!comments"],T=!1,b="";if(w&&w.length>0){var k=!1;w.forEach(function(q){q[1].forEach(function(Y){Y.T==!0&&(k=!0)})}),k&&(b="xl/threadedComments/threadedComment"+f+"."+n,it(o,b,vF(w,g,e)),a.threadedcomments.push(b),Dt(y,-1,"../threadedComments/threadedComment"+f+"."+n,wt.TCMNT)),b="xl/comments"+f+"."+n,it(o,b,JA(w)),a.comments.push(b),Dt(y,-1,"../comments"+f+"."+n,wt.CMNT),T=!0}x["!legacy"]&&T&&it(o,"xl/drawings/vmlDrawing"+f+".vml",ZA(f,x["!comments"])),delete x["!comments"],delete x["!legacy"]}y["!id"].rId1&&it(o,DA(u),jl(y))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+n,it(o,u,GA(e.Strings,e)),a.strs.push(u),Dt(e.wbrels,-1,"sharedStrings."+n,wt.SST)),u="xl/workbook."+n,it(o,u,hS(t)),a.workbooks.push(u),Dt(e.rels,1,u,wt.WB),u="xl/theme/theme1.xml",it(o,u,KA(t.Themes,e)),a.themes.push(u),Dt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),u="xl/styles."+n,it(o,u,XA(t,e)),a.styles.push(u),Dt(e.wbrels,-1,"styles."+n,wt.STY),t.vbaraw&&r&&(u="xl/vbaProject.bin",it(o,u,t.vbaraw),a.vba.push(u),Dt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),u="xl/metadata."+n,it(o,u,QA()),a.metadata.push(u),Dt(e.wbrels,-1,"metadata."+n,wt.XLMETA),g.length>1&&(u="xl/persons/person.xml",it(o,u,xF(g)),a.people.push(u),Dt(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),it(o,"[Content_Types].xml",IA(a,e)),it(o,"_rels/.rels",jl(e.rels)),it(o,"xl/_rels/workbook."+n+".rels",jl(e.wbrels)),delete e.revssf,delete e.ssf,o}function jk(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Oa(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function yS(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return tf(e.file,Vt.write(t,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Vt.write(t,e)}function zk(t,e){var n=br(e||{}),r=Vk(t,n);return Hk(r,n)}function Hk(t,e){var n={},r=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?Vt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array($0(a))}return e.password&&typeof encrypt_agile<"u"?yS(encrypt_agile(a,e.password),e):e.type==="file"?tf(e.file,a):e.type=="string"?Ec(a):a}function Gk(t,e){var n=e||{},r=sk(t,n);return yS(r,n)}function Ui(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return kc(Vc(r));case"binary":return Vc(r);case"string":return t;case"file":return tf(e.file,r,"utf8");case"buffer":return St?Pa(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ui(r,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function qk(t,e){switch(e.type){case"base64":return kc(t);case"binary":return t;case"string":return t;case"file":return tf(e.file,t,"binary");case"buffer":return St?Pa(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ph(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?kc(n):e.type=="string"?Ec(n):n;case"file":return tf(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function _S(t,e){yO(),IP(t);var n=br(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=_S(t,n);return n.type="array",$0(r)}var a=0;if(n.sheet&&(typeof n.sheet=="number"?a=n.sheet:a=t.SheetNames.indexOf(n.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Ui(ik(t,n),n);case"slk":case"sylk":return Ui(C5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"htm":case"html":return Ui(pS(t.Sheets[t.SheetNames[a]],n),n);case"txt":return qk(ES(t.Sheets[t.SheetNames[a]],n),n);case"csv":return Ui(S1(t.Sheets[t.SheetNames[a]],n),n,"\uFEFF");case"dif":return Ui(R5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"dbf":return Ph(b5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"prn":return Ui(N5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"rtf":return Ui(k5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"eth":return Ui(HA.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"fods":return Ui(xS(t,n),n);case"wk1":return Ph(iE.sheet_to_wk1(t.Sheets[t.SheetNames[a]],n),n);case"wk3":return Ph(iE.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Ph(mS(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),Gk(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return zk(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function $k(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function ed(t,e,n){var r={};return r.type="file",r.file=e,$k(r),_S(t,r)}function Yk(t,e,n,r,a,o,u,f){var d=$n(n),h=f.defval,g=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),y=!0,x=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(x,"__rowNum__",{value:n,enumerable:!1})}catch{x.__rowNum__=n}else x.__rowNum__=n;if(!u||t[n])for(var E=e.s.c;E<=e.e.c;++E){var w=u?t[n][E]:t[r[E]+d];if(w===void 0||w.t===void 0){if(h===void 0)continue;o[E]!=null&&(x[o[E]]=h);continue}var T=w.v;switch(w.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[E]!=null){if(T==null)if(w.t=="e"&&T===null)x[o[E]]=null;else if(h!==void 0)x[o[E]]=h;else if(g&&T===null)x[o[E]]=null;else continue;else x[o[E]]=g&&(w.t!=="n"||w.t==="n"&&f.rawNumbers!==!1)?T:Fa(w,T,f);T!=null&&(y=!1)}}return{row:x,isempty:y}}function E0(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,o=[],u=0,f="",d={s:{r:0,c:0},e:{r:0,c:0}},h=e||{},g=h.range!=null?h.range:t["!ref"];switch(h.header===1?r=1:h.header==="A"?r=2:Array.isArray(h.header)?r=3:h.header==null&&(r=0),typeof g){case"string":d=Yt(g);break;case"number":d=Yt(t["!ref"]),d.s.r=g;break;default:d=g}r>0&&(a=0);var y=$n(d.s.r),x=[],E=[],w=0,T=0,b=Array.isArray(t),k=d.s.r,q=0,Y={};b&&!t[k]&&(t[k]=[]);var ee=h.skipHidden&&t["!cols"]||[],he=h.skipHidden&&t["!rows"]||[];for(q=d.s.c;q<=d.e.c;++q)if(!(ee[q]||{}).hidden)switch(x[q]=nr(q),n=b?t[k][q]:t[x[q]+y],r){case 1:o[q]=q-d.s.c;break;case 2:o[q]=x[q];break;case 3:o[q]=h.header[q-d.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),f=u=Fa(n,null,h),T=Y[u]||0,!T)Y[u]=1;else{do f=u+"_"+T++;while(Y[f]);Y[u]=T,Y[f]=1}o[q]=f}for(k=d.s.r+a;k<=d.e.r;++k)if(!(he[k]||{}).hidden){var Ae=Yk(t,d,k,x,r,o,b,h);(Ae.isempty===!1||(r===1?h.blankrows!==!1:h.blankrows))&&(E[w++]=Ae.row)}return E.length=w,E}var hE=/"/g;function Xk(t,e,n,r,a,o,u,f){for(var d=!0,h=[],g="",y=$n(n),x=e.s.c;x<=e.e.c;++x)if(r[x]){var E=f.dense?(t[n]||[])[x]:t[r[x]+y];if(E==null)g="";else if(E.v!=null){d=!1,g=""+(f.rawNumbers&&E.t=="n"?E.v:Fa(E,null,f));for(var w=0,T=0;w!==g.length;++w)if((T=g.charCodeAt(w))===a||T===o||T===34||f.forceQuotes){g='"'+g.replace(hE,'""')+'"';break}g=="ID"&&(g='"ID"')}else E.f!=null&&!E.F?(d=!1,g="="+E.f,g.indexOf(",")>=0&&(g='"'+g.replace(hE,'""')+'"')):g="";h.push(g)}return f.blankrows===!1&&d?null:h.join(u)}function S1(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=Yt(t["!ref"]),o=r.FS!==void 0?r.FS:",",u=o.charCodeAt(0),f=r.RS!==void 0?r.RS:`
`,d=f.charCodeAt(0),h=new RegExp((o=="|"?"\\|":o)+"+$"),g="",y=[];r.dense=Array.isArray(t);for(var x=r.skipHidden&&t["!cols"]||[],E=r.skipHidden&&t["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(x[w]||{}).hidden||(y[w]=nr(w));for(var T=0,b=a.s.r;b<=a.e.r;++b)(E[b]||{}).hidden||(g=Xk(t,a,b,y,u,d,o,r),g!=null&&(r.strip&&(g=g.replace(h,"")),(g||r.blankrows!==!1)&&n.push((T++?f:"")+g)));return delete r.dense,n.join("")}function ES(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=S1(t,e);return n}function Wk(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=Yt(t["!ref"]),o="",u=[],f,d=[],h=Array.isArray(t);for(f=a.s.c;f<=a.e.c;++f)u[f]=nr(f);for(var g=a.s.r;g<=a.e.r;++g)for(o=$n(g),f=a.s.c;f<=a.e.c;++f)if(e=u[f]+o,n=h?(t[g]||[])[f]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}d[d.length]=e+"="+r}return d}function TS(t,e,n){var r=n||{},a=+!r.skipHeader,o=t||{},u=0,f=0;if(o&&r.origin!=null)if(typeof r.origin=="number")u=r.origin;else{var d=typeof r.origin=="string"?Mn(r.origin):r.origin;u=d.r,f=d.c}var h,g={s:{c:0,r:0},e:{c:f,r:u+e.length-1+a}};if(o["!ref"]){var y=Yt(o["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),u==-1&&(u=y.e.r+1,g.e.r=u+e.length-1+a)}else u==-1&&(u=0,g.e.r=e.length-1+a);var x=r.header||[],E=0;e.forEach(function(T,b){Xn(T).forEach(function(k){(E=x.indexOf(k))==-1&&(x[E=x.length]=k);var q=T[k],Y="z",ee="",he=Ft({c:f+E,r:u+b+a});h=jc(o,he),q&&typeof q=="object"&&!(q instanceof Date)?o[he]=q:(typeof q=="number"?Y="n":typeof q=="boolean"?Y="b":typeof q=="string"?Y="s":q instanceof Date?(Y="d",r.cellDates||(Y="n",q=Sr(q)),ee=r.dateNF||rn[14]):q===null&&r.nullError&&(Y="e",q=0),h?(h.t=Y,h.v=q,delete h.w,delete h.R,ee&&(h.z=ee)):o[he]=h={t:Y,v:q},ee&&(h.z=ee))})}),g.e.c=Math.max(g.e.c,f+x.length-1);var w=$n(u);if(a)for(E=0;E<x.length;++E)o[nr(E+f)+w]={t:"s",v:x[E]};return o["!ref"]=xn(g),o}function Kk(t,e){return TS(null,t,e)}function jc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=Mn(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?jc(t,Ft(e)):jc(t,Ft({r:e,c:n||0}))}function Qk(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Zk(){return{SheetNames:[],Sheets:{}}}function Jk(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var u=o&&o[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=u+a)!=-1;++a);}if(fS(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function eL(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=Qk(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function tL(t,e){return t.z=e,t}function wS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function nL(t,e,n){return wS(t,"#"+e,n)}function rL(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function iL(t,e,n,r){for(var a=typeof e!="string"?e:Yt(e),o=typeof e=="string"?e:xn(e),u=a.s.r;u<=a.e.r;++u)for(var f=a.s.c;f<=a.e.c;++f){var d=jc(t,u,f);d.t="n",d.F=o,delete d.v,u==a.s.r&&f==a.s.c&&(d.f=n,r&&(d.D=!0))}return t}var Bt={encode_col:nr,encode_row:$n,encode_cell:Ft,encode_range:xn,decode_col:m1,decode_row:d1,split_cell:y8,decode_cell:Mn,decode_range:Ur,format_cell:Fa,sheet_add_aoa:wA,sheet_add_json:TS,sheet_add_dom:gS,aoa_to_sheet:iu,json_to_sheet:Kk,table_to_sheet:vS,table_to_book:Rk,sheet_to_csv:S1,sheet_to_txt:ES,sheet_to_json:E0,sheet_to_html:pS,sheet_to_formulae:Wk,sheet_to_row_object_array:E0,sheet_get_cell:jc,book_new:Zk,book_append_sheet:Jk,book_set_sheet_visibility:eL,cell_set_number_format:tL,cell_set_hyperlink:wS,cell_set_internal_link:nL,cell_add_comment:rL,sheet_set_array_formula:iL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aL=async t=>{try{const e=t.invoiceNumber||`temp${Math.random().toString(10).substring(2,10)}`,n=Is(Xi,"invoices",e);(await H0(n)).exists()?(await wo(n,t,{merge:!0}),alert("Invoice updated in Firebase!")):(await wo(n,t),alert("Invoice saved to Firebase!"))}catch(e){console.error("Error saving invoice:",e),alert("Error saving invoice. Please try again.")}},sL=()=>{const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"If any work is extended on site, the additional amount will be added during the final completion and may be collected before the site is handed over.",items:[{sno:1,name:"",quantity:1,price:0,total:0}],brandInvoice:!1}),{invoiceId:n}=TE();ve.useEffect(()=>{(async()=>{const y=Is(Xi,"invoices",n),x=await H0(y);x.exists()&&e(x.data())})()},[]);const r=()=>t.items.reduce((g,y)=>g+y.total,0),a=async()=>{try{if(t.invoiceNumber&&t.clientName){const y=t.invoiceNumber||`temp${Math.random().toString(10).substring(2,10)}`,x=Is(Xi,"invoices",y);await wo(x,t),console.log("Current invoice saved to Firebase")}const g={...t,invoiceNumber:"",date:new Date().toISOString().split("T")[0]};e(g),alert("Invoice copied! You can now edit the new invoice and assign a new invoice number.")}catch(g){console.error("Error copying invoice:",g),alert("Error copying invoice. Please try again.")}},o=()=>{try{const g=Bt.book_new(),y=r(),x=t.items.map(ee=>({"S.No":ee.sno,Description:ee.name,Quantity:ee.quantity,"Price ()":ee.price,"Total ()":ee.total}));x.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":y});const E=Bt.json_to_sheet(x);Bt.book_append_sheet(g,E,"Items");const w=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${y.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],T=Bt.aoa_to_sheet(w);Bt.book_append_sheet(g,T,"Invoice Info");const b=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${y.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(ee=>[ee.name,`${ee.quantity}  ${ee.price} = ${ee.total}`])],k=Bt.aoa_to_sheet(b);Bt.book_append_sheet(g,k,"Summary");const q=new Date().toISOString().slice(0,10),Y=`Invoice_${t.invoiceNumber||"Data"}_${q}.xlsx`;ed(g,Y),alert(`Excel file exported successfully: ${Y}`)}catch(g){console.error("Error exporting to Excel:",g),alert("Error exporting to Excel. Please try again.")}},u=(g,y,x)=>{const E=[...t.items];E[g][y]=x,(y==="quantity"||y==="price")&&(E[g].total=E[g].quantity*E[g].price),e({...t,items:E})},f=()=>{const g={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,g]})},d=g=>{const x=t.items.filter((E,w)=>w!==g).map((E,w)=>({...E,sno:w+1}));e({...t,items:x})},h=()=>{const g=r(),y=Ds(Math.floor(g)),x=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
		  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
			.logo-container { width: 150px; height: 100px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; }
            .logo { width: 150px; height: 100px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div class="logo-container">
              <img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" class="logo" alt="Dynamic Range Architects logo" />
            </div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Bill To:</h3>
              <strong>${t.clientName}</strong><br>
              ${t.clientAddress.replace(/\n/g,"<br>")}
			  <strong>Client GST:</strong> ${t.clientGST}
            </div>
            <div class="invoice-info">
              <h3>Invoice Details:</h3>
              <strong>Invoice #:</strong> ${t.invoiceNumber}<br>
              <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
			  <strong>PAN Number:</strong> ${t.panNumber}
            </div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(w=>`
                <tr>
                  <td class="number">${w.sno}</td>
                  <td>${w.name}</td>
                  <td class="number">${w.quantity}</td>
                  <td class="number">${w.price.toFixed(2)}</td>
                  <td class="number">${w.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${g.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${y} Rupees Only
          </div>

		  <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
 		   <strong>Note:</strong> ${t.note}
		  </div>

		<div style="margin-top: 60px; display: flex; justify-content: space-between;">
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Architect Signature
			</div>
		</div>
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Client Signature
			</div>
		</div>
		</div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,E=window.open("","_blank");E.document.write(x),E.document.close(),E.print()};return C.jsxs(C.Fragment,{children:[C.jsx(Jc,{}),C.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[C.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[C.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:C.jsx("img",{src:b0,className:"logo",alt:"Dynamic Range Architects logo"})}),C.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),C.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Invoice Details"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number"}),C.jsx("input",{type:"text",value:t.invoiceNumber,onChange:g=>e({...t,invoiceNumber:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"INV-001"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),C.jsx("input",{type:"date",value:t.date,onChange:g=>e({...t,date:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Number"}),C.jsx("input",{type:"text",value:t.panNumber,onChange:g=>e({...t,panNumber:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Client Information"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),C.jsx("input",{type:"text",value:t.clientName,onChange:g=>e({...t,clientName:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client Name"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Address"}),C.jsx("textarea",{value:t.clientAddress,onChange:g=>e({...t,clientAddress:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"Client Address"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client GST"}),C.jsx("input",{type:"text",value:t.clientGST,onChange:g=>e({...t,clientGST:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client GST"})]})]})]})]}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),C.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[C.jsx(S0,{size:16}),"Add Item"]})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"bg-yellow-600 text-white",children:[C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),C.jsx("tbody",{children:t.items.map((g,y)=>C.jsxs("tr",{className:"hover:bg-gray-50",children:[C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:g.sno}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"text",value:g.name,onChange:x=>u(y,"name",x.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:g.quantity,onChange:x=>u(y,"quantity",parseInt(x.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:g.price,onChange:x=>u(y,"price",parseFloat(x.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),C.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",g.total.toFixed(2)]}),C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&C.jsx("button",{onClick:()=>d(y),className:"text-red-600 hover:text-red-800 transition-colors",children:C.jsx($c,{size:16})})})]},y))})]})})]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),C.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",r().toFixed(2)]})]}),C.jsxs("div",{className:"text-sm text-gray-600",children:[C.jsx("strong",{children:"Amount in Words:"})," ",Ds(Math.floor(r()))," Rupees Only"]}),C.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[" ",C.jsx("strong",{children:"Note:"}),t.note]}),C.jsxs("div",{className:"mb-8",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),C.jsx("textarea",{value:t.note,onChange:g=>e({...t,note:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]}),C.jsxs("div",{className:"flex justify-between items-center pt-8",children:[C.jsx("div",{className:"text-center",children:C.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Architect Signature"})}),C.jsx("div",{className:"text-center",children:C.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Client Signature"})})]})]}),C.jsxs("div",{className:"flex justify-center gap-12",children:[C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:h,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[C.jsx(ys,{size:16}),"Generate PDF Invoice"]})}),C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:async()=>await aL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[C.jsx(A0,{size:16}),"Save Invoice Data"]})}),C.jsx("div",{className:"text-center",children:C.jsxs("button",{onClick:o,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[C.jsx(ys,{size:16}),"Export to Excel"]})}),C.jsx("div",{className:"text-center",children:C.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-cyan-700 text-white px-6 py-3 rounded-md hover:bg-cyan-900 transition-colors mx-auto mt-4",children:[C.jsx(k3,{size:16}),"Copy as New Invoice"]})})]})]})]})},oL=({onInvoiceSelect:t})=>{const[e,n]=ve.useState([]),[r,a]=ve.useState(null),[o,u]=ve.useState(""),[f,d]=ve.useState(!1),h=5;ve.useEffect(()=>{g()},[f]);const g=async()=>{let w=u2(a2(Xi,"invoices"),c2("date","desc"),f2(h));const T=await m2(w);a(T.docs[T.docs.length-1]),n(T.docs.map(b=>({id:b.id,...b.data()})))},y=async()=>{const w=u2(a2(Xi,"invoices"),c2("date","desc"),OD(r),f2(h)),T=await m2(w);T.empty||(a(T.docs[T.docs.length-1]),n(b=>[...b,...T.docs.map(k=>({id:k.id,...k.data()}))]))},x=async w=>{window.confirm("Are you sure you want to delete this invoice?")&&(await LD(Is(Xi,"invoices",w)),d(T=>!T))},E=e.filter(w=>w.invoiceNumber?.toLowerCase().includes(o.toLowerCase())||w.clientName?.toLowerCase().includes(o.toLowerCase()));return console.log(E),C.jsxs(C.Fragment,{children:[C.jsx(Jc,{}),C.jsxs("div",{className:"p-4",children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Invoices"}),C.jsx("input",{type:"text",placeholder:"Search by invoice or client",value:o,onChange:w=>u(w.target.value),className:"w-full mb-4 p-2 border rounded-md focus:ring-2 focus:ring-yellow-500"}),C.jsx("div",{className:"space-y-3",children:E.length===0?C.jsx("p",{className:"text-gray-500",children:"No invoices found."}):E.map(w=>C.jsxs("div",{className:"flex justify-between items-center p-3 rounded border border-gray-300 hover:bg-gray-100 transition",children:[w.brandInvoice===!0?C.jsxs(xo,{to:`/brand-invoice/${w.id}`,className:"cursor-pointer flex-1",children:[C.jsx("div",{className:"font-semibold",children:w.invoiceNumber||w.id}),C.jsxs("div",{className:"text-sm text-gray-600",children:[w.clientName,"  ",w.items?.reduce((T,b)=>T+b.total,0).toFixed(2),"  ",w.date]})]}):C.jsxs(xo,{to:`/invoice/${w.id}`,className:"cursor-pointer flex-1",children:[C.jsx("div",{className:"font-semibold",children:w.invoiceNumber||w.id}),C.jsxs("div",{className:"text-sm text-gray-600",children:[w.clientName,"  ",w.items?.reduce((T,b)=>T+b.total,0).toFixed(2),"  ",w.date]})]}),C.jsx("button",{onClick:()=>x(w.id),className:"text-red-600 hover:text-red-800 ml-2",children:C.jsx($c,{size:18})})]},w.id))}),e.length>=h&&C.jsx("button",{onClick:y,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Load More"})]})]})},lL=async t=>{const e=Is(Xi,"invoices",t.invoiceNumber||temp+Math.random().toString(10).substring(2,10));await wo(e,t),alert("Invoice saved to Firebase!")},uL=()=>{const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"If any work is extended on site, the additional amount will be added during the final completion and may be collected before the site is handed over.",items:[{sno:1,name:"",quantity:1,price:0,total:0}],brandInvoice:!1}),n=(d,h,g)=>{const y=[...t.items];y[d][h]=g,(h==="quantity"||h==="price")&&(y[d].total=y[d].quantity*y[d].price),e({...t,items:y})},r=()=>{const d={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,d]})},a=d=>{const g=t.items.filter((y,x)=>x!==d).map((y,x)=>({...y,sno:x+1}));e({...t,items:g})},o=()=>t.items.reduce((d,h)=>d+h.total,0),u=()=>{try{const d=Bt.book_new(),h=o(),g=t.items.map(q=>({"S.No":q.sno,Description:q.name,Quantity:q.quantity,"Price ()":q.price,"Total ()":q.total}));g.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":h});const y=Bt.json_to_sheet(g);Bt.book_append_sheet(d,y,"Items");const x=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${h.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],E=Bt.aoa_to_sheet(x);Bt.book_append_sheet(d,E,"Invoice Info");const w=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${h.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(q=>[q.name,`${q.quantity}  ${q.price} = ${q.total}`])],T=Bt.aoa_to_sheet(w);Bt.book_append_sheet(d,T,"Summary");const b=new Date().toISOString().slice(0,10),k=`Invoice_${t.invoiceNumber||"Data"}_${b}.xlsx`;ed(d,k),alert(`Excel file exported successfully: ${k}`)}catch(d){console.error("Error exporting to Excel:",d),alert("Error exporting to Excel. Please try again.")}},f=()=>{const d=o(),h=Ds(Math.floor(d)),g=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
		  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
            .logo { width: 25px; height: 20px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div className="w-25 h-20 mx-auto mb-2 bg-slate-600 rounded-lg flex items-center justify-center">
					<img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" className="logo" alt="Dynamic Range Architects logo" style="width: 150px; height: 80px;"/>
			</div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Bill To:</h3>
              <strong>${t.clientName}</strong><br>
              ${t.clientAddress.replace(/\n/g,"<br>")}
			  <br><strong>Client GST:</strong> ${t.clientGST}
            </div>
            <div class="invoice-info">
              <h3>Invoice Details:</h3>
              <strong>Invoice #:</strong> ${t.invoiceNumber}<br>
              <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
			  <br><strong>PAN Number:</strong> ${t.panNumber}
            </div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(x=>`
                <tr>
                  <td class="number">${x.sno}</td>
                  <td>${x.name}</td>
                  <td class="number">${x.quantity}</td>
                  <td class="number">${x.price.toFixed(2)}</td>
                  <td class="number">${x.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${d.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${h} Rupees Only
          </div>

		  <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
 		   <strong>Note:</strong> ${t.note}
		  </div>

		<div style="margin-top: 60px; display: flex; justify-content: space-between;">
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Architect Signature
			</div>
		</div>
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Client Signature
			</div>
		</div>
		</div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,y=window.open("","_blank");y.document.write(g),y.document.close(),y.print()};return C.jsxs(C.Fragment,{children:[C.jsx(Jc,{}),C.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[C.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[C.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:C.jsx("img",{src:b0,className:"logo",alt:"Dynamic Range Architects logo"})}),C.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),C.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Invoice Details"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number"}),C.jsx("input",{type:"text",value:t.invoiceNumber,onChange:d=>e({...t,invoiceNumber:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"INV-001"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),C.jsx("input",{type:"date",value:t.date,onChange:d=>e({...t,date:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Number"}),C.jsx("input",{type:"text",value:t.panNumber,onChange:d=>e({...t,panNumber:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Client Information"}),C.jsxs("div",{className:"space-y-4",children:[C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),C.jsx("input",{type:"text",value:t.clientName,onChange:d=>e({...t,clientName:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client Name"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Address"}),C.jsx("textarea",{value:t.clientAddress,onChange:d=>e({...t,clientAddress:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"Client Address"})]}),C.jsxs("div",{children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client GST"}),C.jsx("input",{type:"text",value:t.clientGST,onChange:d=>e({...t,clientGST:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client GST"})]})]})]})]}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),C.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[C.jsx(S0,{size:16}),"Add Item"]})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"bg-yellow-600 text-white",children:[C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),C.jsx("tbody",{children:t.items.map((d,h)=>C.jsxs("tr",{className:"hover:bg-gray-50",children:[C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:d.sno}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"text",value:d.name,onChange:g=>n(h,"name",g.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:d.quantity,onChange:g=>n(h,"quantity",parseInt(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:d.price,onChange:g=>n(h,"price",parseFloat(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),C.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",d.total.toFixed(2)]}),C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&C.jsx("button",{onClick:()=>a(h),className:"text-red-600 hover:text-red-800 transition-colors",children:C.jsx($c,{size:16})})})]},h))})]})})]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),C.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",o().toFixed(2)]})]}),C.jsxs("div",{className:"text-sm text-gray-600",children:[C.jsx("strong",{children:"Amount in Words:"})," ",Ds(Math.floor(o()))," Rupees Only"]}),C.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[" ",C.jsx("strong",{children:"Note:"}),t.note]}),C.jsxs("div",{className:"mb-8",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),C.jsx("textarea",{value:t.note,onChange:d=>e({...t,note:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]}),C.jsxs("div",{className:"flex justify-between items-center pt-8",children:[C.jsx("div",{className:"text-center",children:C.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Architect Signature"})}),C.jsx("div",{className:"text-center",children:C.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Client Signature"})})]})]}),C.jsxs("div",{className:"flex justify-center gap-12",children:[C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[C.jsx(ys,{size:20}),"Generate PDF Invoice"]})}),C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:async()=>await lL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[C.jsx(A0,{size:20}),"Save Invoice Data"]})}),C.jsx("div",{className:"text-center",children:C.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[C.jsx(ys,{size:20}),"Export to Excel"]})})]})]})]})},cL=async t=>{const e=Is(Xi,"invoices",t.invoiceNumber||temp+Math.random().toString(10).substring(2,10));await wo(e,t),alert("Invoice saved to Firebase!")},fL=()=>{const[t,e]=ve.useState({fromName:"Aaditya Chakravarty",fromAddress:"Regus, Mohali Citi Centre 2, Third Floor, SCO 250251, Airport Road, Mohali  140306",fromPAN:"CJWPC9884M",fromPhone:"9557230546",clientName:"",clientAddress:"",clientGST:"",invoiceNumber:"",date:new Date().toISOString().split("T")[0],bankName:"State Bank Of India",accountName:"Aaditya Chakravarty",accountNumber:"43854002406",ifsc:"SBIN0050502",note:"",items:[{sno:1,name:"",quantity:1,price:0,total:0}],brandInvoice:!0}),n=(d,h,g)=>{const y=[...t.items];y[d][h]=g,(h==="quantity"||h==="price")&&(y[d].total=y[d].quantity*y[d].price),e({...t,items:y})},r=()=>{const d={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,d]})},a=d=>{const g=t.items.filter((y,x)=>x!==d).map((y,x)=>({...y,sno:x+1}));e({...t,items:g})},o=()=>t.items.reduce((d,h)=>d+h.total,0),u=()=>{try{const d=Bt.book_new(),h=o(),g=t.items.map(q=>({"S.No":q.sno,Description:q.name,Quantity:q.quantity,"Price ()":q.price,"Total ()":q.total}));g.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":h});const y=Bt.json_to_sheet(g);Bt.book_append_sheet(d,y,"Items");const x=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${h.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],E=Bt.aoa_to_sheet(x);Bt.book_append_sheet(d,E,"Invoice Info");const w=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${h.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(q=>[q.name,`${q.quantity}  ${q.price} = ${q.total}`])],T=Bt.aoa_to_sheet(w);Bt.book_append_sheet(d,T,"Summary");const b=new Date().toISOString().slice(0,10),k=`Invoice_${t.invoiceNumber||"Data"}_${b}.xlsx`;ed(d,k),alert(`Excel file exported successfully: ${k}`)}catch(d){console.error("Error exporting to Excel:",d),alert("Error exporting to Excel. Please try again.")}},f=()=>{const d=o(),h=Ds(Math.floor(d)),g=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
          <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
            .logo { width: 25px; height: 20px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div className="w-25 h-20 mx-auto mb-2 bg-slate-600 rounded-lg flex items-center justify-center">
                    <img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" className="logo" alt="Dynamic Range Architects logo" style="width: 150px; height: 80px;"/>
            </div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">

  <!-- LEFT: FROM -->
  <div style="width: 48%; text-align: left;">
    <h3>From:</h3>
    <strong>${t.fromName}</strong><br>
    Phone: ${t.fromPhone}<br>
    Address: ${t.fromAddress.replace(/\n/g,"<br>")}<br>
    PAN: ${t.fromPAN}
  </div>

  <!-- RIGHT: BILL TO -->
  <div style="width: 48%; text-align: right;">
    <h3>Bill To:</h3>
    <strong>${t.clientName}</strong><br>
    ${t.clientAddress.replace(/\n/g,"<br>")}<br>
    GST: ${t.clientGST}
  </div>

</div>

<!-- INVOICE META -->
<div style="display: flex; justify-content: space-between; margin-top: 20px;">
  <div>
    <strong>Invoice No:</strong> ${t.invoiceNumber}
  </div>
  <div>
    <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
  </div>
</div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(x=>`
                <tr>
                  <td class="number">${x.sno}</td>
                  <td>${x.name}</td>
                  <td class="number">${x.quantity}</td>
                  <td class="number">${x.price.toFixed(2)}</td>
                  <td class="number">${x.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${d.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${h} Rupees Only
          </div>

          <div style="margin-top: 30px; padding: 15px; border: 1px solid #ddd;">
  <h3 style="margin-bottom: 10px;">Payment Details</h3>
  <p><strong>Bank:</strong> ${t.bankName}</p>
  <p><strong>Account Name:</strong> ${t.accountName}</p>
  <p><strong>Account Number:</strong> ${t.accountNumber}</p>
  <p><strong>IFSC:</strong> ${t.ifsc}</p>
</div>

          <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
          <strong></strong> ${t.note}
          </div>

        </div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,y=window.open("","_blank");y.document.write(g),y.document.close(),y.print()};return C.jsxs(C.Fragment,{children:[C.jsx(Jc,{}),C.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[C.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[C.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:C.jsx("img",{src:b0,className:"logo",alt:"Dynamic Range Architects logo"})}),C.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),C.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-3",children:"From"}),C.jsx("input",{placeholder:"Name",value:t.fromName,onChange:d=>e({...t,fromName:d.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("input",{placeholder:"Phone Number",value:t.fromPhone,onChange:d=>e({...t,fromPhone:d.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("textarea",{placeholder:"Address",value:t.fromAddress,onChange:d=>e({...t,fromAddress:d.target.value}),className:"w-full mb-2 p-2 border rounded",rows:2}),C.jsx("input",{placeholder:"PAN Number",value:t.fromPAN,onChange:d=>e({...t,fromPAN:d.target.value}),className:"w-full p-2 border rounded"})]}),C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Bill To"}),C.jsx("input",{placeholder:"Client / Company Name",value:t.clientName,onChange:d=>e({...t,clientName:d.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("textarea",{placeholder:"Client Address",value:t.clientAddress,onChange:d=>e({...t,clientAddress:d.target.value}),className:"w-full mb-2 p-2 border rounded",rows:3}),C.jsx("input",{placeholder:"GST Number",value:t.clientGST,onChange:d=>e({...t,clientGST:d.target.value}),className:"w-full p-2 border rounded"})]})]}),C.jsxs("div",{className:"flex flex-col md:flex-row justify-between mb-8 gap-4",children:[C.jsx("input",{placeholder:"Invoice Number (e.g. DRA-003)",value:t.invoiceNumber,onChange:d=>e({...t,invoiceNumber:d.target.value}),className:"p-2 border rounded w-full md:w-1/3"}),C.jsx("input",{type:"date",value:t.date,onChange:d=>e({...t,date:d.target.value}),className:"p-2 border rounded w-full md:w-1/3"})]}),C.jsxs("div",{className:"flex justify-between mb-6",children:[C.jsxs("p",{children:[C.jsx("strong",{children:"Invoice No:"})," ",t.invoiceNumber]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Date:"})," ",t.date]})]}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),C.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[C.jsx(S0,{size:16}),"Add Item"]})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"bg-yellow-600 text-white",children:[C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),C.jsx("tbody",{children:t.items.map((d,h)=>C.jsxs("tr",{className:"hover:bg-gray-50",children:[C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:d.sno}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"text",value:d.name,onChange:g=>n(h,"name",g.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:d.quantity,onChange:g=>n(h,"quantity",parseInt(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:d.price,onChange:g=>n(h,"price",parseFloat(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),C.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",d.total.toFixed(2)]}),C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&C.jsx("button",{onClick:()=>a(h),className:"text-red-600 hover:text-red-800 transition-colors",children:C.jsx($c,{size:16})})})]},h))})]})})]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),C.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",o().toFixed(2)]})]}),C.jsxs("div",{className:"text-sm text-gray-600",children:[C.jsx("strong",{children:"Amount in Words:"})," ",Ds(Math.floor(o()))," Rupees Only"]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mt-6",children:[C.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Payment Details"}),C.jsxs("p",{children:[C.jsx("strong",{children:"Bank:"})," ",t.bankName]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Account Name:"})," ",t.accountName]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Account Number:"})," ",t.accountNumber]}),C.jsxs("p",{children:[C.jsx("strong",{children:"IFSC:"})," ",t.ifsc]})]}),C.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[C.jsx("strong",{}),t.note]}),C.jsxs("div",{className:"mb-8",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),C.jsx("textarea",{value:t.note,onChange:d=>e({...t,note:d.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]})]}),C.jsxs("div",{className:"flex justify-center gap-12",children:[C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[C.jsx(ys,{size:20}),"Generate PDF Invoice"]})}),C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:async()=>await cL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[C.jsx(A0,{size:20}),"Save Invoice Data"]})}),C.jsx("div",{className:"text-center",children:C.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[C.jsx(ys,{size:20}),"Export to Excel"]})})]})]})]})},hL=async t=>{try{const e=t.invoiceNumber||`temp${Math.random().toString(10).substring(2,10)}`,n=Is(Xi,"invoices",e);(await H0(n)).exists()?(await wo(n,t,{merge:!0}),alert("Invoice updated in Firebase!")):(await wo(n,t),alert("Invoice saved to Firebase!"))}catch(e){console.error("Error saving invoice:",e),alert("Error saving invoice. Please try again.")}},dL=()=>{const[t,e]=ve.useState({fromName:"Aaditya Chakravarty",fromAddress:"Regus, Mohali Citi Centre 2, Third Floor, SCO 250251, Airport Road, Mohali  140306",fromPAN:"CJWPC9884M",fromPhone:"9557230546",clientName:"",clientAddress:"",clientGST:"",invoiceNumber:"",date:new Date().toISOString().split("T")[0],bankName:"State Bank Of India",accountName:"Aaditya Chakravarty",accountNumber:"43854002406",ifsc:"SBIN0050502",note:"",items:[{sno:1,name:"",quantity:1,price:0,total:0}],brandInvoice:!0}),{invoiceId:n}=TE();ve.useEffect(()=>{(async()=>{const g=Is(Xi,"invoices",n),y=await H0(g);y.exists()&&e(y.data())})()},[]);const r=(h,g,y)=>{const x=[...t.items];x[h][g]=y,(g==="quantity"||g==="price")&&(x[h].total=x[h].quantity*x[h].price),e({...t,items:x})},a=()=>{const h={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,h]})},o=h=>{const y=t.items.filter((x,E)=>E!==h).map((x,E)=>({...x,sno:E+1}));e({...t,items:y})},u=()=>t.items.reduce((h,g)=>h+g.total,0),f=()=>{try{const h=Bt.book_new(),g=u(),y=t.items.map(Y=>({"S.No":Y.sno,Description:Y.name,Quantity:Y.quantity,"Price ()":Y.price,"Total ()":Y.total}));y.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":g});const x=Bt.json_to_sheet(y);Bt.book_append_sheet(h,x,"Items");const E=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${g.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],w=Bt.aoa_to_sheet(E);Bt.book_append_sheet(h,w,"Invoice Info");const T=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${g.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(Y=>[Y.name,`${Y.quantity}  ${Y.price} = ${Y.total}`])],b=Bt.aoa_to_sheet(T);Bt.book_append_sheet(h,b,"Summary");const k=new Date().toISOString().slice(0,10),q=`Invoice_${t.invoiceNumber||"Data"}_${k}.xlsx`;ed(h,q),alert(`Excel file exported successfully: ${q}`)}catch(h){console.error("Error exporting to Excel:",h),alert("Error exporting to Excel. Please try again.")}},d=()=>{const h=u(),g=Ds(Math.floor(h)),y=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
          <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
            .logo { width: 25px; height: 20px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div className="w-25 h-20 mx-auto mb-2 bg-slate-600 rounded-lg flex items-center justify-center">
                    <img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" className="logo" alt="Dynamic Range Architects logo" style="width: 150px; height: 80px;"/>
            </div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">

  <!-- LEFT: FROM -->
  <div style="width: 48%; text-align: left;">
    <h3>From:</h3>
    <strong>${t.fromName}</strong><br>
    Phone: ${t.fromPhone}<br>
    Address: ${t.fromAddress.replace(/\n/g,"<br>")}<br>
    PAN: ${t.fromPAN}
  </div>

  <!-- RIGHT: BILL TO -->
  <div style="width: 48%; text-align: right;">
    <h3>Bill To:</h3>
    <strong>${t.clientName}</strong><br>
    ${t.clientAddress.replace(/\n/g,"<br>")}<br>
    GST: ${t.clientGST}
  </div>

</div>

<!-- INVOICE META -->
<div style="display: flex; justify-content: space-between; margin-top: 20px;">
  <div>
    <strong>Invoice No:</strong> ${t.invoiceNumber}
  </div>
  <div>
    <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
  </div>
</div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(E=>`
                <tr>
                  <td class="number">${E.sno}</td>
                  <td>${E.name}</td>
                  <td class="number">${E.quantity}</td>
                  <td class="number">${E.price.toFixed(2)}</td>
                  <td class="number">${E.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${h.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${g} Rupees Only
          </div>

          <div style="margin-top: 30px; padding: 15px; border: 1px solid #ddd;">
  <h3 style="margin-bottom: 10px;">Payment Details</h3>
  <p><strong>Bank:</strong> ${t.bankName}</p>
  <p><strong>Account Name:</strong> ${t.accountName}</p>
  <p><strong>Account Number:</strong> ${t.accountNumber}</p>
  <p><strong>IFSC:</strong> ${t.ifsc}</p>
</div>

          <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
          <strong></strong> ${t.note}
          </div>

        </div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,x=window.open("","_blank");x.document.write(y),x.document.close(),x.print()};return C.jsxs(C.Fragment,{children:[C.jsx(Jc,{}),C.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[C.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[C.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:C.jsx("img",{src:b0,className:"logo",alt:"Dynamic Range Architects logo"})}),C.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),C.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),C.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-3",children:"From"}),C.jsx("input",{placeholder:"Name",value:t.fromName,onChange:h=>e({...t,fromName:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("input",{placeholder:"Phone Number",value:t.fromPhone,onChange:h=>e({...t,fromPhone:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("textarea",{placeholder:"Address",value:t.fromAddress,onChange:h=>e({...t,fromAddress:h.target.value}),className:"w-full mb-2 p-2 border rounded",rows:2}),C.jsx("input",{placeholder:"PAN Number",value:t.fromPAN,onChange:h=>e({...t,fromPAN:h.target.value}),className:"w-full p-2 border rounded"})]}),C.jsxs("div",{children:[C.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Bill To"}),C.jsx("input",{placeholder:"Client / Company Name",value:t.clientName,onChange:h=>e({...t,clientName:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),C.jsx("textarea",{placeholder:"Client Address",value:t.clientAddress,onChange:h=>e({...t,clientAddress:h.target.value}),className:"w-full mb-2 p-2 border rounded",rows:3}),C.jsx("input",{placeholder:"GST Number",value:t.clientGST,onChange:h=>e({...t,clientGST:h.target.value}),className:"w-full p-2 border rounded"})]})]}),C.jsxs("div",{className:"flex flex-col md:flex-row justify-between mb-8 gap-4",children:[C.jsx("input",{placeholder:"Invoice Number (e.g. DRA-003)",value:t.invoiceNumber,onChange:h=>e({...t,invoiceNumber:h.target.value}),className:"p-2 border rounded w-full md:w-1/3"}),C.jsx("input",{type:"date",value:t.date,onChange:h=>e({...t,date:h.target.value}),className:"p-2 border rounded w-full md:w-1/3"})]}),C.jsxs("div",{className:"flex justify-between mb-6",children:[C.jsxs("p",{children:[C.jsx("strong",{children:"Invoice No:"})," ",t.invoiceNumber]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Date:"})," ",t.date]})]}),C.jsxs("div",{className:"mb-8",children:[C.jsxs("div",{className:"flex justify-between items-center mb-4",children:[C.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),C.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[C.jsx(S0,{size:16}),"Add Item"]})]}),C.jsx("div",{className:"overflow-x-auto",children:C.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[C.jsx("thead",{children:C.jsxs("tr",{className:"bg-yellow-600 text-white",children:[C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),C.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),C.jsx("tbody",{children:t.items.map((h,g)=>C.jsxs("tr",{className:"hover:bg-gray-50",children:[C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:h.sno}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"text",value:h.name,onChange:y=>r(g,"name",y.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:h.quantity,onChange:y=>r(g,"quantity",parseInt(y.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),C.jsx("td",{className:"border border-gray-300 p-3",children:C.jsx("input",{type:"number",value:h.price,onChange:y=>r(g,"price",parseFloat(y.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),C.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",h.total.toFixed(2)]}),C.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&C.jsx("button",{onClick:()=>o(g),className:"text-red-600 hover:text-red-800 transition-colors",children:C.jsx($c,{size:16})})})]},g))})]})})]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[C.jsxs("div",{className:"flex justify-between items-center mb-2",children:[C.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),C.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",u().toFixed(2)]})]}),C.jsxs("div",{className:"text-sm text-gray-600",children:[C.jsx("strong",{children:"Amount in Words:"})," ",Ds(Math.floor(u()))," Rupees Only"]}),C.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mt-6",children:[C.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Payment Details"}),C.jsxs("p",{children:[C.jsx("strong",{children:"Bank:"})," ",t.bankName]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Account Name:"})," ",t.accountName]}),C.jsxs("p",{children:[C.jsx("strong",{children:"Account Number:"})," ",t.accountNumber]}),C.jsxs("p",{children:[C.jsx("strong",{children:"IFSC:"})," ",t.ifsc]})]}),C.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[C.jsx("strong",{}),t.note]}),C.jsxs("div",{className:"mb-8",children:[C.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),C.jsx("textarea",{value:t.note,onChange:h=>e({...t,note:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]})]}),C.jsxs("div",{className:"flex justify-center gap-12",children:[C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:d,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[C.jsx(ys,{size:20}),"Generate PDF Invoice"]})}),C.jsx("div",{className:"text-center mt-4",children:C.jsxs("button",{onClick:async()=>await hL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[C.jsx(A0,{size:20}),"Save Invoice Data"]})}),C.jsx("div",{className:"text-center",children:C.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[C.jsx(ys,{size:20}),"Export to Excel"]})})]})]})]})};function mL(){const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"",items:[{sno:1,name:"",quantity:1,price:0,total:0}],brandInvioce:!1}),n=async r=>{const a=doc(db,"invoices",r),o=await getDoc(a);o.exists()?e(o.data()):alert("Invoice not found")};return C.jsx(_3,{basename:"/dra-invoice",children:C.jsxs(Kb,{children:[C.jsx(Il,{path:"/invoice/:invoiceId",element:C.jsx(sL,{invoiceData:t,setInvoiceData:e})}),C.jsx(Il,{path:"/brand-invoice/:invoiceId",element:C.jsx(dL,{invoiceData:t,setInvoiceData:e})}),C.jsx(Il,{path:"/create-new-invoice",element:C.jsx(uL,{})}),C.jsx(Il,{path:"/brand-invoice",element:C.jsx(fL,{})}),C.jsx(Il,{path:"/",element:C.jsx(oL,{onInvoiceSelect:n})})]})})}rb.createRoot(document.getElementById("root")).render(C.jsx(ve.StrictMode,{children:C.jsx(mL,{})}));
