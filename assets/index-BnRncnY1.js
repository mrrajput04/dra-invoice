(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))r(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const u of o.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&r(u)}).observe(document,{childList:!0,subtree:!0});function n(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerPolicy&&(o.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?o.credentials="include":a.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(a){if(a.ep)return;a.ep=!0;const o=n(a);fetch(a.href,o)}})();var $m={exports:{}},rc={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Py;function X4(){if(Py)return rc;Py=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(r,a,o){var u=null;if(o!==void 0&&(u=""+o),a.key!==void 0&&(u=""+a.key),"key"in a){o={};for(var f in a)f!=="key"&&(o[f]=a[f])}else o=a;return a=o.ref,{$$typeof:t,type:r,key:u,ref:a!==void 0?a:null,props:o}}return rc.Fragment=e,rc.jsx=n,rc.jsxs=n,rc}var ky;function Y4(){return ky||(ky=1,$m.exports=X4()),$m.exports}var P=Y4(),Xm={exports:{}},rt={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ly;function W4(){if(Ly)return rt;Ly=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),u=Symbol.for("react.context"),f=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),m=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),y=Symbol.iterator;function _(Q){return Q===null||typeof Q!="object"?null:(Q=y&&Q[y]||Q["@@iterator"],typeof Q=="function"?Q:null)}var E={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},w=Object.assign,T={};function b(Q,xe,U){this.props=Q,this.context=xe,this.refs=T,this.updater=U||E}b.prototype.isReactComponent={},b.prototype.setState=function(Q,xe){if(typeof Q!="object"&&typeof Q!="function"&&Q!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Q,xe,"setState")},b.prototype.forceUpdate=function(Q){this.updater.enqueueForceUpdate(this,Q,"forceUpdate")};function k(){}k.prototype=b.prototype;function q(Q,xe,U){this.props=Q,this.context=xe,this.refs=T,this.updater=U||E}var X=q.prototype=new k;X.constructor=q,w(X,b.prototype),X.isPureReactComponent=!0;var ee=Array.isArray,he={H:null,A:null,T:null,S:null,V:null},Ae=Object.prototype.hasOwnProperty;function N(Q,xe,U,W,K,Z){return U=Z.ref,{$$typeof:t,type:Q,key:xe,ref:U!==void 0?U:null,props:Z}}function I(Q,xe){return N(Q.type,xe,void 0,void 0,void 0,Q.props)}function R(Q){return typeof Q=="object"&&Q!==null&&Q.$$typeof===t}function M(Q){var xe={"=":"=0",":":"=2"};return"$"+Q.replace(/[=:]/g,function(U){return xe[U]})}var B=/\/+/g;function H(Q,xe){return typeof Q=="object"&&Q!==null&&Q.key!=null?M(""+Q.key):xe.toString(36)}function V(){}function Je(Q){switch(Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason;default:switch(typeof Q.status=="string"?Q.then(V,V):(Q.status="pending",Q.then(function(xe){Q.status==="pending"&&(Q.status="fulfilled",Q.value=xe)},function(xe){Q.status==="pending"&&(Q.status="rejected",Q.reason=xe)})),Q.status){case"fulfilled":return Q.value;case"rejected":throw Q.reason}}throw Q}function He(Q,xe,U,W,K){var Z=typeof Q;(Z==="undefined"||Z==="boolean")&&(Q=null);var ce=!1;if(Q===null)ce=!0;else switch(Z){case"bigint":case"string":case"number":ce=!0;break;case"object":switch(Q.$$typeof){case t:case e:ce=!0;break;case g:return ce=Q._init,He(ce(Q._payload),xe,U,W,K)}}if(ce)return K=K(Q),ce=W===""?"."+H(Q,0):W,ee(K)?(U="",ce!=null&&(U=ce.replace(B,"$&/")+"/"),He(K,xe,U,"",function(Be){return Be})):K!=null&&(R(K)&&(K=I(K,U+(K.key==null||Q&&Q.key===K.key?"":(""+K.key).replace(B,"$&/")+"/")+ce)),xe.push(K)),1;ce=0;var Le=W===""?".":W+":";if(ee(Q))for(var Fe=0;Fe<Q.length;Fe++)W=Q[Fe],Z=Le+H(W,Fe),ce+=He(W,xe,U,Z,K);else if(Fe=_(Q),typeof Fe=="function")for(Q=Fe.call(Q),Fe=0;!(W=Q.next()).done;)W=W.value,Z=Le+H(W,Fe++),ce+=He(W,xe,U,Z,K);else if(Z==="object"){if(typeof Q.then=="function")return He(Je(Q),xe,U,W,K);throw xe=String(Q),Error("Objects are not valid as a React child (found: "+(xe==="[object Object]"?"object with keys {"+Object.keys(Q).join(", ")+"}":xe)+"). If you meant to render a collection of children, use an array instead.")}return ce}function de(Q,xe,U){if(Q==null)return Q;var W=[],K=0;return He(Q,W,"","",function(Z){return xe.call(U,Z,K++)}),W}function Re(Q){if(Q._status===-1){var xe=Q._result;xe=xe(),xe.then(function(U){(Q._status===0||Q._status===-1)&&(Q._status=1,Q._result=U)},function(U){(Q._status===0||Q._status===-1)&&(Q._status=2,Q._result=U)}),Q._status===-1&&(Q._status=0,Q._result=xe)}if(Q._status===1)return Q._result.default;throw Q._result}var ze=typeof reportError=="function"?reportError:function(Q){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xe=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Q=="object"&&Q!==null&&typeof Q.message=="string"?String(Q.message):String(Q),error:Q});if(!window.dispatchEvent(xe))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Q);return}console.error(Q)};function Ye(){}return rt.Children={map:de,forEach:function(Q,xe,U){de(Q,function(){xe.apply(this,arguments)},U)},count:function(Q){var xe=0;return de(Q,function(){xe++}),xe},toArray:function(Q){return de(Q,function(xe){return xe})||[]},only:function(Q){if(!R(Q))throw Error("React.Children.only expected to receive a single React element child.");return Q}},rt.Component=b,rt.Fragment=n,rt.Profiler=a,rt.PureComponent=q,rt.StrictMode=r,rt.Suspense=h,rt.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=he,rt.__COMPILER_RUNTIME={__proto__:null,c:function(Q){return he.H.useMemoCache(Q)}},rt.cache=function(Q){return function(){return Q.apply(null,arguments)}},rt.cloneElement=function(Q,xe,U){if(Q==null)throw Error("The argument must be a React element, but you passed "+Q+".");var W=w({},Q.props),K=Q.key,Z=void 0;if(xe!=null)for(ce in xe.ref!==void 0&&(Z=void 0),xe.key!==void 0&&(K=""+xe.key),xe)!Ae.call(xe,ce)||ce==="key"||ce==="__self"||ce==="__source"||ce==="ref"&&xe.ref===void 0||(W[ce]=xe[ce]);var ce=arguments.length-2;if(ce===1)W.children=U;else if(1<ce){for(var Le=Array(ce),Fe=0;Fe<ce;Fe++)Le[Fe]=arguments[Fe+2];W.children=Le}return N(Q.type,K,void 0,void 0,Z,W)},rt.createContext=function(Q){return Q={$$typeof:u,_currentValue:Q,_currentValue2:Q,_threadCount:0,Provider:null,Consumer:null},Q.Provider=Q,Q.Consumer={$$typeof:o,_context:Q},Q},rt.createElement=function(Q,xe,U){var W,K={},Z=null;if(xe!=null)for(W in xe.key!==void 0&&(Z=""+xe.key),xe)Ae.call(xe,W)&&W!=="key"&&W!=="__self"&&W!=="__source"&&(K[W]=xe[W]);var ce=arguments.length-2;if(ce===1)K.children=U;else if(1<ce){for(var Le=Array(ce),Fe=0;Fe<ce;Fe++)Le[Fe]=arguments[Fe+2];K.children=Le}if(Q&&Q.defaultProps)for(W in ce=Q.defaultProps,ce)K[W]===void 0&&(K[W]=ce[W]);return N(Q,Z,void 0,void 0,null,K)},rt.createRef=function(){return{current:null}},rt.forwardRef=function(Q){return{$$typeof:f,render:Q}},rt.isValidElement=R,rt.lazy=function(Q){return{$$typeof:g,_payload:{_status:-1,_result:Q},_init:Re}},rt.memo=function(Q,xe){return{$$typeof:m,type:Q,compare:xe===void 0?null:xe}},rt.startTransition=function(Q){var xe=he.T,U={};he.T=U;try{var W=Q(),K=he.S;K!==null&&K(U,W),typeof W=="object"&&W!==null&&typeof W.then=="function"&&W.then(Ye,ze)}catch(Z){ze(Z)}finally{he.T=xe}},rt.unstable_useCacheRefresh=function(){return he.H.useCacheRefresh()},rt.use=function(Q){return he.H.use(Q)},rt.useActionState=function(Q,xe,U){return he.H.useActionState(Q,xe,U)},rt.useCallback=function(Q,xe){return he.H.useCallback(Q,xe)},rt.useContext=function(Q){return he.H.useContext(Q)},rt.useDebugValue=function(){},rt.useDeferredValue=function(Q,xe){return he.H.useDeferredValue(Q,xe)},rt.useEffect=function(Q,xe,U){var W=he.H;if(typeof U=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return W.useEffect(Q,xe)},rt.useId=function(){return he.H.useId()},rt.useImperativeHandle=function(Q,xe,U){return he.H.useImperativeHandle(Q,xe,U)},rt.useInsertionEffect=function(Q,xe){return he.H.useInsertionEffect(Q,xe)},rt.useLayoutEffect=function(Q,xe){return he.H.useLayoutEffect(Q,xe)},rt.useMemo=function(Q,xe){return he.H.useMemo(Q,xe)},rt.useOptimistic=function(Q,xe){return he.H.useOptimistic(Q,xe)},rt.useReducer=function(Q,xe,U){return he.H.useReducer(Q,xe,U)},rt.useRef=function(Q){return he.H.useRef(Q)},rt.useState=function(Q){return he.H.useState(Q)},rt.useSyncExternalStore=function(Q,xe,U){return he.H.useSyncExternalStore(Q,xe,U)},rt.useTransition=function(){return he.H.useTransition()},rt.version="19.1.0",rt}var Vy;function Zp(){return Vy||(Vy=1,Xm.exports=W4()),Xm.exports}var ve=Zp(),Ym={exports:{}},ic={},Wm={exports:{}},Km={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var By;function K4(){return By||(By=1,function(t){function e(de,Re){var ze=de.length;de.push(Re);e:for(;0<ze;){var Ye=ze-1>>>1,Q=de[Ye];if(0<a(Q,Re))de[Ye]=Re,de[ze]=Q,ze=Ye;else break e}}function n(de){return de.length===0?null:de[0]}function r(de){if(de.length===0)return null;var Re=de[0],ze=de.pop();if(ze!==Re){de[0]=ze;e:for(var Ye=0,Q=de.length,xe=Q>>>1;Ye<xe;){var U=2*(Ye+1)-1,W=de[U],K=U+1,Z=de[K];if(0>a(W,ze))K<Q&&0>a(Z,W)?(de[Ye]=Z,de[K]=ze,Ye=K):(de[Ye]=W,de[U]=ze,Ye=U);else if(K<Q&&0>a(Z,ze))de[Ye]=Z,de[K]=ze,Ye=K;else break e}}return Re}function a(de,Re){var ze=de.sortIndex-Re.sortIndex;return ze!==0?ze:de.id-Re.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var u=Date,f=u.now();t.unstable_now=function(){return u.now()-f}}var h=[],m=[],g=1,y=null,_=3,E=!1,w=!1,T=!1,b=!1,k=typeof setTimeout=="function"?setTimeout:null,q=typeof clearTimeout=="function"?clearTimeout:null,X=typeof setImmediate<"u"?setImmediate:null;function ee(de){for(var Re=n(m);Re!==null;){if(Re.callback===null)r(m);else if(Re.startTime<=de)r(m),Re.sortIndex=Re.expirationTime,e(h,Re);else break;Re=n(m)}}function he(de){if(T=!1,ee(de),!w)if(n(h)!==null)w=!0,Ae||(Ae=!0,H());else{var Re=n(m);Re!==null&&He(he,Re.startTime-de)}}var Ae=!1,N=-1,I=5,R=-1;function M(){return b?!0:!(t.unstable_now()-R<I)}function B(){if(b=!1,Ae){var de=t.unstable_now();R=de;var Re=!0;try{e:{w=!1,T&&(T=!1,q(N),N=-1),E=!0;var ze=_;try{t:{for(ee(de),y=n(h);y!==null&&!(y.expirationTime>de&&M());){var Ye=y.callback;if(typeof Ye=="function"){y.callback=null,_=y.priorityLevel;var Q=Ye(y.expirationTime<=de);if(de=t.unstable_now(),typeof Q=="function"){y.callback=Q,ee(de),Re=!0;break t}y===n(h)&&r(h),ee(de)}else r(h);y=n(h)}if(y!==null)Re=!0;else{var xe=n(m);xe!==null&&He(he,xe.startTime-de),Re=!1}}break e}finally{y=null,_=ze,E=!1}Re=void 0}}finally{Re?H():Ae=!1}}}var H;if(typeof X=="function")H=function(){X(B)};else if(typeof MessageChannel<"u"){var V=new MessageChannel,Je=V.port2;V.port1.onmessage=B,H=function(){Je.postMessage(null)}}else H=function(){k(B,0)};function He(de,Re){N=k(function(){de(t.unstable_now())},Re)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(de){de.callback=null},t.unstable_forceFrameRate=function(de){0>de||125<de?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<de?Math.floor(1e3/de):5},t.unstable_getCurrentPriorityLevel=function(){return _},t.unstable_next=function(de){switch(_){case 1:case 2:case 3:var Re=3;break;default:Re=_}var ze=_;_=Re;try{return de()}finally{_=ze}},t.unstable_requestPaint=function(){b=!0},t.unstable_runWithPriority=function(de,Re){switch(de){case 1:case 2:case 3:case 4:case 5:break;default:de=3}var ze=_;_=de;try{return Re()}finally{_=ze}},t.unstable_scheduleCallback=function(de,Re,ze){var Ye=t.unstable_now();switch(typeof ze=="object"&&ze!==null?(ze=ze.delay,ze=typeof ze=="number"&&0<ze?Ye+ze:Ye):ze=Ye,de){case 1:var Q=-1;break;case 2:Q=250;break;case 5:Q=1073741823;break;case 4:Q=1e4;break;default:Q=5e3}return Q=ze+Q,de={id:g++,callback:Re,priorityLevel:de,startTime:ze,expirationTime:Q,sortIndex:-1},ze>Ye?(de.sortIndex=ze,e(m,de),n(h)===null&&de===n(m)&&(T?(q(N),N=-1):T=!0,He(he,ze-Ye))):(de.sortIndex=Q,e(h,de),w||E||(w=!0,Ae||(Ae=!0,H()))),de},t.unstable_shouldYield=M,t.unstable_wrapCallback=function(de){var Re=_;return function(){var ze=_;_=Re;try{return de.apply(this,arguments)}finally{_=ze}}}}(Km)),Km}var Uy;function Q4(){return Uy||(Uy=1,Wm.exports=K4()),Wm.exports}var Qm={exports:{}},Zn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var jy;function Z4(){if(jy)return Zn;jy=1;var t=Zp();function e(h){var m="https://react.dev/errors/"+h;if(1<arguments.length){m+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)m+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},a=Symbol.for("react.portal");function o(h,m,g){var y=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:a,key:y==null?null:""+y,children:h,containerInfo:m,implementation:g}}var u=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function f(h,m){if(h==="font")return"";if(typeof m=="string")return m==="use-credentials"?m:""}return Zn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Zn.createPortal=function(h,m){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!m||m.nodeType!==1&&m.nodeType!==9&&m.nodeType!==11)throw Error(e(299));return o(h,m,null,g)},Zn.flushSync=function(h){var m=u.T,g=r.p;try{if(u.T=null,r.p=2,h)return h()}finally{u.T=m,r.p=g,r.d.f()}},Zn.preconnect=function(h,m){typeof h=="string"&&(m?(m=m.crossOrigin,m=typeof m=="string"?m==="use-credentials"?m:"":void 0):m=null,r.d.C(h,m))},Zn.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},Zn.preinit=function(h,m){if(typeof h=="string"&&m&&typeof m.as=="string"){var g=m.as,y=f(g,m.crossOrigin),_=typeof m.integrity=="string"?m.integrity:void 0,E=typeof m.fetchPriority=="string"?m.fetchPriority:void 0;g==="style"?r.d.S(h,typeof m.precedence=="string"?m.precedence:void 0,{crossOrigin:y,integrity:_,fetchPriority:E}):g==="script"&&r.d.X(h,{crossOrigin:y,integrity:_,fetchPriority:E,nonce:typeof m.nonce=="string"?m.nonce:void 0})}},Zn.preinitModule=function(h,m){if(typeof h=="string")if(typeof m=="object"&&m!==null){if(m.as==null||m.as==="script"){var g=f(m.as,m.crossOrigin);r.d.M(h,{crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0})}}else m==null&&r.d.M(h)},Zn.preload=function(h,m){if(typeof h=="string"&&typeof m=="object"&&m!==null&&typeof m.as=="string"){var g=m.as,y=f(g,m.crossOrigin);r.d.L(h,g,{crossOrigin:y,integrity:typeof m.integrity=="string"?m.integrity:void 0,nonce:typeof m.nonce=="string"?m.nonce:void 0,type:typeof m.type=="string"?m.type:void 0,fetchPriority:typeof m.fetchPriority=="string"?m.fetchPriority:void 0,referrerPolicy:typeof m.referrerPolicy=="string"?m.referrerPolicy:void 0,imageSrcSet:typeof m.imageSrcSet=="string"?m.imageSrcSet:void 0,imageSizes:typeof m.imageSizes=="string"?m.imageSizes:void 0,media:typeof m.media=="string"?m.media:void 0})}},Zn.preloadModule=function(h,m){if(typeof h=="string")if(m){var g=f(m.as,m.crossOrigin);r.d.m(h,{as:typeof m.as=="string"&&m.as!=="script"?m.as:void 0,crossOrigin:g,integrity:typeof m.integrity=="string"?m.integrity:void 0})}else r.d.m(h)},Zn.requestFormReset=function(h){r.d.r(h)},Zn.unstable_batchedUpdates=function(h,m){return h(m)},Zn.useFormState=function(h,m,g){return u.H.useFormState(h,m,g)},Zn.useFormStatus=function(){return u.H.useHostTransitionStatus()},Zn.version="19.1.0",Zn}var zy;function J4(){if(zy)return Qm.exports;zy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Qm.exports=Z4(),Qm.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Hy;function eb(){if(Hy)return ic;Hy=1;var t=Q4(),e=Zp(),n=J4();function r(i){var s="https://react.dev/errors/"+i;if(1<arguments.length){s+="?args[]="+encodeURIComponent(arguments[1]);for(var l=2;l<arguments.length;l++)s+="&args[]="+encodeURIComponent(arguments[l])}return"Minified React error #"+i+"; visit "+s+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(i){return!(!i||i.nodeType!==1&&i.nodeType!==9&&i.nodeType!==11)}function o(i){var s=i,l=i;if(i.alternate)for(;s.return;)s=s.return;else{i=s;do s=i,(s.flags&4098)!==0&&(l=s.return),i=s.return;while(i)}return s.tag===3?l:null}function u(i){if(i.tag===13){var s=i.memoizedState;if(s===null&&(i=i.alternate,i!==null&&(s=i.memoizedState)),s!==null)return s.dehydrated}return null}function f(i){if(o(i)!==i)throw Error(r(188))}function h(i){var s=i.alternate;if(!s){if(s=o(i),s===null)throw Error(r(188));return s!==i?null:i}for(var l=i,c=s;;){var p=l.return;if(p===null)break;var v=p.alternate;if(v===null){if(c=p.return,c!==null){l=c;continue}break}if(p.child===v.child){for(v=p.child;v;){if(v===l)return f(p),i;if(v===c)return f(p),s;v=v.sibling}throw Error(r(188))}if(l.return!==c.return)l=p,c=v;else{for(var S=!1,D=p.child;D;){if(D===l){S=!0,l=p,c=v;break}if(D===c){S=!0,c=p,l=v;break}D=D.sibling}if(!S){for(D=v.child;D;){if(D===l){S=!0,l=v,c=p;break}if(D===c){S=!0,c=v,l=p;break}D=D.sibling}if(!S)throw Error(r(189))}}if(l.alternate!==c)throw Error(r(190))}if(l.tag!==3)throw Error(r(188));return l.stateNode.current===l?i:s}function m(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i;for(i=i.child;i!==null;){if(s=m(i),s!==null)return s;i=i.sibling}return null}var g=Object.assign,y=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),E=Symbol.for("react.portal"),w=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),b=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),q=Symbol.for("react.consumer"),X=Symbol.for("react.context"),ee=Symbol.for("react.forward_ref"),he=Symbol.for("react.suspense"),Ae=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),I=Symbol.for("react.lazy"),R=Symbol.for("react.activity"),M=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function H(i){return i===null||typeof i!="object"?null:(i=B&&i[B]||i["@@iterator"],typeof i=="function"?i:null)}var V=Symbol.for("react.client.reference");function Je(i){if(i==null)return null;if(typeof i=="function")return i.$$typeof===V?null:i.displayName||i.name||null;if(typeof i=="string")return i;switch(i){case w:return"Fragment";case b:return"Profiler";case T:return"StrictMode";case he:return"Suspense";case Ae:return"SuspenseList";case R:return"Activity"}if(typeof i=="object")switch(i.$$typeof){case E:return"Portal";case X:return(i.displayName||"Context")+".Provider";case q:return(i._context.displayName||"Context")+".Consumer";case ee:var s=i.render;return i=i.displayName,i||(i=s.displayName||s.name||"",i=i!==""?"ForwardRef("+i+")":"ForwardRef"),i;case N:return s=i.displayName||null,s!==null?s:Je(i.type)||"Memo";case I:s=i._payload,i=i._init;try{return Je(i(s))}catch{}}return null}var He=Array.isArray,de=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Re=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ze={pending:!1,data:null,method:null,action:null},Ye=[],Q=-1;function xe(i){return{current:i}}function U(i){0>Q||(i.current=Ye[Q],Ye[Q]=null,Q--)}function W(i,s){Q++,Ye[Q]=i.current,i.current=s}var K=xe(null),Z=xe(null),ce=xe(null),Le=xe(null);function Fe(i,s){switch(W(ce,s),W(Z,i),W(K,null),s.nodeType){case 9:case 11:i=(i=s.documentElement)&&(i=i.namespaceURI)?uy(i):0;break;default:if(i=s.tagName,s=s.namespaceURI)s=uy(s),i=cy(s,i);else switch(i){case"svg":i=1;break;case"math":i=2;break;default:i=0}}U(K),W(K,i)}function Be(){U(K),U(Z),U(ce)}function Me(i){i.memoizedState!==null&&W(Le,i);var s=K.current,l=cy(s,i.type);s!==l&&(W(Z,i),W(K,l))}function ut(i){Z.current===i&&(U(K),U(Z)),Le.current===i&&(U(Le),Zu._currentValue=ze)}var nt=Object.prototype.hasOwnProperty,Wt=t.unstable_scheduleCallback,ot=t.unstable_cancelCallback,ir=t.unstable_shouldYield,Bt=t.unstable_requestPaint,Ve=t.unstable_now,Wn=t.unstable_getCurrentPriorityLevel,ar=t.unstable_ImmediatePriority,mr=t.unstable_UserBlockingPriority,pr=t.unstable_NormalPriority,Mo=t.unstable_LowPriority,_i=t.unstable_IdlePriority,Kn=t.log,Ji=t.unstable_setDisableYieldValue,zt=null,xt=null;function rn(i){if(typeof Kn=="function"&&Ji(i),xt&&typeof xt.setStrictMode=="function")try{xt.setStrictMode(zt,i)}catch{}}var bn=Math.clz32?Math.clz32:yi,Ps=Math.log,Po=Math.LN2;function yi(i){return i>>>=0,i===0?32:31-(Ps(i)/Po|0)|0}var xi=256,Ei=4194304;function gr(i){var s=i&42;if(s!==0)return s;switch(i&-i){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return i&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return i}}function Pa(i,s,l){var c=i.pendingLanes;if(c===0)return 0;var p=0,v=i.suspendedLanes,S=i.pingedLanes;i=i.warmLanes;var D=c&134217727;return D!==0?(c=D&~v,c!==0?p=gr(c):(S&=D,S!==0?p=gr(S):l||(l=D&~i,l!==0&&(p=gr(l))))):(D=c&~v,D!==0?p=gr(D):S!==0?p=gr(S):l||(l=c&~i,l!==0&&(p=gr(l)))),p===0?0:s!==0&&s!==p&&(s&v)===0&&(v=p&-p,l=s&-s,v>=l||v===32&&(l&4194048)!==0)?s:p}function ea(i,s){return(i.pendingLanes&~(i.suspendedLanes&~i.pingedLanes)&s)===0}function ka(i,s){switch(i){case 1:case 2:case 4:case 8:case 64:return s+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function La(){var i=xi;return xi<<=1,(xi&4194048)===0&&(xi=256),i}function Va(){var i=Ei;return Ei<<=1,(Ei&62914560)===0&&(Ei=4194304),i}function ai(i){for(var s=[],l=0;31>l;l++)s.push(i);return s}function si(i,s){i.pendingLanes|=s,s!==268435456&&(i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0)}function Ti(i,s,l,c,p,v){var S=i.pendingLanes;i.pendingLanes=l,i.suspendedLanes=0,i.pingedLanes=0,i.warmLanes=0,i.expiredLanes&=l,i.entangledLanes&=l,i.errorRecoveryDisabledLanes&=l,i.shellSuspendCounter=0;var D=i.entanglements,Y=i.expirationTimes,se=i.hiddenUpdates;for(l=S&~l;0<l;){var ye=31-bn(l),Te=1<<ye;D[ye]=0,Y[ye]=-1;var ue=se[ye];if(ue!==null)for(se[ye]=null,ye=0;ye<ue.length;ye++){var fe=ue[ye];fe!==null&&(fe.lane&=-536870913)}l&=~Te}c!==0&&jr(i,c,0),v!==0&&p===0&&i.tag!==0&&(i.suspendedLanes|=v&~(S&~s))}function jr(i,s,l){i.pendingLanes|=s,i.suspendedLanes&=~s;var c=31-bn(s);i.entangledLanes|=s,i.entanglements[c]=i.entanglements[c]|1073741824|l&4194090}function ks(i,s){var l=i.entangledLanes|=s;for(i=i.entanglements;l;){var c=31-bn(l),p=1<<c;p&s|i[c]&s&&(i[c]|=s),l&=~p}}function wi(i){switch(i){case 2:i=1;break;case 8:i=4;break;case 32:i=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:i=128;break;case 268435456:i=134217728;break;default:i=0}return i}function Ba(i){return i&=-i,2<i?8<i?(i&134217727)!==0?32:268435456:8:2}function Ai(){var i=Re.p;return i!==0?i:(i=window.event,i===void 0?32:Iy(i.type))}function ko(i,s){var l=Re.p;try{return Re.p=i,s()}finally{Re.p=l}}var Ht=Math.random().toString(36).slice(2),an="__reactFiber$"+Ht,Xt="__reactProps$"+Ht,vr="__reactContainer$"+Ht,Ls="__reactEvents$"+Ht,au="__reactListeners$"+Ht,C="__reactHandles$"+Ht,z="__reactResources$"+Ht,F="__reactMarker$"+Ht;function L(i){delete i[an],delete i[Xt],delete i[Ls],delete i[au],delete i[C]}function j(i){var s=i[an];if(s)return s;for(var l=i.parentNode;l;){if(s=l[vr]||l[an]){if(l=s.alternate,s.child!==null||l!==null&&l.child!==null)for(i=my(i);i!==null;){if(l=i[an])return l;i=my(i)}return s}i=l,l=i.parentNode}return null}function G(i){if(i=i[an]||i[vr]){var s=i.tag;if(s===5||s===6||s===13||s===26||s===27||s===3)return i}return null}function ae(i){var s=i.tag;if(s===5||s===26||s===27||s===6)return i.stateNode;throw Error(r(33))}function me(i){var s=i[z];return s||(s=i[z]={hoistableStyles:new Map,hoistableScripts:new Map}),s}function ne(i){i[F]=!0}var oe=new Set,le={};function be(i,s){Ie(i,s),Ie(i+"Capture",s)}function Ie(i,s){for(le[i]=s,i=0;i<s.length;i++)oe.add(s[i])}var Ue=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ce={},Pe={};function Qe(i){return nt.call(Pe,i)?!0:nt.call(Ce,i)?!1:Ue.test(i)?Pe[i]=!0:(Ce[i]=!0,!1)}function Et(i,s,l){if(Qe(s))if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":i.removeAttribute(s);return;case"boolean":var c=s.toLowerCase().slice(0,5);if(c!=="data-"&&c!=="aria-"){i.removeAttribute(s);return}}i.setAttribute(s,""+l)}}function dt(i,s,l){if(l===null)i.removeAttribute(s);else{switch(typeof l){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(s);return}i.setAttribute(s,""+l)}}function mt(i,s,l,c){if(c===null)i.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":i.removeAttribute(l);return}i.setAttributeNS(s,l,""+c)}}var Rr,Si;function sr(i){if(Rr===void 0)try{throw Error()}catch(l){var s=l.stack.trim().match(/\n( *(at )?)/);Rr=s&&s[1]||"",Si=-1<l.stack.indexOf(`
    at`)?" (<anonymous>)":-1<l.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Rr+i+Si}var _r=!1;function bi(i,s){if(!i||_r)return"";_r=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var c={DetermineComponentFrameRoot:function(){try{if(s){var Te=function(){throw Error()};if(Object.defineProperty(Te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Te,[])}catch(fe){var ue=fe}Reflect.construct(i,[],Te)}else{try{Te.call()}catch(fe){ue=fe}i.call(Te.prototype)}}else{try{throw Error()}catch(fe){ue=fe}(Te=i())&&typeof Te.catch=="function"&&Te.catch(function(){})}}catch(fe){if(fe&&ue&&typeof fe.stack=="string")return[fe.stack,ue.stack]}return[null,null]}};c.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(c.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(c.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var v=c.DetermineComponentFrameRoot(),S=v[0],D=v[1];if(S&&D){var Y=S.split(`
`),se=D.split(`
`);for(p=c=0;c<Y.length&&!Y[c].includes("DetermineComponentFrameRoot");)c++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(c===Y.length||p===se.length)for(c=Y.length-1,p=se.length-1;1<=c&&0<=p&&Y[c]!==se[p];)p--;for(;1<=c&&0<=p;c--,p--)if(Y[c]!==se[p]){if(c!==1||p!==1)do if(c--,p--,0>p||Y[c]!==se[p]){var ye=`
`+Y[c].replace(" at new "," at ");return i.displayName&&ye.includes("<anonymous>")&&(ye=ye.replace("<anonymous>",i.displayName)),ye}while(1<=c&&0<=p);break}}}finally{_r=!1,Error.prepareStackTrace=l}return(l=i?i.displayName||i.name:"")?sr(l):""}function or(i){switch(i.tag){case 26:case 27:case 5:return sr(i.type);case 16:return sr("Lazy");case 13:return sr("Suspense");case 19:return sr("SuspenseList");case 0:case 15:return bi(i.type,!1);case 11:return bi(i.type.render,!1);case 1:return bi(i.type,!0);case 31:return sr("Activity");default:return""}}function Lo(i){try{var s="";do s+=or(i),i=i.return;while(i);return s}catch(l){return`
Error generating stack: `+l.message+`
`+l.stack}}function lr(i){switch(typeof i){case"bigint":case"boolean":case"number":case"string":case"undefined":return i;case"object":return i;default:return""}}function su(i){var s=i.type;return(i=i.nodeName)&&i.toLowerCase()==="input"&&(s==="checkbox"||s==="radio")}function K0(i){var s=su(i)?"checked":"value",l=Object.getOwnPropertyDescriptor(i.constructor.prototype,s),c=""+i[s];if(!i.hasOwnProperty(s)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var p=l.get,v=l.set;return Object.defineProperty(i,s,{configurable:!0,get:function(){return p.call(this)},set:function(S){c=""+S,v.call(this,S)}}),Object.defineProperty(i,s,{enumerable:l.enumerable}),{getValue:function(){return c},setValue:function(S){c=""+S},stopTracking:function(){i._valueTracker=null,delete i[s]}}}}function Vo(i){i._valueTracker||(i._valueTracker=K0(i))}function ou(i){if(!i)return!1;var s=i._valueTracker;if(!s)return!0;var l=s.getValue(),c="";return i&&(c=su(i)?i.checked?"true":"false":i.value),i=c,i!==l?(s.setValue(i),!0):!1}function Vs(i){if(i=i||(typeof document<"u"?document:void 0),typeof i>"u")return null;try{return i.activeElement||i.body}catch{return i.body}}var Q0=/[\n"\\]/g;function cn(i){return i.replace(Q0,function(s){return"\\"+s.charCodeAt(0).toString(16)+" "})}function Cr(i,s,l,c,p,v,S,D){i.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?i.type=S:i.removeAttribute("type"),s!=null?S==="number"?(s===0&&i.value===""||i.value!=s)&&(i.value=""+lr(s)):i.value!==""+lr(s)&&(i.value=""+lr(s)):S!=="submit"&&S!=="reset"||i.removeAttribute("value"),s!=null?Ua(i,S,lr(s)):l!=null?Ua(i,S,lr(l)):c!=null&&i.removeAttribute("value"),p==null&&v!=null&&(i.defaultChecked=!!v),p!=null&&(i.checked=p&&typeof p!="function"&&typeof p!="symbol"),D!=null&&typeof D!="function"&&typeof D!="symbol"&&typeof D!="boolean"?i.name=""+lr(D):i.removeAttribute("name")}function Bs(i,s,l,c,p,v,S,D){if(v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(i.type=v),s!=null||l!=null){if(!(v!=="submit"&&v!=="reset"||s!=null))return;l=l!=null?""+lr(l):"",s=s!=null?""+lr(s):l,D||s===i.value||(i.value=s),i.defaultValue=s}c=c??p,c=typeof c!="function"&&typeof c!="symbol"&&!!c,i.checked=D?i.checked:!!c,i.defaultChecked=!!c,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(i.name=S)}function Ua(i,s,l){s==="number"&&Vs(i.ownerDocument)===i||i.defaultValue===""+l||(i.defaultValue=""+l)}function ta(i,s,l,c){if(i=i.options,s){s={};for(var p=0;p<l.length;p++)s["$"+l[p]]=!0;for(l=0;l<i.length;l++)p=s.hasOwnProperty("$"+i[l].value),i[l].selected!==p&&(i[l].selected=p),p&&c&&(i[l].defaultSelected=!0)}else{for(l=""+lr(l),s=null,p=0;p<i.length;p++){if(i[p].value===l){i[p].selected=!0,c&&(i[p].defaultSelected=!0);return}s!==null||i[p].disabled||(s=i[p])}s!==null&&(s.selected=!0)}}function Mt(i,s,l){if(s!=null&&(s=""+lr(s),s!==i.value&&(i.value=s),l==null)){i.defaultValue!==s&&(i.defaultValue=s);return}i.defaultValue=l!=null?""+lr(l):""}function Us(i,s,l,c){if(s==null){if(c!=null){if(l!=null)throw Error(r(92));if(He(c)){if(1<c.length)throw Error(r(93));c=c[0]}l=c}l==null&&(l=""),s=l}l=lr(s),i.defaultValue=l,c=i.textContent,c===l&&c!==""&&c!==null&&(i.value=c)}function zr(i,s){if(s){var l=i.firstChild;if(l&&l===i.lastChild&&l.nodeType===3){l.nodeValue=s;return}}i.textContent=s}var js=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function af(i,s,l){var c=s.indexOf("--")===0;l==null||typeof l=="boolean"||l===""?c?i.setProperty(s,""):s==="float"?i.cssFloat="":i[s]="":c?i.setProperty(s,l):typeof l!="number"||l===0||js.has(s)?s==="float"?i.cssFloat=l:i[s]=(""+l).trim():i[s]=l+"px"}function lu(i,s,l){if(s!=null&&typeof s!="object")throw Error(r(62));if(i=i.style,l!=null){for(var c in l)!l.hasOwnProperty(c)||s!=null&&s.hasOwnProperty(c)||(c.indexOf("--")===0?i.setProperty(c,""):c==="float"?i.cssFloat="":i[c]="");for(var p in s)c=s[p],s.hasOwnProperty(p)&&l[p]!==c&&af(i,p,c)}else for(var v in s)s.hasOwnProperty(v)&&af(i,v,s[v])}function uu(i){if(i.indexOf("-")===-1)return!1;switch(i){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Z0=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),J0=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Bo(i){return J0.test(""+i)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":i}var na=null;function Hr(i){return i=i.target||i.srcElement||window,i.correspondingUseElement&&(i=i.correspondingUseElement),i.nodeType===3?i.parentNode:i}var ra=null,ia=null;function cu(i){var s=G(i);if(s&&(i=s.stateNode)){var l=i[Xt]||null;e:switch(i=s.stateNode,s.type){case"input":if(Cr(i,l.value,l.defaultValue,l.defaultValue,l.checked,l.defaultChecked,l.type,l.name),s=l.name,l.type==="radio"&&s!=null){for(l=i;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll('input[name="'+cn(""+s)+'"][type="radio"]'),s=0;s<l.length;s++){var c=l[s];if(c!==i&&c.form===i.form){var p=c[Xt]||null;if(!p)throw Error(r(90));Cr(c,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(s=0;s<l.length;s++)c=l[s],c.form===i.form&&ou(c)}break e;case"textarea":Mt(i,l.value,l.defaultValue);break e;case"select":s=l.value,s!=null&&ta(i,!!l.multiple,s,!1)}}}var Ri=!1;function sf(i,s,l){if(Ri)return i(s,l);Ri=!0;try{var c=i(s);return c}finally{if(Ri=!1,(ra!==null||ia!==null)&&(Jf(),ra&&(s=ra,i=ia,ia=ra=null,cu(s),i)))for(s=0;s<i.length;s++)cu(i[s])}}function zs(i,s){var l=i.stateNode;if(l===null)return null;var c=l[Xt]||null;if(c===null)return null;l=c[s];e:switch(s){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(c=!c.disabled)||(i=i.type,c=!(i==="button"||i==="input"||i==="select"||i==="textarea")),i=!c;break e;default:i=!1}if(i)return null;if(l&&typeof l!="function")throw Error(r(231,s,typeof l));return l}var oi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gr=!1;if(oi)try{var Hs={};Object.defineProperty(Hs,"passive",{get:function(){Gr=!0}}),window.addEventListener("test",Hs,Hs),window.removeEventListener("test",Hs,Hs)}catch{Gr=!1}var Ci=null,ja=null,aa=null;function fu(){if(aa)return aa;var i,s=ja,l=s.length,c,p="value"in Ci?Ci.value:Ci.textContent,v=p.length;for(i=0;i<l&&s[i]===p[i];i++);var S=l-i;for(c=1;c<=S&&s[l-c]===p[v-c];c++);return aa=p.slice(i,1<c?1-c:void 0)}function Ii(i){var s=i.keyCode;return"charCode"in i?(i=i.charCode,i===0&&s===13&&(i=13)):i=s,i===10&&(i=13),32<=i||i===13?i:0}function Ni(){return!0}function hu(){return!1}function Rn(i){function s(l,c,p,v,S){this._reactName=l,this._targetInst=p,this.type=c,this.nativeEvent=v,this.target=S,this.currentTarget=null;for(var D in i)i.hasOwnProperty(D)&&(l=i[D],this[D]=l?l(v):v[D]);return this.isDefaultPrevented=(v.defaultPrevented!=null?v.defaultPrevented:v.returnValue===!1)?Ni:hu,this.isPropagationStopped=hu,this}return g(s.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=Ni)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=Ni)},persist:function(){},isPersistent:Ni}),s}var bt={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(i){return i.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Uo=Rn(bt),Gs=g({},bt,{view:0,detail:0}),of=Rn(Gs),jo,zo,Di,qs=g({},Gs,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ys,button:0,buttons:0,relatedTarget:function(i){return i.relatedTarget===void 0?i.fromElement===i.srcElement?i.toElement:i.fromElement:i.relatedTarget},movementX:function(i){return"movementX"in i?i.movementX:(i!==Di&&(Di&&i.type==="mousemove"?(jo=i.screenX-Di.screenX,zo=i.screenY-Di.screenY):zo=jo=0,Di=i),jo)},movementY:function(i){return"movementY"in i?i.movementY:zo}}),qr=Rn(qs),lf=g({},qs,{dataTransfer:0}),ed=Rn(lf),$s=g({},Gs,{relatedTarget:0}),Ho=Rn($s),du=g({},bt,{animationName:0,elapsedTime:0,pseudoElement:0}),Go=Rn(du),uf=g({},bt,{clipboardData:function(i){return"clipboardData"in i?i.clipboardData:window.clipboardData}}),qo=Rn(uf),td=g({},bt,{data:0}),mu=Rn(td),Xs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},cf={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ff={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function pu(i){var s=this.nativeEvent;return s.getModifierState?s.getModifierState(i):(i=ff[i])?!!s[i]:!1}function Ys(){return pu}var hf=g({},Gs,{key:function(i){if(i.key){var s=Xs[i.key]||i.key;if(s!=="Unidentified")return s}return i.type==="keypress"?(i=Ii(i),i===13?"Enter":String.fromCharCode(i)):i.type==="keydown"||i.type==="keyup"?cf[i.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ys,charCode:function(i){return i.type==="keypress"?Ii(i):0},keyCode:function(i){return i.type==="keydown"||i.type==="keyup"?i.keyCode:0},which:function(i){return i.type==="keypress"?Ii(i):i.type==="keydown"||i.type==="keyup"?i.keyCode:0}}),$o=Rn(hf),df=g({},qs,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),gu=Rn(df),sa=g({},Gs,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ys}),mf=Rn(sa),pf=g({},bt,{propertyName:0,elapsedTime:0,pseudoElement:0}),gf=Rn(pf),vf=g({},qs,{deltaX:function(i){return"deltaX"in i?i.deltaX:"wheelDeltaX"in i?-i.wheelDeltaX:0},deltaY:function(i){return"deltaY"in i?i.deltaY:"wheelDeltaY"in i?-i.wheelDeltaY:"wheelDelta"in i?-i.wheelDelta:0},deltaZ:0,deltaMode:0}),Xo=Rn(vf),ur=g({},bt,{newState:0,oldState:0}),_f=Rn(ur),yf=[9,13,27,32],Oi=oi&&"CompositionEvent"in window,d=null;oi&&"documentMode"in document&&(d=document.documentMode);var x=oi&&"TextEvent"in window&&!d,A=oi&&(!Oi||d&&8<d&&11>=d),O=" ",re=!1;function pe(i,s){switch(i){case"keyup":return yf.indexOf(s.keyCode)!==-1;case"keydown":return s.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function De(i){return i=i.detail,typeof i=="object"&&"data"in i?i.data:null}var pt=!1;function xn(i,s){switch(i){case"compositionend":return De(s);case"keypress":return s.which!==32?null:(re=!0,O);case"textInput":return i=s.data,i===O&&re?null:i;default:return null}}function gt(i,s){if(pt)return i==="compositionend"||!Oi&&pe(i,s)?(i=fu(),aa=ja=Ci=null,pt=!1,i):null;switch(i){case"paste":return null;case"keypress":if(!(s.ctrlKey||s.altKey||s.metaKey)||s.ctrlKey&&s.altKey){if(s.char&&1<s.char.length)return s.char;if(s.which)return String.fromCharCode(s.which)}return null;case"compositionend":return A&&s.locale!=="ko"?null:s.data;default:return null}}var Cn={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function En(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s==="input"?!!Cn[i.type]:s==="textarea"}function oa(i,s,l,c){ra?ia?ia.push(c):ia=[c]:ra=c,s=ah(s,"onChange"),0<s.length&&(l=new Uo("onChange","change",null,l,c),i.push({event:l,listeners:s}))}var kn=null,Fi=null;function vu(i){iy(i,0)}function xf(i){var s=ae(i);if(ou(s))return i}function S1(i,s){if(i==="change")return s}var b1=!1;if(oi){var nd;if(oi){var rd="oninput"in document;if(!rd){var R1=document.createElement("div");R1.setAttribute("oninput","return;"),rd=typeof R1.oninput=="function"}nd=rd}else nd=!1;b1=nd&&(!document.documentMode||9<document.documentMode)}function C1(){kn&&(kn.detachEvent("onpropertychange",I1),Fi=kn=null)}function I1(i){if(i.propertyName==="value"&&xf(Fi)){var s=[];oa(s,Fi,i,Hr(i)),sf(vu,s)}}function wS(i,s,l){i==="focusin"?(C1(),kn=s,Fi=l,kn.attachEvent("onpropertychange",I1)):i==="focusout"&&C1()}function AS(i){if(i==="selectionchange"||i==="keyup"||i==="keydown")return xf(Fi)}function SS(i,s){if(i==="click")return xf(s)}function bS(i,s){if(i==="input"||i==="change")return xf(s)}function RS(i,s){return i===s&&(i!==0||1/i===1/s)||i!==i&&s!==s}var Ir=typeof Object.is=="function"?Object.is:RS;function _u(i,s){if(Ir(i,s))return!0;if(typeof i!="object"||i===null||typeof s!="object"||s===null)return!1;var l=Object.keys(i),c=Object.keys(s);if(l.length!==c.length)return!1;for(c=0;c<l.length;c++){var p=l[c];if(!nt.call(s,p)||!Ir(i[p],s[p]))return!1}return!0}function N1(i){for(;i&&i.firstChild;)i=i.firstChild;return i}function D1(i,s){var l=N1(i);i=0;for(var c;l;){if(l.nodeType===3){if(c=i+l.textContent.length,i<=s&&c>=s)return{node:l,offset:s-i};i=c}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=N1(l)}}function O1(i,s){return i&&s?i===s?!0:i&&i.nodeType===3?!1:s&&s.nodeType===3?O1(i,s.parentNode):"contains"in i?i.contains(s):i.compareDocumentPosition?!!(i.compareDocumentPosition(s)&16):!1:!1}function F1(i){i=i!=null&&i.ownerDocument!=null&&i.ownerDocument.defaultView!=null?i.ownerDocument.defaultView:window;for(var s=Vs(i.document);s instanceof i.HTMLIFrameElement;){try{var l=typeof s.contentWindow.location.href=="string"}catch{l=!1}if(l)i=s.contentWindow;else break;s=Vs(i.document)}return s}function id(i){var s=i&&i.nodeName&&i.nodeName.toLowerCase();return s&&(s==="input"&&(i.type==="text"||i.type==="search"||i.type==="tel"||i.type==="url"||i.type==="password")||s==="textarea"||i.contentEditable==="true")}var CS=oi&&"documentMode"in document&&11>=document.documentMode,Yo=null,ad=null,yu=null,sd=!1;function M1(i,s,l){var c=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;sd||Yo==null||Yo!==Vs(c)||(c=Yo,"selectionStart"in c&&id(c)?c={start:c.selectionStart,end:c.selectionEnd}:(c=(c.ownerDocument&&c.ownerDocument.defaultView||window).getSelection(),c={anchorNode:c.anchorNode,anchorOffset:c.anchorOffset,focusNode:c.focusNode,focusOffset:c.focusOffset}),yu&&_u(yu,c)||(yu=c,c=ah(ad,"onSelect"),0<c.length&&(s=new Uo("onSelect","select",null,s,l),i.push({event:s,listeners:c}),s.target=Yo)))}function Ws(i,s){var l={};return l[i.toLowerCase()]=s.toLowerCase(),l["Webkit"+i]="webkit"+s,l["Moz"+i]="moz"+s,l}var Wo={animationend:Ws("Animation","AnimationEnd"),animationiteration:Ws("Animation","AnimationIteration"),animationstart:Ws("Animation","AnimationStart"),transitionrun:Ws("Transition","TransitionRun"),transitionstart:Ws("Transition","TransitionStart"),transitioncancel:Ws("Transition","TransitionCancel"),transitionend:Ws("Transition","TransitionEnd")},od={},P1={};oi&&(P1=document.createElement("div").style,"AnimationEvent"in window||(delete Wo.animationend.animation,delete Wo.animationiteration.animation,delete Wo.animationstart.animation),"TransitionEvent"in window||delete Wo.transitionend.transition);function Ks(i){if(od[i])return od[i];if(!Wo[i])return i;var s=Wo[i],l;for(l in s)if(s.hasOwnProperty(l)&&l in P1)return od[i]=s[l];return i}var k1=Ks("animationend"),L1=Ks("animationiteration"),V1=Ks("animationstart"),IS=Ks("transitionrun"),NS=Ks("transitionstart"),DS=Ks("transitioncancel"),B1=Ks("transitionend"),U1=new Map,ld="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");ld.push("scrollEnd");function li(i,s){U1.set(i,s),be(s,[i])}var j1=new WeakMap;function $r(i,s){if(typeof i=="object"&&i!==null){var l=j1.get(i);return l!==void 0?l:(s={value:i,source:s,stack:Lo(s)},j1.set(i,s),s)}return{value:i,source:s,stack:Lo(s)}}var Xr=[],Ko=0,ud=0;function Ef(){for(var i=Ko,s=ud=Ko=0;s<i;){var l=Xr[s];Xr[s++]=null;var c=Xr[s];Xr[s++]=null;var p=Xr[s];Xr[s++]=null;var v=Xr[s];if(Xr[s++]=null,c!==null&&p!==null){var S=c.pending;S===null?p.next=p:(p.next=S.next,S.next=p),c.pending=p}v!==0&&z1(l,p,v)}}function Tf(i,s,l,c){Xr[Ko++]=i,Xr[Ko++]=s,Xr[Ko++]=l,Xr[Ko++]=c,ud|=c,i.lanes|=c,i=i.alternate,i!==null&&(i.lanes|=c)}function cd(i,s,l,c){return Tf(i,s,l,c),wf(i)}function Qo(i,s){return Tf(i,null,null,s),wf(i)}function z1(i,s,l){i.lanes|=l;var c=i.alternate;c!==null&&(c.lanes|=l);for(var p=!1,v=i.return;v!==null;)v.childLanes|=l,c=v.alternate,c!==null&&(c.childLanes|=l),v.tag===22&&(i=v.stateNode,i===null||i._visibility&1||(p=!0)),i=v,v=v.return;return i.tag===3?(v=i.stateNode,p&&s!==null&&(p=31-bn(l),i=v.hiddenUpdates,c=i[p],c===null?i[p]=[s]:c.push(s),s.lane=l|536870912),v):null}function wf(i){if(50<Gu)throw Gu=0,gm=null,Error(r(185));for(var s=i.return;s!==null;)i=s,s=i.return;return i.tag===3?i.stateNode:null}var Zo={};function OS(i,s,l,c){this.tag=i,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=s,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=c,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Nr(i,s,l,c){return new OS(i,s,l,c)}function fd(i){return i=i.prototype,!(!i||!i.isReactComponent)}function la(i,s){var l=i.alternate;return l===null?(l=Nr(i.tag,s,i.key,i.mode),l.elementType=i.elementType,l.type=i.type,l.stateNode=i.stateNode,l.alternate=i,i.alternate=l):(l.pendingProps=s,l.type=i.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=i.flags&65011712,l.childLanes=i.childLanes,l.lanes=i.lanes,l.child=i.child,l.memoizedProps=i.memoizedProps,l.memoizedState=i.memoizedState,l.updateQueue=i.updateQueue,s=i.dependencies,l.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext},l.sibling=i.sibling,l.index=i.index,l.ref=i.ref,l.refCleanup=i.refCleanup,l}function H1(i,s){i.flags&=65011714;var l=i.alternate;return l===null?(i.childLanes=0,i.lanes=s,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=l.childLanes,i.lanes=l.lanes,i.child=l.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=l.memoizedProps,i.memoizedState=l.memoizedState,i.updateQueue=l.updateQueue,i.type=l.type,s=l.dependencies,i.dependencies=s===null?null:{lanes:s.lanes,firstContext:s.firstContext}),i}function Af(i,s,l,c,p,v){var S=0;if(c=i,typeof i=="function")fd(i)&&(S=1);else if(typeof i=="string")S=M4(i,l,K.current)?26:i==="html"||i==="head"||i==="body"?27:5;else e:switch(i){case R:return i=Nr(31,l,s,p),i.elementType=R,i.lanes=v,i;case w:return Qs(l.children,p,v,s);case T:S=8,p|=24;break;case b:return i=Nr(12,l,s,p|2),i.elementType=b,i.lanes=v,i;case he:return i=Nr(13,l,s,p),i.elementType=he,i.lanes=v,i;case Ae:return i=Nr(19,l,s,p),i.elementType=Ae,i.lanes=v,i;default:if(typeof i=="object"&&i!==null)switch(i.$$typeof){case k:case X:S=10;break e;case q:S=9;break e;case ee:S=11;break e;case N:S=14;break e;case I:S=16,c=null;break e}S=29,l=Error(r(130,i===null?"null":typeof i,"")),c=null}return s=Nr(S,l,s,p),s.elementType=i,s.type=c,s.lanes=v,s}function Qs(i,s,l,c){return i=Nr(7,i,c,s),i.lanes=l,i}function hd(i,s,l){return i=Nr(6,i,null,s),i.lanes=l,i}function dd(i,s,l){return s=Nr(4,i.children!==null?i.children:[],i.key,s),s.lanes=l,s.stateNode={containerInfo:i.containerInfo,pendingChildren:null,implementation:i.implementation},s}var Jo=[],el=0,Sf=null,bf=0,Yr=[],Wr=0,Zs=null,ua=1,ca="";function Js(i,s){Jo[el++]=bf,Jo[el++]=Sf,Sf=i,bf=s}function G1(i,s,l){Yr[Wr++]=ua,Yr[Wr++]=ca,Yr[Wr++]=Zs,Zs=i;var c=ua;i=ca;var p=32-bn(c)-1;c&=~(1<<p),l+=1;var v=32-bn(s)+p;if(30<v){var S=p-p%5;v=(c&(1<<S)-1).toString(32),c>>=S,p-=S,ua=1<<32-bn(s)+p|l<<p|c,ca=v+i}else ua=1<<v|l<<p|c,ca=i}function md(i){i.return!==null&&(Js(i,1),G1(i,1,0))}function pd(i){for(;i===Sf;)Sf=Jo[--el],Jo[el]=null,bf=Jo[--el],Jo[el]=null;for(;i===Zs;)Zs=Yr[--Wr],Yr[Wr]=null,ca=Yr[--Wr],Yr[Wr]=null,ua=Yr[--Wr],Yr[Wr]=null}var cr=null,Jt=null,At=!1,eo=null,Mi=!1,gd=Error(r(519));function to(i){var s=Error(r(418,""));throw Tu($r(s,i)),gd}function q1(i){var s=i.stateNode,l=i.type,c=i.memoizedProps;switch(s[an]=i,s[Xt]=c,l){case"dialog":ft("cancel",s),ft("close",s);break;case"iframe":case"object":case"embed":ft("load",s);break;case"video":case"audio":for(l=0;l<$u.length;l++)ft($u[l],s);break;case"source":ft("error",s);break;case"img":case"image":case"link":ft("error",s),ft("load",s);break;case"details":ft("toggle",s);break;case"input":ft("invalid",s),Bs(s,c.value,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name,!0),Vo(s);break;case"select":ft("invalid",s);break;case"textarea":ft("invalid",s),Us(s,c.value,c.defaultValue,c.children),Vo(s)}l=c.children,typeof l!="string"&&typeof l!="number"&&typeof l!="bigint"||s.textContent===""+l||c.suppressHydrationWarning===!0||ly(s.textContent,l)?(c.popover!=null&&(ft("beforetoggle",s),ft("toggle",s)),c.onScroll!=null&&ft("scroll",s),c.onScrollEnd!=null&&ft("scrollend",s),c.onClick!=null&&(s.onclick=sh),s=!0):s=!1,s||to(i)}function $1(i){for(cr=i.return;cr;)switch(cr.tag){case 5:case 13:Mi=!1;return;case 27:case 3:Mi=!0;return;default:cr=cr.return}}function xu(i){if(i!==cr)return!1;if(!At)return $1(i),At=!0,!1;var s=i.tag,l;if((l=s!==3&&s!==27)&&((l=s===5)&&(l=i.type,l=!(l!=="form"&&l!=="button")||Om(i.type,i.memoizedProps)),l=!l),l&&Jt&&to(i),$1(i),s===13){if(i=i.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(r(317));e:{for(i=i.nextSibling,s=0;i;){if(i.nodeType===8)if(l=i.data,l==="/$"){if(s===0){Jt=ci(i.nextSibling);break e}s--}else l!=="$"&&l!=="$!"&&l!=="$?"||s++;i=i.nextSibling}Jt=null}}else s===27?(s=Jt,rs(i.type)?(i=km,km=null,Jt=i):Jt=s):Jt=cr?ci(i.stateNode.nextSibling):null;return!0}function Eu(){Jt=cr=null,At=!1}function X1(){var i=eo;return i!==null&&(Er===null?Er=i:Er.push.apply(Er,i),eo=null),i}function Tu(i){eo===null?eo=[i]:eo.push(i)}var vd=xe(null),no=null,fa=null;function za(i,s,l){W(vd,s._currentValue),s._currentValue=l}function ha(i){i._currentValue=vd.current,U(vd)}function _d(i,s,l){for(;i!==null;){var c=i.alternate;if((i.childLanes&s)!==s?(i.childLanes|=s,c!==null&&(c.childLanes|=s)):c!==null&&(c.childLanes&s)!==s&&(c.childLanes|=s),i===l)break;i=i.return}}function yd(i,s,l,c){var p=i.child;for(p!==null&&(p.return=i);p!==null;){var v=p.dependencies;if(v!==null){var S=p.child;v=v.firstContext;e:for(;v!==null;){var D=v;v=p;for(var Y=0;Y<s.length;Y++)if(D.context===s[Y]){v.lanes|=l,D=v.alternate,D!==null&&(D.lanes|=l),_d(v.return,l,i),c||(S=null);break e}v=D.next}}else if(p.tag===18){if(S=p.return,S===null)throw Error(r(341));S.lanes|=l,v=S.alternate,v!==null&&(v.lanes|=l),_d(S,l,i),S=null}else S=p.child;if(S!==null)S.return=p;else for(S=p;S!==null;){if(S===i){S=null;break}if(p=S.sibling,p!==null){p.return=S.return,S=p;break}S=S.return}p=S}}function wu(i,s,l,c){i=null;for(var p=s,v=!1;p!==null;){if(!v){if((p.flags&524288)!==0)v=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var S=p.alternate;if(S===null)throw Error(r(387));if(S=S.memoizedProps,S!==null){var D=p.type;Ir(p.pendingProps.value,S.value)||(i!==null?i.push(D):i=[D])}}else if(p===Le.current){if(S=p.alternate,S===null)throw Error(r(387));S.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(i!==null?i.push(Zu):i=[Zu])}p=p.return}i!==null&&yd(s,i,l,c),s.flags|=262144}function Rf(i){for(i=i.firstContext;i!==null;){if(!Ir(i.context._currentValue,i.memoizedValue))return!0;i=i.next}return!1}function ro(i){no=i,fa=null,i=i.dependencies,i!==null&&(i.firstContext=null)}function Qn(i){return Y1(no,i)}function Cf(i,s){return no===null&&ro(i),Y1(i,s)}function Y1(i,s){var l=s._currentValue;if(s={context:s,memoizedValue:l,next:null},fa===null){if(i===null)throw Error(r(308));fa=s,i.dependencies={lanes:0,firstContext:s},i.flags|=524288}else fa=fa.next=s;return l}var FS=typeof AbortController<"u"?AbortController:function(){var i=[],s=this.signal={aborted:!1,addEventListener:function(l,c){i.push(c)}};this.abort=function(){s.aborted=!0,i.forEach(function(l){return l()})}},MS=t.unstable_scheduleCallback,PS=t.unstable_NormalPriority,Tn={$$typeof:X,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xd(){return{controller:new FS,data:new Map,refCount:0}}function Au(i){i.refCount--,i.refCount===0&&MS(PS,function(){i.controller.abort()})}var Su=null,Ed=0,tl=0,nl=null;function kS(i,s){if(Su===null){var l=Su=[];Ed=0,tl=wm(),nl={status:"pending",value:void 0,then:function(c){l.push(c)}}}return Ed++,s.then(W1,W1),s}function W1(){if(--Ed===0&&Su!==null){nl!==null&&(nl.status="fulfilled");var i=Su;Su=null,tl=0,nl=null;for(var s=0;s<i.length;s++)(0,i[s])()}}function LS(i,s){var l=[],c={status:"pending",value:null,reason:null,then:function(p){l.push(p)}};return i.then(function(){c.status="fulfilled",c.value=s;for(var p=0;p<l.length;p++)(0,l[p])(s)},function(p){for(c.status="rejected",c.reason=p,p=0;p<l.length;p++)(0,l[p])(void 0)}),c}var K1=de.S;de.S=function(i,s){typeof s=="object"&&s!==null&&typeof s.then=="function"&&kS(i,s),K1!==null&&K1(i,s)};var io=xe(null);function Td(){var i=io.current;return i!==null?i:Gt.pooledCache}function If(i,s){s===null?W(io,io.current):W(io,s.pool)}function Q1(){var i=Td();return i===null?null:{parent:Tn._currentValue,pool:i}}var bu=Error(r(460)),Z1=Error(r(474)),Nf=Error(r(542)),wd={then:function(){}};function J1(i){return i=i.status,i==="fulfilled"||i==="rejected"}function Df(){}function ev(i,s,l){switch(l=i[l],l===void 0?i.push(s):l!==s&&(s.then(Df,Df),s=l),s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,nv(i),i;default:if(typeof s.status=="string")s.then(Df,Df);else{if(i=Gt,i!==null&&100<i.shellSuspendCounter)throw Error(r(482));i=s,i.status="pending",i.then(function(c){if(s.status==="pending"){var p=s;p.status="fulfilled",p.value=c}},function(c){if(s.status==="pending"){var p=s;p.status="rejected",p.reason=c}})}switch(s.status){case"fulfilled":return s.value;case"rejected":throw i=s.reason,nv(i),i}throw Ru=s,bu}}var Ru=null;function tv(){if(Ru===null)throw Error(r(459));var i=Ru;return Ru=null,i}function nv(i){if(i===bu||i===Nf)throw Error(r(483))}var Ha=!1;function Ad(i){i.updateQueue={baseState:i.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Sd(i,s){i=i.updateQueue,s.updateQueue===i&&(s.updateQueue={baseState:i.baseState,firstBaseUpdate:i.firstBaseUpdate,lastBaseUpdate:i.lastBaseUpdate,shared:i.shared,callbacks:null})}function Ga(i){return{lane:i,tag:0,payload:null,callback:null,next:null}}function qa(i,s,l){var c=i.updateQueue;if(c===null)return null;if(c=c.shared,(Ct&2)!==0){var p=c.pending;return p===null?s.next=s:(s.next=p.next,p.next=s),c.pending=s,s=wf(i),z1(i,null,l),s}return Tf(i,c,s,l),wf(i)}function Cu(i,s,l){if(s=s.updateQueue,s!==null&&(s=s.shared,(l&4194048)!==0)){var c=s.lanes;c&=i.pendingLanes,l|=c,s.lanes=l,ks(i,l)}}function bd(i,s){var l=i.updateQueue,c=i.alternate;if(c!==null&&(c=c.updateQueue,l===c)){var p=null,v=null;if(l=l.firstBaseUpdate,l!==null){do{var S={lane:l.lane,tag:l.tag,payload:l.payload,callback:null,next:null};v===null?p=v=S:v=v.next=S,l=l.next}while(l!==null);v===null?p=v=s:v=v.next=s}else p=v=s;l={baseState:c.baseState,firstBaseUpdate:p,lastBaseUpdate:v,shared:c.shared,callbacks:c.callbacks},i.updateQueue=l;return}i=l.lastBaseUpdate,i===null?l.firstBaseUpdate=s:i.next=s,l.lastBaseUpdate=s}var Rd=!1;function Iu(){if(Rd){var i=nl;if(i!==null)throw i}}function Nu(i,s,l,c){Rd=!1;var p=i.updateQueue;Ha=!1;var v=p.firstBaseUpdate,S=p.lastBaseUpdate,D=p.shared.pending;if(D!==null){p.shared.pending=null;var Y=D,se=Y.next;Y.next=null,S===null?v=se:S.next=se,S=Y;var ye=i.alternate;ye!==null&&(ye=ye.updateQueue,D=ye.lastBaseUpdate,D!==S&&(D===null?ye.firstBaseUpdate=se:D.next=se,ye.lastBaseUpdate=Y))}if(v!==null){var Te=p.baseState;S=0,ye=se=Y=null,D=v;do{var ue=D.lane&-536870913,fe=ue!==D.lane;if(fe?(vt&ue)===ue:(c&ue)===ue){ue!==0&&ue===tl&&(Rd=!0),ye!==null&&(ye=ye.next={lane:0,tag:D.tag,payload:D.payload,callback:null,next:null});e:{var Ze=i,Xe=D;ue=s;var Lt=l;switch(Xe.tag){case 1:if(Ze=Xe.payload,typeof Ze=="function"){Te=Ze.call(Lt,Te,ue);break e}Te=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Xe.payload,ue=typeof Ze=="function"?Ze.call(Lt,Te,ue):Ze,ue==null)break e;Te=g({},Te,ue);break e;case 2:Ha=!0}}ue=D.callback,ue!==null&&(i.flags|=64,fe&&(i.flags|=8192),fe=p.callbacks,fe===null?p.callbacks=[ue]:fe.push(ue))}else fe={lane:ue,tag:D.tag,payload:D.payload,callback:D.callback,next:null},ye===null?(se=ye=fe,Y=Te):ye=ye.next=fe,S|=ue;if(D=D.next,D===null){if(D=p.shared.pending,D===null)break;fe=D,D=fe.next,fe.next=null,p.lastBaseUpdate=fe,p.shared.pending=null}}while(!0);ye===null&&(Y=Te),p.baseState=Y,p.firstBaseUpdate=se,p.lastBaseUpdate=ye,v===null&&(p.shared.lanes=0),Ja|=S,i.lanes=S,i.memoizedState=Te}}function rv(i,s){if(typeof i!="function")throw Error(r(191,i));i.call(s)}function iv(i,s){var l=i.callbacks;if(l!==null)for(i.callbacks=null,i=0;i<l.length;i++)rv(l[i],s)}var rl=xe(null),Of=xe(0);function av(i,s){i=ya,W(Of,i),W(rl,s),ya=i|s.baseLanes}function Cd(){W(Of,ya),W(rl,rl.current)}function Id(){ya=Of.current,U(rl),U(Of)}var $a=0,at=null,Pt=null,fn=null,Ff=!1,il=!1,ao=!1,Mf=0,Du=0,al=null,VS=0;function sn(){throw Error(r(321))}function Nd(i,s){if(s===null)return!1;for(var l=0;l<s.length&&l<i.length;l++)if(!Ir(i[l],s[l]))return!1;return!0}function Dd(i,s,l,c,p,v){return $a=v,at=s,s.memoizedState=null,s.updateQueue=null,s.lanes=0,de.H=i===null||i.memoizedState===null?zv:Hv,ao=!1,v=l(c,p),ao=!1,il&&(v=ov(s,l,c,p)),sv(i),v}function sv(i){de.H=Uf;var s=Pt!==null&&Pt.next!==null;if($a=0,fn=Pt=at=null,Ff=!1,Du=0,al=null,s)throw Error(r(300));i===null||In||(i=i.dependencies,i!==null&&Rf(i)&&(In=!0))}function ov(i,s,l,c){at=i;var p=0;do{if(il&&(al=null),Du=0,il=!1,25<=p)throw Error(r(301));if(p+=1,fn=Pt=null,i.updateQueue!=null){var v=i.updateQueue;v.lastEffect=null,v.events=null,v.stores=null,v.memoCache!=null&&(v.memoCache.index=0)}de.H=qS,v=s(l,c)}while(il);return v}function BS(){var i=de.H,s=i.useState()[0];return s=typeof s.then=="function"?Ou(s):s,i=i.useState()[0],(Pt!==null?Pt.memoizedState:null)!==i&&(at.flags|=1024),s}function Od(){var i=Mf!==0;return Mf=0,i}function Fd(i,s,l){s.updateQueue=i.updateQueue,s.flags&=-2053,i.lanes&=~l}function Md(i){if(Ff){for(i=i.memoizedState;i!==null;){var s=i.queue;s!==null&&(s.pending=null),i=i.next}Ff=!1}$a=0,fn=Pt=at=null,il=!1,Du=Mf=0,al=null}function yr(){var i={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return fn===null?at.memoizedState=fn=i:fn=fn.next=i,fn}function hn(){if(Pt===null){var i=at.alternate;i=i!==null?i.memoizedState:null}else i=Pt.next;var s=fn===null?at.memoizedState:fn.next;if(s!==null)fn=s,Pt=i;else{if(i===null)throw at.alternate===null?Error(r(467)):Error(r(310));Pt=i,i={memoizedState:Pt.memoizedState,baseState:Pt.baseState,baseQueue:Pt.baseQueue,queue:Pt.queue,next:null},fn===null?at.memoizedState=fn=i:fn=fn.next=i}return fn}function Pd(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Ou(i){var s=Du;return Du+=1,al===null&&(al=[]),i=ev(al,i,s),s=at,(fn===null?s.memoizedState:fn.next)===null&&(s=s.alternate,de.H=s===null||s.memoizedState===null?zv:Hv),i}function Pf(i){if(i!==null&&typeof i=="object"){if(typeof i.then=="function")return Ou(i);if(i.$$typeof===X)return Qn(i)}throw Error(r(438,String(i)))}function kd(i){var s=null,l=at.updateQueue;if(l!==null&&(s=l.memoCache),s==null){var c=at.alternate;c!==null&&(c=c.updateQueue,c!==null&&(c=c.memoCache,c!=null&&(s={data:c.data.map(function(p){return p.slice()}),index:0})))}if(s==null&&(s={data:[],index:0}),l===null&&(l=Pd(),at.updateQueue=l),l.memoCache=s,l=s.data[s.index],l===void 0)for(l=s.data[s.index]=Array(i),c=0;c<i;c++)l[c]=M;return s.index++,l}function da(i,s){return typeof s=="function"?s(i):s}function kf(i){var s=hn();return Ld(s,Pt,i)}function Ld(i,s,l){var c=i.queue;if(c===null)throw Error(r(311));c.lastRenderedReducer=l;var p=i.baseQueue,v=c.pending;if(v!==null){if(p!==null){var S=p.next;p.next=v.next,v.next=S}s.baseQueue=p=v,c.pending=null}if(v=i.baseState,p===null)i.memoizedState=v;else{s=p.next;var D=S=null,Y=null,se=s,ye=!1;do{var Te=se.lane&-536870913;if(Te!==se.lane?(vt&Te)===Te:($a&Te)===Te){var ue=se.revertLane;if(ue===0)Y!==null&&(Y=Y.next={lane:0,revertLane:0,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),Te===tl&&(ye=!0);else if(($a&ue)===ue){se=se.next,ue===tl&&(ye=!0);continue}else Te={lane:0,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Y===null?(D=Y=Te,S=v):Y=Y.next=Te,at.lanes|=ue,Ja|=ue;Te=se.action,ao&&l(v,Te),v=se.hasEagerState?se.eagerState:l(v,Te)}else ue={lane:Te,revertLane:se.revertLane,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},Y===null?(D=Y=ue,S=v):Y=Y.next=ue,at.lanes|=Te,Ja|=Te;se=se.next}while(se!==null&&se!==s);if(Y===null?S=v:Y.next=D,!Ir(v,i.memoizedState)&&(In=!0,ye&&(l=nl,l!==null)))throw l;i.memoizedState=v,i.baseState=S,i.baseQueue=Y,c.lastRenderedState=v}return p===null&&(c.lanes=0),[i.memoizedState,c.dispatch]}function Vd(i){var s=hn(),l=s.queue;if(l===null)throw Error(r(311));l.lastRenderedReducer=i;var c=l.dispatch,p=l.pending,v=s.memoizedState;if(p!==null){l.pending=null;var S=p=p.next;do v=i(v,S.action),S=S.next;while(S!==p);Ir(v,s.memoizedState)||(In=!0),s.memoizedState=v,s.baseQueue===null&&(s.baseState=v),l.lastRenderedState=v}return[v,c]}function lv(i,s,l){var c=at,p=hn(),v=At;if(v){if(l===void 0)throw Error(r(407));l=l()}else l=s();var S=!Ir((Pt||p).memoizedState,l);S&&(p.memoizedState=l,In=!0),p=p.queue;var D=fv.bind(null,c,p,i);if(Fu(2048,8,D,[i]),p.getSnapshot!==s||S||fn!==null&&fn.memoizedState.tag&1){if(c.flags|=2048,sl(9,Lf(),cv.bind(null,c,p,l,s),null),Gt===null)throw Error(r(349));v||($a&124)!==0||uv(c,s,l)}return l}function uv(i,s,l){i.flags|=16384,i={getSnapshot:s,value:l},s=at.updateQueue,s===null?(s=Pd(),at.updateQueue=s,s.stores=[i]):(l=s.stores,l===null?s.stores=[i]:l.push(i))}function cv(i,s,l,c){s.value=l,s.getSnapshot=c,hv(s)&&dv(i)}function fv(i,s,l){return l(function(){hv(s)&&dv(i)})}function hv(i){var s=i.getSnapshot;i=i.value;try{var l=s();return!Ir(i,l)}catch{return!0}}function dv(i){var s=Qo(i,2);s!==null&&Pr(s,i,2)}function Bd(i){var s=yr();if(typeof i=="function"){var l=i;if(i=l(),ao){rn(!0);try{l()}finally{rn(!1)}}}return s.memoizedState=s.baseState=i,s.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:da,lastRenderedState:i},s}function mv(i,s,l,c){return i.baseState=l,Ld(i,Pt,typeof c=="function"?c:da)}function US(i,s,l,c,p){if(Bf(i))throw Error(r(485));if(i=s.action,i!==null){var v={payload:p,action:i,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){v.listeners.push(S)}};de.T!==null?l(!0):v.isTransition=!1,c(v),l=s.pending,l===null?(v.next=s.pending=v,pv(s,v)):(v.next=l.next,s.pending=l.next=v)}}function pv(i,s){var l=s.action,c=s.payload,p=i.state;if(s.isTransition){var v=de.T,S={};de.T=S;try{var D=l(p,c),Y=de.S;Y!==null&&Y(S,D),gv(i,s,D)}catch(se){Ud(i,s,se)}finally{de.T=v}}else try{v=l(p,c),gv(i,s,v)}catch(se){Ud(i,s,se)}}function gv(i,s,l){l!==null&&typeof l=="object"&&typeof l.then=="function"?l.then(function(c){vv(i,s,c)},function(c){return Ud(i,s,c)}):vv(i,s,l)}function vv(i,s,l){s.status="fulfilled",s.value=l,_v(s),i.state=l,s=i.pending,s!==null&&(l=s.next,l===s?i.pending=null:(l=l.next,s.next=l,pv(i,l)))}function Ud(i,s,l){var c=i.pending;if(i.pending=null,c!==null){c=c.next;do s.status="rejected",s.reason=l,_v(s),s=s.next;while(s!==c)}i.action=null}function _v(i){i=i.listeners;for(var s=0;s<i.length;s++)(0,i[s])()}function yv(i,s){return s}function xv(i,s){if(At){var l=Gt.formState;if(l!==null){e:{var c=at;if(At){if(Jt){t:{for(var p=Jt,v=Mi;p.nodeType!==8;){if(!v){p=null;break t}if(p=ci(p.nextSibling),p===null){p=null;break t}}v=p.data,p=v==="F!"||v==="F"?p:null}if(p){Jt=ci(p.nextSibling),c=p.data==="F!";break e}}to(c)}c=!1}c&&(s=l[0])}}return l=yr(),l.memoizedState=l.baseState=s,c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yv,lastRenderedState:s},l.queue=c,l=Bv.bind(null,at,c),c.dispatch=l,c=Bd(!1),v=qd.bind(null,at,!1,c.queue),c=yr(),p={state:s,dispatch:null,action:i,pending:null},c.queue=p,l=US.bind(null,at,p,v,l),p.dispatch=l,c.memoizedState=i,[s,l,!1]}function Ev(i){var s=hn();return Tv(s,Pt,i)}function Tv(i,s,l){if(s=Ld(i,s,yv)[0],i=kf(da)[0],typeof s=="object"&&s!==null&&typeof s.then=="function")try{var c=Ou(s)}catch(S){throw S===bu?Nf:S}else c=s;s=hn();var p=s.queue,v=p.dispatch;return l!==s.memoizedState&&(at.flags|=2048,sl(9,Lf(),jS.bind(null,p,l),null)),[c,v,i]}function jS(i,s){i.action=s}function wv(i){var s=hn(),l=Pt;if(l!==null)return Tv(s,l,i);hn(),s=s.memoizedState,l=hn();var c=l.queue.dispatch;return l.memoizedState=i,[s,c,!1]}function sl(i,s,l,c){return i={tag:i,create:l,deps:c,inst:s,next:null},s=at.updateQueue,s===null&&(s=Pd(),at.updateQueue=s),l=s.lastEffect,l===null?s.lastEffect=i.next=i:(c=l.next,l.next=i,i.next=c,s.lastEffect=i),i}function Lf(){return{destroy:void 0,resource:void 0}}function Av(){return hn().memoizedState}function Vf(i,s,l,c){var p=yr();c=c===void 0?null:c,at.flags|=i,p.memoizedState=sl(1|s,Lf(),l,c)}function Fu(i,s,l,c){var p=hn();c=c===void 0?null:c;var v=p.memoizedState.inst;Pt!==null&&c!==null&&Nd(c,Pt.memoizedState.deps)?p.memoizedState=sl(s,v,l,c):(at.flags|=i,p.memoizedState=sl(1|s,v,l,c))}function Sv(i,s){Vf(8390656,8,i,s)}function bv(i,s){Fu(2048,8,i,s)}function Rv(i,s){return Fu(4,2,i,s)}function Cv(i,s){return Fu(4,4,i,s)}function Iv(i,s){if(typeof s=="function"){i=i();var l=s(i);return function(){typeof l=="function"?l():s(null)}}if(s!=null)return i=i(),s.current=i,function(){s.current=null}}function Nv(i,s,l){l=l!=null?l.concat([i]):null,Fu(4,4,Iv.bind(null,s,i),l)}function jd(){}function Dv(i,s){var l=hn();s=s===void 0?null:s;var c=l.memoizedState;return s!==null&&Nd(s,c[1])?c[0]:(l.memoizedState=[i,s],i)}function Ov(i,s){var l=hn();s=s===void 0?null:s;var c=l.memoizedState;if(s!==null&&Nd(s,c[1]))return c[0];if(c=i(),ao){rn(!0);try{i()}finally{rn(!1)}}return l.memoizedState=[c,s],c}function zd(i,s,l){return l===void 0||($a&1073741824)!==0?i.memoizedState=s:(i.memoizedState=l,i=P_(),at.lanes|=i,Ja|=i,l)}function Fv(i,s,l,c){return Ir(l,s)?l:rl.current!==null?(i=zd(i,l,c),Ir(i,s)||(In=!0),i):($a&42)===0?(In=!0,i.memoizedState=l):(i=P_(),at.lanes|=i,Ja|=i,s)}function Mv(i,s,l,c,p){var v=Re.p;Re.p=v!==0&&8>v?v:8;var S=de.T,D={};de.T=D,qd(i,!1,s,l);try{var Y=p(),se=de.S;if(se!==null&&se(D,Y),Y!==null&&typeof Y=="object"&&typeof Y.then=="function"){var ye=LS(Y,c);Mu(i,s,ye,Mr(i))}else Mu(i,s,c,Mr(i))}catch(Te){Mu(i,s,{then:function(){},status:"rejected",reason:Te},Mr())}finally{Re.p=v,de.T=S}}function zS(){}function Hd(i,s,l,c){if(i.tag!==5)throw Error(r(476));var p=Pv(i).queue;Mv(i,p,s,ze,l===null?zS:function(){return kv(i),l(c)})}function Pv(i){var s=i.memoizedState;if(s!==null)return s;s={memoizedState:ze,baseState:ze,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:da,lastRenderedState:ze},next:null};var l={};return s.next={memoizedState:l,baseState:l,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:da,lastRenderedState:l},next:null},i.memoizedState=s,i=i.alternate,i!==null&&(i.memoizedState=s),s}function kv(i){var s=Pv(i).next.queue;Mu(i,s,{},Mr())}function Gd(){return Qn(Zu)}function Lv(){return hn().memoizedState}function Vv(){return hn().memoizedState}function HS(i){for(var s=i.return;s!==null;){switch(s.tag){case 24:case 3:var l=Mr();i=Ga(l);var c=qa(s,i,l);c!==null&&(Pr(c,s,l),Cu(c,s,l)),s={cache:xd()},i.payload=s;return}s=s.return}}function GS(i,s,l){var c=Mr();l={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null},Bf(i)?Uv(s,l):(l=cd(i,s,l,c),l!==null&&(Pr(l,i,c),jv(l,s,c)))}function Bv(i,s,l){var c=Mr();Mu(i,s,l,c)}function Mu(i,s,l,c){var p={lane:c,revertLane:0,action:l,hasEagerState:!1,eagerState:null,next:null};if(Bf(i))Uv(s,p);else{var v=i.alternate;if(i.lanes===0&&(v===null||v.lanes===0)&&(v=s.lastRenderedReducer,v!==null))try{var S=s.lastRenderedState,D=v(S,l);if(p.hasEagerState=!0,p.eagerState=D,Ir(D,S))return Tf(i,s,p,0),Gt===null&&Ef(),!1}catch{}finally{}if(l=cd(i,s,p,c),l!==null)return Pr(l,i,c),jv(l,s,c),!0}return!1}function qd(i,s,l,c){if(c={lane:2,revertLane:wm(),action:c,hasEagerState:!1,eagerState:null,next:null},Bf(i)){if(s)throw Error(r(479))}else s=cd(i,l,c,2),s!==null&&Pr(s,i,2)}function Bf(i){var s=i.alternate;return i===at||s!==null&&s===at}function Uv(i,s){il=Ff=!0;var l=i.pending;l===null?s.next=s:(s.next=l.next,l.next=s),i.pending=s}function jv(i,s,l){if((l&4194048)!==0){var c=s.lanes;c&=i.pendingLanes,l|=c,s.lanes=l,ks(i,l)}}var Uf={readContext:Qn,use:Pf,useCallback:sn,useContext:sn,useEffect:sn,useImperativeHandle:sn,useLayoutEffect:sn,useInsertionEffect:sn,useMemo:sn,useReducer:sn,useRef:sn,useState:sn,useDebugValue:sn,useDeferredValue:sn,useTransition:sn,useSyncExternalStore:sn,useId:sn,useHostTransitionStatus:sn,useFormState:sn,useActionState:sn,useOptimistic:sn,useMemoCache:sn,useCacheRefresh:sn},zv={readContext:Qn,use:Pf,useCallback:function(i,s){return yr().memoizedState=[i,s===void 0?null:s],i},useContext:Qn,useEffect:Sv,useImperativeHandle:function(i,s,l){l=l!=null?l.concat([i]):null,Vf(4194308,4,Iv.bind(null,s,i),l)},useLayoutEffect:function(i,s){return Vf(4194308,4,i,s)},useInsertionEffect:function(i,s){Vf(4,2,i,s)},useMemo:function(i,s){var l=yr();s=s===void 0?null:s;var c=i();if(ao){rn(!0);try{i()}finally{rn(!1)}}return l.memoizedState=[c,s],c},useReducer:function(i,s,l){var c=yr();if(l!==void 0){var p=l(s);if(ao){rn(!0);try{l(s)}finally{rn(!1)}}}else p=s;return c.memoizedState=c.baseState=p,i={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i,lastRenderedState:p},c.queue=i,i=i.dispatch=GS.bind(null,at,i),[c.memoizedState,i]},useRef:function(i){var s=yr();return i={current:i},s.memoizedState=i},useState:function(i){i=Bd(i);var s=i.queue,l=Bv.bind(null,at,s);return s.dispatch=l,[i.memoizedState,l]},useDebugValue:jd,useDeferredValue:function(i,s){var l=yr();return zd(l,i,s)},useTransition:function(){var i=Bd(!1);return i=Mv.bind(null,at,i.queue,!0,!1),yr().memoizedState=i,[!1,i]},useSyncExternalStore:function(i,s,l){var c=at,p=yr();if(At){if(l===void 0)throw Error(r(407));l=l()}else{if(l=s(),Gt===null)throw Error(r(349));(vt&124)!==0||uv(c,s,l)}p.memoizedState=l;var v={value:l,getSnapshot:s};return p.queue=v,Sv(fv.bind(null,c,v,i),[i]),c.flags|=2048,sl(9,Lf(),cv.bind(null,c,v,l,s),null),l},useId:function(){var i=yr(),s=Gt.identifierPrefix;if(At){var l=ca,c=ua;l=(c&~(1<<32-bn(c)-1)).toString(32)+l,s=""+s+"R"+l,l=Mf++,0<l&&(s+="H"+l.toString(32)),s+=""}else l=VS++,s=""+s+"r"+l.toString(32)+"";return i.memoizedState=s},useHostTransitionStatus:Gd,useFormState:xv,useActionState:xv,useOptimistic:function(i){var s=yr();s.memoizedState=s.baseState=i;var l={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return s.queue=l,s=qd.bind(null,at,!0,l),l.dispatch=s,[i,s]},useMemoCache:kd,useCacheRefresh:function(){return yr().memoizedState=HS.bind(null,at)}},Hv={readContext:Qn,use:Pf,useCallback:Dv,useContext:Qn,useEffect:bv,useImperativeHandle:Nv,useInsertionEffect:Rv,useLayoutEffect:Cv,useMemo:Ov,useReducer:kf,useRef:Av,useState:function(){return kf(da)},useDebugValue:jd,useDeferredValue:function(i,s){var l=hn();return Fv(l,Pt.memoizedState,i,s)},useTransition:function(){var i=kf(da)[0],s=hn().memoizedState;return[typeof i=="boolean"?i:Ou(i),s]},useSyncExternalStore:lv,useId:Lv,useHostTransitionStatus:Gd,useFormState:Ev,useActionState:Ev,useOptimistic:function(i,s){var l=hn();return mv(l,Pt,i,s)},useMemoCache:kd,useCacheRefresh:Vv},qS={readContext:Qn,use:Pf,useCallback:Dv,useContext:Qn,useEffect:bv,useImperativeHandle:Nv,useInsertionEffect:Rv,useLayoutEffect:Cv,useMemo:Ov,useReducer:Vd,useRef:Av,useState:function(){return Vd(da)},useDebugValue:jd,useDeferredValue:function(i,s){var l=hn();return Pt===null?zd(l,i,s):Fv(l,Pt.memoizedState,i,s)},useTransition:function(){var i=Vd(da)[0],s=hn().memoizedState;return[typeof i=="boolean"?i:Ou(i),s]},useSyncExternalStore:lv,useId:Lv,useHostTransitionStatus:Gd,useFormState:wv,useActionState:wv,useOptimistic:function(i,s){var l=hn();return Pt!==null?mv(l,Pt,i,s):(l.baseState=i,[i,l.queue.dispatch])},useMemoCache:kd,useCacheRefresh:Vv},ol=null,Pu=0;function jf(i){var s=Pu;return Pu+=1,ol===null&&(ol=[]),ev(ol,i,s)}function ku(i,s){s=s.props.ref,i.ref=s!==void 0?s:null}function zf(i,s){throw s.$$typeof===y?Error(r(525)):(i=Object.prototype.toString.call(s),Error(r(31,i==="[object Object]"?"object with keys {"+Object.keys(s).join(", ")+"}":i)))}function Gv(i){var s=i._init;return s(i._payload)}function qv(i){function s(te,J){if(i){var ie=te.deletions;ie===null?(te.deletions=[J],te.flags|=16):ie.push(J)}}function l(te,J){if(!i)return null;for(;J!==null;)s(te,J),J=J.sibling;return null}function c(te){for(var J=new Map;te!==null;)te.key!==null?J.set(te.key,te):J.set(te.index,te),te=te.sibling;return J}function p(te,J){return te=la(te,J),te.index=0,te.sibling=null,te}function v(te,J,ie){return te.index=ie,i?(ie=te.alternate,ie!==null?(ie=ie.index,ie<J?(te.flags|=67108866,J):ie):(te.flags|=67108866,J)):(te.flags|=1048576,J)}function S(te){return i&&te.alternate===null&&(te.flags|=67108866),te}function D(te,J,ie,Ee){return J===null||J.tag!==6?(J=hd(ie,te.mode,Ee),J.return=te,J):(J=p(J,ie),J.return=te,J)}function Y(te,J,ie,Ee){var Ge=ie.type;return Ge===w?ye(te,J,ie.props.children,Ee,ie.key):J!==null&&(J.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===I&&Gv(Ge)===J.type)?(J=p(J,ie.props),ku(J,ie),J.return=te,J):(J=Af(ie.type,ie.key,ie.props,null,te.mode,Ee),ku(J,ie),J.return=te,J)}function se(te,J,ie,Ee){return J===null||J.tag!==4||J.stateNode.containerInfo!==ie.containerInfo||J.stateNode.implementation!==ie.implementation?(J=dd(ie,te.mode,Ee),J.return=te,J):(J=p(J,ie.children||[]),J.return=te,J)}function ye(te,J,ie,Ee,Ge){return J===null||J.tag!==7?(J=Qs(ie,te.mode,Ee,Ge),J.return=te,J):(J=p(J,ie),J.return=te,J)}function Te(te,J,ie){if(typeof J=="string"&&J!==""||typeof J=="number"||typeof J=="bigint")return J=hd(""+J,te.mode,ie),J.return=te,J;if(typeof J=="object"&&J!==null){switch(J.$$typeof){case _:return ie=Af(J.type,J.key,J.props,null,te.mode,ie),ku(ie,J),ie.return=te,ie;case E:return J=dd(J,te.mode,ie),J.return=te,J;case I:var Ee=J._init;return J=Ee(J._payload),Te(te,J,ie)}if(He(J)||H(J))return J=Qs(J,te.mode,ie,null),J.return=te,J;if(typeof J.then=="function")return Te(te,jf(J),ie);if(J.$$typeof===X)return Te(te,Cf(te,J),ie);zf(te,J)}return null}function ue(te,J,ie,Ee){var Ge=J!==null?J.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Ge!==null?null:D(te,J,""+ie,Ee);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:return ie.key===Ge?Y(te,J,ie,Ee):null;case E:return ie.key===Ge?se(te,J,ie,Ee):null;case I:return Ge=ie._init,ie=Ge(ie._payload),ue(te,J,ie,Ee)}if(He(ie)||H(ie))return Ge!==null?null:ye(te,J,ie,Ee,null);if(typeof ie.then=="function")return ue(te,J,jf(ie),Ee);if(ie.$$typeof===X)return ue(te,J,Cf(te,ie),Ee);zf(te,ie)}return null}function fe(te,J,ie,Ee,Ge){if(typeof Ee=="string"&&Ee!==""||typeof Ee=="number"||typeof Ee=="bigint")return te=te.get(ie)||null,D(J,te,""+Ee,Ge);if(typeof Ee=="object"&&Ee!==null){switch(Ee.$$typeof){case _:return te=te.get(Ee.key===null?ie:Ee.key)||null,Y(J,te,Ee,Ge);case E:return te=te.get(Ee.key===null?ie:Ee.key)||null,se(J,te,Ee,Ge);case I:var lt=Ee._init;return Ee=lt(Ee._payload),fe(te,J,ie,Ee,Ge)}if(He(Ee)||H(Ee))return te=te.get(ie)||null,ye(J,te,Ee,Ge,null);if(typeof Ee.then=="function")return fe(te,J,ie,jf(Ee),Ge);if(Ee.$$typeof===X)return fe(te,J,ie,Cf(J,Ee),Ge);zf(J,Ee)}return null}function Ze(te,J,ie,Ee){for(var Ge=null,lt=null,qe=J,We=J=0,Dn=null;qe!==null&&We<ie.length;We++){qe.index>We?(Dn=qe,qe=null):Dn=qe.sibling;var Tt=ue(te,qe,ie[We],Ee);if(Tt===null){qe===null&&(qe=Dn);break}i&&qe&&Tt.alternate===null&&s(te,qe),J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt,qe=Dn}if(We===ie.length)return l(te,qe),At&&Js(te,We),Ge;if(qe===null){for(;We<ie.length;We++)qe=Te(te,ie[We],Ee),qe!==null&&(J=v(qe,J,We),lt===null?Ge=qe:lt.sibling=qe,lt=qe);return At&&Js(te,We),Ge}for(qe=c(qe);We<ie.length;We++)Dn=fe(qe,te,We,ie[We],Ee),Dn!==null&&(i&&Dn.alternate!==null&&qe.delete(Dn.key===null?We:Dn.key),J=v(Dn,J,We),lt===null?Ge=Dn:lt.sibling=Dn,lt=Dn);return i&&qe.forEach(function(ls){return s(te,ls)}),At&&Js(te,We),Ge}function Xe(te,J,ie,Ee){if(ie==null)throw Error(r(151));for(var Ge=null,lt=null,qe=J,We=J=0,Dn=null,Tt=ie.next();qe!==null&&!Tt.done;We++,Tt=ie.next()){qe.index>We?(Dn=qe,qe=null):Dn=qe.sibling;var ls=ue(te,qe,Tt.value,Ee);if(ls===null){qe===null&&(qe=Dn);break}i&&qe&&ls.alternate===null&&s(te,qe),J=v(ls,J,We),lt===null?Ge=ls:lt.sibling=ls,lt=ls,qe=Dn}if(Tt.done)return l(te,qe),At&&Js(te,We),Ge;if(qe===null){for(;!Tt.done;We++,Tt=ie.next())Tt=Te(te,Tt.value,Ee),Tt!==null&&(J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt);return At&&Js(te,We),Ge}for(qe=c(qe);!Tt.done;We++,Tt=ie.next())Tt=fe(qe,te,We,Tt.value,Ee),Tt!==null&&(i&&Tt.alternate!==null&&qe.delete(Tt.key===null?We:Tt.key),J=v(Tt,J,We),lt===null?Ge=Tt:lt.sibling=Tt,lt=Tt);return i&&qe.forEach(function($4){return s(te,$4)}),At&&Js(te,We),Ge}function Lt(te,J,ie,Ee){if(typeof ie=="object"&&ie!==null&&ie.type===w&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case _:e:{for(var Ge=ie.key;J!==null;){if(J.key===Ge){if(Ge=ie.type,Ge===w){if(J.tag===7){l(te,J.sibling),Ee=p(J,ie.props.children),Ee.return=te,te=Ee;break e}}else if(J.elementType===Ge||typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===I&&Gv(Ge)===J.type){l(te,J.sibling),Ee=p(J,ie.props),ku(Ee,ie),Ee.return=te,te=Ee;break e}l(te,J);break}else s(te,J);J=J.sibling}ie.type===w?(Ee=Qs(ie.props.children,te.mode,Ee,ie.key),Ee.return=te,te=Ee):(Ee=Af(ie.type,ie.key,ie.props,null,te.mode,Ee),ku(Ee,ie),Ee.return=te,te=Ee)}return S(te);case E:e:{for(Ge=ie.key;J!==null;){if(J.key===Ge)if(J.tag===4&&J.stateNode.containerInfo===ie.containerInfo&&J.stateNode.implementation===ie.implementation){l(te,J.sibling),Ee=p(J,ie.children||[]),Ee.return=te,te=Ee;break e}else{l(te,J);break}else s(te,J);J=J.sibling}Ee=dd(ie,te.mode,Ee),Ee.return=te,te=Ee}return S(te);case I:return Ge=ie._init,ie=Ge(ie._payload),Lt(te,J,ie,Ee)}if(He(ie))return Ze(te,J,ie,Ee);if(H(ie)){if(Ge=H(ie),typeof Ge!="function")throw Error(r(150));return ie=Ge.call(ie),Xe(te,J,ie,Ee)}if(typeof ie.then=="function")return Lt(te,J,jf(ie),Ee);if(ie.$$typeof===X)return Lt(te,J,Cf(te,ie),Ee);zf(te,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,J!==null&&J.tag===6?(l(te,J.sibling),Ee=p(J,ie),Ee.return=te,te=Ee):(l(te,J),Ee=hd(ie,te.mode,Ee),Ee.return=te,te=Ee),S(te)):l(te,J)}return function(te,J,ie,Ee){try{Pu=0;var Ge=Lt(te,J,ie,Ee);return ol=null,Ge}catch(qe){if(qe===bu||qe===Nf)throw qe;var lt=Nr(29,qe,null,te.mode);return lt.lanes=Ee,lt.return=te,lt}finally{}}}var ll=qv(!0),$v=qv(!1),Kr=xe(null),Pi=null;function Xa(i){var s=i.alternate;W(wn,wn.current&1),W(Kr,i),Pi===null&&(s===null||rl.current!==null||s.memoizedState!==null)&&(Pi=i)}function Xv(i){if(i.tag===22){if(W(wn,wn.current),W(Kr,i),Pi===null){var s=i.alternate;s!==null&&s.memoizedState!==null&&(Pi=i)}}else Ya()}function Ya(){W(wn,wn.current),W(Kr,Kr.current)}function ma(i){U(Kr),Pi===i&&(Pi=null),U(wn)}var wn=xe(0);function Hf(i){for(var s=i;s!==null;){if(s.tag===13){var l=s.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||Pm(l)))return s}else if(s.tag===19&&s.memoizedProps.revealOrder!==void 0){if((s.flags&128)!==0)return s}else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return null;s=s.return}s.sibling.return=s.return,s=s.sibling}return null}function $d(i,s,l,c){s=i.memoizedState,l=l(c,s),l=l==null?s:g({},s,l),i.memoizedState=l,i.lanes===0&&(i.updateQueue.baseState=l)}var Xd={enqueueSetState:function(i,s,l){i=i._reactInternals;var c=Mr(),p=Ga(c);p.payload=s,l!=null&&(p.callback=l),s=qa(i,p,c),s!==null&&(Pr(s,i,c),Cu(s,i,c))},enqueueReplaceState:function(i,s,l){i=i._reactInternals;var c=Mr(),p=Ga(c);p.tag=1,p.payload=s,l!=null&&(p.callback=l),s=qa(i,p,c),s!==null&&(Pr(s,i,c),Cu(s,i,c))},enqueueForceUpdate:function(i,s){i=i._reactInternals;var l=Mr(),c=Ga(l);c.tag=2,s!=null&&(c.callback=s),s=qa(i,c,l),s!==null&&(Pr(s,i,l),Cu(s,i,l))}};function Yv(i,s,l,c,p,v,S){return i=i.stateNode,typeof i.shouldComponentUpdate=="function"?i.shouldComponentUpdate(c,v,S):s.prototype&&s.prototype.isPureReactComponent?!_u(l,c)||!_u(p,v):!0}function Wv(i,s,l,c){i=s.state,typeof s.componentWillReceiveProps=="function"&&s.componentWillReceiveProps(l,c),typeof s.UNSAFE_componentWillReceiveProps=="function"&&s.UNSAFE_componentWillReceiveProps(l,c),s.state!==i&&Xd.enqueueReplaceState(s,s.state,null)}function so(i,s){var l=s;if("ref"in s){l={};for(var c in s)c!=="ref"&&(l[c]=s[c])}if(i=i.defaultProps){l===s&&(l=g({},l));for(var p in i)l[p]===void 0&&(l[p]=i[p])}return l}var Gf=typeof reportError=="function"?reportError:function(i){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var s=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof i=="object"&&i!==null&&typeof i.message=="string"?String(i.message):String(i),error:i});if(!window.dispatchEvent(s))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",i);return}console.error(i)};function Kv(i){Gf(i)}function Qv(i){console.error(i)}function Zv(i){Gf(i)}function qf(i,s){try{var l=i.onUncaughtError;l(s.value,{componentStack:s.stack})}catch(c){setTimeout(function(){throw c})}}function Jv(i,s,l){try{var c=i.onCaughtError;c(l.value,{componentStack:l.stack,errorBoundary:s.tag===1?s.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function Yd(i,s,l){return l=Ga(l),l.tag=3,l.payload={element:null},l.callback=function(){qf(i,s)},l}function e_(i){return i=Ga(i),i.tag=3,i}function t_(i,s,l,c){var p=l.type.getDerivedStateFromError;if(typeof p=="function"){var v=c.value;i.payload=function(){return p(v)},i.callback=function(){Jv(s,l,c)}}var S=l.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(i.callback=function(){Jv(s,l,c),typeof p!="function"&&(es===null?es=new Set([this]):es.add(this));var D=c.stack;this.componentDidCatch(c.value,{componentStack:D!==null?D:""})})}function $S(i,s,l,c,p){if(l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){if(s=l.alternate,s!==null&&wu(s,l,p,!0),l=Kr.current,l!==null){switch(l.tag){case 13:return Pi===null?_m():l.alternate===null&&en===0&&(en=3),l.flags&=-257,l.flags|=65536,l.lanes=p,c===wd?l.flags|=16384:(s=l.updateQueue,s===null?l.updateQueue=new Set([c]):s.add(c),xm(i,c,p)),!1;case 22:return l.flags|=65536,c===wd?l.flags|=16384:(s=l.updateQueue,s===null?(s={transitions:null,markerInstances:null,retryQueue:new Set([c])},l.updateQueue=s):(l=s.retryQueue,l===null?s.retryQueue=new Set([c]):l.add(c)),xm(i,c,p)),!1}throw Error(r(435,l.tag))}return xm(i,c,p),_m(),!1}if(At)return s=Kr.current,s!==null?((s.flags&65536)===0&&(s.flags|=256),s.flags|=65536,s.lanes=p,c!==gd&&(i=Error(r(422),{cause:c}),Tu($r(i,l)))):(c!==gd&&(s=Error(r(423),{cause:c}),Tu($r(s,l))),i=i.current.alternate,i.flags|=65536,p&=-p,i.lanes|=p,c=$r(c,l),p=Yd(i.stateNode,c,p),bd(i,p),en!==4&&(en=2)),!1;var v=Error(r(520),{cause:c});if(v=$r(v,l),Hu===null?Hu=[v]:Hu.push(v),en!==4&&(en=2),s===null)return!0;c=$r(c,l),l=s;do{switch(l.tag){case 3:return l.flags|=65536,i=p&-p,l.lanes|=i,i=Yd(l.stateNode,c,i),bd(l,i),!1;case 1:if(s=l.type,v=l.stateNode,(l.flags&128)===0&&(typeof s.getDerivedStateFromError=="function"||v!==null&&typeof v.componentDidCatch=="function"&&(es===null||!es.has(v))))return l.flags|=65536,p&=-p,l.lanes|=p,p=e_(p),t_(p,i,l,c),bd(l,p),!1}l=l.return}while(l!==null);return!1}var n_=Error(r(461)),In=!1;function Ln(i,s,l,c){s.child=i===null?$v(s,null,l,c):ll(s,i.child,l,c)}function r_(i,s,l,c,p){l=l.render;var v=s.ref;if("ref"in c){var S={};for(var D in c)D!=="ref"&&(S[D]=c[D])}else S=c;return ro(s),c=Dd(i,s,l,S,v,p),D=Od(),i!==null&&!In?(Fd(i,s,p),pa(i,s,p)):(At&&D&&md(s),s.flags|=1,Ln(i,s,c,p),s.child)}function i_(i,s,l,c,p){if(i===null){var v=l.type;return typeof v=="function"&&!fd(v)&&v.defaultProps===void 0&&l.compare===null?(s.tag=15,s.type=v,a_(i,s,v,c,p)):(i=Af(l.type,null,c,s,s.mode,p),i.ref=s.ref,i.return=s,s.child=i)}if(v=i.child,!nm(i,p)){var S=v.memoizedProps;if(l=l.compare,l=l!==null?l:_u,l(S,c)&&i.ref===s.ref)return pa(i,s,p)}return s.flags|=1,i=la(v,c),i.ref=s.ref,i.return=s,s.child=i}function a_(i,s,l,c,p){if(i!==null){var v=i.memoizedProps;if(_u(v,c)&&i.ref===s.ref)if(In=!1,s.pendingProps=c=v,nm(i,p))(i.flags&131072)!==0&&(In=!0);else return s.lanes=i.lanes,pa(i,s,p)}return Wd(i,s,l,c,p)}function s_(i,s,l){var c=s.pendingProps,p=c.children,v=i!==null?i.memoizedState:null;if(c.mode==="hidden"){if((s.flags&128)!==0){if(c=v!==null?v.baseLanes|l:l,i!==null){for(p=s.child=i.child,v=0;p!==null;)v=v|p.lanes|p.childLanes,p=p.sibling;s.childLanes=v&~c}else s.childLanes=0,s.child=null;return o_(i,s,c,l)}if((l&536870912)!==0)s.memoizedState={baseLanes:0,cachePool:null},i!==null&&If(s,v!==null?v.cachePool:null),v!==null?av(s,v):Cd(),Xv(s);else return s.lanes=s.childLanes=536870912,o_(i,s,v!==null?v.baseLanes|l:l,l)}else v!==null?(If(s,v.cachePool),av(s,v),Ya(),s.memoizedState=null):(i!==null&&If(s,null),Cd(),Ya());return Ln(i,s,p,l),s.child}function o_(i,s,l,c){var p=Td();return p=p===null?null:{parent:Tn._currentValue,pool:p},s.memoizedState={baseLanes:l,cachePool:p},i!==null&&If(s,null),Cd(),Xv(s),i!==null&&wu(i,s,c,!0),null}function $f(i,s){var l=s.ref;if(l===null)i!==null&&i.ref!==null&&(s.flags|=4194816);else{if(typeof l!="function"&&typeof l!="object")throw Error(r(284));(i===null||i.ref!==l)&&(s.flags|=4194816)}}function Wd(i,s,l,c,p){return ro(s),l=Dd(i,s,l,c,void 0,p),c=Od(),i!==null&&!In?(Fd(i,s,p),pa(i,s,p)):(At&&c&&md(s),s.flags|=1,Ln(i,s,l,p),s.child)}function l_(i,s,l,c,p,v){return ro(s),s.updateQueue=null,l=ov(s,c,l,p),sv(i),c=Od(),i!==null&&!In?(Fd(i,s,v),pa(i,s,v)):(At&&c&&md(s),s.flags|=1,Ln(i,s,l,v),s.child)}function u_(i,s,l,c,p){if(ro(s),s.stateNode===null){var v=Zo,S=l.contextType;typeof S=="object"&&S!==null&&(v=Qn(S)),v=new l(c,v),s.memoizedState=v.state!==null&&v.state!==void 0?v.state:null,v.updater=Xd,s.stateNode=v,v._reactInternals=s,v=s.stateNode,v.props=c,v.state=s.memoizedState,v.refs={},Ad(s),S=l.contextType,v.context=typeof S=="object"&&S!==null?Qn(S):Zo,v.state=s.memoizedState,S=l.getDerivedStateFromProps,typeof S=="function"&&($d(s,l,S,c),v.state=s.memoizedState),typeof l.getDerivedStateFromProps=="function"||typeof v.getSnapshotBeforeUpdate=="function"||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(S=v.state,typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount(),S!==v.state&&Xd.enqueueReplaceState(v,v.state,null),Nu(s,c,v,p),Iu(),v.state=s.memoizedState),typeof v.componentDidMount=="function"&&(s.flags|=4194308),c=!0}else if(i===null){v=s.stateNode;var D=s.memoizedProps,Y=so(l,D);v.props=Y;var se=v.context,ye=l.contextType;S=Zo,typeof ye=="object"&&ye!==null&&(S=Qn(ye));var Te=l.getDerivedStateFromProps;ye=typeof Te=="function"||typeof v.getSnapshotBeforeUpdate=="function",D=s.pendingProps!==D,ye||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(D||se!==S)&&Wv(s,v,c,S),Ha=!1;var ue=s.memoizedState;v.state=ue,Nu(s,c,v,p),Iu(),se=s.memoizedState,D||ue!==se||Ha?(typeof Te=="function"&&($d(s,l,Te,c),se=s.memoizedState),(Y=Ha||Yv(s,l,Y,c,ue,se,S))?(ye||typeof v.UNSAFE_componentWillMount!="function"&&typeof v.componentWillMount!="function"||(typeof v.componentWillMount=="function"&&v.componentWillMount(),typeof v.UNSAFE_componentWillMount=="function"&&v.UNSAFE_componentWillMount()),typeof v.componentDidMount=="function"&&(s.flags|=4194308)):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),s.memoizedProps=c,s.memoizedState=se),v.props=c,v.state=se,v.context=S,c=Y):(typeof v.componentDidMount=="function"&&(s.flags|=4194308),c=!1)}else{v=s.stateNode,Sd(i,s),S=s.memoizedProps,ye=so(l,S),v.props=ye,Te=s.pendingProps,ue=v.context,se=l.contextType,Y=Zo,typeof se=="object"&&se!==null&&(Y=Qn(se)),D=l.getDerivedStateFromProps,(se=typeof D=="function"||typeof v.getSnapshotBeforeUpdate=="function")||typeof v.UNSAFE_componentWillReceiveProps!="function"&&typeof v.componentWillReceiveProps!="function"||(S!==Te||ue!==Y)&&Wv(s,v,c,Y),Ha=!1,ue=s.memoizedState,v.state=ue,Nu(s,c,v,p),Iu();var fe=s.memoizedState;S!==Te||ue!==fe||Ha||i!==null&&i.dependencies!==null&&Rf(i.dependencies)?(typeof D=="function"&&($d(s,l,D,c),fe=s.memoizedState),(ye=Ha||Yv(s,l,ye,c,ue,fe,Y)||i!==null&&i.dependencies!==null&&Rf(i.dependencies))?(se||typeof v.UNSAFE_componentWillUpdate!="function"&&typeof v.componentWillUpdate!="function"||(typeof v.componentWillUpdate=="function"&&v.componentWillUpdate(c,fe,Y),typeof v.UNSAFE_componentWillUpdate=="function"&&v.UNSAFE_componentWillUpdate(c,fe,Y)),typeof v.componentDidUpdate=="function"&&(s.flags|=4),typeof v.getSnapshotBeforeUpdate=="function"&&(s.flags|=1024)):(typeof v.componentDidUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),s.memoizedProps=c,s.memoizedState=fe),v.props=c,v.state=fe,v.context=Y,c=ye):(typeof v.componentDidUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=4),typeof v.getSnapshotBeforeUpdate!="function"||S===i.memoizedProps&&ue===i.memoizedState||(s.flags|=1024),c=!1)}return v=c,$f(i,s),c=(s.flags&128)!==0,v||c?(v=s.stateNode,l=c&&typeof l.getDerivedStateFromError!="function"?null:v.render(),s.flags|=1,i!==null&&c?(s.child=ll(s,i.child,null,p),s.child=ll(s,null,l,p)):Ln(i,s,l,p),s.memoizedState=v.state,i=s.child):i=pa(i,s,p),i}function c_(i,s,l,c){return Eu(),s.flags|=256,Ln(i,s,l,c),s.child}var Kd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Qd(i){return{baseLanes:i,cachePool:Q1()}}function Zd(i,s,l){return i=i!==null?i.childLanes&~l:0,s&&(i|=Qr),i}function f_(i,s,l){var c=s.pendingProps,p=!1,v=(s.flags&128)!==0,S;if((S=v)||(S=i!==null&&i.memoizedState===null?!1:(wn.current&2)!==0),S&&(p=!0,s.flags&=-129),S=(s.flags&32)!==0,s.flags&=-33,i===null){if(At){if(p?Xa(s):Ya(),At){var D=Jt,Y;if(Y=D){e:{for(Y=D,D=Mi;Y.nodeType!==8;){if(!D){D=null;break e}if(Y=ci(Y.nextSibling),Y===null){D=null;break e}}D=Y}D!==null?(s.memoizedState={dehydrated:D,treeContext:Zs!==null?{id:ua,overflow:ca}:null,retryLane:536870912,hydrationErrors:null},Y=Nr(18,null,null,0),Y.stateNode=D,Y.return=s,s.child=Y,cr=s,Jt=null,Y=!0):Y=!1}Y||to(s)}if(D=s.memoizedState,D!==null&&(D=D.dehydrated,D!==null))return Pm(D)?s.lanes=32:s.lanes=536870912,null;ma(s)}return D=c.children,c=c.fallback,p?(Ya(),p=s.mode,D=Xf({mode:"hidden",children:D},p),c=Qs(c,p,l,null),D.return=s,c.return=s,D.sibling=c,s.child=D,p=s.child,p.memoizedState=Qd(l),p.childLanes=Zd(i,S,l),s.memoizedState=Kd,c):(Xa(s),Jd(s,D))}if(Y=i.memoizedState,Y!==null&&(D=Y.dehydrated,D!==null)){if(v)s.flags&256?(Xa(s),s.flags&=-257,s=em(i,s,l)):s.memoizedState!==null?(Ya(),s.child=i.child,s.flags|=128,s=null):(Ya(),p=c.fallback,D=s.mode,c=Xf({mode:"visible",children:c.children},D),p=Qs(p,D,l,null),p.flags|=2,c.return=s,p.return=s,c.sibling=p,s.child=c,ll(s,i.child,null,l),c=s.child,c.memoizedState=Qd(l),c.childLanes=Zd(i,S,l),s.memoizedState=Kd,s=p);else if(Xa(s),Pm(D)){if(S=D.nextSibling&&D.nextSibling.dataset,S)var se=S.dgst;S=se,c=Error(r(419)),c.stack="",c.digest=S,Tu({value:c,source:null,stack:null}),s=em(i,s,l)}else if(In||wu(i,s,l,!1),S=(l&i.childLanes)!==0,In||S){if(S=Gt,S!==null&&(c=l&-l,c=(c&42)!==0?1:wi(c),c=(c&(S.suspendedLanes|l))!==0?0:c,c!==0&&c!==Y.retryLane))throw Y.retryLane=c,Qo(i,c),Pr(S,i,c),n_;D.data==="$?"||_m(),s=em(i,s,l)}else D.data==="$?"?(s.flags|=192,s.child=i.child,s=null):(i=Y.treeContext,Jt=ci(D.nextSibling),cr=s,At=!0,eo=null,Mi=!1,i!==null&&(Yr[Wr++]=ua,Yr[Wr++]=ca,Yr[Wr++]=Zs,ua=i.id,ca=i.overflow,Zs=s),s=Jd(s,c.children),s.flags|=4096);return s}return p?(Ya(),p=c.fallback,D=s.mode,Y=i.child,se=Y.sibling,c=la(Y,{mode:"hidden",children:c.children}),c.subtreeFlags=Y.subtreeFlags&65011712,se!==null?p=la(se,p):(p=Qs(p,D,l,null),p.flags|=2),p.return=s,c.return=s,c.sibling=p,s.child=c,c=p,p=s.child,D=i.child.memoizedState,D===null?D=Qd(l):(Y=D.cachePool,Y!==null?(se=Tn._currentValue,Y=Y.parent!==se?{parent:se,pool:se}:Y):Y=Q1(),D={baseLanes:D.baseLanes|l,cachePool:Y}),p.memoizedState=D,p.childLanes=Zd(i,S,l),s.memoizedState=Kd,c):(Xa(s),l=i.child,i=l.sibling,l=la(l,{mode:"visible",children:c.children}),l.return=s,l.sibling=null,i!==null&&(S=s.deletions,S===null?(s.deletions=[i],s.flags|=16):S.push(i)),s.child=l,s.memoizedState=null,l)}function Jd(i,s){return s=Xf({mode:"visible",children:s},i.mode),s.return=i,i.child=s}function Xf(i,s){return i=Nr(22,i,null,s),i.lanes=0,i.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},i}function em(i,s,l){return ll(s,i.child,null,l),i=Jd(s,s.pendingProps.children),i.flags|=2,s.memoizedState=null,i}function h_(i,s,l){i.lanes|=s;var c=i.alternate;c!==null&&(c.lanes|=s),_d(i.return,s,l)}function tm(i,s,l,c,p){var v=i.memoizedState;v===null?i.memoizedState={isBackwards:s,rendering:null,renderingStartTime:0,last:c,tail:l,tailMode:p}:(v.isBackwards=s,v.rendering=null,v.renderingStartTime=0,v.last=c,v.tail=l,v.tailMode=p)}function d_(i,s,l){var c=s.pendingProps,p=c.revealOrder,v=c.tail;if(Ln(i,s,c.children,l),c=wn.current,(c&2)!==0)c=c&1|2,s.flags|=128;else{if(i!==null&&(i.flags&128)!==0)e:for(i=s.child;i!==null;){if(i.tag===13)i.memoizedState!==null&&h_(i,l,s);else if(i.tag===19)h_(i,l,s);else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===s)break e;for(;i.sibling===null;){if(i.return===null||i.return===s)break e;i=i.return}i.sibling.return=i.return,i=i.sibling}c&=1}switch(W(wn,c),p){case"forwards":for(l=s.child,p=null;l!==null;)i=l.alternate,i!==null&&Hf(i)===null&&(p=l),l=l.sibling;l=p,l===null?(p=s.child,s.child=null):(p=l.sibling,l.sibling=null),tm(s,!1,p,l,v);break;case"backwards":for(l=null,p=s.child,s.child=null;p!==null;){if(i=p.alternate,i!==null&&Hf(i)===null){s.child=p;break}i=p.sibling,p.sibling=l,l=p,p=i}tm(s,!0,l,null,v);break;case"together":tm(s,!1,null,null,void 0);break;default:s.memoizedState=null}return s.child}function pa(i,s,l){if(i!==null&&(s.dependencies=i.dependencies),Ja|=s.lanes,(l&s.childLanes)===0)if(i!==null){if(wu(i,s,l,!1),(l&s.childLanes)===0)return null}else return null;if(i!==null&&s.child!==i.child)throw Error(r(153));if(s.child!==null){for(i=s.child,l=la(i,i.pendingProps),s.child=l,l.return=s;i.sibling!==null;)i=i.sibling,l=l.sibling=la(i,i.pendingProps),l.return=s;l.sibling=null}return s.child}function nm(i,s){return(i.lanes&s)!==0?!0:(i=i.dependencies,!!(i!==null&&Rf(i)))}function XS(i,s,l){switch(s.tag){case 3:Fe(s,s.stateNode.containerInfo),za(s,Tn,i.memoizedState.cache),Eu();break;case 27:case 5:Me(s);break;case 4:Fe(s,s.stateNode.containerInfo);break;case 10:za(s,s.type,s.memoizedProps.value);break;case 13:var c=s.memoizedState;if(c!==null)return c.dehydrated!==null?(Xa(s),s.flags|=128,null):(l&s.child.childLanes)!==0?f_(i,s,l):(Xa(s),i=pa(i,s,l),i!==null?i.sibling:null);Xa(s);break;case 19:var p=(i.flags&128)!==0;if(c=(l&s.childLanes)!==0,c||(wu(i,s,l,!1),c=(l&s.childLanes)!==0),p){if(c)return d_(i,s,l);s.flags|=128}if(p=s.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),W(wn,wn.current),c)break;return null;case 22:case 23:return s.lanes=0,s_(i,s,l);case 24:za(s,Tn,i.memoizedState.cache)}return pa(i,s,l)}function m_(i,s,l){if(i!==null)if(i.memoizedProps!==s.pendingProps)In=!0;else{if(!nm(i,l)&&(s.flags&128)===0)return In=!1,XS(i,s,l);In=(i.flags&131072)!==0}else In=!1,At&&(s.flags&1048576)!==0&&G1(s,bf,s.index);switch(s.lanes=0,s.tag){case 16:e:{i=s.pendingProps;var c=s.elementType,p=c._init;if(c=p(c._payload),s.type=c,typeof c=="function")fd(c)?(i=so(c,i),s.tag=1,s=u_(null,s,c,i,l)):(s.tag=0,s=Wd(null,s,c,i,l));else{if(c!=null){if(p=c.$$typeof,p===ee){s.tag=11,s=r_(null,s,c,i,l);break e}else if(p===N){s.tag=14,s=i_(null,s,c,i,l);break e}}throw s=Je(c)||c,Error(r(306,s,""))}}return s;case 0:return Wd(i,s,s.type,s.pendingProps,l);case 1:return c=s.type,p=so(c,s.pendingProps),u_(i,s,c,p,l);case 3:e:{if(Fe(s,s.stateNode.containerInfo),i===null)throw Error(r(387));c=s.pendingProps;var v=s.memoizedState;p=v.element,Sd(i,s),Nu(s,c,null,l);var S=s.memoizedState;if(c=S.cache,za(s,Tn,c),c!==v.cache&&yd(s,[Tn],l,!0),Iu(),c=S.element,v.isDehydrated)if(v={element:c,isDehydrated:!1,cache:S.cache},s.updateQueue.baseState=v,s.memoizedState=v,s.flags&256){s=c_(i,s,c,l);break e}else if(c!==p){p=$r(Error(r(424)),s),Tu(p),s=c_(i,s,c,l);break e}else{switch(i=s.stateNode.containerInfo,i.nodeType){case 9:i=i.body;break;default:i=i.nodeName==="HTML"?i.ownerDocument.body:i}for(Jt=ci(i.firstChild),cr=s,At=!0,eo=null,Mi=!0,l=$v(s,null,c,l),s.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling}else{if(Eu(),c===p){s=pa(i,s,l);break e}Ln(i,s,c,l)}s=s.child}return s;case 26:return $f(i,s),i===null?(l=_y(s.type,null,s.pendingProps,null))?s.memoizedState=l:At||(l=s.type,i=s.pendingProps,c=oh(ce.current).createElement(l),c[an]=s,c[Xt]=i,Bn(c,l,i),ne(c),s.stateNode=c):s.memoizedState=_y(s.type,i.memoizedProps,s.pendingProps,i.memoizedState),null;case 27:return Me(s),i===null&&At&&(c=s.stateNode=py(s.type,s.pendingProps,ce.current),cr=s,Mi=!0,p=Jt,rs(s.type)?(km=p,Jt=ci(c.firstChild)):Jt=p),Ln(i,s,s.pendingProps.children,l),$f(i,s),i===null&&(s.flags|=4194304),s.child;case 5:return i===null&&At&&((p=c=Jt)&&(c=E4(c,s.type,s.pendingProps,Mi),c!==null?(s.stateNode=c,cr=s,Jt=ci(c.firstChild),Mi=!1,p=!0):p=!1),p||to(s)),Me(s),p=s.type,v=s.pendingProps,S=i!==null?i.memoizedProps:null,c=v.children,Om(p,v)?c=null:S!==null&&Om(p,S)&&(s.flags|=32),s.memoizedState!==null&&(p=Dd(i,s,BS,null,null,l),Zu._currentValue=p),$f(i,s),Ln(i,s,c,l),s.child;case 6:return i===null&&At&&((i=l=Jt)&&(l=T4(l,s.pendingProps,Mi),l!==null?(s.stateNode=l,cr=s,Jt=null,i=!0):i=!1),i||to(s)),null;case 13:return f_(i,s,l);case 4:return Fe(s,s.stateNode.containerInfo),c=s.pendingProps,i===null?s.child=ll(s,null,c,l):Ln(i,s,c,l),s.child;case 11:return r_(i,s,s.type,s.pendingProps,l);case 7:return Ln(i,s,s.pendingProps,l),s.child;case 8:return Ln(i,s,s.pendingProps.children,l),s.child;case 12:return Ln(i,s,s.pendingProps.children,l),s.child;case 10:return c=s.pendingProps,za(s,s.type,c.value),Ln(i,s,c.children,l),s.child;case 9:return p=s.type._context,c=s.pendingProps.children,ro(s),p=Qn(p),c=c(p),s.flags|=1,Ln(i,s,c,l),s.child;case 14:return i_(i,s,s.type,s.pendingProps,l);case 15:return a_(i,s,s.type,s.pendingProps,l);case 19:return d_(i,s,l);case 31:return c=s.pendingProps,l=s.mode,c={mode:c.mode,children:c.children},i===null?(l=Xf(c,l),l.ref=s.ref,s.child=l,l.return=s,s=l):(l=la(i.child,c),l.ref=s.ref,s.child=l,l.return=s,s=l),s;case 22:return s_(i,s,l);case 24:return ro(s),c=Qn(Tn),i===null?(p=Td(),p===null&&(p=Gt,v=xd(),p.pooledCache=v,v.refCount++,v!==null&&(p.pooledCacheLanes|=l),p=v),s.memoizedState={parent:c,cache:p},Ad(s),za(s,Tn,p)):((i.lanes&l)!==0&&(Sd(i,s),Nu(s,null,null,l),Iu()),p=i.memoizedState,v=s.memoizedState,p.parent!==c?(p={parent:c,cache:c},s.memoizedState=p,s.lanes===0&&(s.memoizedState=s.updateQueue.baseState=p),za(s,Tn,c)):(c=v.cache,za(s,Tn,c),c!==p.cache&&yd(s,[Tn],l,!0))),Ln(i,s,s.pendingProps.children,l),s.child;case 29:throw s.pendingProps}throw Error(r(156,s.tag))}function ga(i){i.flags|=4}function p_(i,s){if(s.type!=="stylesheet"||(s.state.loading&4)!==0)i.flags&=-16777217;else if(i.flags|=16777216,!wy(s)){if(s=Kr.current,s!==null&&((vt&4194048)===vt?Pi!==null:(vt&62914560)!==vt&&(vt&536870912)===0||s!==Pi))throw Ru=wd,Z1;i.flags|=8192}}function Yf(i,s){s!==null&&(i.flags|=4),i.flags&16384&&(s=i.tag!==22?Va():536870912,i.lanes|=s,hl|=s)}function Lu(i,s){if(!At)switch(i.tailMode){case"hidden":s=i.tail;for(var l=null;s!==null;)s.alternate!==null&&(l=s),s=s.sibling;l===null?i.tail=null:l.sibling=null;break;case"collapsed":l=i.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s||i.tail===null?i.tail=null:i.tail.sibling=null:c.sibling=null}}function Kt(i){var s=i.alternate!==null&&i.alternate.child===i.child,l=0,c=0;if(s)for(var p=i.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags&65011712,c|=p.flags&65011712,p.return=i,p=p.sibling;else for(p=i.child;p!==null;)l|=p.lanes|p.childLanes,c|=p.subtreeFlags,c|=p.flags,p.return=i,p=p.sibling;return i.subtreeFlags|=c,i.childLanes=l,s}function YS(i,s,l){var c=s.pendingProps;switch(pd(s),s.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Kt(s),null;case 1:return Kt(s),null;case 3:return l=s.stateNode,c=null,i!==null&&(c=i.memoizedState.cache),s.memoizedState.cache!==c&&(s.flags|=2048),ha(Tn),Be(),l.pendingContext&&(l.context=l.pendingContext,l.pendingContext=null),(i===null||i.child===null)&&(xu(s)?ga(s):i===null||i.memoizedState.isDehydrated&&(s.flags&256)===0||(s.flags|=1024,X1())),Kt(s),null;case 26:return l=s.memoizedState,i===null?(ga(s),l!==null?(Kt(s),p_(s,l)):(Kt(s),s.flags&=-16777217)):l?l!==i.memoizedState?(ga(s),Kt(s),p_(s,l)):(Kt(s),s.flags&=-16777217):(i.memoizedProps!==c&&ga(s),Kt(s),s.flags&=-16777217),null;case 27:ut(s),l=ce.current;var p=s.type;if(i!==null&&s.stateNode!=null)i.memoizedProps!==c&&ga(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Kt(s),null}i=K.current,xu(s)?q1(s):(i=py(p,c,l),s.stateNode=i,ga(s))}return Kt(s),null;case 5:if(ut(s),l=s.type,i!==null&&s.stateNode!=null)i.memoizedProps!==c&&ga(s);else{if(!c){if(s.stateNode===null)throw Error(r(166));return Kt(s),null}if(i=K.current,xu(s))q1(s);else{switch(p=oh(ce.current),i){case 1:i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case 2:i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;default:switch(l){case"svg":i=p.createElementNS("http://www.w3.org/2000/svg",l);break;case"math":i=p.createElementNS("http://www.w3.org/1998/Math/MathML",l);break;case"script":i=p.createElement("div"),i.innerHTML="<script><\/script>",i=i.removeChild(i.firstChild);break;case"select":i=typeof c.is=="string"?p.createElement("select",{is:c.is}):p.createElement("select"),c.multiple?i.multiple=!0:c.size&&(i.size=c.size);break;default:i=typeof c.is=="string"?p.createElement(l,{is:c.is}):p.createElement(l)}}i[an]=s,i[Xt]=c;e:for(p=s.child;p!==null;){if(p.tag===5||p.tag===6)i.appendChild(p.stateNode);else if(p.tag!==4&&p.tag!==27&&p.child!==null){p.child.return=p,p=p.child;continue}if(p===s)break e;for(;p.sibling===null;){if(p.return===null||p.return===s)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}s.stateNode=i;e:switch(Bn(i,l,c),l){case"button":case"input":case"select":case"textarea":i=!!c.autoFocus;break e;case"img":i=!0;break e;default:i=!1}i&&ga(s)}}return Kt(s),s.flags&=-16777217,null;case 6:if(i&&s.stateNode!=null)i.memoizedProps!==c&&ga(s);else{if(typeof c!="string"&&s.stateNode===null)throw Error(r(166));if(i=ce.current,xu(s)){if(i=s.stateNode,l=s.memoizedProps,c=null,p=cr,p!==null)switch(p.tag){case 27:case 5:c=p.memoizedProps}i[an]=s,i=!!(i.nodeValue===l||c!==null&&c.suppressHydrationWarning===!0||ly(i.nodeValue,l)),i||to(s)}else i=oh(i).createTextNode(c),i[an]=s,s.stateNode=i}return Kt(s),null;case 13:if(c=s.memoizedState,i===null||i.memoizedState!==null&&i.memoizedState.dehydrated!==null){if(p=xu(s),c!==null&&c.dehydrated!==null){if(i===null){if(!p)throw Error(r(318));if(p=s.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));p[an]=s}else Eu(),(s.flags&128)===0&&(s.memoizedState=null),s.flags|=4;Kt(s),p=!1}else p=X1(),i!==null&&i.memoizedState!==null&&(i.memoizedState.hydrationErrors=p),p=!0;if(!p)return s.flags&256?(ma(s),s):(ma(s),null)}if(ma(s),(s.flags&128)!==0)return s.lanes=l,s;if(l=c!==null,i=i!==null&&i.memoizedState!==null,l){c=s.child,p=null,c.alternate!==null&&c.alternate.memoizedState!==null&&c.alternate.memoizedState.cachePool!==null&&(p=c.alternate.memoizedState.cachePool.pool);var v=null;c.memoizedState!==null&&c.memoizedState.cachePool!==null&&(v=c.memoizedState.cachePool.pool),v!==p&&(c.flags|=2048)}return l!==i&&l&&(s.child.flags|=8192),Yf(s,s.updateQueue),Kt(s),null;case 4:return Be(),i===null&&Rm(s.stateNode.containerInfo),Kt(s),null;case 10:return ha(s.type),Kt(s),null;case 19:if(U(wn),p=s.memoizedState,p===null)return Kt(s),null;if(c=(s.flags&128)!==0,v=p.rendering,v===null)if(c)Lu(p,!1);else{if(en!==0||i!==null&&(i.flags&128)!==0)for(i=s.child;i!==null;){if(v=Hf(i),v!==null){for(s.flags|=128,Lu(p,!1),i=v.updateQueue,s.updateQueue=i,Yf(s,i),s.subtreeFlags=0,i=l,l=s.child;l!==null;)H1(l,i),l=l.sibling;return W(wn,wn.current&1|2),s.child}i=i.sibling}p.tail!==null&&Ve()>Qf&&(s.flags|=128,c=!0,Lu(p,!1),s.lanes=4194304)}else{if(!c)if(i=Hf(v),i!==null){if(s.flags|=128,c=!0,i=i.updateQueue,s.updateQueue=i,Yf(s,i),Lu(p,!0),p.tail===null&&p.tailMode==="hidden"&&!v.alternate&&!At)return Kt(s),null}else 2*Ve()-p.renderingStartTime>Qf&&l!==536870912&&(s.flags|=128,c=!0,Lu(p,!1),s.lanes=4194304);p.isBackwards?(v.sibling=s.child,s.child=v):(i=p.last,i!==null?i.sibling=v:s.child=v,p.last=v)}return p.tail!==null?(s=p.tail,p.rendering=s,p.tail=s.sibling,p.renderingStartTime=Ve(),s.sibling=null,i=wn.current,W(wn,c?i&1|2:i&1),s):(Kt(s),null);case 22:case 23:return ma(s),Id(),c=s.memoizedState!==null,i!==null?i.memoizedState!==null!==c&&(s.flags|=8192):c&&(s.flags|=8192),c?(l&536870912)!==0&&(s.flags&128)===0&&(Kt(s),s.subtreeFlags&6&&(s.flags|=8192)):Kt(s),l=s.updateQueue,l!==null&&Yf(s,l.retryQueue),l=null,i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),c=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),c!==l&&(s.flags|=2048),i!==null&&U(io),null;case 24:return l=null,i!==null&&(l=i.memoizedState.cache),s.memoizedState.cache!==l&&(s.flags|=2048),ha(Tn),Kt(s),null;case 25:return null;case 30:return null}throw Error(r(156,s.tag))}function WS(i,s){switch(pd(s),s.tag){case 1:return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 3:return ha(Tn),Be(),i=s.flags,(i&65536)!==0&&(i&128)===0?(s.flags=i&-65537|128,s):null;case 26:case 27:case 5:return ut(s),null;case 13:if(ma(s),i=s.memoizedState,i!==null&&i.dehydrated!==null){if(s.alternate===null)throw Error(r(340));Eu()}return i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 19:return U(wn),null;case 4:return Be(),null;case 10:return ha(s.type),null;case 22:case 23:return ma(s),Id(),i!==null&&U(io),i=s.flags,i&65536?(s.flags=i&-65537|128,s):null;case 24:return ha(Tn),null;case 25:return null;default:return null}}function g_(i,s){switch(pd(s),s.tag){case 3:ha(Tn),Be();break;case 26:case 27:case 5:ut(s);break;case 4:Be();break;case 13:ma(s);break;case 19:U(wn);break;case 10:ha(s.type);break;case 22:case 23:ma(s),Id(),i!==null&&U(io);break;case 24:ha(Tn)}}function Vu(i,s){try{var l=s.updateQueue,c=l!==null?l.lastEffect:null;if(c!==null){var p=c.next;l=p;do{if((l.tag&i)===i){c=void 0;var v=l.create,S=l.inst;c=v(),S.destroy=c}l=l.next}while(l!==p)}}catch(D){Ut(s,s.return,D)}}function Wa(i,s,l){try{var c=s.updateQueue,p=c!==null?c.lastEffect:null;if(p!==null){var v=p.next;c=v;do{if((c.tag&i)===i){var S=c.inst,D=S.destroy;if(D!==void 0){S.destroy=void 0,p=s;var Y=l,se=D;try{se()}catch(ye){Ut(p,Y,ye)}}}c=c.next}while(c!==v)}}catch(ye){Ut(s,s.return,ye)}}function v_(i){var s=i.updateQueue;if(s!==null){var l=i.stateNode;try{iv(s,l)}catch(c){Ut(i,i.return,c)}}}function __(i,s,l){l.props=so(i.type,i.memoizedProps),l.state=i.memoizedState;try{l.componentWillUnmount()}catch(c){Ut(i,s,c)}}function Bu(i,s){try{var l=i.ref;if(l!==null){switch(i.tag){case 26:case 27:case 5:var c=i.stateNode;break;case 30:c=i.stateNode;break;default:c=i.stateNode}typeof l=="function"?i.refCleanup=l(c):l.current=c}}catch(p){Ut(i,s,p)}}function ki(i,s){var l=i.ref,c=i.refCleanup;if(l!==null)if(typeof c=="function")try{c()}catch(p){Ut(i,s,p)}finally{i.refCleanup=null,i=i.alternate,i!=null&&(i.refCleanup=null)}else if(typeof l=="function")try{l(null)}catch(p){Ut(i,s,p)}else l.current=null}function y_(i){var s=i.type,l=i.memoizedProps,c=i.stateNode;try{e:switch(s){case"button":case"input":case"select":case"textarea":l.autoFocus&&c.focus();break e;case"img":l.src?c.src=l.src:l.srcSet&&(c.srcset=l.srcSet)}}catch(p){Ut(i,i.return,p)}}function rm(i,s,l){try{var c=i.stateNode;g4(c,i.type,l,s),c[Xt]=s}catch(p){Ut(i,i.return,p)}}function x_(i){return i.tag===5||i.tag===3||i.tag===26||i.tag===27&&rs(i.type)||i.tag===4}function im(i){e:for(;;){for(;i.sibling===null;){if(i.return===null||x_(i.return))return null;i=i.return}for(i.sibling.return=i.return,i=i.sibling;i.tag!==5&&i.tag!==6&&i.tag!==18;){if(i.tag===27&&rs(i.type)||i.flags&2||i.child===null||i.tag===4)continue e;i.child.return=i,i=i.child}if(!(i.flags&2))return i.stateNode}}function am(i,s,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?(l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l).insertBefore(i,s):(s=l.nodeType===9?l.body:l.nodeName==="HTML"?l.ownerDocument.body:l,s.appendChild(i),l=l._reactRootContainer,l!=null||s.onclick!==null||(s.onclick=sh));else if(c!==4&&(c===27&&rs(i.type)&&(l=i.stateNode,s=null),i=i.child,i!==null))for(am(i,s,l),i=i.sibling;i!==null;)am(i,s,l),i=i.sibling}function Wf(i,s,l){var c=i.tag;if(c===5||c===6)i=i.stateNode,s?l.insertBefore(i,s):l.appendChild(i);else if(c!==4&&(c===27&&rs(i.type)&&(l=i.stateNode),i=i.child,i!==null))for(Wf(i,s,l),i=i.sibling;i!==null;)Wf(i,s,l),i=i.sibling}function E_(i){var s=i.stateNode,l=i.memoizedProps;try{for(var c=i.type,p=s.attributes;p.length;)s.removeAttributeNode(p[0]);Bn(s,c,l),s[an]=i,s[Xt]=l}catch(v){Ut(i,i.return,v)}}var va=!1,on=!1,sm=!1,T_=typeof WeakSet=="function"?WeakSet:Set,Nn=null;function KS(i,s){if(i=i.containerInfo,Nm=dh,i=F1(i),id(i)){if("selectionStart"in i)var l={start:i.selectionStart,end:i.selectionEnd};else e:{l=(l=i.ownerDocument)&&l.defaultView||window;var c=l.getSelection&&l.getSelection();if(c&&c.rangeCount!==0){l=c.anchorNode;var p=c.anchorOffset,v=c.focusNode;c=c.focusOffset;try{l.nodeType,v.nodeType}catch{l=null;break e}var S=0,D=-1,Y=-1,se=0,ye=0,Te=i,ue=null;t:for(;;){for(var fe;Te!==l||p!==0&&Te.nodeType!==3||(D=S+p),Te!==v||c!==0&&Te.nodeType!==3||(Y=S+c),Te.nodeType===3&&(S+=Te.nodeValue.length),(fe=Te.firstChild)!==null;)ue=Te,Te=fe;for(;;){if(Te===i)break t;if(ue===l&&++se===p&&(D=S),ue===v&&++ye===c&&(Y=S),(fe=Te.nextSibling)!==null)break;Te=ue,ue=Te.parentNode}Te=fe}l=D===-1||Y===-1?null:{start:D,end:Y}}else l=null}l=l||{start:0,end:0}}else l=null;for(Dm={focusedElem:i,selectionRange:l},dh=!1,Nn=s;Nn!==null;)if(s=Nn,i=s.child,(s.subtreeFlags&1024)!==0&&i!==null)i.return=s,Nn=i;else for(;Nn!==null;){switch(s=Nn,v=s.alternate,i=s.flags,s.tag){case 0:break;case 11:case 15:break;case 1:if((i&1024)!==0&&v!==null){i=void 0,l=s,p=v.memoizedProps,v=v.memoizedState,c=l.stateNode;try{var Ze=so(l.type,p,l.elementType===l.type);i=c.getSnapshotBeforeUpdate(Ze,v),c.__reactInternalSnapshotBeforeUpdate=i}catch(Xe){Ut(l,l.return,Xe)}}break;case 3:if((i&1024)!==0){if(i=s.stateNode.containerInfo,l=i.nodeType,l===9)Mm(i);else if(l===1)switch(i.nodeName){case"HEAD":case"HTML":case"BODY":Mm(i);break;default:i.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((i&1024)!==0)throw Error(r(163))}if(i=s.sibling,i!==null){i.return=s.return,Nn=i;break}Nn=s.return}}function w_(i,s,l){var c=l.flags;switch(l.tag){case 0:case 11:case 15:Ka(i,l),c&4&&Vu(5,l);break;case 1:if(Ka(i,l),c&4)if(i=l.stateNode,s===null)try{i.componentDidMount()}catch(S){Ut(l,l.return,S)}else{var p=so(l.type,s.memoizedProps);s=s.memoizedState;try{i.componentDidUpdate(p,s,i.__reactInternalSnapshotBeforeUpdate)}catch(S){Ut(l,l.return,S)}}c&64&&v_(l),c&512&&Bu(l,l.return);break;case 3:if(Ka(i,l),c&64&&(i=l.updateQueue,i!==null)){if(s=null,l.child!==null)switch(l.child.tag){case 27:case 5:s=l.child.stateNode;break;case 1:s=l.child.stateNode}try{iv(i,s)}catch(S){Ut(l,l.return,S)}}break;case 27:s===null&&c&4&&E_(l);case 26:case 5:Ka(i,l),s===null&&c&4&&y_(l),c&512&&Bu(l,l.return);break;case 12:Ka(i,l);break;case 13:Ka(i,l),c&4&&b_(i,l),c&64&&(i=l.memoizedState,i!==null&&(i=i.dehydrated,i!==null&&(l=a4.bind(null,l),w4(i,l))));break;case 22:if(c=l.memoizedState!==null||va,!c){s=s!==null&&s.memoizedState!==null||on,p=va;var v=on;va=c,(on=s)&&!v?Qa(i,l,(l.subtreeFlags&8772)!==0):Ka(i,l),va=p,on=v}break;case 30:break;default:Ka(i,l)}}function A_(i){var s=i.alternate;s!==null&&(i.alternate=null,A_(s)),i.child=null,i.deletions=null,i.sibling=null,i.tag===5&&(s=i.stateNode,s!==null&&L(s)),i.stateNode=null,i.return=null,i.dependencies=null,i.memoizedProps=null,i.memoizedState=null,i.pendingProps=null,i.stateNode=null,i.updateQueue=null}var Yt=null,xr=!1;function _a(i,s,l){for(l=l.child;l!==null;)S_(i,s,l),l=l.sibling}function S_(i,s,l){if(xt&&typeof xt.onCommitFiberUnmount=="function")try{xt.onCommitFiberUnmount(zt,l)}catch{}switch(l.tag){case 26:on||ki(l,s),_a(i,s,l),l.memoizedState?l.memoizedState.count--:l.stateNode&&(l=l.stateNode,l.parentNode.removeChild(l));break;case 27:on||ki(l,s);var c=Yt,p=xr;rs(l.type)&&(Yt=l.stateNode,xr=!1),_a(i,s,l),Yu(l.stateNode),Yt=c,xr=p;break;case 5:on||ki(l,s);case 6:if(c=Yt,p=xr,Yt=null,_a(i,s,l),Yt=c,xr=p,Yt!==null)if(xr)try{(Yt.nodeType===9?Yt.body:Yt.nodeName==="HTML"?Yt.ownerDocument.body:Yt).removeChild(l.stateNode)}catch(v){Ut(l,s,v)}else try{Yt.removeChild(l.stateNode)}catch(v){Ut(l,s,v)}break;case 18:Yt!==null&&(xr?(i=Yt,dy(i.nodeType===9?i.body:i.nodeName==="HTML"?i.ownerDocument.body:i,l.stateNode),nc(i)):dy(Yt,l.stateNode));break;case 4:c=Yt,p=xr,Yt=l.stateNode.containerInfo,xr=!0,_a(i,s,l),Yt=c,xr=p;break;case 0:case 11:case 14:case 15:on||Wa(2,l,s),on||Wa(4,l,s),_a(i,s,l);break;case 1:on||(ki(l,s),c=l.stateNode,typeof c.componentWillUnmount=="function"&&__(l,s,c)),_a(i,s,l);break;case 21:_a(i,s,l);break;case 22:on=(c=on)||l.memoizedState!==null,_a(i,s,l),on=c;break;default:_a(i,s,l)}}function b_(i,s){if(s.memoizedState===null&&(i=s.alternate,i!==null&&(i=i.memoizedState,i!==null&&(i=i.dehydrated,i!==null))))try{nc(i)}catch(l){Ut(s,s.return,l)}}function QS(i){switch(i.tag){case 13:case 19:var s=i.stateNode;return s===null&&(s=i.stateNode=new T_),s;case 22:return i=i.stateNode,s=i._retryCache,s===null&&(s=i._retryCache=new T_),s;default:throw Error(r(435,i.tag))}}function om(i,s){var l=QS(i);s.forEach(function(c){var p=s4.bind(null,i,c);l.has(c)||(l.add(c),c.then(p,p))})}function Dr(i,s){var l=s.deletions;if(l!==null)for(var c=0;c<l.length;c++){var p=l[c],v=i,S=s,D=S;e:for(;D!==null;){switch(D.tag){case 27:if(rs(D.type)){Yt=D.stateNode,xr=!1;break e}break;case 5:Yt=D.stateNode,xr=!1;break e;case 3:case 4:Yt=D.stateNode.containerInfo,xr=!0;break e}D=D.return}if(Yt===null)throw Error(r(160));S_(v,S,p),Yt=null,xr=!1,v=p.alternate,v!==null&&(v.return=null),p.return=null}if(s.subtreeFlags&13878)for(s=s.child;s!==null;)R_(s,i),s=s.sibling}var ui=null;function R_(i,s){var l=i.alternate,c=i.flags;switch(i.tag){case 0:case 11:case 14:case 15:Dr(s,i),Or(i),c&4&&(Wa(3,i,i.return),Vu(3,i),Wa(5,i,i.return));break;case 1:Dr(s,i),Or(i),c&512&&(on||l===null||ki(l,l.return)),c&64&&va&&(i=i.updateQueue,i!==null&&(c=i.callbacks,c!==null&&(l=i.shared.hiddenCallbacks,i.shared.hiddenCallbacks=l===null?c:l.concat(c))));break;case 26:var p=ui;if(Dr(s,i),Or(i),c&512&&(on||l===null||ki(l,l.return)),c&4){var v=l!==null?l.memoizedState:null;if(c=i.memoizedState,l===null)if(c===null)if(i.stateNode===null){e:{c=i.type,l=i.memoizedProps,p=p.ownerDocument||p;t:switch(c){case"title":v=p.getElementsByTagName("title")[0],(!v||v[F]||v[an]||v.namespaceURI==="http://www.w3.org/2000/svg"||v.hasAttribute("itemprop"))&&(v=p.createElement(c),p.head.insertBefore(v,p.querySelector("head > title"))),Bn(v,c,l),v[an]=i,ne(v),c=v;break e;case"link":var S=Ey("link","href",p).get(c+(l.href||""));if(S){for(var D=0;D<S.length;D++)if(v=S[D],v.getAttribute("href")===(l.href==null||l.href===""?null:l.href)&&v.getAttribute("rel")===(l.rel==null?null:l.rel)&&v.getAttribute("title")===(l.title==null?null:l.title)&&v.getAttribute("crossorigin")===(l.crossOrigin==null?null:l.crossOrigin)){S.splice(D,1);break t}}v=p.createElement(c),Bn(v,c,l),p.head.appendChild(v);break;case"meta":if(S=Ey("meta","content",p).get(c+(l.content||""))){for(D=0;D<S.length;D++)if(v=S[D],v.getAttribute("content")===(l.content==null?null:""+l.content)&&v.getAttribute("name")===(l.name==null?null:l.name)&&v.getAttribute("property")===(l.property==null?null:l.property)&&v.getAttribute("http-equiv")===(l.httpEquiv==null?null:l.httpEquiv)&&v.getAttribute("charset")===(l.charSet==null?null:l.charSet)){S.splice(D,1);break t}}v=p.createElement(c),Bn(v,c,l),p.head.appendChild(v);break;default:throw Error(r(468,c))}v[an]=i,ne(v),c=v}i.stateNode=c}else Ty(p,i.type,i.stateNode);else i.stateNode=xy(p,c,i.memoizedProps);else v!==c?(v===null?l.stateNode!==null&&(l=l.stateNode,l.parentNode.removeChild(l)):v.count--,c===null?Ty(p,i.type,i.stateNode):xy(p,c,i.memoizedProps)):c===null&&i.stateNode!==null&&rm(i,i.memoizedProps,l.memoizedProps)}break;case 27:Dr(s,i),Or(i),c&512&&(on||l===null||ki(l,l.return)),l!==null&&c&4&&rm(i,i.memoizedProps,l.memoizedProps);break;case 5:if(Dr(s,i),Or(i),c&512&&(on||l===null||ki(l,l.return)),i.flags&32){p=i.stateNode;try{zr(p,"")}catch(fe){Ut(i,i.return,fe)}}c&4&&i.stateNode!=null&&(p=i.memoizedProps,rm(i,p,l!==null?l.memoizedProps:p)),c&1024&&(sm=!0);break;case 6:if(Dr(s,i),Or(i),c&4){if(i.stateNode===null)throw Error(r(162));c=i.memoizedProps,l=i.stateNode;try{l.nodeValue=c}catch(fe){Ut(i,i.return,fe)}}break;case 3:if(ch=null,p=ui,ui=lh(s.containerInfo),Dr(s,i),ui=p,Or(i),c&4&&l!==null&&l.memoizedState.isDehydrated)try{nc(s.containerInfo)}catch(fe){Ut(i,i.return,fe)}sm&&(sm=!1,C_(i));break;case 4:c=ui,ui=lh(i.stateNode.containerInfo),Dr(s,i),Or(i),ui=c;break;case 12:Dr(s,i),Or(i);break;case 13:Dr(s,i),Or(i),i.child.flags&8192&&i.memoizedState!==null!=(l!==null&&l.memoizedState!==null)&&(dm=Ve()),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,om(i,c)));break;case 22:p=i.memoizedState!==null;var Y=l!==null&&l.memoizedState!==null,se=va,ye=on;if(va=se||p,on=ye||Y,Dr(s,i),on=ye,va=se,Or(i),c&8192)e:for(s=i.stateNode,s._visibility=p?s._visibility&-2:s._visibility|1,p&&(l===null||Y||va||on||oo(i)),l=null,s=i;;){if(s.tag===5||s.tag===26){if(l===null){Y=l=s;try{if(v=Y.stateNode,p)S=v.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{D=Y.stateNode;var Te=Y.memoizedProps.style,ue=Te!=null&&Te.hasOwnProperty("display")?Te.display:null;D.style.display=ue==null||typeof ue=="boolean"?"":(""+ue).trim()}}catch(fe){Ut(Y,Y.return,fe)}}}else if(s.tag===6){if(l===null){Y=s;try{Y.stateNode.nodeValue=p?"":Y.memoizedProps}catch(fe){Ut(Y,Y.return,fe)}}}else if((s.tag!==22&&s.tag!==23||s.memoizedState===null||s===i)&&s.child!==null){s.child.return=s,s=s.child;continue}if(s===i)break e;for(;s.sibling===null;){if(s.return===null||s.return===i)break e;l===s&&(l=null),s=s.return}l===s&&(l=null),s.sibling.return=s.return,s=s.sibling}c&4&&(c=i.updateQueue,c!==null&&(l=c.retryQueue,l!==null&&(c.retryQueue=null,om(i,l))));break;case 19:Dr(s,i),Or(i),c&4&&(c=i.updateQueue,c!==null&&(i.updateQueue=null,om(i,c)));break;case 30:break;case 21:break;default:Dr(s,i),Or(i)}}function Or(i){var s=i.flags;if(s&2){try{for(var l,c=i.return;c!==null;){if(x_(c)){l=c;break}c=c.return}if(l==null)throw Error(r(160));switch(l.tag){case 27:var p=l.stateNode,v=im(i);Wf(i,v,p);break;case 5:var S=l.stateNode;l.flags&32&&(zr(S,""),l.flags&=-33);var D=im(i);Wf(i,D,S);break;case 3:case 4:var Y=l.stateNode.containerInfo,se=im(i);am(i,se,Y);break;default:throw Error(r(161))}}catch(ye){Ut(i,i.return,ye)}i.flags&=-3}s&4096&&(i.flags&=-4097)}function C_(i){if(i.subtreeFlags&1024)for(i=i.child;i!==null;){var s=i;C_(s),s.tag===5&&s.flags&1024&&s.stateNode.reset(),i=i.sibling}}function Ka(i,s){if(s.subtreeFlags&8772)for(s=s.child;s!==null;)w_(i,s.alternate,s),s=s.sibling}function oo(i){for(i=i.child;i!==null;){var s=i;switch(s.tag){case 0:case 11:case 14:case 15:Wa(4,s,s.return),oo(s);break;case 1:ki(s,s.return);var l=s.stateNode;typeof l.componentWillUnmount=="function"&&__(s,s.return,l),oo(s);break;case 27:Yu(s.stateNode);case 26:case 5:ki(s,s.return),oo(s);break;case 22:s.memoizedState===null&&oo(s);break;case 30:oo(s);break;default:oo(s)}i=i.sibling}}function Qa(i,s,l){for(l=l&&(s.subtreeFlags&8772)!==0,s=s.child;s!==null;){var c=s.alternate,p=i,v=s,S=v.flags;switch(v.tag){case 0:case 11:case 15:Qa(p,v,l),Vu(4,v);break;case 1:if(Qa(p,v,l),c=v,p=c.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){Ut(c,c.return,se)}if(c=v,p=c.updateQueue,p!==null){var D=c.stateNode;try{var Y=p.shared.hiddenCallbacks;if(Y!==null)for(p.shared.hiddenCallbacks=null,p=0;p<Y.length;p++)rv(Y[p],D)}catch(se){Ut(c,c.return,se)}}l&&S&64&&v_(v),Bu(v,v.return);break;case 27:E_(v);case 26:case 5:Qa(p,v,l),l&&c===null&&S&4&&y_(v),Bu(v,v.return);break;case 12:Qa(p,v,l);break;case 13:Qa(p,v,l),l&&S&4&&b_(p,v);break;case 22:v.memoizedState===null&&Qa(p,v,l),Bu(v,v.return);break;case 30:break;default:Qa(p,v,l)}s=s.sibling}}function lm(i,s){var l=null;i!==null&&i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(l=i.memoizedState.cachePool.pool),i=null,s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(i=s.memoizedState.cachePool.pool),i!==l&&(i!=null&&i.refCount++,l!=null&&Au(l))}function um(i,s){i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Au(i))}function Li(i,s,l,c){if(s.subtreeFlags&10256)for(s=s.child;s!==null;)I_(i,s,l,c),s=s.sibling}function I_(i,s,l,c){var p=s.flags;switch(s.tag){case 0:case 11:case 15:Li(i,s,l,c),p&2048&&Vu(9,s);break;case 1:Li(i,s,l,c);break;case 3:Li(i,s,l,c),p&2048&&(i=null,s.alternate!==null&&(i=s.alternate.memoizedState.cache),s=s.memoizedState.cache,s!==i&&(s.refCount++,i!=null&&Au(i)));break;case 12:if(p&2048){Li(i,s,l,c),i=s.stateNode;try{var v=s.memoizedProps,S=v.id,D=v.onPostCommit;typeof D=="function"&&D(S,s.alternate===null?"mount":"update",i.passiveEffectDuration,-0)}catch(Y){Ut(s,s.return,Y)}}else Li(i,s,l,c);break;case 13:Li(i,s,l,c);break;case 23:break;case 22:v=s.stateNode,S=s.alternate,s.memoizedState!==null?v._visibility&2?Li(i,s,l,c):Uu(i,s):v._visibility&2?Li(i,s,l,c):(v._visibility|=2,ul(i,s,l,c,(s.subtreeFlags&10256)!==0)),p&2048&&lm(S,s);break;case 24:Li(i,s,l,c),p&2048&&um(s.alternate,s);break;default:Li(i,s,l,c)}}function ul(i,s,l,c,p){for(p=p&&(s.subtreeFlags&10256)!==0,s=s.child;s!==null;){var v=i,S=s,D=l,Y=c,se=S.flags;switch(S.tag){case 0:case 11:case 15:ul(v,S,D,Y,p),Vu(8,S);break;case 23:break;case 22:var ye=S.stateNode;S.memoizedState!==null?ye._visibility&2?ul(v,S,D,Y,p):Uu(v,S):(ye._visibility|=2,ul(v,S,D,Y,p)),p&&se&2048&&lm(S.alternate,S);break;case 24:ul(v,S,D,Y,p),p&&se&2048&&um(S.alternate,S);break;default:ul(v,S,D,Y,p)}s=s.sibling}}function Uu(i,s){if(s.subtreeFlags&10256)for(s=s.child;s!==null;){var l=i,c=s,p=c.flags;switch(c.tag){case 22:Uu(l,c),p&2048&&lm(c.alternate,c);break;case 24:Uu(l,c),p&2048&&um(c.alternate,c);break;default:Uu(l,c)}s=s.sibling}}var ju=8192;function cl(i){if(i.subtreeFlags&ju)for(i=i.child;i!==null;)N_(i),i=i.sibling}function N_(i){switch(i.tag){case 26:cl(i),i.flags&ju&&i.memoizedState!==null&&k4(ui,i.memoizedState,i.memoizedProps);break;case 5:cl(i);break;case 3:case 4:var s=ui;ui=lh(i.stateNode.containerInfo),cl(i),ui=s;break;case 22:i.memoizedState===null&&(s=i.alternate,s!==null&&s.memoizedState!==null?(s=ju,ju=16777216,cl(i),ju=s):cl(i));break;default:cl(i)}}function D_(i){var s=i.alternate;if(s!==null&&(i=s.child,i!==null)){s.child=null;do s=i.sibling,i.sibling=null,i=s;while(i!==null)}}function zu(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];Nn=c,F_(c,i)}D_(i)}if(i.subtreeFlags&10256)for(i=i.child;i!==null;)O_(i),i=i.sibling}function O_(i){switch(i.tag){case 0:case 11:case 15:zu(i),i.flags&2048&&Wa(9,i,i.return);break;case 3:zu(i);break;case 12:zu(i);break;case 22:var s=i.stateNode;i.memoizedState!==null&&s._visibility&2&&(i.return===null||i.return.tag!==13)?(s._visibility&=-3,Kf(i)):zu(i);break;default:zu(i)}}function Kf(i){var s=i.deletions;if((i.flags&16)!==0){if(s!==null)for(var l=0;l<s.length;l++){var c=s[l];Nn=c,F_(c,i)}D_(i)}for(i=i.child;i!==null;){switch(s=i,s.tag){case 0:case 11:case 15:Wa(8,s,s.return),Kf(s);break;case 22:l=s.stateNode,l._visibility&2&&(l._visibility&=-3,Kf(s));break;default:Kf(s)}i=i.sibling}}function F_(i,s){for(;Nn!==null;){var l=Nn;switch(l.tag){case 0:case 11:case 15:Wa(8,l,s);break;case 23:case 22:if(l.memoizedState!==null&&l.memoizedState.cachePool!==null){var c=l.memoizedState.cachePool.pool;c!=null&&c.refCount++}break;case 24:Au(l.memoizedState.cache)}if(c=l.child,c!==null)c.return=l,Nn=c;else e:for(l=i;Nn!==null;){c=Nn;var p=c.sibling,v=c.return;if(A_(c),c===l){Nn=null;break e}if(p!==null){p.return=v,Nn=p;break e}Nn=v}}}var ZS={getCacheForType:function(i){var s=Qn(Tn),l=s.data.get(i);return l===void 0&&(l=i(),s.data.set(i,l)),l}},JS=typeof WeakMap=="function"?WeakMap:Map,Ct=0,Gt=null,ct=null,vt=0,It=0,Fr=null,Za=!1,fl=!1,cm=!1,ya=0,en=0,Ja=0,lo=0,fm=0,Qr=0,hl=0,Hu=null,Er=null,hm=!1,dm=0,Qf=1/0,Zf=null,es=null,Vn=0,ts=null,dl=null,ml=0,mm=0,pm=null,M_=null,Gu=0,gm=null;function Mr(){if((Ct&2)!==0&&vt!==0)return vt&-vt;if(de.T!==null){var i=tl;return i!==0?i:wm()}return Ai()}function P_(){Qr===0&&(Qr=(vt&536870912)===0||At?La():536870912);var i=Kr.current;return i!==null&&(i.flags|=32),Qr}function Pr(i,s,l){(i===Gt&&(It===2||It===9)||i.cancelPendingCommit!==null)&&(pl(i,0),ns(i,vt,Qr,!1)),si(i,l),((Ct&2)===0||i!==Gt)&&(i===Gt&&((Ct&2)===0&&(lo|=l),en===4&&ns(i,vt,Qr,!1)),Vi(i))}function k_(i,s,l){if((Ct&6)!==0)throw Error(r(327));var c=!l&&(s&124)===0&&(s&i.expiredLanes)===0||ea(i,s),p=c?n4(i,s):ym(i,s,!0),v=c;do{if(p===0){fl&&!c&&ns(i,s,0,!1);break}else{if(l=i.current.alternate,v&&!e4(l)){p=ym(i,s,!1),v=!1;continue}if(p===2){if(v=s,i.errorRecoveryDisabledLanes&v)var S=0;else S=i.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){s=S;e:{var D=i;p=Hu;var Y=D.current.memoizedState.isDehydrated;if(Y&&(pl(D,S).flags|=256),S=ym(D,S,!1),S!==2){if(cm&&!Y){D.errorRecoveryDisabledLanes|=v,lo|=v,p=4;break e}v=Er,Er=p,v!==null&&(Er===null?Er=v:Er.push.apply(Er,v))}p=S}if(v=!1,p!==2)continue}}if(p===1){pl(i,0),ns(i,s,0,!0);break}e:{switch(c=i,v=p,v){case 0:case 1:throw Error(r(345));case 4:if((s&4194048)!==s)break;case 6:ns(c,s,Qr,!Za);break e;case 2:Er=null;break;case 3:case 5:break;default:throw Error(r(329))}if((s&62914560)===s&&(p=dm+300-Ve(),10<p)){if(ns(c,s,Qr,!Za),Pa(c,0,!0)!==0)break e;c.timeoutHandle=fy(L_.bind(null,c,l,Er,Zf,hm,s,Qr,lo,hl,Za,v,2,-0,0),p);break e}L_(c,l,Er,Zf,hm,s,Qr,lo,hl,Za,v,0,-0,0)}}break}while(!0);Vi(i)}function L_(i,s,l,c,p,v,S,D,Y,se,ye,Te,ue,fe){if(i.timeoutHandle=-1,Te=s.subtreeFlags,(Te&8192||(Te&16785408)===16785408)&&(Qu={stylesheets:null,count:0,unsuspend:P4},N_(s),Te=L4(),Te!==null)){i.cancelPendingCommit=Te(G_.bind(null,i,s,v,l,c,p,S,D,Y,ye,1,ue,fe)),ns(i,v,S,!se);return}G_(i,s,v,l,c,p,S,D,Y)}function e4(i){for(var s=i;;){var l=s.tag;if((l===0||l===11||l===15)&&s.flags&16384&&(l=s.updateQueue,l!==null&&(l=l.stores,l!==null)))for(var c=0;c<l.length;c++){var p=l[c],v=p.getSnapshot;p=p.value;try{if(!Ir(v(),p))return!1}catch{return!1}}if(l=s.child,s.subtreeFlags&16384&&l!==null)l.return=s,s=l;else{if(s===i)break;for(;s.sibling===null;){if(s.return===null||s.return===i)return!0;s=s.return}s.sibling.return=s.return,s=s.sibling}}return!0}function ns(i,s,l,c){s&=~fm,s&=~lo,i.suspendedLanes|=s,i.pingedLanes&=~s,c&&(i.warmLanes|=s),c=i.expirationTimes;for(var p=s;0<p;){var v=31-bn(p),S=1<<v;c[v]=-1,p&=~S}l!==0&&jr(i,l,s)}function Jf(){return(Ct&6)===0?(qu(0),!1):!0}function vm(){if(ct!==null){if(It===0)var i=ct.return;else i=ct,fa=no=null,Md(i),ol=null,Pu=0,i=ct;for(;i!==null;)g_(i.alternate,i),i=i.return;ct=null}}function pl(i,s){var l=i.timeoutHandle;l!==-1&&(i.timeoutHandle=-1,_4(l)),l=i.cancelPendingCommit,l!==null&&(i.cancelPendingCommit=null,l()),vm(),Gt=i,ct=l=la(i.current,null),vt=s,It=0,Fr=null,Za=!1,fl=ea(i,s),cm=!1,hl=Qr=fm=lo=Ja=en=0,Er=Hu=null,hm=!1,(s&8)!==0&&(s|=s&32);var c=i.entangledLanes;if(c!==0)for(i=i.entanglements,c&=s;0<c;){var p=31-bn(c),v=1<<p;s|=i[p],c&=~v}return ya=s,Ef(),l}function V_(i,s){at=null,de.H=Uf,s===bu||s===Nf?(s=tv(),It=3):s===Z1?(s=tv(),It=4):It=s===n_?8:s!==null&&typeof s=="object"&&typeof s.then=="function"?6:1,Fr=s,ct===null&&(en=1,qf(i,$r(s,i.current)))}function B_(){var i=de.H;return de.H=Uf,i===null?Uf:i}function U_(){var i=de.A;return de.A=ZS,i}function _m(){en=4,Za||(vt&4194048)!==vt&&Kr.current!==null||(fl=!0),(Ja&134217727)===0&&(lo&134217727)===0||Gt===null||ns(Gt,vt,Qr,!1)}function ym(i,s,l){var c=Ct;Ct|=2;var p=B_(),v=U_();(Gt!==i||vt!==s)&&(Zf=null,pl(i,s)),s=!1;var S=en;e:do try{if(It!==0&&ct!==null){var D=ct,Y=Fr;switch(It){case 8:vm(),S=6;break e;case 3:case 2:case 9:case 6:Kr.current===null&&(s=!0);var se=It;if(It=0,Fr=null,gl(i,D,Y,se),l&&fl){S=0;break e}break;default:se=It,It=0,Fr=null,gl(i,D,Y,se)}}t4(),S=en;break}catch(ye){V_(i,ye)}while(!0);return s&&i.shellSuspendCounter++,fa=no=null,Ct=c,de.H=p,de.A=v,ct===null&&(Gt=null,vt=0,Ef()),S}function t4(){for(;ct!==null;)j_(ct)}function n4(i,s){var l=Ct;Ct|=2;var c=B_(),p=U_();Gt!==i||vt!==s?(Zf=null,Qf=Ve()+500,pl(i,s)):fl=ea(i,s);e:do try{if(It!==0&&ct!==null){s=ct;var v=Fr;t:switch(It){case 1:It=0,Fr=null,gl(i,s,v,1);break;case 2:case 9:if(J1(v)){It=0,Fr=null,z_(s);break}s=function(){It!==2&&It!==9||Gt!==i||(It=7),Vi(i)},v.then(s,s);break e;case 3:It=7;break e;case 4:It=5;break e;case 7:J1(v)?(It=0,Fr=null,z_(s)):(It=0,Fr=null,gl(i,s,v,7));break;case 5:var S=null;switch(ct.tag){case 26:S=ct.memoizedState;case 5:case 27:var D=ct;if(!S||wy(S)){It=0,Fr=null;var Y=D.sibling;if(Y!==null)ct=Y;else{var se=D.return;se!==null?(ct=se,eh(se)):ct=null}break t}}It=0,Fr=null,gl(i,s,v,5);break;case 6:It=0,Fr=null,gl(i,s,v,6);break;case 8:vm(),en=6;break e;default:throw Error(r(462))}}r4();break}catch(ye){V_(i,ye)}while(!0);return fa=no=null,de.H=c,de.A=p,Ct=l,ct!==null?0:(Gt=null,vt=0,Ef(),en)}function r4(){for(;ct!==null&&!ir();)j_(ct)}function j_(i){var s=m_(i.alternate,i,ya);i.memoizedProps=i.pendingProps,s===null?eh(i):ct=s}function z_(i){var s=i,l=s.alternate;switch(s.tag){case 15:case 0:s=l_(l,s,s.pendingProps,s.type,void 0,vt);break;case 11:s=l_(l,s,s.pendingProps,s.type.render,s.ref,vt);break;case 5:Md(s);default:g_(l,s),s=ct=H1(s,ya),s=m_(l,s,ya)}i.memoizedProps=i.pendingProps,s===null?eh(i):ct=s}function gl(i,s,l,c){fa=no=null,Md(s),ol=null,Pu=0;var p=s.return;try{if($S(i,p,s,l,vt)){en=1,qf(i,$r(l,i.current)),ct=null;return}}catch(v){if(p!==null)throw ct=p,v;en=1,qf(i,$r(l,i.current)),ct=null;return}s.flags&32768?(At||c===1?i=!0:fl||(vt&536870912)!==0?i=!1:(Za=i=!0,(c===2||c===9||c===3||c===6)&&(c=Kr.current,c!==null&&c.tag===13&&(c.flags|=16384))),H_(s,i)):eh(s)}function eh(i){var s=i;do{if((s.flags&32768)!==0){H_(s,Za);return}i=s.return;var l=YS(s.alternate,s,ya);if(l!==null){ct=l;return}if(s=s.sibling,s!==null){ct=s;return}ct=s=i}while(s!==null);en===0&&(en=5)}function H_(i,s){do{var l=WS(i.alternate,i);if(l!==null){l.flags&=32767,ct=l;return}if(l=i.return,l!==null&&(l.flags|=32768,l.subtreeFlags=0,l.deletions=null),!s&&(i=i.sibling,i!==null)){ct=i;return}ct=i=l}while(i!==null);en=6,ct=null}function G_(i,s,l,c,p,v,S,D,Y){i.cancelPendingCommit=null;do th();while(Vn!==0);if((Ct&6)!==0)throw Error(r(327));if(s!==null){if(s===i.current)throw Error(r(177));if(v=s.lanes|s.childLanes,v|=ud,Ti(i,l,v,S,D,Y),i===Gt&&(ct=Gt=null,vt=0),dl=s,ts=i,ml=l,mm=v,pm=p,M_=c,(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?(i.callbackNode=null,i.callbackPriority=0,o4(pr,function(){return W_(),null})):(i.callbackNode=null,i.callbackPriority=0),c=(s.flags&13878)!==0,(s.subtreeFlags&13878)!==0||c){c=de.T,de.T=null,p=Re.p,Re.p=2,S=Ct,Ct|=4;try{KS(i,s,l)}finally{Ct=S,Re.p=p,de.T=c}}Vn=1,q_(),$_(),X_()}}function q_(){if(Vn===1){Vn=0;var i=ts,s=dl,l=(s.flags&13878)!==0;if((s.subtreeFlags&13878)!==0||l){l=de.T,de.T=null;var c=Re.p;Re.p=2;var p=Ct;Ct|=4;try{R_(s,i);var v=Dm,S=F1(i.containerInfo),D=v.focusedElem,Y=v.selectionRange;if(S!==D&&D&&D.ownerDocument&&O1(D.ownerDocument.documentElement,D)){if(Y!==null&&id(D)){var se=Y.start,ye=Y.end;if(ye===void 0&&(ye=se),"selectionStart"in D)D.selectionStart=se,D.selectionEnd=Math.min(ye,D.value.length);else{var Te=D.ownerDocument||document,ue=Te&&Te.defaultView||window;if(ue.getSelection){var fe=ue.getSelection(),Ze=D.textContent.length,Xe=Math.min(Y.start,Ze),Lt=Y.end===void 0?Xe:Math.min(Y.end,Ze);!fe.extend&&Xe>Lt&&(S=Lt,Lt=Xe,Xe=S);var te=D1(D,Xe),J=D1(D,Lt);if(te&&J&&(fe.rangeCount!==1||fe.anchorNode!==te.node||fe.anchorOffset!==te.offset||fe.focusNode!==J.node||fe.focusOffset!==J.offset)){var ie=Te.createRange();ie.setStart(te.node,te.offset),fe.removeAllRanges(),Xe>Lt?(fe.addRange(ie),fe.extend(J.node,J.offset)):(ie.setEnd(J.node,J.offset),fe.addRange(ie))}}}}for(Te=[],fe=D;fe=fe.parentNode;)fe.nodeType===1&&Te.push({element:fe,left:fe.scrollLeft,top:fe.scrollTop});for(typeof D.focus=="function"&&D.focus(),D=0;D<Te.length;D++){var Ee=Te[D];Ee.element.scrollLeft=Ee.left,Ee.element.scrollTop=Ee.top}}dh=!!Nm,Dm=Nm=null}finally{Ct=p,Re.p=c,de.T=l}}i.current=s,Vn=2}}function $_(){if(Vn===2){Vn=0;var i=ts,s=dl,l=(s.flags&8772)!==0;if((s.subtreeFlags&8772)!==0||l){l=de.T,de.T=null;var c=Re.p;Re.p=2;var p=Ct;Ct|=4;try{w_(i,s.alternate,s)}finally{Ct=p,Re.p=c,de.T=l}}Vn=3}}function X_(){if(Vn===4||Vn===3){Vn=0,Bt();var i=ts,s=dl,l=ml,c=M_;(s.subtreeFlags&10256)!==0||(s.flags&10256)!==0?Vn=5:(Vn=0,dl=ts=null,Y_(i,i.pendingLanes));var p=i.pendingLanes;if(p===0&&(es=null),Ba(l),s=s.stateNode,xt&&typeof xt.onCommitFiberRoot=="function")try{xt.onCommitFiberRoot(zt,s,void 0,(s.current.flags&128)===128)}catch{}if(c!==null){s=de.T,p=Re.p,Re.p=2,de.T=null;try{for(var v=i.onRecoverableError,S=0;S<c.length;S++){var D=c[S];v(D.value,{componentStack:D.stack})}}finally{de.T=s,Re.p=p}}(ml&3)!==0&&th(),Vi(i),p=i.pendingLanes,(l&4194090)!==0&&(p&42)!==0?i===gm?Gu++:(Gu=0,gm=i):Gu=0,qu(0)}}function Y_(i,s){(i.pooledCacheLanes&=s)===0&&(s=i.pooledCache,s!=null&&(i.pooledCache=null,Au(s)))}function th(i){return q_(),$_(),X_(),W_()}function W_(){if(Vn!==5)return!1;var i=ts,s=mm;mm=0;var l=Ba(ml),c=de.T,p=Re.p;try{Re.p=32>l?32:l,de.T=null,l=pm,pm=null;var v=ts,S=ml;if(Vn=0,dl=ts=null,ml=0,(Ct&6)!==0)throw Error(r(331));var D=Ct;if(Ct|=4,O_(v.current),I_(v,v.current,S,l),Ct=D,qu(0,!1),xt&&typeof xt.onPostCommitFiberRoot=="function")try{xt.onPostCommitFiberRoot(zt,v)}catch{}return!0}finally{Re.p=p,de.T=c,Y_(i,s)}}function K_(i,s,l){s=$r(l,s),s=Yd(i.stateNode,s,2),i=qa(i,s,2),i!==null&&(si(i,2),Vi(i))}function Ut(i,s,l){if(i.tag===3)K_(i,i,l);else for(;s!==null;){if(s.tag===3){K_(s,i,l);break}else if(s.tag===1){var c=s.stateNode;if(typeof s.type.getDerivedStateFromError=="function"||typeof c.componentDidCatch=="function"&&(es===null||!es.has(c))){i=$r(l,i),l=e_(2),c=qa(s,l,2),c!==null&&(t_(l,c,s,i),si(c,2),Vi(c));break}}s=s.return}}function xm(i,s,l){var c=i.pingCache;if(c===null){c=i.pingCache=new JS;var p=new Set;c.set(s,p)}else p=c.get(s),p===void 0&&(p=new Set,c.set(s,p));p.has(l)||(cm=!0,p.add(l),i=i4.bind(null,i,s,l),s.then(i,i))}function i4(i,s,l){var c=i.pingCache;c!==null&&c.delete(s),i.pingedLanes|=i.suspendedLanes&l,i.warmLanes&=~l,Gt===i&&(vt&l)===l&&(en===4||en===3&&(vt&62914560)===vt&&300>Ve()-dm?(Ct&2)===0&&pl(i,0):fm|=l,hl===vt&&(hl=0)),Vi(i)}function Q_(i,s){s===0&&(s=Va()),i=Qo(i,s),i!==null&&(si(i,s),Vi(i))}function a4(i){var s=i.memoizedState,l=0;s!==null&&(l=s.retryLane),Q_(i,l)}function s4(i,s){var l=0;switch(i.tag){case 13:var c=i.stateNode,p=i.memoizedState;p!==null&&(l=p.retryLane);break;case 19:c=i.stateNode;break;case 22:c=i.stateNode._retryCache;break;default:throw Error(r(314))}c!==null&&c.delete(s),Q_(i,l)}function o4(i,s){return Wt(i,s)}var nh=null,vl=null,Em=!1,rh=!1,Tm=!1,uo=0;function Vi(i){i!==vl&&i.next===null&&(vl===null?nh=vl=i:vl=vl.next=i),rh=!0,Em||(Em=!0,u4())}function qu(i,s){if(!Tm&&rh){Tm=!0;do for(var l=!1,c=nh;c!==null;){if(i!==0){var p=c.pendingLanes;if(p===0)var v=0;else{var S=c.suspendedLanes,D=c.pingedLanes;v=(1<<31-bn(42|i)+1)-1,v&=p&~(S&~D),v=v&201326741?v&201326741|1:v?v|2:0}v!==0&&(l=!0,ty(c,v))}else v=vt,v=Pa(c,c===Gt?v:0,c.cancelPendingCommit!==null||c.timeoutHandle!==-1),(v&3)===0||ea(c,v)||(l=!0,ty(c,v));c=c.next}while(l);Tm=!1}}function l4(){Z_()}function Z_(){rh=Em=!1;var i=0;uo!==0&&(v4()&&(i=uo),uo=0);for(var s=Ve(),l=null,c=nh;c!==null;){var p=c.next,v=J_(c,s);v===0?(c.next=null,l===null?nh=p:l.next=p,p===null&&(vl=l)):(l=c,(i!==0||(v&3)!==0)&&(rh=!0)),c=p}qu(i)}function J_(i,s){for(var l=i.suspendedLanes,c=i.pingedLanes,p=i.expirationTimes,v=i.pendingLanes&-62914561;0<v;){var S=31-bn(v),D=1<<S,Y=p[S];Y===-1?((D&l)===0||(D&c)!==0)&&(p[S]=ka(D,s)):Y<=s&&(i.expiredLanes|=D),v&=~D}if(s=Gt,l=vt,l=Pa(i,i===s?l:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c=i.callbackNode,l===0||i===s&&(It===2||It===9)||i.cancelPendingCommit!==null)return c!==null&&c!==null&&ot(c),i.callbackNode=null,i.callbackPriority=0;if((l&3)===0||ea(i,l)){if(s=l&-l,s===i.callbackPriority)return s;switch(c!==null&&ot(c),Ba(l)){case 2:case 8:l=mr;break;case 32:l=pr;break;case 268435456:l=_i;break;default:l=pr}return c=ey.bind(null,i),l=Wt(l,c),i.callbackPriority=s,i.callbackNode=l,s}return c!==null&&c!==null&&ot(c),i.callbackPriority=2,i.callbackNode=null,2}function ey(i,s){if(Vn!==0&&Vn!==5)return i.callbackNode=null,i.callbackPriority=0,null;var l=i.callbackNode;if(th()&&i.callbackNode!==l)return null;var c=vt;return c=Pa(i,i===Gt?c:0,i.cancelPendingCommit!==null||i.timeoutHandle!==-1),c===0?null:(k_(i,c,s),J_(i,Ve()),i.callbackNode!=null&&i.callbackNode===l?ey.bind(null,i):null)}function ty(i,s){if(th())return null;k_(i,s,!0)}function u4(){y4(function(){(Ct&6)!==0?Wt(ar,l4):Z_()})}function wm(){return uo===0&&(uo=La()),uo}function ny(i){return i==null||typeof i=="symbol"||typeof i=="boolean"?null:typeof i=="function"?i:Bo(""+i)}function ry(i,s){var l=s.ownerDocument.createElement("input");return l.name=s.name,l.value=s.value,i.id&&l.setAttribute("form",i.id),s.parentNode.insertBefore(l,s),i=new FormData(i),l.parentNode.removeChild(l),i}function c4(i,s,l,c,p){if(s==="submit"&&l&&l.stateNode===p){var v=ny((p[Xt]||null).action),S=c.submitter;S&&(s=(s=S[Xt]||null)?ny(s.formAction):S.getAttribute("formAction"),s!==null&&(v=s,S=null));var D=new Uo("action","action",null,c,p);i.push({event:D,listeners:[{instance:null,listener:function(){if(c.defaultPrevented){if(uo!==0){var Y=S?ry(p,S):new FormData(p);Hd(l,{pending:!0,data:Y,method:p.method,action:v},null,Y)}}else typeof v=="function"&&(D.preventDefault(),Y=S?ry(p,S):new FormData(p),Hd(l,{pending:!0,data:Y,method:p.method,action:v},v,Y))},currentTarget:p}]})}}for(var Am=0;Am<ld.length;Am++){var Sm=ld[Am],f4=Sm.toLowerCase(),h4=Sm[0].toUpperCase()+Sm.slice(1);li(f4,"on"+h4)}li(k1,"onAnimationEnd"),li(L1,"onAnimationIteration"),li(V1,"onAnimationStart"),li("dblclick","onDoubleClick"),li("focusin","onFocus"),li("focusout","onBlur"),li(IS,"onTransitionRun"),li(NS,"onTransitionStart"),li(DS,"onTransitionCancel"),li(B1,"onTransitionEnd"),Ie("onMouseEnter",["mouseout","mouseover"]),Ie("onMouseLeave",["mouseout","mouseover"]),Ie("onPointerEnter",["pointerout","pointerover"]),Ie("onPointerLeave",["pointerout","pointerover"]),be("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),be("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),be("onBeforeInput",["compositionend","keypress","textInput","paste"]),be("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),be("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),d4=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($u));function iy(i,s){s=(s&4)!==0;for(var l=0;l<i.length;l++){var c=i[l],p=c.event;c=c.listeners;e:{var v=void 0;if(s)for(var S=c.length-1;0<=S;S--){var D=c[S],Y=D.instance,se=D.currentTarget;if(D=D.listener,Y!==v&&p.isPropagationStopped())break e;v=D,p.currentTarget=se;try{v(p)}catch(ye){Gf(ye)}p.currentTarget=null,v=Y}else for(S=0;S<c.length;S++){if(D=c[S],Y=D.instance,se=D.currentTarget,D=D.listener,Y!==v&&p.isPropagationStopped())break e;v=D,p.currentTarget=se;try{v(p)}catch(ye){Gf(ye)}p.currentTarget=null,v=Y}}}}function ft(i,s){var l=s[Ls];l===void 0&&(l=s[Ls]=new Set);var c=i+"__bubble";l.has(c)||(ay(s,i,2,!1),l.add(c))}function bm(i,s,l){var c=0;s&&(c|=4),ay(l,i,c,s)}var ih="_reactListening"+Math.random().toString(36).slice(2);function Rm(i){if(!i[ih]){i[ih]=!0,oe.forEach(function(l){l!=="selectionchange"&&(d4.has(l)||bm(l,!1,i),bm(l,!0,i))});var s=i.nodeType===9?i:i.ownerDocument;s===null||s[ih]||(s[ih]=!0,bm("selectionchange",!1,s))}}function ay(i,s,l,c){switch(Iy(s)){case 2:var p=U4;break;case 8:p=j4;break;default:p=jm}l=p.bind(null,s,l,i),p=void 0,!Gr||s!=="touchstart"&&s!=="touchmove"&&s!=="wheel"||(p=!0),c?p!==void 0?i.addEventListener(s,l,{capture:!0,passive:p}):i.addEventListener(s,l,!0):p!==void 0?i.addEventListener(s,l,{passive:p}):i.addEventListener(s,l,!1)}function Cm(i,s,l,c,p){var v=c;if((s&1)===0&&(s&2)===0&&c!==null)e:for(;;){if(c===null)return;var S=c.tag;if(S===3||S===4){var D=c.stateNode.containerInfo;if(D===p)break;if(S===4)for(S=c.return;S!==null;){var Y=S.tag;if((Y===3||Y===4)&&S.stateNode.containerInfo===p)return;S=S.return}for(;D!==null;){if(S=j(D),S===null)return;if(Y=S.tag,Y===5||Y===6||Y===26||Y===27){c=v=S;continue e}D=D.parentNode}}c=c.return}sf(function(){var se=v,ye=Hr(l),Te=[];e:{var ue=U1.get(i);if(ue!==void 0){var fe=Uo,Ze=i;switch(i){case"keypress":if(Ii(l)===0)break e;case"keydown":case"keyup":fe=$o;break;case"focusin":Ze="focus",fe=Ho;break;case"focusout":Ze="blur",fe=Ho;break;case"beforeblur":case"afterblur":fe=Ho;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":fe=qr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":fe=ed;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":fe=mf;break;case k1:case L1:case V1:fe=Go;break;case B1:fe=gf;break;case"scroll":case"scrollend":fe=of;break;case"wheel":fe=Xo;break;case"copy":case"cut":case"paste":fe=qo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":fe=gu;break;case"toggle":case"beforetoggle":fe=_f}var Xe=(s&4)!==0,Lt=!Xe&&(i==="scroll"||i==="scrollend"),te=Xe?ue!==null?ue+"Capture":null:ue;Xe=[];for(var J=se,ie;J!==null;){var Ee=J;if(ie=Ee.stateNode,Ee=Ee.tag,Ee!==5&&Ee!==26&&Ee!==27||ie===null||te===null||(Ee=zs(J,te),Ee!=null&&Xe.push(Xu(J,Ee,ie))),Lt)break;J=J.return}0<Xe.length&&(ue=new fe(ue,Ze,null,l,ye),Te.push({event:ue,listeners:Xe}))}}if((s&7)===0){e:{if(ue=i==="mouseover"||i==="pointerover",fe=i==="mouseout"||i==="pointerout",ue&&l!==na&&(Ze=l.relatedTarget||l.fromElement)&&(j(Ze)||Ze[vr]))break e;if((fe||ue)&&(ue=ye.window===ye?ye:(ue=ye.ownerDocument)?ue.defaultView||ue.parentWindow:window,fe?(Ze=l.relatedTarget||l.toElement,fe=se,Ze=Ze?j(Ze):null,Ze!==null&&(Lt=o(Ze),Xe=Ze.tag,Ze!==Lt||Xe!==5&&Xe!==27&&Xe!==6)&&(Ze=null)):(fe=null,Ze=se),fe!==Ze)){if(Xe=qr,Ee="onMouseLeave",te="onMouseEnter",J="mouse",(i==="pointerout"||i==="pointerover")&&(Xe=gu,Ee="onPointerLeave",te="onPointerEnter",J="pointer"),Lt=fe==null?ue:ae(fe),ie=Ze==null?ue:ae(Ze),ue=new Xe(Ee,J+"leave",fe,l,ye),ue.target=Lt,ue.relatedTarget=ie,Ee=null,j(ye)===se&&(Xe=new Xe(te,J+"enter",Ze,l,ye),Xe.target=ie,Xe.relatedTarget=Lt,Ee=Xe),Lt=Ee,fe&&Ze)t:{for(Xe=fe,te=Ze,J=0,ie=Xe;ie;ie=_l(ie))J++;for(ie=0,Ee=te;Ee;Ee=_l(Ee))ie++;for(;0<J-ie;)Xe=_l(Xe),J--;for(;0<ie-J;)te=_l(te),ie--;for(;J--;){if(Xe===te||te!==null&&Xe===te.alternate)break t;Xe=_l(Xe),te=_l(te)}Xe=null}else Xe=null;fe!==null&&sy(Te,ue,fe,Xe,!1),Ze!==null&&Lt!==null&&sy(Te,Lt,Ze,Xe,!0)}}e:{if(ue=se?ae(se):window,fe=ue.nodeName&&ue.nodeName.toLowerCase(),fe==="select"||fe==="input"&&ue.type==="file")var Ge=S1;else if(En(ue))if(b1)Ge=bS;else{Ge=AS;var lt=wS}else fe=ue.nodeName,!fe||fe.toLowerCase()!=="input"||ue.type!=="checkbox"&&ue.type!=="radio"?se&&uu(se.elementType)&&(Ge=S1):Ge=SS;if(Ge&&(Ge=Ge(i,se))){oa(Te,Ge,l,ye);break e}lt&&lt(i,ue,se),i==="focusout"&&se&&ue.type==="number"&&se.memoizedProps.value!=null&&Ua(ue,"number",ue.value)}switch(lt=se?ae(se):window,i){case"focusin":(En(lt)||lt.contentEditable==="true")&&(Yo=lt,ad=se,yu=null);break;case"focusout":yu=ad=Yo=null;break;case"mousedown":sd=!0;break;case"contextmenu":case"mouseup":case"dragend":sd=!1,M1(Te,l,ye);break;case"selectionchange":if(CS)break;case"keydown":case"keyup":M1(Te,l,ye)}var qe;if(Oi)e:{switch(i){case"compositionstart":var We="onCompositionStart";break e;case"compositionend":We="onCompositionEnd";break e;case"compositionupdate":We="onCompositionUpdate";break e}We=void 0}else pt?pe(i,l)&&(We="onCompositionEnd"):i==="keydown"&&l.keyCode===229&&(We="onCompositionStart");We&&(A&&l.locale!=="ko"&&(pt||We!=="onCompositionStart"?We==="onCompositionEnd"&&pt&&(qe=fu()):(Ci=ye,ja="value"in Ci?Ci.value:Ci.textContent,pt=!0)),lt=ah(se,We),0<lt.length&&(We=new mu(We,i,null,l,ye),Te.push({event:We,listeners:lt}),qe?We.data=qe:(qe=De(l),qe!==null&&(We.data=qe)))),(qe=x?xn(i,l):gt(i,l))&&(We=ah(se,"onBeforeInput"),0<We.length&&(lt=new mu("onBeforeInput","beforeinput",null,l,ye),Te.push({event:lt,listeners:We}),lt.data=qe)),c4(Te,i,se,l,ye)}iy(Te,s)})}function Xu(i,s,l){return{instance:i,listener:s,currentTarget:l}}function ah(i,s){for(var l=s+"Capture",c=[];i!==null;){var p=i,v=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||v===null||(p=zs(i,l),p!=null&&c.unshift(Xu(i,p,v)),p=zs(i,s),p!=null&&c.push(Xu(i,p,v))),i.tag===3)return c;i=i.return}return[]}function _l(i){if(i===null)return null;do i=i.return;while(i&&i.tag!==5&&i.tag!==27);return i||null}function sy(i,s,l,c,p){for(var v=s._reactName,S=[];l!==null&&l!==c;){var D=l,Y=D.alternate,se=D.stateNode;if(D=D.tag,Y!==null&&Y===c)break;D!==5&&D!==26&&D!==27||se===null||(Y=se,p?(se=zs(l,v),se!=null&&S.unshift(Xu(l,se,Y))):p||(se=zs(l,v),se!=null&&S.push(Xu(l,se,Y)))),l=l.return}S.length!==0&&i.push({event:s,listeners:S})}var m4=/\r\n?/g,p4=/\u0000|\uFFFD/g;function oy(i){return(typeof i=="string"?i:""+i).replace(m4,`
`).replace(p4,"")}function ly(i,s){return s=oy(s),oy(i)===s}function sh(){}function kt(i,s,l,c,p,v){switch(l){case"children":typeof c=="string"?s==="body"||s==="textarea"&&c===""||zr(i,c):(typeof c=="number"||typeof c=="bigint")&&s!=="body"&&zr(i,""+c);break;case"className":dt(i,"class",c);break;case"tabIndex":dt(i,"tabindex",c);break;case"dir":case"role":case"viewBox":case"width":case"height":dt(i,l,c);break;case"style":lu(i,c,v);break;case"data":if(s!=="object"){dt(i,"data",c);break}case"src":case"href":if(c===""&&(s!=="a"||l!=="href")){i.removeAttribute(l);break}if(c==null||typeof c=="function"||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Bo(""+c),i.setAttribute(l,c);break;case"action":case"formAction":if(typeof c=="function"){i.setAttribute(l,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof v=="function"&&(l==="formAction"?(s!=="input"&&kt(i,s,"name",p.name,p,null),kt(i,s,"formEncType",p.formEncType,p,null),kt(i,s,"formMethod",p.formMethod,p,null),kt(i,s,"formTarget",p.formTarget,p,null)):(kt(i,s,"encType",p.encType,p,null),kt(i,s,"method",p.method,p,null),kt(i,s,"target",p.target,p,null)));if(c==null||typeof c=="symbol"||typeof c=="boolean"){i.removeAttribute(l);break}c=Bo(""+c),i.setAttribute(l,c);break;case"onClick":c!=null&&(i.onclick=sh);break;case"onScroll":c!=null&&ft("scroll",i);break;case"onScrollEnd":c!=null&&ft("scrollend",i);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"multiple":i.multiple=c&&typeof c!="function"&&typeof c!="symbol";break;case"muted":i.muted=c&&typeof c!="function"&&typeof c!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(c==null||typeof c=="function"||typeof c=="boolean"||typeof c=="symbol"){i.removeAttribute("xlink:href");break}l=Bo(""+c),i.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",l);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""+c):i.removeAttribute(l);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":c&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,""):i.removeAttribute(l);break;case"capture":case"download":c===!0?i.setAttribute(l,""):c!==!1&&c!=null&&typeof c!="function"&&typeof c!="symbol"?i.setAttribute(l,c):i.removeAttribute(l);break;case"cols":case"rows":case"size":case"span":c!=null&&typeof c!="function"&&typeof c!="symbol"&&!isNaN(c)&&1<=c?i.setAttribute(l,c):i.removeAttribute(l);break;case"rowSpan":case"start":c==null||typeof c=="function"||typeof c=="symbol"||isNaN(c)?i.removeAttribute(l):i.setAttribute(l,c);break;case"popover":ft("beforetoggle",i),ft("toggle",i),Et(i,"popover",c);break;case"xlinkActuate":mt(i,"http://www.w3.org/1999/xlink","xlink:actuate",c);break;case"xlinkArcrole":mt(i,"http://www.w3.org/1999/xlink","xlink:arcrole",c);break;case"xlinkRole":mt(i,"http://www.w3.org/1999/xlink","xlink:role",c);break;case"xlinkShow":mt(i,"http://www.w3.org/1999/xlink","xlink:show",c);break;case"xlinkTitle":mt(i,"http://www.w3.org/1999/xlink","xlink:title",c);break;case"xlinkType":mt(i,"http://www.w3.org/1999/xlink","xlink:type",c);break;case"xmlBase":mt(i,"http://www.w3.org/XML/1998/namespace","xml:base",c);break;case"xmlLang":mt(i,"http://www.w3.org/XML/1998/namespace","xml:lang",c);break;case"xmlSpace":mt(i,"http://www.w3.org/XML/1998/namespace","xml:space",c);break;case"is":Et(i,"is",c);break;case"innerText":case"textContent":break;default:(!(2<l.length)||l[0]!=="o"&&l[0]!=="O"||l[1]!=="n"&&l[1]!=="N")&&(l=Z0.get(l)||l,Et(i,l,c))}}function Im(i,s,l,c,p,v){switch(l){case"style":lu(i,c,v);break;case"dangerouslySetInnerHTML":if(c!=null){if(typeof c!="object"||!("__html"in c))throw Error(r(61));if(l=c.__html,l!=null){if(p.children!=null)throw Error(r(60));i.innerHTML=l}}break;case"children":typeof c=="string"?zr(i,c):(typeof c=="number"||typeof c=="bigint")&&zr(i,""+c);break;case"onScroll":c!=null&&ft("scroll",i);break;case"onScrollEnd":c!=null&&ft("scrollend",i);break;case"onClick":c!=null&&(i.onclick=sh);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!le.hasOwnProperty(l))e:{if(l[0]==="o"&&l[1]==="n"&&(p=l.endsWith("Capture"),s=l.slice(2,p?l.length-7:void 0),v=i[Xt]||null,v=v!=null?v[l]:null,typeof v=="function"&&i.removeEventListener(s,v,p),typeof c=="function")){typeof v!="function"&&v!==null&&(l in i?i[l]=null:i.hasAttribute(l)&&i.removeAttribute(l)),i.addEventListener(s,c,p);break e}l in i?i[l]=c:c===!0?i.setAttribute(l,""):Et(i,l,c)}}}function Bn(i,s,l){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ft("error",i),ft("load",i);var c=!1,p=!1,v;for(v in l)if(l.hasOwnProperty(v)){var S=l[v];if(S!=null)switch(v){case"src":c=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:kt(i,s,v,S,l,null)}}p&&kt(i,s,"srcSet",l.srcSet,l,null),c&&kt(i,s,"src",l.src,l,null);return;case"input":ft("invalid",i);var D=v=S=p=null,Y=null,se=null;for(c in l)if(l.hasOwnProperty(c)){var ye=l[c];if(ye!=null)switch(c){case"name":p=ye;break;case"type":S=ye;break;case"checked":Y=ye;break;case"defaultChecked":se=ye;break;case"value":v=ye;break;case"defaultValue":D=ye;break;case"children":case"dangerouslySetInnerHTML":if(ye!=null)throw Error(r(137,s));break;default:kt(i,s,c,ye,l,null)}}Bs(i,v,D,Y,se,S,p,!1),Vo(i);return;case"select":ft("invalid",i),c=S=v=null;for(p in l)if(l.hasOwnProperty(p)&&(D=l[p],D!=null))switch(p){case"value":v=D;break;case"defaultValue":S=D;break;case"multiple":c=D;default:kt(i,s,p,D,l,null)}s=v,l=S,i.multiple=!!c,s!=null?ta(i,!!c,s,!1):l!=null&&ta(i,!!c,l,!0);return;case"textarea":ft("invalid",i),v=p=c=null;for(S in l)if(l.hasOwnProperty(S)&&(D=l[S],D!=null))switch(S){case"value":c=D;break;case"defaultValue":p=D;break;case"children":v=D;break;case"dangerouslySetInnerHTML":if(D!=null)throw Error(r(91));break;default:kt(i,s,S,D,l,null)}Us(i,c,p,v),Vo(i);return;case"option":for(Y in l)if(l.hasOwnProperty(Y)&&(c=l[Y],c!=null))switch(Y){case"selected":i.selected=c&&typeof c!="function"&&typeof c!="symbol";break;default:kt(i,s,Y,c,l,null)}return;case"dialog":ft("beforetoggle",i),ft("toggle",i),ft("cancel",i),ft("close",i);break;case"iframe":case"object":ft("load",i);break;case"video":case"audio":for(c=0;c<$u.length;c++)ft($u[c],i);break;case"image":ft("error",i),ft("load",i);break;case"details":ft("toggle",i);break;case"embed":case"source":case"link":ft("error",i),ft("load",i);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in l)if(l.hasOwnProperty(se)&&(c=l[se],c!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,s));default:kt(i,s,se,c,l,null)}return;default:if(uu(s)){for(ye in l)l.hasOwnProperty(ye)&&(c=l[ye],c!==void 0&&Im(i,s,ye,c,l,void 0));return}}for(D in l)l.hasOwnProperty(D)&&(c=l[D],c!=null&&kt(i,s,D,c,l,null))}function g4(i,s,l,c){switch(s){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,v=null,S=null,D=null,Y=null,se=null,ye=null;for(fe in l){var Te=l[fe];if(l.hasOwnProperty(fe)&&Te!=null)switch(fe){case"checked":break;case"value":break;case"defaultValue":Y=Te;default:c.hasOwnProperty(fe)||kt(i,s,fe,null,c,Te)}}for(var ue in c){var fe=c[ue];if(Te=l[ue],c.hasOwnProperty(ue)&&(fe!=null||Te!=null))switch(ue){case"type":v=fe;break;case"name":p=fe;break;case"checked":se=fe;break;case"defaultChecked":ye=fe;break;case"value":S=fe;break;case"defaultValue":D=fe;break;case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,s));break;default:fe!==Te&&kt(i,s,ue,fe,c,Te)}}Cr(i,S,D,Y,se,ye,v,p);return;case"select":fe=S=D=ue=null;for(v in l)if(Y=l[v],l.hasOwnProperty(v)&&Y!=null)switch(v){case"value":break;case"multiple":fe=Y;default:c.hasOwnProperty(v)||kt(i,s,v,null,c,Y)}for(p in c)if(v=c[p],Y=l[p],c.hasOwnProperty(p)&&(v!=null||Y!=null))switch(p){case"value":ue=v;break;case"defaultValue":D=v;break;case"multiple":S=v;default:v!==Y&&kt(i,s,p,v,c,Y)}s=D,l=S,c=fe,ue!=null?ta(i,!!l,ue,!1):!!c!=!!l&&(s!=null?ta(i,!!l,s,!0):ta(i,!!l,l?[]:"",!1));return;case"textarea":fe=ue=null;for(D in l)if(p=l[D],l.hasOwnProperty(D)&&p!=null&&!c.hasOwnProperty(D))switch(D){case"value":break;case"children":break;default:kt(i,s,D,null,c,p)}for(S in c)if(p=c[S],v=l[S],c.hasOwnProperty(S)&&(p!=null||v!=null))switch(S){case"value":ue=p;break;case"defaultValue":fe=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(r(91));break;default:p!==v&&kt(i,s,S,p,c,v)}Mt(i,ue,fe);return;case"option":for(var Ze in l)if(ue=l[Ze],l.hasOwnProperty(Ze)&&ue!=null&&!c.hasOwnProperty(Ze))switch(Ze){case"selected":i.selected=!1;break;default:kt(i,s,Ze,null,c,ue)}for(Y in c)if(ue=c[Y],fe=l[Y],c.hasOwnProperty(Y)&&ue!==fe&&(ue!=null||fe!=null))switch(Y){case"selected":i.selected=ue&&typeof ue!="function"&&typeof ue!="symbol";break;default:kt(i,s,Y,ue,c,fe)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Xe in l)ue=l[Xe],l.hasOwnProperty(Xe)&&ue!=null&&!c.hasOwnProperty(Xe)&&kt(i,s,Xe,null,c,ue);for(se in c)if(ue=c[se],fe=l[se],c.hasOwnProperty(se)&&ue!==fe&&(ue!=null||fe!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ue!=null)throw Error(r(137,s));break;default:kt(i,s,se,ue,c,fe)}return;default:if(uu(s)){for(var Lt in l)ue=l[Lt],l.hasOwnProperty(Lt)&&ue!==void 0&&!c.hasOwnProperty(Lt)&&Im(i,s,Lt,void 0,c,ue);for(ye in c)ue=c[ye],fe=l[ye],!c.hasOwnProperty(ye)||ue===fe||ue===void 0&&fe===void 0||Im(i,s,ye,ue,c,fe);return}}for(var te in l)ue=l[te],l.hasOwnProperty(te)&&ue!=null&&!c.hasOwnProperty(te)&&kt(i,s,te,null,c,ue);for(Te in c)ue=c[Te],fe=l[Te],!c.hasOwnProperty(Te)||ue===fe||ue==null&&fe==null||kt(i,s,Te,ue,c,fe)}var Nm=null,Dm=null;function oh(i){return i.nodeType===9?i:i.ownerDocument}function uy(i){switch(i){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function cy(i,s){if(i===0)switch(s){case"svg":return 1;case"math":return 2;default:return 0}return i===1&&s==="foreignObject"?0:i}function Om(i,s){return i==="textarea"||i==="noscript"||typeof s.children=="string"||typeof s.children=="number"||typeof s.children=="bigint"||typeof s.dangerouslySetInnerHTML=="object"&&s.dangerouslySetInnerHTML!==null&&s.dangerouslySetInnerHTML.__html!=null}var Fm=null;function v4(){var i=window.event;return i&&i.type==="popstate"?i===Fm?!1:(Fm=i,!0):(Fm=null,!1)}var fy=typeof setTimeout=="function"?setTimeout:void 0,_4=typeof clearTimeout=="function"?clearTimeout:void 0,hy=typeof Promise=="function"?Promise:void 0,y4=typeof queueMicrotask=="function"?queueMicrotask:typeof hy<"u"?function(i){return hy.resolve(null).then(i).catch(x4)}:fy;function x4(i){setTimeout(function(){throw i})}function rs(i){return i==="head"}function dy(i,s){var l=s,c=0,p=0;do{var v=l.nextSibling;if(i.removeChild(l),v&&v.nodeType===8)if(l=v.data,l==="/$"){if(0<c&&8>c){l=c;var S=i.ownerDocument;if(l&1&&Yu(S.documentElement),l&2&&Yu(S.body),l&4)for(l=S.head,Yu(l),S=l.firstChild;S;){var D=S.nextSibling,Y=S.nodeName;S[F]||Y==="SCRIPT"||Y==="STYLE"||Y==="LINK"&&S.rel.toLowerCase()==="stylesheet"||l.removeChild(S),S=D}}if(p===0){i.removeChild(v),nc(s);return}p--}else l==="$"||l==="$?"||l==="$!"?p++:c=l.charCodeAt(0)-48;else c=0;l=v}while(l);nc(s)}function Mm(i){var s=i.firstChild;for(s&&s.nodeType===10&&(s=s.nextSibling);s;){var l=s;switch(s=s.nextSibling,l.nodeName){case"HTML":case"HEAD":case"BODY":Mm(l),L(l);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(l.rel.toLowerCase()==="stylesheet")continue}i.removeChild(l)}}function E4(i,s,l,c){for(;i.nodeType===1;){var p=l;if(i.nodeName.toLowerCase()!==s.toLowerCase()){if(!c&&(i.nodeName!=="INPUT"||i.type!=="hidden"))break}else if(c){if(!i[F])switch(s){case"meta":if(!i.hasAttribute("itemprop"))break;return i;case"link":if(v=i.getAttribute("rel"),v==="stylesheet"&&i.hasAttribute("data-precedence"))break;if(v!==p.rel||i.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||i.getAttribute("title")!==(p.title==null?null:p.title))break;return i;case"style":if(i.hasAttribute("data-precedence"))break;return i;case"script":if(v=i.getAttribute("src"),(v!==(p.src==null?null:p.src)||i.getAttribute("type")!==(p.type==null?null:p.type)||i.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&v&&i.hasAttribute("async")&&!i.hasAttribute("itemprop"))break;return i;default:return i}}else if(s==="input"&&i.type==="hidden"){var v=p.name==null?null:""+p.name;if(p.type==="hidden"&&i.getAttribute("name")===v)return i}else return i;if(i=ci(i.nextSibling),i===null)break}return null}function T4(i,s,l){if(s==="")return null;for(;i.nodeType!==3;)if((i.nodeType!==1||i.nodeName!=="INPUT"||i.type!=="hidden")&&!l||(i=ci(i.nextSibling),i===null))return null;return i}function Pm(i){return i.data==="$!"||i.data==="$?"&&i.ownerDocument.readyState==="complete"}function w4(i,s){var l=i.ownerDocument;if(i.data!=="$?"||l.readyState==="complete")s();else{var c=function(){s(),l.removeEventListener("DOMContentLoaded",c)};l.addEventListener("DOMContentLoaded",c),i._reactRetry=c}}function ci(i){for(;i!=null;i=i.nextSibling){var s=i.nodeType;if(s===1||s===3)break;if(s===8){if(s=i.data,s==="$"||s==="$!"||s==="$?"||s==="F!"||s==="F")break;if(s==="/$")return null}}return i}var km=null;function my(i){i=i.previousSibling;for(var s=0;i;){if(i.nodeType===8){var l=i.data;if(l==="$"||l==="$!"||l==="$?"){if(s===0)return i;s--}else l==="/$"&&s++}i=i.previousSibling}return null}function py(i,s,l){switch(s=oh(l),i){case"html":if(i=s.documentElement,!i)throw Error(r(452));return i;case"head":if(i=s.head,!i)throw Error(r(453));return i;case"body":if(i=s.body,!i)throw Error(r(454));return i;default:throw Error(r(451))}}function Yu(i){for(var s=i.attributes;s.length;)i.removeAttributeNode(s[0]);L(i)}var Zr=new Map,gy=new Set;function lh(i){return typeof i.getRootNode=="function"?i.getRootNode():i.nodeType===9?i:i.ownerDocument}var xa=Re.d;Re.d={f:A4,r:S4,D:b4,C:R4,L:C4,m:I4,X:D4,S:N4,M:O4};function A4(){var i=xa.f(),s=Jf();return i||s}function S4(i){var s=G(i);s!==null&&s.tag===5&&s.type==="form"?kv(s):xa.r(i)}var yl=typeof document>"u"?null:document;function vy(i,s,l){var c=yl;if(c&&typeof s=="string"&&s){var p=cn(s);p='link[rel="'+i+'"][href="'+p+'"]',typeof l=="string"&&(p+='[crossorigin="'+l+'"]'),gy.has(p)||(gy.add(p),i={rel:i,crossOrigin:l,href:s},c.querySelector(p)===null&&(s=c.createElement("link"),Bn(s,"link",i),ne(s),c.head.appendChild(s)))}}function b4(i){xa.D(i),vy("dns-prefetch",i,null)}function R4(i,s){xa.C(i,s),vy("preconnect",i,s)}function C4(i,s,l){xa.L(i,s,l);var c=yl;if(c&&i&&s){var p='link[rel="preload"][as="'+cn(s)+'"]';s==="image"&&l&&l.imageSrcSet?(p+='[imagesrcset="'+cn(l.imageSrcSet)+'"]',typeof l.imageSizes=="string"&&(p+='[imagesizes="'+cn(l.imageSizes)+'"]')):p+='[href="'+cn(i)+'"]';var v=p;switch(s){case"style":v=xl(i);break;case"script":v=El(i)}Zr.has(v)||(i=g({rel:"preload",href:s==="image"&&l&&l.imageSrcSet?void 0:i,as:s},l),Zr.set(v,i),c.querySelector(p)!==null||s==="style"&&c.querySelector(Wu(v))||s==="script"&&c.querySelector(Ku(v))||(s=c.createElement("link"),Bn(s,"link",i),ne(s),c.head.appendChild(s)))}}function I4(i,s){xa.m(i,s);var l=yl;if(l&&i){var c=s&&typeof s.as=="string"?s.as:"script",p='link[rel="modulepreload"][as="'+cn(c)+'"][href="'+cn(i)+'"]',v=p;switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":v=El(i)}if(!Zr.has(v)&&(i=g({rel:"modulepreload",href:i},s),Zr.set(v,i),l.querySelector(p)===null)){switch(c){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(l.querySelector(Ku(v)))return}c=l.createElement("link"),Bn(c,"link",i),ne(c),l.head.appendChild(c)}}}function N4(i,s,l){xa.S(i,s,l);var c=yl;if(c&&i){var p=me(c).hoistableStyles,v=xl(i);s=s||"default";var S=p.get(v);if(!S){var D={loading:0,preload:null};if(S=c.querySelector(Wu(v)))D.loading=5;else{i=g({rel:"stylesheet",href:i,"data-precedence":s},l),(l=Zr.get(v))&&Lm(i,l);var Y=S=c.createElement("link");ne(Y),Bn(Y,"link",i),Y._p=new Promise(function(se,ye){Y.onload=se,Y.onerror=ye}),Y.addEventListener("load",function(){D.loading|=1}),Y.addEventListener("error",function(){D.loading|=2}),D.loading|=4,uh(S,s,c)}S={type:"stylesheet",instance:S,count:1,state:D},p.set(v,S)}}}function D4(i,s){xa.X(i,s);var l=yl;if(l&&i){var c=me(l).hoistableScripts,p=El(i),v=c.get(p);v||(v=l.querySelector(Ku(p)),v||(i=g({src:i,async:!0},s),(s=Zr.get(p))&&Vm(i,s),v=l.createElement("script"),ne(v),Bn(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(p,v))}}function O4(i,s){xa.M(i,s);var l=yl;if(l&&i){var c=me(l).hoistableScripts,p=El(i),v=c.get(p);v||(v=l.querySelector(Ku(p)),v||(i=g({src:i,async:!0,type:"module"},s),(s=Zr.get(p))&&Vm(i,s),v=l.createElement("script"),ne(v),Bn(v,"link",i),l.head.appendChild(v)),v={type:"script",instance:v,count:1,state:null},c.set(p,v))}}function _y(i,s,l,c){var p=(p=ce.current)?lh(p):null;if(!p)throw Error(r(446));switch(i){case"meta":case"title":return null;case"style":return typeof l.precedence=="string"&&typeof l.href=="string"?(s=xl(l.href),l=me(p).hoistableStyles,c=l.get(s),c||(c={type:"style",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};case"link":if(l.rel==="stylesheet"&&typeof l.href=="string"&&typeof l.precedence=="string"){i=xl(l.href);var v=me(p).hoistableStyles,S=v.get(i);if(S||(p=p.ownerDocument||p,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},v.set(i,S),(v=p.querySelector(Wu(i)))&&!v._p&&(S.instance=v,S.state.loading=5),Zr.has(i)||(l={rel:"preload",as:"style",href:l.href,crossOrigin:l.crossOrigin,integrity:l.integrity,media:l.media,hrefLang:l.hrefLang,referrerPolicy:l.referrerPolicy},Zr.set(i,l),v||F4(p,i,l,S.state))),s&&c===null)throw Error(r(528,""));return S}if(s&&c!==null)throw Error(r(529,""));return null;case"script":return s=l.async,l=l.src,typeof l=="string"&&s&&typeof s!="function"&&typeof s!="symbol"?(s=El(l),l=me(p).hoistableScripts,c=l.get(s),c||(c={type:"script",instance:null,count:0,state:null},l.set(s,c)),c):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,i))}}function xl(i){return'href="'+cn(i)+'"'}function Wu(i){return'link[rel="stylesheet"]['+i+"]"}function yy(i){return g({},i,{"data-precedence":i.precedence,precedence:null})}function F4(i,s,l,c){i.querySelector('link[rel="preload"][as="style"]['+s+"]")?c.loading=1:(s=i.createElement("link"),c.preload=s,s.addEventListener("load",function(){return c.loading|=1}),s.addEventListener("error",function(){return c.loading|=2}),Bn(s,"link",l),ne(s),i.head.appendChild(s))}function El(i){return'[src="'+cn(i)+'"]'}function Ku(i){return"script[async]"+i}function xy(i,s,l){if(s.count++,s.instance===null)switch(s.type){case"style":var c=i.querySelector('style[data-href~="'+cn(l.href)+'"]');if(c)return s.instance=c,ne(c),c;var p=g({},l,{"data-href":l.href,"data-precedence":l.precedence,href:null,precedence:null});return c=(i.ownerDocument||i).createElement("style"),ne(c),Bn(c,"style",p),uh(c,l.precedence,i),s.instance=c;case"stylesheet":p=xl(l.href);var v=i.querySelector(Wu(p));if(v)return s.state.loading|=4,s.instance=v,ne(v),v;c=yy(l),(p=Zr.get(p))&&Lm(c,p),v=(i.ownerDocument||i).createElement("link"),ne(v);var S=v;return S._p=new Promise(function(D,Y){S.onload=D,S.onerror=Y}),Bn(v,"link",c),s.state.loading|=4,uh(v,l.precedence,i),s.instance=v;case"script":return v=El(l.src),(p=i.querySelector(Ku(v)))?(s.instance=p,ne(p),p):(c=l,(p=Zr.get(v))&&(c=g({},l),Vm(c,p)),i=i.ownerDocument||i,p=i.createElement("script"),ne(p),Bn(p,"link",c),i.head.appendChild(p),s.instance=p);case"void":return null;default:throw Error(r(443,s.type))}else s.type==="stylesheet"&&(s.state.loading&4)===0&&(c=s.instance,s.state.loading|=4,uh(c,l.precedence,i));return s.instance}function uh(i,s,l){for(var c=l.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=c.length?c[c.length-1]:null,v=p,S=0;S<c.length;S++){var D=c[S];if(D.dataset.precedence===s)v=D;else if(v!==p)break}v?v.parentNode.insertBefore(i,v.nextSibling):(s=l.nodeType===9?l.head:l,s.insertBefore(i,s.firstChild))}function Lm(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.title==null&&(i.title=s.title)}function Vm(i,s){i.crossOrigin==null&&(i.crossOrigin=s.crossOrigin),i.referrerPolicy==null&&(i.referrerPolicy=s.referrerPolicy),i.integrity==null&&(i.integrity=s.integrity)}var ch=null;function Ey(i,s,l){if(ch===null){var c=new Map,p=ch=new Map;p.set(l,c)}else p=ch,c=p.get(l),c||(c=new Map,p.set(l,c));if(c.has(i))return c;for(c.set(i,null),l=l.getElementsByTagName(i),p=0;p<l.length;p++){var v=l[p];if(!(v[F]||v[an]||i==="link"&&v.getAttribute("rel")==="stylesheet")&&v.namespaceURI!=="http://www.w3.org/2000/svg"){var S=v.getAttribute(s)||"";S=i+S;var D=c.get(S);D?D.push(v):c.set(S,[v])}}return c}function Ty(i,s,l){i=i.ownerDocument||i,i.head.insertBefore(l,s==="title"?i.querySelector("head > title"):null)}function M4(i,s,l){if(l===1||s.itemProp!=null)return!1;switch(i){case"meta":case"title":return!0;case"style":if(typeof s.precedence!="string"||typeof s.href!="string"||s.href==="")break;return!0;case"link":if(typeof s.rel!="string"||typeof s.href!="string"||s.href===""||s.onLoad||s.onError)break;switch(s.rel){case"stylesheet":return i=s.disabled,typeof s.precedence=="string"&&i==null;default:return!0}case"script":if(s.async&&typeof s.async!="function"&&typeof s.async!="symbol"&&!s.onLoad&&!s.onError&&s.src&&typeof s.src=="string")return!0}return!1}function wy(i){return!(i.type==="stylesheet"&&(i.state.loading&3)===0)}var Qu=null;function P4(){}function k4(i,s,l){if(Qu===null)throw Error(r(475));var c=Qu;if(s.type==="stylesheet"&&(typeof l.media!="string"||matchMedia(l.media).matches!==!1)&&(s.state.loading&4)===0){if(s.instance===null){var p=xl(l.href),v=i.querySelector(Wu(p));if(v){i=v._p,i!==null&&typeof i=="object"&&typeof i.then=="function"&&(c.count++,c=fh.bind(c),i.then(c,c)),s.state.loading|=4,s.instance=v,ne(v);return}v=i.ownerDocument||i,l=yy(l),(p=Zr.get(p))&&Lm(l,p),v=v.createElement("link"),ne(v);var S=v;S._p=new Promise(function(D,Y){S.onload=D,S.onerror=Y}),Bn(v,"link",l),s.instance=v}c.stylesheets===null&&(c.stylesheets=new Map),c.stylesheets.set(s,i),(i=s.state.preload)&&(s.state.loading&3)===0&&(c.count++,s=fh.bind(c),i.addEventListener("load",s),i.addEventListener("error",s))}}function L4(){if(Qu===null)throw Error(r(475));var i=Qu;return i.stylesheets&&i.count===0&&Bm(i,i.stylesheets),0<i.count?function(s){var l=setTimeout(function(){if(i.stylesheets&&Bm(i,i.stylesheets),i.unsuspend){var c=i.unsuspend;i.unsuspend=null,c()}},6e4);return i.unsuspend=s,function(){i.unsuspend=null,clearTimeout(l)}}:null}function fh(){if(this.count--,this.count===0){if(this.stylesheets)Bm(this,this.stylesheets);else if(this.unsuspend){var i=this.unsuspend;this.unsuspend=null,i()}}}var hh=null;function Bm(i,s){i.stylesheets=null,i.unsuspend!==null&&(i.count++,hh=new Map,s.forEach(V4,i),hh=null,fh.call(i))}function V4(i,s){if(!(s.state.loading&4)){var l=hh.get(i);if(l)var c=l.get(null);else{l=new Map,hh.set(i,l);for(var p=i.querySelectorAll("link[data-precedence],style[data-precedence]"),v=0;v<p.length;v++){var S=p[v];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(l.set(S.dataset.precedence,S),c=S)}c&&l.set(null,c)}p=s.instance,S=p.getAttribute("data-precedence"),v=l.get(S)||c,v===c&&l.set(null,p),l.set(S,p),this.count++,c=fh.bind(this),p.addEventListener("load",c),p.addEventListener("error",c),v?v.parentNode.insertBefore(p,v.nextSibling):(i=i.nodeType===9?i.head:i,i.insertBefore(p,i.firstChild)),s.state.loading|=4}}var Zu={$$typeof:X,Provider:null,Consumer:null,_currentValue:ze,_currentValue2:ze,_threadCount:0};function B4(i,s,l,c,p,v,S,D){this.tag=1,this.containerInfo=i,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=ai(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ai(0),this.hiddenUpdates=ai(null),this.identifierPrefix=c,this.onUncaughtError=p,this.onCaughtError=v,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=D,this.incompleteTransitions=new Map}function Ay(i,s,l,c,p,v,S,D,Y,se,ye,Te){return i=new B4(i,s,l,S,D,Y,se,Te),s=1,v===!0&&(s|=24),v=Nr(3,null,null,s),i.current=v,v.stateNode=i,s=xd(),s.refCount++,i.pooledCache=s,s.refCount++,v.memoizedState={element:c,isDehydrated:l,cache:s},Ad(v),i}function Sy(i){return i?(i=Zo,i):Zo}function by(i,s,l,c,p,v){p=Sy(p),c.context===null?c.context=p:c.pendingContext=p,c=Ga(s),c.payload={element:l},v=v===void 0?null:v,v!==null&&(c.callback=v),l=qa(i,c,s),l!==null&&(Pr(l,i,s),Cu(l,i,s))}function Ry(i,s){if(i=i.memoizedState,i!==null&&i.dehydrated!==null){var l=i.retryLane;i.retryLane=l!==0&&l<s?l:s}}function Um(i,s){Ry(i,s),(i=i.alternate)&&Ry(i,s)}function Cy(i){if(i.tag===13){var s=Qo(i,67108864);s!==null&&Pr(s,i,67108864),Um(i,67108864)}}var dh=!0;function U4(i,s,l,c){var p=de.T;de.T=null;var v=Re.p;try{Re.p=2,jm(i,s,l,c)}finally{Re.p=v,de.T=p}}function j4(i,s,l,c){var p=de.T;de.T=null;var v=Re.p;try{Re.p=8,jm(i,s,l,c)}finally{Re.p=v,de.T=p}}function jm(i,s,l,c){if(dh){var p=zm(c);if(p===null)Cm(i,s,c,mh,l),Ny(i,c);else if(H4(p,i,s,l,c))c.stopPropagation();else if(Ny(i,c),s&4&&-1<z4.indexOf(i)){for(;p!==null;){var v=G(p);if(v!==null)switch(v.tag){case 3:if(v=v.stateNode,v.current.memoizedState.isDehydrated){var S=gr(v.pendingLanes);if(S!==0){var D=v;for(D.pendingLanes|=2,D.entangledLanes|=2;S;){var Y=1<<31-bn(S);D.entanglements[1]|=Y,S&=~Y}Vi(v),(Ct&6)===0&&(Qf=Ve()+500,qu(0))}}break;case 13:D=Qo(v,2),D!==null&&Pr(D,v,2),Jf(),Um(v,2)}if(v=zm(c),v===null&&Cm(i,s,c,mh,l),v===p)break;p=v}p!==null&&c.stopPropagation()}else Cm(i,s,c,null,l)}}function zm(i){return i=Hr(i),Hm(i)}var mh=null;function Hm(i){if(mh=null,i=j(i),i!==null){var s=o(i);if(s===null)i=null;else{var l=s.tag;if(l===13){if(i=u(s),i!==null)return i;i=null}else if(l===3){if(s.stateNode.current.memoizedState.isDehydrated)return s.tag===3?s.stateNode.containerInfo:null;i=null}else s!==i&&(i=null)}}return mh=i,null}function Iy(i){switch(i){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Wn()){case ar:return 2;case mr:return 8;case pr:case Mo:return 32;case _i:return 268435456;default:return 32}default:return 32}}var Gm=!1,is=null,as=null,ss=null,Ju=new Map,ec=new Map,os=[],z4="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Ny(i,s){switch(i){case"focusin":case"focusout":is=null;break;case"dragenter":case"dragleave":as=null;break;case"mouseover":case"mouseout":ss=null;break;case"pointerover":case"pointerout":Ju.delete(s.pointerId);break;case"gotpointercapture":case"lostpointercapture":ec.delete(s.pointerId)}}function tc(i,s,l,c,p,v){return i===null||i.nativeEvent!==v?(i={blockedOn:s,domEventName:l,eventSystemFlags:c,nativeEvent:v,targetContainers:[p]},s!==null&&(s=G(s),s!==null&&Cy(s)),i):(i.eventSystemFlags|=c,s=i.targetContainers,p!==null&&s.indexOf(p)===-1&&s.push(p),i)}function H4(i,s,l,c,p){switch(s){case"focusin":return is=tc(is,i,s,l,c,p),!0;case"dragenter":return as=tc(as,i,s,l,c,p),!0;case"mouseover":return ss=tc(ss,i,s,l,c,p),!0;case"pointerover":var v=p.pointerId;return Ju.set(v,tc(Ju.get(v)||null,i,s,l,c,p)),!0;case"gotpointercapture":return v=p.pointerId,ec.set(v,tc(ec.get(v)||null,i,s,l,c,p)),!0}return!1}function Dy(i){var s=j(i.target);if(s!==null){var l=o(s);if(l!==null){if(s=l.tag,s===13){if(s=u(l),s!==null){i.blockedOn=s,ko(i.priority,function(){if(l.tag===13){var c=Mr();c=wi(c);var p=Qo(l,c);p!==null&&Pr(p,l,c),Um(l,c)}});return}}else if(s===3&&l.stateNode.current.memoizedState.isDehydrated){i.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}i.blockedOn=null}function ph(i){if(i.blockedOn!==null)return!1;for(var s=i.targetContainers;0<s.length;){var l=zm(i.nativeEvent);if(l===null){l=i.nativeEvent;var c=new l.constructor(l.type,l);na=c,l.target.dispatchEvent(c),na=null}else return s=G(l),s!==null&&Cy(s),i.blockedOn=l,!1;s.shift()}return!0}function Oy(i,s,l){ph(i)&&l.delete(s)}function G4(){Gm=!1,is!==null&&ph(is)&&(is=null),as!==null&&ph(as)&&(as=null),ss!==null&&ph(ss)&&(ss=null),Ju.forEach(Oy),ec.forEach(Oy)}function gh(i,s){i.blockedOn===s&&(i.blockedOn=null,Gm||(Gm=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,G4)))}var vh=null;function Fy(i){vh!==i&&(vh=i,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){vh===i&&(vh=null);for(var s=0;s<i.length;s+=3){var l=i[s],c=i[s+1],p=i[s+2];if(typeof c!="function"){if(Hm(c||l)===null)continue;break}var v=G(l);v!==null&&(i.splice(s,3),s-=3,Hd(v,{pending:!0,data:p,method:l.method,action:c},c,p))}}))}function nc(i){function s(Y){return gh(Y,i)}is!==null&&gh(is,i),as!==null&&gh(as,i),ss!==null&&gh(ss,i),Ju.forEach(s),ec.forEach(s);for(var l=0;l<os.length;l++){var c=os[l];c.blockedOn===i&&(c.blockedOn=null)}for(;0<os.length&&(l=os[0],l.blockedOn===null);)Dy(l),l.blockedOn===null&&os.shift();if(l=(i.ownerDocument||i).$$reactFormReplay,l!=null)for(c=0;c<l.length;c+=3){var p=l[c],v=l[c+1],S=p[Xt]||null;if(typeof v=="function")S||Fy(l);else if(S){var D=null;if(v&&v.hasAttribute("formAction")){if(p=v,S=v[Xt]||null)D=S.formAction;else if(Hm(p)!==null)continue}else D=S.action;typeof D=="function"?l[c+1]=D:(l.splice(c,3),c-=3),Fy(l)}}}function qm(i){this._internalRoot=i}_h.prototype.render=qm.prototype.render=function(i){var s=this._internalRoot;if(s===null)throw Error(r(409));var l=s.current,c=Mr();by(l,c,i,s,null,null)},_h.prototype.unmount=qm.prototype.unmount=function(){var i=this._internalRoot;if(i!==null){this._internalRoot=null;var s=i.containerInfo;by(i.current,2,null,i,null,null),Jf(),s[vr]=null}};function _h(i){this._internalRoot=i}_h.prototype.unstable_scheduleHydration=function(i){if(i){var s=Ai();i={blockedOn:null,target:i,priority:s};for(var l=0;l<os.length&&s!==0&&s<os[l].priority;l++);os.splice(l,0,i),l===0&&Dy(i)}};var My=e.version;if(My!=="19.1.0")throw Error(r(527,My,"19.1.0"));Re.findDOMNode=function(i){var s=i._reactInternals;if(s===void 0)throw typeof i.render=="function"?Error(r(188)):(i=Object.keys(i).join(","),Error(r(268,i)));return i=h(s),i=i!==null?m(i):null,i=i===null?null:i.stateNode,i};var q4={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:de,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var yh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!yh.isDisabled&&yh.supportsFiber)try{zt=yh.inject(q4),xt=yh}catch{}}return ic.createRoot=function(i,s){if(!a(i))throw Error(r(299));var l=!1,c="",p=Kv,v=Qv,S=Zv,D=null;return s!=null&&(s.unstable_strictMode===!0&&(l=!0),s.identifierPrefix!==void 0&&(c=s.identifierPrefix),s.onUncaughtError!==void 0&&(p=s.onUncaughtError),s.onCaughtError!==void 0&&(v=s.onCaughtError),s.onRecoverableError!==void 0&&(S=s.onRecoverableError),s.unstable_transitionCallbacks!==void 0&&(D=s.unstable_transitionCallbacks)),s=Ay(i,1,!1,null,null,l,c,p,v,S,D,null),i[vr]=s.current,Rm(i),new qm(s)},ic.hydrateRoot=function(i,s,l){if(!a(i))throw Error(r(299));var c=!1,p="",v=Kv,S=Qv,D=Zv,Y=null,se=null;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(p=l.identifierPrefix),l.onUncaughtError!==void 0&&(v=l.onUncaughtError),l.onCaughtError!==void 0&&(S=l.onCaughtError),l.onRecoverableError!==void 0&&(D=l.onRecoverableError),l.unstable_transitionCallbacks!==void 0&&(Y=l.unstable_transitionCallbacks),l.formState!==void 0&&(se=l.formState)),s=Ay(i,1,!0,s,l??null,c,p,v,S,D,Y,se),s.context=Sy(null),l=s.current,c=Mr(),c=wi(c),p=Ga(c),p.callback=null,qa(l,p,c),l=c,s.current.lanes=l,si(s,l),Vi(s),i[vr]=s.current,Rm(i),new _h(s)},ic.version="19.1.0",ic}var Gy;function tb(){if(Gy)return Ym.exports;Gy=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),Ym.exports=eb(),Ym.exports}var nb=tb(),ac={},qy;function rb(){if(qy)return ac;qy=1,Object.defineProperty(ac,"__esModule",{value:!0}),ac.parse=u,ac.serialize=m;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,a=Object.prototype.toString,o=(()=>{const _=function(){};return _.prototype=Object.create(null),_})();function u(_,E){const w=new o,T=_.length;if(T<2)return w;const b=E?.decode||g;let k=0;do{const q=_.indexOf("=",k);if(q===-1)break;const X=_.indexOf(";",k),ee=X===-1?T:X;if(q>ee){k=_.lastIndexOf(";",q-1)+1;continue}const he=f(_,k,q),Ae=h(_,q,he),N=_.slice(he,Ae);if(w[N]===void 0){let I=f(_,q+1,ee),R=h(_,ee,I);const M=b(_.slice(I,R));w[N]=M}k=ee+1}while(k<T);return w}function f(_,E,w){do{const T=_.charCodeAt(E);if(T!==32&&T!==9)return E}while(++E<w);return w}function h(_,E,w){for(;E>w;){const T=_.charCodeAt(--E);if(T!==32&&T!==9)return E+1}return w}function m(_,E,w){const T=w?.encode||encodeURIComponent;if(!t.test(_))throw new TypeError(`argument name is invalid: ${_}`);const b=T(E);if(!e.test(b))throw new TypeError(`argument val is invalid: ${E}`);let k=_+"="+b;if(!w)return k;if(w.maxAge!==void 0){if(!Number.isInteger(w.maxAge))throw new TypeError(`option maxAge is invalid: ${w.maxAge}`);k+="; Max-Age="+w.maxAge}if(w.domain){if(!n.test(w.domain))throw new TypeError(`option domain is invalid: ${w.domain}`);k+="; Domain="+w.domain}if(w.path){if(!r.test(w.path))throw new TypeError(`option path is invalid: ${w.path}`);k+="; Path="+w.path}if(w.expires){if(!y(w.expires)||!Number.isFinite(w.expires.valueOf()))throw new TypeError(`option expires is invalid: ${w.expires}`);k+="; Expires="+w.expires.toUTCString()}if(w.httpOnly&&(k+="; HttpOnly"),w.secure&&(k+="; Secure"),w.partitioned&&(k+="; Partitioned"),w.priority)switch(typeof w.priority=="string"?w.priority.toLowerCase():void 0){case"low":k+="; Priority=Low";break;case"medium":k+="; Priority=Medium";break;case"high":k+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${w.priority}`)}if(w.sameSite)switch(typeof w.sameSite=="string"?w.sameSite.toLowerCase():w.sameSite){case!0:case"strict":k+="; SameSite=Strict";break;case"lax":k+="; SameSite=Lax";break;case"none":k+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${w.sameSite}`)}return k}function g(_){if(_.indexOf("%")===-1)return _;try{return decodeURIComponent(_)}catch{return _}}function y(_){return a.call(_)==="[object Date]"}return ac}rb();var $y="popstate";function ib(t={}){function e(r,a){let{pathname:o,search:u,hash:f}=r.location;return Tp("",{pathname:o,search:u,hash:f},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function n(r,a){return typeof a=="string"?a:Sc(a)}return sb(e,n,null,t)}function Qt(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Yi(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function ab(){return Math.random().toString(36).substring(2,10)}function Xy(t,e){return{usr:t.state,key:t.key,idx:e}}function Tp(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?Wl(e):e,state:n,key:e&&e.key||r||ab()}}function Sc({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Wl(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function sb(t,e,n,r={}){let{window:a=document.defaultView,v5Compat:o=!1}=r,u=a.history,f="POP",h=null,m=g();m==null&&(m=0,u.replaceState({...u.state,idx:m},""));function g(){return(u.state||{idx:null}).idx}function y(){f="POP";let b=g(),k=b==null?null:b-m;m=b,h&&h({action:f,location:T.location,delta:k})}function _(b,k){f="PUSH";let q=Tp(T.location,b,k);m=g()+1;let X=Xy(q,m),ee=T.createHref(q);try{u.pushState(X,"",ee)}catch(he){if(he instanceof DOMException&&he.name==="DataCloneError")throw he;a.location.assign(ee)}o&&h&&h({action:f,location:T.location,delta:1})}function E(b,k){f="REPLACE";let q=Tp(T.location,b,k);m=g();let X=Xy(q,m),ee=T.createHref(q);u.replaceState(X,"",ee),o&&h&&h({action:f,location:T.location,delta:0})}function w(b){return ob(b)}let T={get action(){return f},get location(){return t(a,u)},listen(b){if(h)throw new Error("A history only accepts one active listener");return a.addEventListener($y,y),h=b,()=>{a.removeEventListener($y,y),h=null}},createHref(b){return e(a,b)},createURL:w,encodeLocation(b){let k=w(b);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:_,replace:E,go(b){return u.go(b)}};return T}function ob(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Qt(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:Sc(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function hE(t,e,n="/"){return lb(t,e,n,!1)}function lb(t,e,n,r){let a=typeof e=="string"?Wl(e):e,o=ba(a.pathname||"/",n);if(o==null)return null;let u=dE(t);ub(u);let f=null;for(let h=0;f==null&&h<u.length;++h){let m=Eb(o);f=yb(u[h],m,r)}return f}function dE(t,e=[],n=[],r=""){let a=(o,u,f)=>{let h={relativePath:f===void 0?o.path||"":f,caseSensitive:o.caseSensitive===!0,childrenIndex:u,route:o};h.relativePath.startsWith("/")&&(Qt(h.relativePath.startsWith(r),`Absolute route path "${h.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),h.relativePath=h.relativePath.slice(r.length));let m=Ea([r,h.relativePath]),g=n.concat(h);o.children&&o.children.length>0&&(Qt(o.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${m}".`),dE(o.children,e,g,m)),!(o.path==null&&!o.index)&&e.push({path:m,score:vb(m,o.index),routesMeta:g})};return t.forEach((o,u)=>{if(o.path===""||!o.path?.includes("?"))a(o,u);else for(let f of mE(o.path))a(o,u,f)}),e}function mE(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,a=n.endsWith("?"),o=n.replace(/\?$/,"");if(r.length===0)return a?[o,""]:[o];let u=mE(r.join("/")),f=[];return f.push(...u.map(h=>h===""?o:[o,h].join("/"))),a&&f.push(...u),f.map(h=>t.startsWith("/")&&h===""?"/":h)}function ub(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:_b(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var cb=/^:[\w-]+$/,fb=3,hb=2,mb=1,pb=10,gb=-2,Yy=t=>t==="*";function vb(t,e){let n=t.split("/"),r=n.length;return n.some(Yy)&&(r+=gb),e&&(r+=hb),n.filter(a=>!Yy(a)).reduce((a,o)=>a+(cb.test(o)?fb:o===""?mb:pb),r)}function _b(t,e){return t.length===e.length&&t.slice(0,-1).every((r,a)=>r===e[a])?t[t.length-1]-e[e.length-1]:0}function yb(t,e,n=!1){let{routesMeta:r}=t,a={},o="/",u=[];for(let f=0;f<r.length;++f){let h=r[f],m=f===r.length-1,g=o==="/"?e:e.slice(o.length)||"/",y=zh({path:h.relativePath,caseSensitive:h.caseSensitive,end:m},g),_=h.route;if(!y&&m&&n&&!r[r.length-1].route.index&&(y=zh({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},g)),!y)return null;Object.assign(a,y.params),u.push({params:a,pathname:Ea([o,y.pathname]),pathnameBase:Sb(Ea([o,y.pathnameBase])),route:_}),y.pathnameBase!=="/"&&(o=Ea([o,y.pathnameBase]))}return u}function zh(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=xb(t.path,t.caseSensitive,t.end),a=e.match(n);if(!a)return null;let o=a[0],u=o.replace(/(.)\/+$/,"$1"),f=a.slice(1);return{params:r.reduce((m,{paramName:g,isOptional:y},_)=>{if(g==="*"){let w=f[_]||"";u=o.slice(0,o.length-w.length).replace(/(.)\/+$/,"$1")}const E=f[_];return y&&!E?m[g]=void 0:m[g]=(E||"").replace(/%2F/g,"/"),m},{}),pathname:o,pathnameBase:u,pattern:t}}function xb(t,e=!1,n=!0){Yi(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],a="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(u,f,h)=>(r.push({paramName:f,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),a+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?a+="\\/*$":t!==""&&t!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,e?void 0:"i"),r]}function Eb(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Yi(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function ba(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function Tb(t,e="/"){let{pathname:n,search:r="",hash:a=""}=typeof t=="string"?Wl(t):t;return{pathname:n?n.startsWith("/")?n:wb(n,e):e,search:bb(r),hash:Rb(a)}}function wb(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(a=>{a===".."?n.length>1&&n.pop():a!=="."&&n.push(a)}),n.length>1?n.join("/"):"/"}function Zm(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function Ab(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function pE(t){let e=Ab(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function gE(t,e,n,r=!1){let a;typeof t=="string"?a=Wl(t):(a={...t},Qt(!a.pathname||!a.pathname.includes("?"),Zm("?","pathname","search",a)),Qt(!a.pathname||!a.pathname.includes("#"),Zm("#","pathname","hash",a)),Qt(!a.search||!a.search.includes("#"),Zm("#","search","hash",a)));let o=t===""||a.pathname==="",u=o?"/":a.pathname,f;if(u==null)f=n;else{let y=e.length-1;if(!r&&u.startsWith("..")){let _=u.split("/");for(;_[0]==="..";)_.shift(),y-=1;a.pathname=_.join("/")}f=y>=0?e[y]:"/"}let h=Tb(a,f),m=u&&u!=="/"&&u.endsWith("/"),g=(o||u===".")&&n.endsWith("/");return!h.pathname.endsWith("/")&&(m||g)&&(h.pathname+="/"),h}var Ea=t=>t.join("/").replace(/\/\/+/g,"/"),Sb=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),bb=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Rb=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Cb(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var vE=["POST","PUT","PATCH","DELETE"];new Set(vE);var Ib=["GET",...vE];new Set(Ib);var Kl=ve.createContext(null);Kl.displayName="DataRouter";var x0=ve.createContext(null);x0.displayName="DataRouterState";var _E=ve.createContext({isTransitioning:!1});_E.displayName="ViewTransition";var Nb=ve.createContext(new Map);Nb.displayName="Fetchers";var Db=ve.createContext(null);Db.displayName="Await";var Qi=ve.createContext(null);Qi.displayName="Navigation";var zc=ve.createContext(null);zc.displayName="Location";var Zi=ve.createContext({outlet:null,matches:[],isDataRoute:!1});Zi.displayName="Route";var Jp=ve.createContext(null);Jp.displayName="RouteError";function Ob(t,{relative:e}={}){Qt(Hc(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=ve.useContext(Qi),{hash:a,pathname:o,search:u}=Gc(t,{relative:e}),f=o;return n!=="/"&&(f=o==="/"?n:Ea([n,o])),r.createHref({pathname:f,search:u,hash:a})}function Hc(){return ve.useContext(zc)!=null}function Os(){return Qt(Hc(),"useLocation() may be used only in the context of a <Router> component."),ve.useContext(zc).location}var yE="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function xE(t){ve.useContext(Qi).static||ve.useLayoutEffect(t)}function Fb(){let{isDataRoute:t}=ve.useContext(Zi);return t?Xb():Mb()}function Mb(){Qt(Hc(),"useNavigate() may be used only in the context of a <Router> component.");let t=ve.useContext(Kl),{basename:e,navigator:n}=ve.useContext(Qi),{matches:r}=ve.useContext(Zi),{pathname:a}=Os(),o=JSON.stringify(pE(r)),u=ve.useRef(!1);return xE(()=>{u.current=!0}),ve.useCallback((h,m={})=>{if(Yi(u.current,yE),!u.current)return;if(typeof h=="number"){n.go(h);return}let g=gE(h,JSON.parse(o),a,m.relative==="path");t==null&&e!=="/"&&(g.pathname=g.pathname==="/"?e:Ea([e,g.pathname])),(m.replace?n.replace:n.push)(g,m.state,m)},[e,n,o,a,t])}ve.createContext(null);function Pb(){let{matches:t}=ve.useContext(Zi),e=t[t.length-1];return e?e.params:{}}function Gc(t,{relative:e}={}){let{matches:n}=ve.useContext(Zi),{pathname:r}=Os(),a=JSON.stringify(pE(n));return ve.useMemo(()=>gE(t,JSON.parse(a),r,e==="path"),[t,a,r,e])}function kb(t,e){return EE(t,e)}function EE(t,e,n,r){Qt(Hc(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:a}=ve.useContext(Qi),{matches:o}=ve.useContext(Zi),u=o[o.length-1],f=u?u.params:{},h=u?u.pathname:"/",m=u?u.pathnameBase:"/",g=u&&u.route;{let k=g&&g.path||"";TE(h,!g||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${h}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let y=Os(),_;if(e){let k=typeof e=="string"?Wl(e):e;Qt(m==="/"||k.pathname?.startsWith(m),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${m}" but pathname "${k.pathname}" was given in the \`location\` prop.`),_=k}else _=y;let E=_.pathname||"/",w=E;if(m!=="/"){let k=m.replace(/^\//,"").split("/");w="/"+E.replace(/^\//,"").split("/").slice(k.length).join("/")}let T=hE(t,{pathname:w});Yi(g||T!=null,`No routes matched location "${_.pathname}${_.search}${_.hash}" `),Yi(T==null||T[T.length-1].route.element!==void 0||T[T.length-1].route.Component!==void 0||T[T.length-1].route.lazy!==void 0,`Matched leaf route at location "${_.pathname}${_.search}${_.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let b=jb(T&&T.map(k=>Object.assign({},k,{params:Object.assign({},f,k.params),pathname:Ea([m,a.encodeLocation?a.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?m:Ea([m,a.encodeLocation?a.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),o,n,r);return e&&b?ve.createElement(zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",..._},navigationType:"POP"}},b):b}function Lb(){let t=$b(),e=Cb(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",a={padding:"0.5rem",backgroundColor:r},o={padding:"2px 4px",backgroundColor:r},u=null;return console.error("Error handled by React Router default ErrorBoundary:",t),u=ve.createElement(ve.Fragment,null,ve.createElement("p",null," Hey developer "),ve.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ve.createElement("code",{style:o},"ErrorBoundary")," or"," ",ve.createElement("code",{style:o},"errorElement")," prop on your route.")),ve.createElement(ve.Fragment,null,ve.createElement("h2",null,"Unexpected Application Error!"),ve.createElement("h3",{style:{fontStyle:"italic"}},e),n?ve.createElement("pre",{style:a},n):null,u)}var Vb=ve.createElement(Lb,null),Bb=class extends ve.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?ve.createElement(Zi.Provider,{value:this.props.routeContext},ve.createElement(Jp.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function Ub({routeContext:t,match:e,children:n}){let r=ve.useContext(Kl);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),ve.createElement(Zi.Provider,{value:t},n)}function jb(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let a=t,o=n?.errors;if(o!=null){let h=a.findIndex(m=>m.route.id&&o?.[m.route.id]!==void 0);Qt(h>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(o).join(",")}`),a=a.slice(0,Math.min(a.length,h+1))}let u=!1,f=-1;if(n)for(let h=0;h<a.length;h++){let m=a[h];if((m.route.HydrateFallback||m.route.hydrateFallbackElement)&&(f=h),m.route.id){let{loaderData:g,errors:y}=n,_=m.route.loader&&!g.hasOwnProperty(m.route.id)&&(!y||y[m.route.id]===void 0);if(m.route.lazy||_){u=!0,f>=0?a=a.slice(0,f+1):a=[a[0]];break}}}return a.reduceRight((h,m,g)=>{let y,_=!1,E=null,w=null;n&&(y=o&&m.route.id?o[m.route.id]:void 0,E=m.route.errorElement||Vb,u&&(f<0&&g===0?(TE("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),_=!0,w=null):f===g&&(_=!0,w=m.route.hydrateFallbackElement||null)));let T=e.concat(a.slice(0,g+1)),b=()=>{let k;return y?k=E:_?k=w:m.route.Component?k=ve.createElement(m.route.Component,null):m.route.element?k=m.route.element:k=h,ve.createElement(Ub,{match:m,routeContext:{outlet:h,matches:T,isDataRoute:n!=null},children:k})};return n&&(m.route.ErrorBoundary||m.route.errorElement||g===0)?ve.createElement(Bb,{location:n.location,revalidation:n.revalidation,component:E,error:y,children:b(),routeContext:{outlet:null,matches:T,isDataRoute:!0}}):b()},null)}function eg(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function zb(t){let e=ve.useContext(Kl);return Qt(e,eg(t)),e}function Hb(t){let e=ve.useContext(x0);return Qt(e,eg(t)),e}function Gb(t){let e=ve.useContext(Zi);return Qt(e,eg(t)),e}function tg(t){let e=Gb(t),n=e.matches[e.matches.length-1];return Qt(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function qb(){return tg("useRouteId")}function $b(){let t=ve.useContext(Jp),e=Hb("useRouteError"),n=tg("useRouteError");return t!==void 0?t:e.errors?.[n]}function Xb(){let{router:t}=zb("useNavigate"),e=tg("useNavigate"),n=ve.useRef(!1);return xE(()=>{n.current=!0}),ve.useCallback(async(a,o={})=>{Yi(n.current,yE),n.current&&(typeof a=="number"?t.navigate(a):await t.navigate(a,{fromRouteId:e,...o}))},[t,e])}var Wy={};function TE(t,e,n){!e&&!Wy[t]&&(Wy[t]=!0,Yi(!1,n))}ve.memo(Yb);function Yb({routes:t,future:e,state:n}){return EE(t,void 0,n,e)}function lc(t){Qt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function Wb({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:a,static:o=!1}){Qt(!Hc(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let u=t.replace(/^\/*/,"/"),f=ve.useMemo(()=>({basename:u,navigator:a,static:o,future:{}}),[u,a,o]);typeof n=="string"&&(n=Wl(n));let{pathname:h="/",search:m="",hash:g="",state:y=null,key:_="default"}=n,E=ve.useMemo(()=>{let w=ba(h,u);return w==null?null:{location:{pathname:w,search:m,hash:g,state:y,key:_},navigationType:r}},[u,h,m,g,y,_,r]);return Yi(E!=null,`<Router basename="${u}"> is not able to match the URL "${h}${m}${g}" because it does not start with the basename, so the <Router> won't render anything.`),E==null?null:ve.createElement(Qi.Provider,{value:f},ve.createElement(zc.Provider,{children:e,value:E}))}function Kb({children:t,location:e}){return kb(wp(t),e)}function wp(t,e=[]){let n=[];return ve.Children.forEach(t,(r,a)=>{if(!ve.isValidElement(r))return;let o=[...e,a];if(r.type===ve.Fragment){n.push.apply(n,wp(r.props.children,o));return}Qt(r.type===lc,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Qt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let u={id:r.props.id||o.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(u.children=wp(r.props.children,o)),n.push(u)}),n}var Mh="get",Ph="application/x-www-form-urlencoded";function E0(t){return t!=null&&typeof t.tagName=="string"}function Qb(t){return E0(t)&&t.tagName.toLowerCase()==="button"}function Zb(t){return E0(t)&&t.tagName.toLowerCase()==="form"}function Jb(t){return E0(t)&&t.tagName.toLowerCase()==="input"}function e3(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function t3(t,e){return t.button===0&&(!e||e==="_self")&&!e3(t)}var xh=null;function n3(){if(xh===null)try{new FormData(document.createElement("form"),0),xh=!1}catch{xh=!0}return xh}var r3=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Jm(t){return t!=null&&!r3.has(t)?(Yi(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Ph}"`),null):t}function i3(t,e){let n,r,a,o,u;if(Zb(t)){let f=t.getAttribute("action");r=f?ba(f,e):null,n=t.getAttribute("method")||Mh,a=Jm(t.getAttribute("enctype"))||Ph,o=new FormData(t)}else if(Qb(t)||Jb(t)&&(t.type==="submit"||t.type==="image")){let f=t.form;if(f==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||f.getAttribute("action");if(r=h?ba(h,e):null,n=t.getAttribute("formmethod")||f.getAttribute("method")||Mh,a=Jm(t.getAttribute("formenctype"))||Jm(f.getAttribute("enctype"))||Ph,o=new FormData(f,t),!n3()){let{name:m,type:g,value:y}=t;if(g==="image"){let _=m?`${m}.`:"";o.append(`${_}x`,"0"),o.append(`${_}y`,"0")}else m&&o.append(m,y)}}else{if(E0(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Mh,r=null,a=Ph,u=t}return o&&a==="text/plain"&&(u=o,o=void 0),{action:r,method:n.toLowerCase(),encType:a,formData:o,body:u}}function ng(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function a3(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function s3(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function o3(t,e,n){let r=await Promise.all(t.map(async a=>{let o=e.routes[a.route.id];if(o){let u=await a3(o,n);return u.links?u.links():[]}return[]}));return f3(r.flat(1).filter(s3).filter(a=>a.rel==="stylesheet"||a.rel==="preload").map(a=>a.rel==="stylesheet"?{...a,rel:"prefetch",as:"style"}:{...a,rel:"prefetch"}))}function Ky(t,e,n,r,a,o){let u=(h,m)=>n[m]?h.route.id!==n[m].route.id:!0,f=(h,m)=>n[m].pathname!==h.pathname||n[m].route.path?.endsWith("*")&&n[m].params["*"]!==h.params["*"];return o==="assets"?e.filter((h,m)=>u(h,m)||f(h,m)):o==="data"?e.filter((h,m)=>{let g=r.routes[h.route.id];if(!g||!g.hasLoader)return!1;if(u(h,m)||f(h,m))return!0;if(h.route.shouldRevalidate){let y=h.route.shouldRevalidate({currentUrl:new URL(a.pathname+a.search+a.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof y=="boolean")return y}return!0}):[]}function l3(t,e,{includeHydrateFallback:n}={}){return u3(t.map(r=>{let a=e.routes[r.route.id];if(!a)return[];let o=[a.module];return a.clientActionModule&&(o=o.concat(a.clientActionModule)),a.clientLoaderModule&&(o=o.concat(a.clientLoaderModule)),n&&a.hydrateFallbackModule&&(o=o.concat(a.hydrateFallbackModule)),a.imports&&(o=o.concat(a.imports)),o}).flat(1))}function u3(t){return[...new Set(t)]}function c3(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function f3(t,e){let n=new Set;return new Set(e),t.reduce((r,a)=>{let o=JSON.stringify(c3(a));return n.has(o)||(n.add(o),r.push({key:o,link:a})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var h3=new Set([100,101,204,205]);function d3(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&ba(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function wE(){let t=ve.useContext(Kl);return ng(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function m3(){let t=ve.useContext(x0);return ng(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var rg=ve.createContext(void 0);rg.displayName="FrameworkContext";function AE(){let t=ve.useContext(rg);return ng(t,"You must render this element inside a <HydratedRouter> element"),t}function p3(t,e){let n=ve.useContext(rg),[r,a]=ve.useState(!1),[o,u]=ve.useState(!1),{onFocus:f,onBlur:h,onMouseEnter:m,onMouseLeave:g,onTouchStart:y}=e,_=ve.useRef(null);ve.useEffect(()=>{if(t==="render"&&u(!0),t==="viewport"){let T=k=>{k.forEach(q=>{u(q.isIntersecting)})},b=new IntersectionObserver(T,{threshold:.5});return _.current&&b.observe(_.current),()=>{b.disconnect()}}},[t]),ve.useEffect(()=>{if(r){let T=setTimeout(()=>{u(!0)},100);return()=>{clearTimeout(T)}}},[r]);let E=()=>{a(!0)},w=()=>{a(!1),u(!1)};return n?t!=="intent"?[o,_,{}]:[o,_,{onFocus:sc(f,E),onBlur:sc(h,w),onMouseEnter:sc(m,E),onMouseLeave:sc(g,w),onTouchStart:sc(y,E)}]:[!1,_,{}]}function sc(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function g3({page:t,...e}){let{router:n}=wE(),r=ve.useMemo(()=>hE(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?ve.createElement(_3,{page:t,matches:r,...e}):null}function v3(t){let{manifest:e,routeModules:n}=AE(),[r,a]=ve.useState([]);return ve.useEffect(()=>{let o=!1;return o3(t,e,n).then(u=>{o||a(u)}),()=>{o=!0}},[t,e,n]),r}function _3({page:t,matches:e,...n}){let r=Os(),{manifest:a,routeModules:o}=AE(),{basename:u}=wE(),{loaderData:f,matches:h}=m3(),m=ve.useMemo(()=>Ky(t,e,h,a,r,"data"),[t,e,h,a,r]),g=ve.useMemo(()=>Ky(t,e,h,a,r,"assets"),[t,e,h,a,r]),y=ve.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let w=new Set,T=!1;if(e.forEach(k=>{let q=a.routes[k.route.id];!q||!q.hasLoader||(!m.some(X=>X.route.id===k.route.id)&&k.route.id in f&&o[k.route.id]?.shouldRevalidate||q.hasClientLoader?T=!0:w.add(k.route.id))}),w.size===0)return[];let b=d3(t,u);return T&&w.size>0&&b.searchParams.set("_routes",e.filter(k=>w.has(k.route.id)).map(k=>k.route.id).join(",")),[b.pathname+b.search]},[u,f,r,a,m,e,t,o]),_=ve.useMemo(()=>l3(g,a),[g,a]),E=v3(g);return ve.createElement(ve.Fragment,null,y.map(w=>ve.createElement("link",{key:w,rel:"prefetch",as:"fetch",href:w,...n})),_.map(w=>ve.createElement("link",{key:w,rel:"modulepreload",href:w,...n})),E.map(({key:w,link:T})=>ve.createElement("link",{key:w,...T})))}function y3(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var SE=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{SE&&(window.__reactRouterVersion="7.6.3")}catch{}function x3({basename:t,children:e,window:n}){let r=ve.useRef();r.current==null&&(r.current=ib({window:n,v5Compat:!0}));let a=r.current,[o,u]=ve.useState({action:a.action,location:a.location}),f=ve.useCallback(h=>{ve.startTransition(()=>u(h))},[u]);return ve.useLayoutEffect(()=>a.listen(f),[a,f]),ve.createElement(Wb,{basename:t,children:e,location:o.location,navigationType:o.action,navigator:a})}var bE=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Dl=ve.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:a,reloadDocument:o,replace:u,state:f,target:h,to:m,preventScrollReset:g,viewTransition:y,..._},E){let{basename:w}=ve.useContext(Qi),T=typeof m=="string"&&bE.test(m),b,k=!1;if(typeof m=="string"&&T&&(b=m,SE))try{let R=new URL(window.location.href),M=m.startsWith("//")?new URL(R.protocol+m):new URL(m),B=ba(M.pathname,w);M.origin===R.origin&&B!=null?m=B+M.search+M.hash:k=!0}catch{Yi(!1,`<Link to="${m}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let q=Ob(m,{relative:a}),[X,ee,he]=p3(r,_),Ae=A3(m,{replace:u,state:f,target:h,preventScrollReset:g,relative:a,viewTransition:y});function N(R){e&&e(R),R.defaultPrevented||Ae(R)}let I=ve.createElement("a",{..._,...he,href:b||q,onClick:k||o?e:N,ref:y3(E,ee),target:h,"data-discover":!T&&n==="render"?"true":void 0});return X&&!T?ve.createElement(ve.Fragment,null,I,ve.createElement(g3,{page:q})):I});Dl.displayName="Link";var E3=ve.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:a=!1,style:o,to:u,viewTransition:f,children:h,...m},g){let y=Gc(u,{relative:m.relative}),_=Os(),E=ve.useContext(x0),{navigator:w,basename:T}=ve.useContext(Qi),b=E!=null&&I3(y)&&f===!0,k=w.encodeLocation?w.encodeLocation(y).pathname:y.pathname,q=_.pathname,X=E&&E.navigation&&E.navigation.location?E.navigation.location.pathname:null;n||(q=q.toLowerCase(),X=X?X.toLowerCase():null,k=k.toLowerCase()),X&&T&&(X=ba(X,T)||X);const ee=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let he=q===k||!a&&q.startsWith(k)&&q.charAt(ee)==="/",Ae=X!=null&&(X===k||!a&&X.startsWith(k)&&X.charAt(k.length)==="/"),N={isActive:he,isPending:Ae,isTransitioning:b},I=he?e:void 0,R;typeof r=="function"?R=r(N):R=[r,he?"active":null,Ae?"pending":null,b?"transitioning":null].filter(Boolean).join(" ");let M=typeof o=="function"?o(N):o;return ve.createElement(Dl,{...m,"aria-current":I,className:R,ref:g,style:M,to:u,viewTransition:f},typeof h=="function"?h(N):h)});E3.displayName="NavLink";var T3=ve.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:a,state:o,method:u=Mh,action:f,onSubmit:h,relative:m,preventScrollReset:g,viewTransition:y,..._},E)=>{let w=R3(),T=C3(f,{relative:m}),b=u.toLowerCase()==="get"?"get":"post",k=typeof f=="string"&&bE.test(f),q=X=>{if(h&&h(X),X.defaultPrevented)return;X.preventDefault();let ee=X.nativeEvent.submitter,he=ee?.getAttribute("formmethod")||u;w(ee||X.currentTarget,{fetcherKey:e,method:he,navigate:n,replace:a,state:o,relative:m,preventScrollReset:g,viewTransition:y})};return ve.createElement("form",{ref:E,method:b,action:T,onSubmit:r?h:q,..._,"data-discover":!k&&t==="render"?"true":void 0})});T3.displayName="Form";function w3(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function RE(t){let e=ve.useContext(Kl);return Qt(e,w3(t)),e}function A3(t,{target:e,replace:n,state:r,preventScrollReset:a,relative:o,viewTransition:u}={}){let f=Fb(),h=Os(),m=Gc(t,{relative:o});return ve.useCallback(g=>{if(t3(g,e)){g.preventDefault();let y=n!==void 0?n:Sc(h)===Sc(m);f(t,{replace:y,state:r,preventScrollReset:a,relative:o,viewTransition:u})}},[h,f,m,n,r,e,t,a,o,u])}var S3=0,b3=()=>`__${String(++S3)}__`;function R3(){let{router:t}=RE("useSubmit"),{basename:e}=ve.useContext(Qi),n=qb();return ve.useCallback(async(r,a={})=>{let{action:o,method:u,encType:f,formData:h,body:m}=i3(r,e);if(a.navigate===!1){let g=a.fetcherKey||b3();await t.fetch(g,n,a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:m,formMethod:a.method||u,formEncType:a.encType||f,flushSync:a.flushSync})}else await t.navigate(a.action||o,{preventScrollReset:a.preventScrollReset,formData:h,body:m,formMethod:a.method||u,formEncType:a.encType||f,replace:a.replace,state:a.state,fromRouteId:n,flushSync:a.flushSync,viewTransition:a.viewTransition})},[t,e,n])}function C3(t,{relative:e}={}){let{basename:n}=ve.useContext(Qi),r=ve.useContext(Zi);Qt(r,"useFormAction must be used inside a RouteContext");let[a]=r.matches.slice(-1),o={...Gc(t||".",{relative:e})},u=Os();if(t==null){o.search=u.search;let f=new URLSearchParams(o.search),h=f.getAll("index");if(h.some(g=>g==="")){f.delete("index"),h.filter(y=>y).forEach(y=>f.append("index",y));let g=f.toString();o.search=g?`?${g}`:""}}return(!t||t===".")&&a.route.index&&(o.search=o.search?o.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(o.pathname=o.pathname==="/"?n:Ea([n,o.pathname])),Sc(o)}function I3(t,e={}){let n=ve.useContext(_E);Qt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=RE("useViewTransitionState"),a=Gc(t,{relative:e.relative});if(!n.isTransitioning)return!1;let o=ba(n.currentLocation.pathname,r)||n.currentLocation.pathname,u=ba(n.nextLocation.pathname,r)||n.nextLocation.pathname;return zh(a.pathname,u)!=null||zh(a.pathname,o)!=null}[...h3];/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const N3=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),D3=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,r)=>r?r.toUpperCase():n.toLowerCase()),Qy=t=>{const e=D3(t);return e.charAt(0).toUpperCase()+e.slice(1)},CE=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim(),O3=t=>{for(const e in t)if(e.startsWith("aria-")||e==="role"||e==="title")return!0};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var F3={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M3=ve.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:a="",children:o,iconNode:u,...f},h)=>ve.createElement("svg",{ref:h,...F3,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:CE("lucide",a),...!o&&!O3(f)&&{"aria-hidden":"true"},...f},[...u.map(([m,g])=>ve.createElement(m,g)),...Array.isArray(o)?o:[o]]));/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qc=(t,e)=>{const n=ve.forwardRef(({className:r,...a},o)=>ve.createElement(M3,{ref:o,iconNode:e,className:CE(`lucide-${N3(Qy(t))}`,`lucide-${t}`,r),...a}));return n.displayName=Qy(t),n};/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P3=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],k3=qc("copy",P3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L3=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Bl=qc("download",L3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V3=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],ig=qc("file-text",V3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B3=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],ag=qc("plus",B3);/**
 * @license lucide-react v0.525.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const U3=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],T0=qc("trash-2",U3),sg="/dra-invoice/logo.svg",j3=()=>{};var Zy={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IE=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let a=t.charCodeAt(r);a<128?e[n++]=a:a<2048?(e[n++]=a>>6|192,e[n++]=a&63|128):(a&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(a=65536+((a&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=a>>18|240,e[n++]=a>>12&63|128,e[n++]=a>>6&63|128,e[n++]=a&63|128):(e[n++]=a>>12|224,e[n++]=a>>6&63|128,e[n++]=a&63|128)}return e},z3=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const a=t[n++];if(a<128)e[r++]=String.fromCharCode(a);else if(a>191&&a<224){const o=t[n++];e[r++]=String.fromCharCode((a&31)<<6|o&63)}else if(a>239&&a<365){const o=t[n++],u=t[n++],f=t[n++],h=((a&7)<<18|(o&63)<<12|(u&63)<<6|f&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{const o=t[n++],u=t[n++];e[r++]=String.fromCharCode((a&15)<<12|(o&63)<<6|u&63)}}return e.join("")},NE={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let a=0;a<t.length;a+=3){const o=t[a],u=a+1<t.length,f=u?t[a+1]:0,h=a+2<t.length,m=h?t[a+2]:0,g=o>>2,y=(o&3)<<4|f>>4;let _=(f&15)<<2|m>>6,E=m&63;h||(E=64,u||(_=64)),r.push(n[g],n[y],n[_],n[E])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(IE(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):z3(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let a=0;a<t.length;){const o=n[t.charAt(a++)],f=a<t.length?n[t.charAt(a)]:0;++a;const m=a<t.length?n[t.charAt(a)]:64;++a;const y=a<t.length?n[t.charAt(a)]:64;if(++a,o==null||f==null||m==null||y==null)throw new H3;const _=o<<2|f>>4;if(r.push(_),m!==64){const E=f<<4&240|m>>2;if(r.push(E),y!==64){const w=m<<6&192|y;r.push(w)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class H3 extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const G3=function(t){const e=IE(t);return NE.encodeByteArray(e,!0)},Hh=function(t){return G3(t).replace(/\./g,"")},q3=function(t){try{return NE.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $3(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const X3=()=>$3().__FIREBASE_DEFAULTS__,Y3=()=>{if(typeof process>"u"||typeof Zy>"u")return;const t=Zy.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},W3=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&q3(t[1]);return e&&JSON.parse(e)},og=()=>{try{return j3()||X3()||Y3()||W3()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},K3=t=>{var e,n;return(n=(e=og())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},Q3=t=>{const e=K3(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},DE=()=>{var t;return(t=og())===null||t===void 0?void 0:t.config};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Z3{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function lg(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function J3(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eR(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",a=t.iat||0,o=t.sub||t.user_id;if(!o)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const u=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:a,exp:a+3600,auth_time:a,sub:o,user_id:o,firebase:{sign_in_provider:"custom",identities:{}}},t);return[Hh(JSON.stringify(n)),Hh(JSON.stringify(u)),""].join(".")}const mc={};function tR(){const t={prod:[],emulator:[]};for(const e of Object.keys(mc))mc[e]?t.emulator.push(e):t.prod.push(e);return t}function nR(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let Jy=!1;function rR(t,e){if(typeof window>"u"||typeof document>"u"||!lg(window.location.host)||mc[t]===e||mc[t]||Jy)return;mc[t]=e;function n(_){return`__firebase__banner__${_}`}const r="__firebase__banner",o=tR().prod.length>0;function u(){const _=document.getElementById(r);_&&_.remove()}function f(_){_.style.display="flex",_.style.background="#7faaf0",_.style.position="fixed",_.style.bottom="5px",_.style.left="5px",_.style.padding=".5em",_.style.borderRadius="5px",_.style.alignItems="center"}function h(_,E){_.setAttribute("width","24"),_.setAttribute("id",E),_.setAttribute("height","24"),_.setAttribute("viewBox","0 0 24 24"),_.setAttribute("fill","none"),_.style.marginLeft="-6px"}function m(){const _=document.createElement("span");return _.style.cursor="pointer",_.style.marginLeft="16px",_.style.fontSize="24px",_.innerHTML=" &times;",_.onclick=()=>{Jy=!0,u()},_}function g(_,E){_.setAttribute("id",E),_.innerText="Learn more",_.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",_.setAttribute("target","__blank"),_.style.paddingLeft="5px",_.style.textDecoration="underline"}function y(){const _=nR(r),E=n("text"),w=document.getElementById(E)||document.createElement("span"),T=n("learnmore"),b=document.getElementById(T)||document.createElement("a"),k=n("preprendIcon"),q=document.getElementById(k)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(_.created){const X=_.element;f(X),g(b,T);const ee=m();h(q,k),X.append(q,w,b,ee),document.body.appendChild(X)}o?(w.innerText="Preview backend disconnected.",q.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(q.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,w.innerText="Preview backend running in this workspace."),w.setAttribute("id",E)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",y):y()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function iR(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function aR(){var t;const e=(t=og())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function sR(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function oR(){return!aR()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function OE(){try{return typeof indexedDB=="object"}catch{return!1}}function FE(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",a=self.indexedDB.open(r);a.onsuccess=()=>{a.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},a.onupgradeneeded=()=>{n=!1},a.onerror=()=>{var o;e(((o=a.error)===null||o===void 0?void 0:o.message)||"")}}catch(n){e(n)}})}function lR(){return!(typeof navigator>"u"||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uR="FirebaseError";class Fs extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uR,Object.setPrototypeOf(this,Fs.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,w0.prototype.create)}}class w0{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},a=`${this.service}/${e}`,o=this.errors[e],u=o?cR(o,r):"Error",f=`${this.serviceName}: ${u} (${a}).`;return new Fs(a,f,r)}}function cR(t,e){return t.replace(fR,(n,r)=>{const a=e[r];return a!=null?String(a):`<${r}?>`})}const fR=/\{\$([^}]+)}/g;function Gh(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const a of n){if(!r.includes(a))return!1;const o=t[a],u=e[a];if(ex(o)&&ex(u)){if(!Gh(o,u))return!1}else if(o!==u)return!1}for(const a of r)if(!n.includes(a))return!1;return!0}function ex(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const hR=1e3,dR=2,mR=4*60*60*1e3,pR=.5;function tx(t,e=hR,n=dR){const r=e*Math.pow(n,t),a=Math.round(pR*r*(Math.random()-.5)*2);return Math.min(mR,r+a)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ys(t){return t&&t._delegate?t._delegate:t}class Ra{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const co="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class gR{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new Z3;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const a=this.getOrInitializeService({instanceIdentifier:n});a&&r.resolve(a)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e?.identifier),a=(n=e?.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(o){if(a)return null;throw o}else{if(a)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(_R(e))try{this.getOrInitializeService({instanceIdentifier:co})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const a=this.normalizeInstanceIdentifier(n);try{const o=this.getOrInitializeService({instanceIdentifier:a});r.resolve(o)}catch{}}}}clearInstance(e=co){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=co){return this.instances.has(e)}getOptions(e=co){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const a=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[o,u]of this.instancesDeferred.entries()){const f=this.normalizeInstanceIdentifier(o);r===f&&u.resolve(a)}return a}onInit(e,n){var r;const a=this.normalizeInstanceIdentifier(n),o=(r=this.onInitCallbacks.get(a))!==null&&r!==void 0?r:new Set;o.add(e),this.onInitCallbacks.set(a,o);const u=this.instances.get(a);return u&&e(u,a),()=>{o.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const a of r)try{a(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:vR(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=co){return this.component?this.component.multipleInstances?e:co:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function vR(t){return t===co?void 0:t}function _R(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yR{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new gR(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yt;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(yt||(yt={}));const xR={debug:yt.DEBUG,verbose:yt.VERBOSE,info:yt.INFO,warn:yt.WARN,error:yt.ERROR,silent:yt.SILENT},ER=yt.INFO,TR={[yt.DEBUG]:"log",[yt.VERBOSE]:"log",[yt.INFO]:"info",[yt.WARN]:"warn",[yt.ERROR]:"error"},wR=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),a=TR[e];if(a)console[a](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class ug{constructor(e){this.name=e,this._logLevel=ER,this._logHandler=wR,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in yt))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xR[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,yt.DEBUG,...e),this._logHandler(this,yt.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,yt.VERBOSE,...e),this._logHandler(this,yt.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,yt.INFO,...e),this._logHandler(this,yt.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,yt.WARN,...e),this._logHandler(this,yt.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,yt.ERROR,...e),this._logHandler(this,yt.ERROR,...e)}}const AR=(t,e)=>e.some(n=>t instanceof n);let nx,rx;function SR(){return nx||(nx=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function bR(){return rx||(rx=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const ME=new WeakMap,Ap=new WeakMap,PE=new WeakMap,ep=new WeakMap,cg=new WeakMap;function RR(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{n(ds(t.result)),a()},u=()=>{r(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&ME.set(n,t)}).catch(()=>{}),cg.set(e,t),e}function CR(t){if(Ap.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{n(),a()},u=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});Ap.set(t,e)}let Sp={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Ap.get(t);if(e==="objectStoreNames")return t.objectStoreNames||PE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ds(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function IR(t){Sp=t(Sp)}function NR(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(tp(this),e,...n);return PE.set(r,e.sort?e.sort():[e]),ds(r)}:bR().includes(t)?function(...e){return t.apply(tp(this),e),ds(ME.get(this))}:function(...e){return ds(t.apply(tp(this),e))}}function DR(t){return typeof t=="function"?NR(t):(t instanceof IDBTransaction&&CR(t),AR(t,SR())?new Proxy(t,Sp):t)}function ds(t){if(t instanceof IDBRequest)return RR(t);if(ep.has(t))return ep.get(t);const e=DR(t);return e!==t&&(ep.set(t,e),cg.set(e,t)),e}const tp=t=>cg.get(t);function OR(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const u=indexedDB.open(t,e),f=ds(u);return r&&u.addEventListener("upgradeneeded",h=>{r(ds(u.result),h.oldVersion,h.newVersion,ds(u.transaction),h)}),n&&u.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),f.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),f}const FR=["get","getKey","getAll","getAllKeys","count"],MR=["put","add","delete","clear"],np=new Map;function ix(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(np.get(e))return np.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=MR.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||FR.includes(n)))return;const o=async function(u,...f){const h=this.transaction(u,a?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(f.shift())),(await Promise.all([m[n](...f),a&&h.done]))[0]};return np.set(e,o),o}IR(t=>({...t,get:(e,n,r)=>ix(e,n)||t.get(e,n,r),has:(e,n)=>!!ix(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PR{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(kR(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function kR(t){const e=t.getComponent();return e?.type==="VERSION"}const bp="@firebase/app",ax="0.13.2";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ca=new ug("@firebase/app"),LR="@firebase/app-compat",VR="@firebase/analytics-compat",BR="@firebase/analytics",UR="@firebase/app-check-compat",jR="@firebase/app-check",zR="@firebase/auth",HR="@firebase/auth-compat",GR="@firebase/database",qR="@firebase/data-connect",$R="@firebase/database-compat",XR="@firebase/functions",YR="@firebase/functions-compat",WR="@firebase/installations",KR="@firebase/installations-compat",QR="@firebase/messaging",ZR="@firebase/messaging-compat",JR="@firebase/performance",eC="@firebase/performance-compat",tC="@firebase/remote-config",nC="@firebase/remote-config-compat",rC="@firebase/storage",iC="@firebase/storage-compat",aC="@firebase/firestore",sC="@firebase/ai",oC="@firebase/firestore-compat",lC="firebase",uC="11.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rp="[DEFAULT]",cC={[bp]:"fire-core",[LR]:"fire-core-compat",[BR]:"fire-analytics",[VR]:"fire-analytics-compat",[jR]:"fire-app-check",[UR]:"fire-app-check-compat",[zR]:"fire-auth",[HR]:"fire-auth-compat",[GR]:"fire-rtdb",[qR]:"fire-data-connect",[$R]:"fire-rtdb-compat",[XR]:"fire-fn",[YR]:"fire-fn-compat",[WR]:"fire-iid",[KR]:"fire-iid-compat",[QR]:"fire-fcm",[ZR]:"fire-fcm-compat",[JR]:"fire-perf",[eC]:"fire-perf-compat",[tC]:"fire-rc",[nC]:"fire-rc-compat",[rC]:"fire-gcs",[iC]:"fire-gcs-compat",[aC]:"fire-fst",[oC]:"fire-fst-compat",[sC]:"fire-vertex","fire-js":"fire-js",[lC]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qh=new Map,fC=new Map,Cp=new Map;function sx(t,e){try{t.container.addComponent(e)}catch(n){Ca.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function xs(t){const e=t.name;if(Cp.has(e))return Ca.debug(`There were multiple attempts to register component ${e}.`),!1;Cp.set(e,t);for(const n of qh.values())sx(n,t);for(const n of fC.values())sx(n,t);return!0}function fg(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function hC(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const dC={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},ms=new w0("app","Firebase",dC);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mC{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new Ra("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw ms.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pC=uC;function kE(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Rp,automaticDataCollectionEnabled:!0},e),a=r.name;if(typeof a!="string"||!a)throw ms.create("bad-app-name",{appName:String(a)});if(n||(n=DE()),!n)throw ms.create("no-options");const o=qh.get(a);if(o){if(Gh(n,o.options)&&Gh(r,o.config))return o;throw ms.create("duplicate-app",{appName:a})}const u=new yR(a);for(const h of Cp.values())u.addComponent(h);const f=new mC(n,r,u);return qh.set(a,f),f}function gC(t=Rp){const e=qh.get(t);if(!e&&t===Rp&&DE())return kE();if(!e)throw ms.create("no-app",{appName:t});return e}function zi(t,e,n){var r;let a=(r=cC[t])!==null&&r!==void 0?r:t;n&&(a+=`-${n}`);const o=a.match(/\s|\//),u=e.match(/\s|\//);if(o||u){const f=[`Unable to register library "${a}" with version "${e}":`];o&&f.push(`library name "${a}" contains illegal characters (whitespace or "/")`),o&&u&&f.push("and"),u&&f.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Ca.warn(f.join(" "));return}xs(new Ra(`${a}-version`,()=>({library:a,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vC="firebase-heartbeat-database",_C=1,bc="firebase-heartbeat-store";let rp=null;function LE(){return rp||(rp=OR(vC,_C,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(bc)}catch(n){console.warn(n)}}}}).catch(t=>{throw ms.create("idb-open",{originalErrorMessage:t.message})})),rp}async function yC(t){try{const n=(await LE()).transaction(bc),r=await n.objectStore(bc).get(VE(t));return await n.done,r}catch(e){if(e instanceof Fs)Ca.warn(e.message);else{const n=ms.create("idb-get",{originalErrorMessage:e?.message});Ca.warn(n.message)}}}async function ox(t,e){try{const r=(await LE()).transaction(bc,"readwrite");await r.objectStore(bc).put(e,VE(t)),await r.done}catch(n){if(n instanceof Fs)Ca.warn(n.message);else{const r=ms.create("idb-set",{originalErrorMessage:n?.message});Ca.warn(r.message)}}}function VE(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xC=1024,EC=30;class TC{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new AC(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const a=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),o=lx();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===o||this._heartbeatsCache.heartbeats.some(u=>u.date===o))return;if(this._heartbeatsCache.heartbeats.push({date:o,agent:a}),this._heartbeatsCache.heartbeats.length>EC){const u=SC(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){Ca.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=lx(),{heartbeatsToSend:r,unsentEntries:a}=wC(this._heartbeatsCache.heartbeats),o=Hh(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,a.length>0?(this._heartbeatsCache.heartbeats=a,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),o}catch(n){return Ca.warn(n),""}}}function lx(){return new Date().toISOString().substring(0,10)}function wC(t,e=xC){const n=[];let r=t.slice();for(const a of t){const o=n.find(u=>u.agent===a.agent);if(o){if(o.dates.push(a.date),ux(n)>e){o.dates.pop();break}}else if(n.push({agent:a.agent,dates:[a.date]}),ux(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class AC{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return OE()?FE().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await yC(this.app);return n?.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return ox(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const a=await this.read();return ox(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:a.lastSentHeartbeatDate,heartbeats:[...a.heartbeats,...e.heartbeats]})}else return}}function ux(t){return Hh(JSON.stringify({version:2,heartbeats:t})).length}function SC(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bC(t){xs(new Ra("platform-logger",e=>new PR(e),"PRIVATE")),xs(new Ra("heartbeat",e=>new TC(e),"PRIVATE")),zi(bp,ax,t),zi(bp,ax,"esm2017"),zi("fire-js","")}bC("");var cx=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var ps,BE;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(N,I){function R(){}R.prototype=I.prototype,N.D=I.prototype,N.prototype=new R,N.prototype.constructor=N,N.C=function(M,B,H){for(var V=Array(arguments.length-2),Je=2;Je<arguments.length;Je++)V[Je-2]=arguments[Je];return I.prototype[B].apply(M,V)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function a(N,I,R){R||(R=0);var M=Array(16);if(typeof I=="string")for(var B=0;16>B;++B)M[B]=I.charCodeAt(R++)|I.charCodeAt(R++)<<8|I.charCodeAt(R++)<<16|I.charCodeAt(R++)<<24;else for(B=0;16>B;++B)M[B]=I[R++]|I[R++]<<8|I[R++]<<16|I[R++]<<24;I=N.g[0],R=N.g[1],B=N.g[2];var H=N.g[3],V=I+(H^R&(B^H))+M[0]+3614090360&4294967295;I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+M[1]+3905402710&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+M[2]+606105819&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+M[3]+3250441966&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+M[4]+4118548399&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+M[5]+1200080426&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+M[6]+2821735955&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+M[7]+4249261313&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+M[8]+1770035416&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+M[9]+2336552879&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+M[10]+4294925233&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+M[11]+2304563134&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(H^R&(B^H))+M[12]+1804603682&4294967295,I=R+(V<<7&4294967295|V>>>25),V=H+(B^I&(R^B))+M[13]+4254626195&4294967295,H=I+(V<<12&4294967295|V>>>20),V=B+(R^H&(I^R))+M[14]+2792965006&4294967295,B=H+(V<<17&4294967295|V>>>15),V=R+(I^B&(H^I))+M[15]+1236535329&4294967295,R=B+(V<<22&4294967295|V>>>10),V=I+(B^H&(R^B))+M[1]+4129170786&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+M[6]+3225465664&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+M[11]+643717713&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+M[0]+3921069994&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+M[5]+3593408605&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+M[10]+38016083&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+M[15]+3634488961&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+M[4]+3889429448&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+M[9]+568446438&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+M[14]+3275163606&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+M[3]+4107603335&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+M[8]+1163531501&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(B^H&(R^B))+M[13]+2850285829&4294967295,I=R+(V<<5&4294967295|V>>>27),V=H+(R^B&(I^R))+M[2]+4243563512&4294967295,H=I+(V<<9&4294967295|V>>>23),V=B+(I^R&(H^I))+M[7]+1735328473&4294967295,B=H+(V<<14&4294967295|V>>>18),V=R+(H^I&(B^H))+M[12]+2368359562&4294967295,R=B+(V<<20&4294967295|V>>>12),V=I+(R^B^H)+M[5]+4294588738&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+M[8]+2272392833&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+M[11]+1839030562&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+M[14]+4259657740&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+M[1]+2763975236&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+M[4]+1272893353&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+M[7]+4139469664&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+M[10]+3200236656&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+M[13]+681279174&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+M[0]+3936430074&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+M[3]+3572445317&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+M[6]+76029189&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(R^B^H)+M[9]+3654602809&4294967295,I=R+(V<<4&4294967295|V>>>28),V=H+(I^R^B)+M[12]+3873151461&4294967295,H=I+(V<<11&4294967295|V>>>21),V=B+(H^I^R)+M[15]+530742520&4294967295,B=H+(V<<16&4294967295|V>>>16),V=R+(B^H^I)+M[2]+3299628645&4294967295,R=B+(V<<23&4294967295|V>>>9),V=I+(B^(R|~H))+M[0]+4096336452&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+M[7]+1126891415&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+M[14]+2878612391&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+M[5]+4237533241&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+M[12]+1700485571&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+M[3]+2399980690&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+M[10]+4293915773&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+M[1]+2240044497&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+M[8]+1873313359&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+M[15]+4264355552&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+M[6]+2734768916&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+M[13]+1309151649&4294967295,R=B+(V<<21&4294967295|V>>>11),V=I+(B^(R|~H))+M[4]+4149444226&4294967295,I=R+(V<<6&4294967295|V>>>26),V=H+(R^(I|~B))+M[11]+3174756917&4294967295,H=I+(V<<10&4294967295|V>>>22),V=B+(I^(H|~R))+M[2]+718787259&4294967295,B=H+(V<<15&4294967295|V>>>17),V=R+(H^(B|~I))+M[9]+3951481745&4294967295,N.g[0]=N.g[0]+I&4294967295,N.g[1]=N.g[1]+(B+(V<<21&4294967295|V>>>11))&4294967295,N.g[2]=N.g[2]+B&4294967295,N.g[3]=N.g[3]+H&4294967295}r.prototype.u=function(N,I){I===void 0&&(I=N.length);for(var R=I-this.blockSize,M=this.B,B=this.h,H=0;H<I;){if(B==0)for(;H<=R;)a(this,N,H),H+=this.blockSize;if(typeof N=="string"){for(;H<I;)if(M[B++]=N.charCodeAt(H++),B==this.blockSize){a(this,M),B=0;break}}else for(;H<I;)if(M[B++]=N[H++],B==this.blockSize){a(this,M),B=0;break}}this.h=B,this.o+=I},r.prototype.v=function(){var N=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);N[0]=128;for(var I=1;I<N.length-8;++I)N[I]=0;var R=8*this.o;for(I=N.length-8;I<N.length;++I)N[I]=R&255,R/=256;for(this.u(N),N=Array(16),I=R=0;4>I;++I)for(var M=0;32>M;M+=8)N[R++]=this.g[I]>>>M&255;return N};function o(N,I){var R=f;return Object.prototype.hasOwnProperty.call(R,N)?R[N]:R[N]=I(N)}function u(N,I){this.h=I;for(var R=[],M=!0,B=N.length-1;0<=B;B--){var H=N[B]|0;M&&H==I||(R[B]=H,M=!1)}this.g=R}var f={};function h(N){return-128<=N&&128>N?o(N,function(I){return new u([I|0],0>I?-1:0)}):new u([N|0],0>N?-1:0)}function m(N){if(isNaN(N)||!isFinite(N))return y;if(0>N)return b(m(-N));for(var I=[],R=1,M=0;N>=R;M++)I[M]=N/R|0,R*=4294967296;return new u(I,0)}function g(N,I){if(N.length==0)throw Error("number format error: empty string");if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(N.charAt(0)=="-")return b(g(N.substring(1),I));if(0<=N.indexOf("-"))throw Error('number format error: interior "-" character');for(var R=m(Math.pow(I,8)),M=y,B=0;B<N.length;B+=8){var H=Math.min(8,N.length-B),V=parseInt(N.substring(B,B+H),I);8>H?(H=m(Math.pow(I,H)),M=M.j(H).add(m(V))):(M=M.j(R),M=M.add(m(V)))}return M}var y=h(0),_=h(1),E=h(16777216);t=u.prototype,t.m=function(){if(T(this))return-b(this).m();for(var N=0,I=1,R=0;R<this.g.length;R++){var M=this.i(R);N+=(0<=M?M:4294967296+M)*I,I*=4294967296}return N},t.toString=function(N){if(N=N||10,2>N||36<N)throw Error("radix out of range: "+N);if(w(this))return"0";if(T(this))return"-"+b(this).toString(N);for(var I=m(Math.pow(N,6)),R=this,M="";;){var B=ee(R,I).g;R=k(R,B.j(I));var H=((0<R.g.length?R.g[0]:R.h)>>>0).toString(N);if(R=B,w(R))return H+M;for(;6>H.length;)H="0"+H;M=H+M}},t.i=function(N){return 0>N?0:N<this.g.length?this.g[N]:this.h};function w(N){if(N.h!=0)return!1;for(var I=0;I<N.g.length;I++)if(N.g[I]!=0)return!1;return!0}function T(N){return N.h==-1}t.l=function(N){return N=k(this,N),T(N)?-1:w(N)?0:1};function b(N){for(var I=N.g.length,R=[],M=0;M<I;M++)R[M]=~N.g[M];return new u(R,~N.h).add(_)}t.abs=function(){return T(this)?b(this):this},t.add=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],M=0,B=0;B<=I;B++){var H=M+(this.i(B)&65535)+(N.i(B)&65535),V=(H>>>16)+(this.i(B)>>>16)+(N.i(B)>>>16);M=V>>>16,H&=65535,V&=65535,R[B]=V<<16|H}return new u(R,R[R.length-1]&-2147483648?-1:0)};function k(N,I){return N.add(b(I))}t.j=function(N){if(w(this)||w(N))return y;if(T(this))return T(N)?b(this).j(b(N)):b(b(this).j(N));if(T(N))return b(this.j(b(N)));if(0>this.l(E)&&0>N.l(E))return m(this.m()*N.m());for(var I=this.g.length+N.g.length,R=[],M=0;M<2*I;M++)R[M]=0;for(M=0;M<this.g.length;M++)for(var B=0;B<N.g.length;B++){var H=this.i(M)>>>16,V=this.i(M)&65535,Je=N.i(B)>>>16,He=N.i(B)&65535;R[2*M+2*B]+=V*He,q(R,2*M+2*B),R[2*M+2*B+1]+=H*He,q(R,2*M+2*B+1),R[2*M+2*B+1]+=V*Je,q(R,2*M+2*B+1),R[2*M+2*B+2]+=H*Je,q(R,2*M+2*B+2)}for(M=0;M<I;M++)R[M]=R[2*M+1]<<16|R[2*M];for(M=I;M<2*I;M++)R[M]=0;return new u(R,0)};function q(N,I){for(;(N[I]&65535)!=N[I];)N[I+1]+=N[I]>>>16,N[I]&=65535,I++}function X(N,I){this.g=N,this.h=I}function ee(N,I){if(w(I))throw Error("division by zero");if(w(N))return new X(y,y);if(T(N))return I=ee(b(N),I),new X(b(I.g),b(I.h));if(T(I))return I=ee(N,b(I)),new X(b(I.g),I.h);if(30<N.g.length){if(T(N)||T(I))throw Error("slowDivide_ only works with positive integers.");for(var R=_,M=I;0>=M.l(N);)R=he(R),M=he(M);var B=Ae(R,1),H=Ae(M,1);for(M=Ae(M,2),R=Ae(R,2);!w(M);){var V=H.add(M);0>=V.l(N)&&(B=B.add(R),H=V),M=Ae(M,1),R=Ae(R,1)}return I=k(N,B.j(I)),new X(B,I)}for(B=y;0<=N.l(I);){for(R=Math.max(1,Math.floor(N.m()/I.m())),M=Math.ceil(Math.log(R)/Math.LN2),M=48>=M?1:Math.pow(2,M-48),H=m(R),V=H.j(I);T(V)||0<V.l(N);)R-=M,H=m(R),V=H.j(I);w(H)&&(H=_),B=B.add(H),N=k(N,V)}return new X(B,N)}t.A=function(N){return ee(this,N).h},t.and=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],M=0;M<I;M++)R[M]=this.i(M)&N.i(M);return new u(R,this.h&N.h)},t.or=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],M=0;M<I;M++)R[M]=this.i(M)|N.i(M);return new u(R,this.h|N.h)},t.xor=function(N){for(var I=Math.max(this.g.length,N.g.length),R=[],M=0;M<I;M++)R[M]=this.i(M)^N.i(M);return new u(R,this.h^N.h)};function he(N){for(var I=N.g.length+1,R=[],M=0;M<I;M++)R[M]=N.i(M)<<1|N.i(M-1)>>>31;return new u(R,N.h)}function Ae(N,I){var R=I>>5;I%=32;for(var M=N.g.length-R,B=[],H=0;H<M;H++)B[H]=0<I?N.i(H+R)>>>I|N.i(H+R+1)<<32-I:N.i(H+R);return new u(B,N.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,BE=r,u.prototype.add=u.prototype.add,u.prototype.multiply=u.prototype.j,u.prototype.modulo=u.prototype.A,u.prototype.compare=u.prototype.l,u.prototype.toNumber=u.prototype.m,u.prototype.toString=u.prototype.toString,u.prototype.getBits=u.prototype.i,u.fromNumber=m,u.fromString=g,ps=u}).apply(typeof cx<"u"?cx:typeof self<"u"?self:typeof window<"u"?window:{});var Eh=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var UE,uc,jE,kh,Ip,zE,HE,GE;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(d,x,A){return d==Array.prototype||d==Object.prototype||(d[x]=A.value),d};function n(d){d=[typeof globalThis=="object"&&globalThis,d,typeof window=="object"&&window,typeof self=="object"&&self,typeof Eh=="object"&&Eh];for(var x=0;x<d.length;++x){var A=d[x];if(A&&A.Math==Math)return A}throw Error("Cannot find global object")}var r=n(this);function a(d,x){if(x)e:{var A=r;d=d.split(".");for(var O=0;O<d.length-1;O++){var re=d[O];if(!(re in A))break e;A=A[re]}d=d[d.length-1],O=A[d],x=x(O),x!=O&&x!=null&&e(A,d,{configurable:!0,writable:!0,value:x})}}function o(d,x){d instanceof String&&(d+="");var A=0,O=!1,re={next:function(){if(!O&&A<d.length){var pe=A++;return{value:x(pe,d[pe]),done:!1}}return O=!0,{done:!0,value:void 0}}};return re[Symbol.iterator]=function(){return re},re}a("Array.prototype.values",function(d){return d||function(){return o(this,function(x,A){return A})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var u=u||{},f=this||self;function h(d){var x=typeof d;return x=x!="object"?x:d?Array.isArray(d)?"array":x:"null",x=="array"||x=="object"&&typeof d.length=="number"}function m(d){var x=typeof d;return x=="object"&&d!=null||x=="function"}function g(d,x,A){return d.call.apply(d.bind,arguments)}function y(d,x,A){if(!d)throw Error();if(2<arguments.length){var O=Array.prototype.slice.call(arguments,2);return function(){var re=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(re,O),d.apply(x,re)}}return function(){return d.apply(x,arguments)}}function _(d,x,A){return _=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?g:y,_.apply(null,arguments)}function E(d,x){var A=Array.prototype.slice.call(arguments,1);return function(){var O=A.slice();return O.push.apply(O,arguments),d.apply(this,O)}}function w(d,x){function A(){}A.prototype=x.prototype,d.aa=x.prototype,d.prototype=new A,d.prototype.constructor=d,d.Qb=function(O,re,pe){for(var De=Array(arguments.length-2),pt=2;pt<arguments.length;pt++)De[pt-2]=arguments[pt];return x.prototype[re].apply(O,De)}}function T(d){const x=d.length;if(0<x){const A=Array(x);for(let O=0;O<x;O++)A[O]=d[O];return A}return[]}function b(d,x){for(let A=1;A<arguments.length;A++){const O=arguments[A];if(h(O)){const re=d.length||0,pe=O.length||0;d.length=re+pe;for(let De=0;De<pe;De++)d[re+De]=O[De]}else d.push(O)}}class k{constructor(x,A){this.i=x,this.j=A,this.h=0,this.g=null}get(){let x;return 0<this.h?(this.h--,x=this.g,this.g=x.next,x.next=null):x=this.i(),x}}function q(d){return/^[\s\xa0]*$/.test(d)}function X(){var d=f.navigator;return d&&(d=d.userAgent)?d:""}function ee(d){return ee[" "](d),d}ee[" "]=function(){};var he=X().indexOf("Gecko")!=-1&&!(X().toLowerCase().indexOf("webkit")!=-1&&X().indexOf("Edge")==-1)&&!(X().indexOf("Trident")!=-1||X().indexOf("MSIE")!=-1)&&X().indexOf("Edge")==-1;function Ae(d,x,A){for(const O in d)x.call(A,d[O],O,d)}function N(d,x){for(const A in d)x.call(void 0,d[A],A,d)}function I(d){const x={};for(const A in d)x[A]=d[A];return x}const R="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function M(d,x){let A,O;for(let re=1;re<arguments.length;re++){O=arguments[re];for(A in O)d[A]=O[A];for(let pe=0;pe<R.length;pe++)A=R[pe],Object.prototype.hasOwnProperty.call(O,A)&&(d[A]=O[A])}}function B(d){var x=1;d=d.split(":");const A=[];for(;0<x&&d.length;)A.push(d.shift()),x--;return d.length&&A.push(d.join(":")),A}function H(d){f.setTimeout(()=>{throw d},0)}function V(){var d=Ye;let x=null;return d.g&&(x=d.g,d.g=d.g.next,d.g||(d.h=null),x.next=null),x}class Je{constructor(){this.h=this.g=null}add(x,A){const O=He.get();O.set(x,A),this.h?this.h.next=O:this.g=O,this.h=O}}var He=new k(()=>new de,d=>d.reset());class de{constructor(){this.next=this.g=this.h=null}set(x,A){this.h=x,this.g=A,this.next=null}reset(){this.next=this.g=this.h=null}}let Re,ze=!1,Ye=new Je,Q=()=>{const d=f.Promise.resolve(void 0);Re=()=>{d.then(xe)}};var xe=()=>{for(var d;d=V();){try{d.h.call(d.g)}catch(A){H(A)}var x=He;x.j(d),100>x.h&&(x.h++,d.next=x.g,x.g=d)}ze=!1};function U(){this.s=this.s,this.C=this.C}U.prototype.s=!1,U.prototype.ma=function(){this.s||(this.s=!0,this.N())},U.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function W(d,x){this.type=d,this.g=this.target=x,this.defaultPrevented=!1}W.prototype.h=function(){this.defaultPrevented=!0};var K=function(){if(!f.addEventListener||!Object.defineProperty)return!1;var d=!1,x=Object.defineProperty({},"passive",{get:function(){d=!0}});try{const A=()=>{};f.addEventListener("test",A,x),f.removeEventListener("test",A,x)}catch{}return d}();function Z(d,x){if(W.call(this,d?d.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,d){var A=this.type=d.type,O=d.changedTouches&&d.changedTouches.length?d.changedTouches[0]:null;if(this.target=d.target||d.srcElement,this.g=x,x=d.relatedTarget){if(he){e:{try{ee(x.nodeName);var re=!0;break e}catch{}re=!1}re||(x=null)}}else A=="mouseover"?x=d.fromElement:A=="mouseout"&&(x=d.toElement);this.relatedTarget=x,O?(this.clientX=O.clientX!==void 0?O.clientX:O.pageX,this.clientY=O.clientY!==void 0?O.clientY:O.pageY,this.screenX=O.screenX||0,this.screenY=O.screenY||0):(this.clientX=d.clientX!==void 0?d.clientX:d.pageX,this.clientY=d.clientY!==void 0?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0),this.button=d.button,this.key=d.key||"",this.ctrlKey=d.ctrlKey,this.altKey=d.altKey,this.shiftKey=d.shiftKey,this.metaKey=d.metaKey,this.pointerId=d.pointerId||0,this.pointerType=typeof d.pointerType=="string"?d.pointerType:ce[d.pointerType]||"",this.state=d.state,this.i=d,d.defaultPrevented&&Z.aa.h.call(this)}}w(Z,W);var ce={2:"touch",3:"pen",4:"mouse"};Z.prototype.h=function(){Z.aa.h.call(this);var d=this.i;d.preventDefault?d.preventDefault():d.returnValue=!1};var Le="closure_listenable_"+(1e6*Math.random()|0),Fe=0;function Be(d,x,A,O,re){this.listener=d,this.proxy=null,this.src=x,this.type=A,this.capture=!!O,this.ha=re,this.key=++Fe,this.da=this.fa=!1}function Me(d){d.da=!0,d.listener=null,d.proxy=null,d.src=null,d.ha=null}function ut(d){this.src=d,this.g={},this.h=0}ut.prototype.add=function(d,x,A,O,re){var pe=d.toString();d=this.g[pe],d||(d=this.g[pe]=[],this.h++);var De=Wt(d,x,O,re);return-1<De?(x=d[De],A||(x.fa=!1)):(x=new Be(x,this.src,pe,!!O,re),x.fa=A,d.push(x)),x};function nt(d,x){var A=x.type;if(A in d.g){var O=d.g[A],re=Array.prototype.indexOf.call(O,x,void 0),pe;(pe=0<=re)&&Array.prototype.splice.call(O,re,1),pe&&(Me(x),d.g[A].length==0&&(delete d.g[A],d.h--))}}function Wt(d,x,A,O){for(var re=0;re<d.length;++re){var pe=d[re];if(!pe.da&&pe.listener==x&&pe.capture==!!A&&pe.ha==O)return re}return-1}var ot="closure_lm_"+(1e6*Math.random()|0),ir={};function Bt(d,x,A,O,re){if(Array.isArray(x)){for(var pe=0;pe<x.length;pe++)Bt(d,x[pe],A,O,re);return null}return A=Ji(A),d&&d[Le]?d.K(x,A,m(O)?!!O.capture:!1,re):Ve(d,x,A,!1,O,re)}function Ve(d,x,A,O,re,pe){if(!x)throw Error("Invalid event type");var De=m(re)?!!re.capture:!!re,pt=_i(d);if(pt||(d[ot]=pt=new ut(d)),A=pt.add(x,A,O,De,pe),A.proxy)return A;if(O=Wn(),A.proxy=O,O.src=d,O.listener=A,d.addEventListener)K||(re=De),re===void 0&&(re=!1),d.addEventListener(x.toString(),O,re);else if(d.attachEvent)d.attachEvent(pr(x.toString()),O);else if(d.addListener&&d.removeListener)d.addListener(O);else throw Error("addEventListener and attachEvent are unavailable.");return A}function Wn(){function d(A){return x.call(d.src,d.listener,A)}const x=Mo;return d}function ar(d,x,A,O,re){if(Array.isArray(x))for(var pe=0;pe<x.length;pe++)ar(d,x[pe],A,O,re);else O=m(O)?!!O.capture:!!O,A=Ji(A),d&&d[Le]?(d=d.i,x=String(x).toString(),x in d.g&&(pe=d.g[x],A=Wt(pe,A,O,re),-1<A&&(Me(pe[A]),Array.prototype.splice.call(pe,A,1),pe.length==0&&(delete d.g[x],d.h--)))):d&&(d=_i(d))&&(x=d.g[x.toString()],d=-1,x&&(d=Wt(x,A,O,re)),(A=-1<d?x[d]:null)&&mr(A))}function mr(d){if(typeof d!="number"&&d&&!d.da){var x=d.src;if(x&&x[Le])nt(x.i,d);else{var A=d.type,O=d.proxy;x.removeEventListener?x.removeEventListener(A,O,d.capture):x.detachEvent?x.detachEvent(pr(A),O):x.addListener&&x.removeListener&&x.removeListener(O),(A=_i(x))?(nt(A,d),A.h==0&&(A.src=null,x[ot]=null)):Me(d)}}}function pr(d){return d in ir?ir[d]:ir[d]="on"+d}function Mo(d,x){if(d.da)d=!0;else{x=new Z(x,this);var A=d.listener,O=d.ha||d.src;d.fa&&mr(d),d=A.call(O,x)}return d}function _i(d){return d=d[ot],d instanceof ut?d:null}var Kn="__closure_events_fn_"+(1e9*Math.random()>>>0);function Ji(d){return typeof d=="function"?d:(d[Kn]||(d[Kn]=function(x){return d.handleEvent(x)}),d[Kn])}function zt(){U.call(this),this.i=new ut(this),this.M=this,this.F=null}w(zt,U),zt.prototype[Le]=!0,zt.prototype.removeEventListener=function(d,x,A,O){ar(this,d,x,A,O)};function xt(d,x){var A,O=d.F;if(O)for(A=[];O;O=O.F)A.push(O);if(d=d.M,O=x.type||x,typeof x=="string")x=new W(x,d);else if(x instanceof W)x.target=x.target||d;else{var re=x;x=new W(O,d),M(x,re)}if(re=!0,A)for(var pe=A.length-1;0<=pe;pe--){var De=x.g=A[pe];re=rn(De,O,!0,x)&&re}if(De=x.g=d,re=rn(De,O,!0,x)&&re,re=rn(De,O,!1,x)&&re,A)for(pe=0;pe<A.length;pe++)De=x.g=A[pe],re=rn(De,O,!1,x)&&re}zt.prototype.N=function(){if(zt.aa.N.call(this),this.i){var d=this.i,x;for(x in d.g){for(var A=d.g[x],O=0;O<A.length;O++)Me(A[O]);delete d.g[x],d.h--}}this.F=null},zt.prototype.K=function(d,x,A,O){return this.i.add(String(d),x,!1,A,O)},zt.prototype.L=function(d,x,A,O){return this.i.add(String(d),x,!0,A,O)};function rn(d,x,A,O){if(x=d.i.g[String(x)],!x)return!0;x=x.concat();for(var re=!0,pe=0;pe<x.length;++pe){var De=x[pe];if(De&&!De.da&&De.capture==A){var pt=De.listener,xn=De.ha||De.src;De.fa&&nt(d.i,De),re=pt.call(xn,O)!==!1&&re}}return re&&!O.defaultPrevented}function bn(d,x,A){if(typeof d=="function")A&&(d=_(d,A));else if(d&&typeof d.handleEvent=="function")d=_(d.handleEvent,d);else throw Error("Invalid listener argument");return 2147483647<Number(x)?-1:f.setTimeout(d,x||0)}function Ps(d){d.g=bn(()=>{d.g=null,d.i&&(d.i=!1,Ps(d))},d.l);const x=d.h;d.h=null,d.m.apply(null,x)}class Po extends U{constructor(x,A){super(),this.m=x,this.l=A,this.h=null,this.i=!1,this.g=null}j(x){this.h=arguments,this.g?this.i=!0:Ps(this)}N(){super.N(),this.g&&(f.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function yi(d){U.call(this),this.h=d,this.g={}}w(yi,U);var xi=[];function Ei(d){Ae(d.g,function(x,A){this.g.hasOwnProperty(A)&&mr(x)},d),d.g={}}yi.prototype.N=function(){yi.aa.N.call(this),Ei(this)},yi.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var gr=f.JSON.stringify,Pa=f.JSON.parse,ea=class{stringify(d){return f.JSON.stringify(d,void 0)}parse(d){return f.JSON.parse(d,void 0)}};function ka(){}ka.prototype.h=null;function La(d){return d.h||(d.h=d.i())}function Va(){}var ai={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function si(){W.call(this,"d")}w(si,W);function Ti(){W.call(this,"c")}w(Ti,W);var jr={},ks=null;function wi(){return ks=ks||new zt}jr.La="serverreachability";function Ba(d){W.call(this,jr.La,d)}w(Ba,W);function Ai(d){const x=wi();xt(x,new Ba(x))}jr.STAT_EVENT="statevent";function ko(d,x){W.call(this,jr.STAT_EVENT,d),this.stat=x}w(ko,W);function Ht(d){const x=wi();xt(x,new ko(x,d))}jr.Ma="timingevent";function an(d,x){W.call(this,jr.Ma,d),this.size=x}w(an,W);function Xt(d,x){if(typeof d!="function")throw Error("Fn must not be null and must be a function");return f.setTimeout(function(){d()},x)}function vr(){this.g=!0}vr.prototype.xa=function(){this.g=!1};function Ls(d,x,A,O,re,pe){d.info(function(){if(d.g)if(pe)for(var De="",pt=pe.split("&"),xn=0;xn<pt.length;xn++){var gt=pt[xn].split("=");if(1<gt.length){var Cn=gt[0];gt=gt[1];var En=Cn.split("_");De=2<=En.length&&En[1]=="type"?De+(Cn+"="+gt+"&"):De+(Cn+"=redacted&")}}else De=null;else De=pe;return"XMLHTTP REQ ("+O+") [attempt "+re+"]: "+x+`
`+A+`
`+De})}function au(d,x,A,O,re,pe,De){d.info(function(){return"XMLHTTP RESP ("+O+") [ attempt "+re+"]: "+x+`
`+A+`
`+pe+" "+De})}function C(d,x,A,O){d.info(function(){return"XMLHTTP TEXT ("+x+"): "+F(d,A)+(O?" "+O:"")})}function z(d,x){d.info(function(){return"TIMEOUT: "+x})}vr.prototype.info=function(){};function F(d,x){if(!d.g)return x;if(!x)return null;try{var A=JSON.parse(x);if(A){for(d=0;d<A.length;d++)if(Array.isArray(A[d])){var O=A[d];if(!(2>O.length)){var re=O[1];if(Array.isArray(re)&&!(1>re.length)){var pe=re[0];if(pe!="noop"&&pe!="stop"&&pe!="close")for(var De=1;De<re.length;De++)re[De]=""}}}}return gr(A)}catch{return x}}var L={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},j={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},G;function ae(){}w(ae,ka),ae.prototype.g=function(){return new XMLHttpRequest},ae.prototype.i=function(){return{}},G=new ae;function me(d,x,A,O){this.j=d,this.i=x,this.l=A,this.R=O||1,this.U=new yi(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new ne}function ne(){this.i=null,this.g="",this.h=!1}var oe={},le={};function be(d,x,A){d.L=1,d.v=Us(Cr(x)),d.m=A,d.P=!0,Ie(d,null)}function Ie(d,x){d.F=Date.now(),Pe(d),d.A=Cr(d.v);var A=d.A,O=d.R;Array.isArray(O)||(O=[String(O)]),cu(A.i,"t",O),d.C=0,A=d.j.J,d.h=new ne,d.g=gf(d.j,A?x:null,!d.m),0<d.O&&(d.M=new Po(_(d.Y,d,d.g),d.O)),x=d.U,A=d.g,O=d.ca;var re="readystatechange";Array.isArray(re)||(re&&(xi[0]=re.toString()),re=xi);for(var pe=0;pe<re.length;pe++){var De=Bt(A,re[pe],O||x.handleEvent,!1,x.h||x);if(!De)break;x.g[De.key]=De}x=d.H?I(d.H):{},d.m?(d.u||(d.u="POST"),x["Content-Type"]="application/x-www-form-urlencoded",d.g.ea(d.A,d.u,d.m,x)):(d.u="GET",d.g.ea(d.A,d.u,null,x)),Ai(),Ls(d.i,d.u,d.A,d.l,d.R,d.m)}me.prototype.ca=function(d){d=d.target;const x=this.M;x&&qr(d)==3?x.j():this.Y(d)},me.prototype.Y=function(d){try{if(d==this.g)e:{const En=qr(this.g);var x=this.g.Ba();const oa=this.g.Z();if(!(3>En)&&(En!=3||this.g&&(this.h.h||this.g.oa()||lf(this.g)))){this.J||En!=4||x==7||(x==8||0>=oa?Ai(3):Ai(2)),Et(this);var A=this.g.Z();this.X=A;t:if(Ue(this)){var O=lf(this.g);d="";var re=O.length,pe=qr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){mt(this),dt(this);var De="";break t}this.h.i=new f.TextDecoder}for(x=0;x<re;x++)this.h.h=!0,d+=this.h.i.decode(O[x],{stream:!(pe&&x==re-1)});O.length=0,this.h.g+=d,this.C=0,De=this.h.g}else De=this.g.oa();if(this.o=A==200,au(this.i,this.u,this.A,this.l,this.R,En,A),this.o){if(this.T&&!this.K){t:{if(this.g){var pt,xn=this.g;if((pt=xn.g?xn.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!q(pt)){var gt=pt;break t}}gt=null}if(A=gt)C(this.i,this.l,A,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,Rr(this,A);else{this.o=!1,this.s=3,Ht(12),mt(this),dt(this);break e}}if(this.P){A=!0;let kn;for(;!this.J&&this.C<De.length;)if(kn=Ce(this,De),kn==le){En==4&&(this.s=4,Ht(14),A=!1),C(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==oe){this.s=4,Ht(15),C(this.i,this.l,De,"[Invalid Chunk]"),A=!1;break}else C(this.i,this.l,kn,null),Rr(this,kn);if(Ue(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),En!=4||De.length!=0||this.h.h||(this.s=1,Ht(16),A=!1),this.o=this.o&&A,!A)C(this.i,this.l,De,"[Invalid Chunked Response]"),mt(this),dt(this);else if(0<De.length&&!this.W){this.W=!0;var Cn=this.j;Cn.g==this&&Cn.ba&&!Cn.M&&(Cn.j.info("Great, no buffering proxy detected. Bytes received: "+De.length),Ys(Cn),Cn.M=!0,Ht(11))}}else C(this.i,this.l,De,null),Rr(this,De);En==4&&mt(this),this.o&&!this.J&&(En==4?df(this.j,this):(this.o=!1,Pe(this)))}else ed(this.g),A==400&&0<De.indexOf("Unknown SID")?(this.s=3,Ht(12)):(this.s=0,Ht(13)),mt(this),dt(this)}}}catch{}finally{}};function Ue(d){return d.g?d.u=="GET"&&d.L!=2&&d.j.Ca:!1}function Ce(d,x){var A=d.C,O=x.indexOf(`
`,A);return O==-1?le:(A=Number(x.substring(A,O)),isNaN(A)?oe:(O+=1,O+A>x.length?le:(x=x.slice(O,O+A),d.C=O+A,x)))}me.prototype.cancel=function(){this.J=!0,mt(this)};function Pe(d){d.S=Date.now()+d.I,Qe(d,d.I)}function Qe(d,x){if(d.B!=null)throw Error("WatchDog timer not null");d.B=Xt(_(d.ba,d),x)}function Et(d){d.B&&(f.clearTimeout(d.B),d.B=null)}me.prototype.ba=function(){this.B=null;const d=Date.now();0<=d-this.S?(z(this.i,this.A),this.L!=2&&(Ai(),Ht(17)),mt(this),this.s=2,dt(this)):Qe(this,this.S-d)};function dt(d){d.j.G==0||d.J||df(d.j,d)}function mt(d){Et(d);var x=d.M;x&&typeof x.ma=="function"&&x.ma(),d.M=null,Ei(d.U),d.g&&(x=d.g,d.g=null,x.abort(),x.ma())}function Rr(d,x){try{var A=d.j;if(A.G!=0&&(A.g==d||or(A.h,d))){if(!d.K&&or(A.h,d)&&A.G==3){try{var O=A.Da.g.parse(x)}catch{O=null}if(Array.isArray(O)&&O.length==3){var re=O;if(re[0]==0){e:if(!A.u){if(A.g)if(A.g.F+3e3<d.F)$o(A),Go(A);else break e;pu(A),Ht(18)}}else A.za=re[1],0<A.za-A.T&&37500>re[2]&&A.F&&A.v==0&&!A.C&&(A.C=Xt(_(A.Za,A),6e3));if(1>=bi(A.h)&&A.ca){try{A.ca()}catch{}A.ca=void 0}}else sa(A,11)}else if((d.K||A.g==d)&&$o(A),!q(x))for(re=A.Da.g.parse(x),x=0;x<re.length;x++){let gt=re[x];if(A.T=gt[0],gt=gt[1],A.G==2)if(gt[0]=="c"){A.K=gt[1],A.ia=gt[2];const Cn=gt[3];Cn!=null&&(A.la=Cn,A.j.info("VER="+A.la));const En=gt[4];En!=null&&(A.Aa=En,A.j.info("SVER="+A.Aa));const oa=gt[5];oa!=null&&typeof oa=="number"&&0<oa&&(O=1.5*oa,A.L=O,A.j.info("backChannelRequestTimeoutMs_="+O)),O=A;const kn=d.g;if(kn){const Fi=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(Fi){var pe=O.h;pe.g||Fi.indexOf("spdy")==-1&&Fi.indexOf("quic")==-1&&Fi.indexOf("h2")==-1||(pe.j=pe.l,pe.g=new Set,pe.h&&(Lo(pe,pe.h),pe.h=null))}if(O.D){const vu=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;vu&&(O.ya=vu,Mt(O.I,O.D,vu))}}A.G=3,A.l&&A.l.ua(),A.ba&&(A.R=Date.now()-d.F,A.j.info("Handshake RTT: "+A.R+"ms")),O=A;var De=d;if(O.qa=pf(O,O.J?O.ia:null,O.W),De.K){lr(O.h,De);var pt=De,xn=O.L;xn&&(pt.I=xn),pt.B&&(Et(pt),Pe(pt)),O.g=De}else ff(O);0<A.i.length&&qo(A)}else gt[0]!="stop"&&gt[0]!="close"||sa(A,7);else A.G==3&&(gt[0]=="stop"||gt[0]=="close"?gt[0]=="stop"?sa(A,7):du(A):gt[0]!="noop"&&A.l&&A.l.ta(gt),A.v=0)}}Ai(4)}catch{}}var Si=class{constructor(d,x){this.g=d,this.map=x}};function sr(d){this.l=d||10,f.PerformanceNavigationTiming?(d=f.performance.getEntriesByType("navigation"),d=0<d.length&&(d[0].nextHopProtocol=="hq"||d[0].nextHopProtocol=="h2")):d=!!(f.chrome&&f.chrome.loadTimes&&f.chrome.loadTimes()&&f.chrome.loadTimes().wasFetchedViaSpdy),this.j=d?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function _r(d){return d.h?!0:d.g?d.g.size>=d.j:!1}function bi(d){return d.h?1:d.g?d.g.size:0}function or(d,x){return d.h?d.h==x:d.g?d.g.has(x):!1}function Lo(d,x){d.g?d.g.add(x):d.h=x}function lr(d,x){d.h&&d.h==x?d.h=null:d.g&&d.g.has(x)&&d.g.delete(x)}sr.prototype.cancel=function(){if(this.i=su(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const d of this.g.values())d.cancel();this.g.clear()}};function su(d){if(d.h!=null)return d.i.concat(d.h.D);if(d.g!=null&&d.g.size!==0){let x=d.i;for(const A of d.g.values())x=x.concat(A.D);return x}return T(d.i)}function K0(d){if(d.V&&typeof d.V=="function")return d.V();if(typeof Map<"u"&&d instanceof Map||typeof Set<"u"&&d instanceof Set)return Array.from(d.values());if(typeof d=="string")return d.split("");if(h(d)){for(var x=[],A=d.length,O=0;O<A;O++)x.push(d[O]);return x}x=[],A=0;for(O in d)x[A++]=d[O];return x}function Vo(d){if(d.na&&typeof d.na=="function")return d.na();if(!d.V||typeof d.V!="function"){if(typeof Map<"u"&&d instanceof Map)return Array.from(d.keys());if(!(typeof Set<"u"&&d instanceof Set)){if(h(d)||typeof d=="string"){var x=[];d=d.length;for(var A=0;A<d;A++)x.push(A);return x}x=[],A=0;for(const O in d)x[A++]=O;return x}}}function ou(d,x){if(d.forEach&&typeof d.forEach=="function")d.forEach(x,void 0);else if(h(d)||typeof d=="string")Array.prototype.forEach.call(d,x,void 0);else for(var A=Vo(d),O=K0(d),re=O.length,pe=0;pe<re;pe++)x.call(void 0,O[pe],A&&A[pe],d)}var Vs=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Q0(d,x){if(d){d=d.split("&");for(var A=0;A<d.length;A++){var O=d[A].indexOf("="),re=null;if(0<=O){var pe=d[A].substring(0,O);re=d[A].substring(O+1)}else pe=d[A];x(pe,re?decodeURIComponent(re.replace(/\+/g," ")):"")}}}function cn(d){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,d instanceof cn){this.h=d.h,Bs(this,d.j),this.o=d.o,this.g=d.g,Ua(this,d.s),this.l=d.l;var x=d.i,A=new na;A.i=x.i,x.g&&(A.g=new Map(x.g),A.h=x.h),ta(this,A),this.m=d.m}else d&&(x=String(d).match(Vs))?(this.h=!1,Bs(this,x[1]||"",!0),this.o=zr(x[2]||""),this.g=zr(x[3]||"",!0),Ua(this,x[4]),this.l=zr(x[5]||"",!0),ta(this,x[6]||"",!0),this.m=zr(x[7]||"")):(this.h=!1,this.i=new na(null,this.h))}cn.prototype.toString=function(){var d=[],x=this.j;x&&d.push(js(x,lu,!0),":");var A=this.g;return(A||x=="file")&&(d.push("//"),(x=this.o)&&d.push(js(x,lu,!0),"@"),d.push(encodeURIComponent(String(A)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),A=this.s,A!=null&&d.push(":",String(A))),(A=this.l)&&(this.g&&A.charAt(0)!="/"&&d.push("/"),d.push(js(A,A.charAt(0)=="/"?Z0:uu,!0))),(A=this.i.toString())&&d.push("?",A),(A=this.m)&&d.push("#",js(A,Bo)),d.join("")};function Cr(d){return new cn(d)}function Bs(d,x,A){d.j=A?zr(x,!0):x,d.j&&(d.j=d.j.replace(/:$/,""))}function Ua(d,x){if(x){if(x=Number(x),isNaN(x)||0>x)throw Error("Bad port number "+x);d.s=x}else d.s=null}function ta(d,x,A){x instanceof na?(d.i=x,sf(d.i,d.h)):(A||(x=js(x,J0)),d.i=new na(x,d.h))}function Mt(d,x,A){d.i.set(x,A)}function Us(d){return Mt(d,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),d}function zr(d,x){return d?x?decodeURI(d.replace(/%25/g,"%2525")):decodeURIComponent(d):""}function js(d,x,A){return typeof d=="string"?(d=encodeURI(d).replace(x,af),A&&(d=d.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),d):null}function af(d){return d=d.charCodeAt(0),"%"+(d>>4&15).toString(16)+(d&15).toString(16)}var lu=/[#\/\?@]/g,uu=/[#\?:]/g,Z0=/[#\?]/g,J0=/[#\?@]/g,Bo=/#/g;function na(d,x){this.h=this.g=null,this.i=d||null,this.j=!!x}function Hr(d){d.g||(d.g=new Map,d.h=0,d.i&&Q0(d.i,function(x,A){d.add(decodeURIComponent(x.replace(/\+/g," ")),A)}))}t=na.prototype,t.add=function(d,x){Hr(this),this.i=null,d=Ri(this,d);var A=this.g.get(d);return A||this.g.set(d,A=[]),A.push(x),this.h+=1,this};function ra(d,x){Hr(d),x=Ri(d,x),d.g.has(x)&&(d.i=null,d.h-=d.g.get(x).length,d.g.delete(x))}function ia(d,x){return Hr(d),x=Ri(d,x),d.g.has(x)}t.forEach=function(d,x){Hr(this),this.g.forEach(function(A,O){A.forEach(function(re){d.call(x,re,O,this)},this)},this)},t.na=function(){Hr(this);const d=Array.from(this.g.values()),x=Array.from(this.g.keys()),A=[];for(let O=0;O<x.length;O++){const re=d[O];for(let pe=0;pe<re.length;pe++)A.push(x[O])}return A},t.V=function(d){Hr(this);let x=[];if(typeof d=="string")ia(this,d)&&(x=x.concat(this.g.get(Ri(this,d))));else{d=Array.from(this.g.values());for(let A=0;A<d.length;A++)x=x.concat(d[A])}return x},t.set=function(d,x){return Hr(this),this.i=null,d=Ri(this,d),ia(this,d)&&(this.h-=this.g.get(d).length),this.g.set(d,[x]),this.h+=1,this},t.get=function(d,x){return d?(d=this.V(d),0<d.length?String(d[0]):x):x};function cu(d,x,A){ra(d,x),0<A.length&&(d.i=null,d.g.set(Ri(d,x),T(A)),d.h+=A.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const d=[],x=Array.from(this.g.keys());for(var A=0;A<x.length;A++){var O=x[A];const pe=encodeURIComponent(String(O)),De=this.V(O);for(O=0;O<De.length;O++){var re=pe;De[O]!==""&&(re+="="+encodeURIComponent(String(De[O]))),d.push(re)}}return this.i=d.join("&")};function Ri(d,x){return x=String(x),d.j&&(x=x.toLowerCase()),x}function sf(d,x){x&&!d.j&&(Hr(d),d.i=null,d.g.forEach(function(A,O){var re=O.toLowerCase();O!=re&&(ra(this,O),cu(this,re,A))},d)),d.j=x}function zs(d,x){const A=new vr;if(f.Image){const O=new Image;O.onload=E(Gr,A,"TestLoadImage: loaded",!0,x,O),O.onerror=E(Gr,A,"TestLoadImage: error",!1,x,O),O.onabort=E(Gr,A,"TestLoadImage: abort",!1,x,O),O.ontimeout=E(Gr,A,"TestLoadImage: timeout",!1,x,O),f.setTimeout(function(){O.ontimeout&&O.ontimeout()},1e4),O.src=d}else x(!1)}function oi(d,x){const A=new vr,O=new AbortController,re=setTimeout(()=>{O.abort(),Gr(A,"TestPingServer: timeout",!1,x)},1e4);fetch(d,{signal:O.signal}).then(pe=>{clearTimeout(re),pe.ok?Gr(A,"TestPingServer: ok",!0,x):Gr(A,"TestPingServer: server error",!1,x)}).catch(()=>{clearTimeout(re),Gr(A,"TestPingServer: error",!1,x)})}function Gr(d,x,A,O,re){try{re&&(re.onload=null,re.onerror=null,re.onabort=null,re.ontimeout=null),O(A)}catch{}}function Hs(){this.g=new ea}function Ci(d,x,A){const O=A||"";try{ou(d,function(re,pe){let De=re;m(re)&&(De=gr(re)),x.push(O+pe+"="+encodeURIComponent(De))})}catch(re){throw x.push(O+"type="+encodeURIComponent("_badmap")),re}}function ja(d){this.l=d.Ub||null,this.j=d.eb||!1}w(ja,ka),ja.prototype.g=function(){return new aa(this.l,this.j)},ja.prototype.i=function(d){return function(){return d}}({});function aa(d,x){zt.call(this),this.D=d,this.o=x,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}w(aa,zt),t=aa.prototype,t.open=function(d,x){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=d,this.A=x,this.readyState=1,Ni(this)},t.send=function(d){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const x={headers:this.u,method:this.B,credentials:this.m,cache:void 0};d&&(x.body=d),(this.D||f).fetch(new Request(this.A,x)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ii(this)),this.readyState=0},t.Sa=function(d){if(this.g&&(this.l=d,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=d.headers,this.readyState=2,Ni(this)),this.g&&(this.readyState=3,Ni(this),this.g)))if(this.responseType==="arraybuffer")d.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof f.ReadableStream<"u"&&"body"in d){if(this.j=d.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;fu(this)}else d.text().then(this.Ra.bind(this),this.ga.bind(this))};function fu(d){d.j.read().then(d.Pa.bind(d)).catch(d.ga.bind(d))}t.Pa=function(d){if(this.g){if(this.o&&d.value)this.response.push(d.value);else if(!this.o){var x=d.value?d.value:new Uint8Array(0);(x=this.v.decode(x,{stream:!d.done}))&&(this.response=this.responseText+=x)}d.done?Ii(this):Ni(this),this.readyState==3&&fu(this)}},t.Ra=function(d){this.g&&(this.response=this.responseText=d,Ii(this))},t.Qa=function(d){this.g&&(this.response=d,Ii(this))},t.ga=function(){this.g&&Ii(this)};function Ii(d){d.readyState=4,d.l=null,d.j=null,d.v=null,Ni(d)}t.setRequestHeader=function(d,x){this.u.append(d,x)},t.getResponseHeader=function(d){return this.h&&this.h.get(d.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const d=[],x=this.h.entries();for(var A=x.next();!A.done;)A=A.value,d.push(A[0]+": "+A[1]),A=x.next();return d.join(`\r
`)};function Ni(d){d.onreadystatechange&&d.onreadystatechange.call(d)}Object.defineProperty(aa.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(d){this.m=d?"include":"same-origin"}});function hu(d){let x="";return Ae(d,function(A,O){x+=O,x+=":",x+=A,x+=`\r
`}),x}function Rn(d,x,A){e:{for(O in A){var O=!1;break e}O=!0}O||(A=hu(A),typeof d=="string"?A!=null&&encodeURIComponent(String(A)):Mt(d,x,A))}function bt(d){zt.call(this),this.headers=new Map,this.o=d||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}w(bt,zt);var Uo=/^https?$/i,Gs=["POST","PUT"];t=bt.prototype,t.Ha=function(d){this.J=d},t.ea=function(d,x,A,O){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+d);x=x?x.toUpperCase():"GET",this.D=d,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():G.g(),this.v=this.o?La(this.o):La(G),this.g.onreadystatechange=_(this.Ea,this);try{this.B=!0,this.g.open(x,String(d),!0),this.B=!1}catch(pe){of(this,pe);return}if(d=A||"",A=new Map(this.headers),O)if(Object.getPrototypeOf(O)===Object.prototype)for(var re in O)A.set(re,O[re]);else if(typeof O.keys=="function"&&typeof O.get=="function")for(const pe of O.keys())A.set(pe,O.get(pe));else throw Error("Unknown input type for opt_headers: "+String(O));O=Array.from(A.keys()).find(pe=>pe.toLowerCase()=="content-type"),re=f.FormData&&d instanceof f.FormData,!(0<=Array.prototype.indexOf.call(Gs,x,void 0))||O||re||A.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[pe,De]of A)this.g.setRequestHeader(pe,De);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{qs(this),this.u=!0,this.g.send(d),this.u=!1}catch(pe){of(this,pe)}};function of(d,x){d.h=!1,d.g&&(d.j=!0,d.g.abort(),d.j=!1),d.l=x,d.m=5,jo(d),Di(d)}function jo(d){d.A||(d.A=!0,xt(d,"complete"),xt(d,"error"))}t.abort=function(d){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=d||7,xt(this,"complete"),xt(this,"abort"),Di(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Di(this,!0)),bt.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?zo(this):this.bb())},t.bb=function(){zo(this)};function zo(d){if(d.h&&typeof u<"u"&&(!d.v[1]||qr(d)!=4||d.Z()!=2)){if(d.u&&qr(d)==4)bn(d.Ea,0,d);else if(xt(d,"readystatechange"),qr(d)==4){d.h=!1;try{const De=d.Z();e:switch(De){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var x=!0;break e;default:x=!1}var A;if(!(A=x)){var O;if(O=De===0){var re=String(d.D).match(Vs)[1]||null;!re&&f.self&&f.self.location&&(re=f.self.location.protocol.slice(0,-1)),O=!Uo.test(re?re.toLowerCase():"")}A=O}if(A)xt(d,"complete"),xt(d,"success");else{d.m=6;try{var pe=2<qr(d)?d.g.statusText:""}catch{pe=""}d.l=pe+" ["+d.Z()+"]",jo(d)}}finally{Di(d)}}}}function Di(d,x){if(d.g){qs(d);const A=d.g,O=d.v[0]?()=>{}:null;d.g=null,d.v=null,x||xt(d,"ready");try{A.onreadystatechange=O}catch{}}}function qs(d){d.I&&(f.clearTimeout(d.I),d.I=null)}t.isActive=function(){return!!this.g};function qr(d){return d.g?d.g.readyState:0}t.Z=function(){try{return 2<qr(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(d){if(this.g){var x=this.g.responseText;return d&&x.indexOf(d)==0&&(x=x.substring(d.length)),Pa(x)}};function lf(d){try{if(!d.g)return null;if("response"in d.g)return d.g.response;switch(d.H){case"":case"text":return d.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in d.g)return d.g.mozResponseArrayBuffer}return null}catch{return null}}function ed(d){const x={};d=(d.g&&2<=qr(d)&&d.g.getAllResponseHeaders()||"").split(`\r
`);for(let O=0;O<d.length;O++){if(q(d[O]))continue;var A=B(d[O]);const re=A[0];if(A=A[1],typeof A!="string")continue;A=A.trim();const pe=x[re]||[];x[re]=pe,pe.push(A)}N(x,function(O){return O.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function $s(d,x,A){return A&&A.internalChannelParams&&A.internalChannelParams[d]||x}function Ho(d){this.Aa=0,this.i=[],this.j=new vr,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=$s("failFast",!1,d),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=$s("baseRetryDelayMs",5e3,d),this.cb=$s("retryDelaySeedMs",1e4,d),this.Wa=$s("forwardChannelMaxRetries",2,d),this.wa=$s("forwardChannelRequestTimeoutMs",2e4,d),this.pa=d&&d.xmlHttpFactory||void 0,this.Xa=d&&d.Tb||void 0,this.Ca=d&&d.useFetchStreams||!1,this.L=void 0,this.J=d&&d.supportsCrossDomainXhr||!1,this.K="",this.h=new sr(d&&d.concurrentRequestLimit),this.Da=new Hs,this.P=d&&d.fastHandshake||!1,this.O=d&&d.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=d&&d.Rb||!1,d&&d.xa&&this.j.xa(),d&&d.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&d&&d.detectBufferingProxy||!1,this.ja=void 0,d&&d.longPollingTimeout&&0<d.longPollingTimeout&&(this.ja=d.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=Ho.prototype,t.la=8,t.G=1,t.connect=function(d,x,A,O){Ht(0),this.W=d,this.H=x||{},A&&O!==void 0&&(this.H.OSID=A,this.H.OAID=O),this.F=this.X,this.I=pf(this,null,this.W),qo(this)};function du(d){if(uf(d),d.G==3){var x=d.U++,A=Cr(d.I);if(Mt(A,"SID",d.K),Mt(A,"RID",x),Mt(A,"TYPE","terminate"),Xs(d,A),x=new me(d,d.j,x),x.L=2,x.v=Us(Cr(A)),A=!1,f.navigator&&f.navigator.sendBeacon)try{A=f.navigator.sendBeacon(x.v.toString(),"")}catch{}!A&&f.Image&&(new Image().src=x.v,A=!0),A||(x.g=gf(x.j,null),x.g.ea(x.v)),x.F=Date.now(),Pe(x)}mf(d)}function Go(d){d.g&&(Ys(d),d.g.cancel(),d.g=null)}function uf(d){Go(d),d.u&&(f.clearTimeout(d.u),d.u=null),$o(d),d.h.cancel(),d.s&&(typeof d.s=="number"&&f.clearTimeout(d.s),d.s=null)}function qo(d){if(!_r(d.h)&&!d.s){d.s=!0;var x=d.Ga;Re||Q(),ze||(Re(),ze=!0),Ye.add(x,d),d.B=0}}function td(d,x){return bi(d.h)>=d.h.j-(d.s?1:0)?!1:d.s?(d.i=x.D.concat(d.i),!0):d.G==1||d.G==2||d.B>=(d.Va?0:d.Wa)?!1:(d.s=Xt(_(d.Ga,d,x),gu(d,d.B)),d.B++,!0)}t.Ga=function(d){if(this.s)if(this.s=null,this.G==1){if(!d){this.U=Math.floor(1e5*Math.random()),d=this.U++;const re=new me(this,this.j,d);let pe=this.o;if(this.S&&(pe?(pe=I(pe),M(pe,this.S)):pe=this.S),this.m!==null||this.O||(re.H=pe,pe=null),this.P)e:{for(var x=0,A=0;A<this.i.length;A++){t:{var O=this.i[A];if("__data__"in O.map&&(O=O.map.__data__,typeof O=="string")){O=O.length;break t}O=void 0}if(O===void 0)break;if(x+=O,4096<x){x=A;break e}if(x===4096||A===this.i.length-1){x=A+1;break e}}x=1e3}else x=1e3;x=cf(this,re,x),A=Cr(this.I),Mt(A,"RID",d),Mt(A,"CVER",22),this.D&&Mt(A,"X-HTTP-Session-Id",this.D),Xs(this,A),pe&&(this.O?x="headers="+encodeURIComponent(String(hu(pe)))+"&"+x:this.m&&Rn(A,this.m,pe)),Lo(this.h,re),this.Ua&&Mt(A,"TYPE","init"),this.P?(Mt(A,"$req",x),Mt(A,"SID","null"),re.T=!0,be(re,A,null)):be(re,A,x),this.G=2}}else this.G==3&&(d?mu(this,d):this.i.length==0||_r(this.h)||mu(this))};function mu(d,x){var A;x?A=x.l:A=d.U++;const O=Cr(d.I);Mt(O,"SID",d.K),Mt(O,"RID",A),Mt(O,"AID",d.T),Xs(d,O),d.m&&d.o&&Rn(O,d.m,d.o),A=new me(d,d.j,A,d.B+1),d.m===null&&(A.H=d.o),x&&(d.i=x.D.concat(d.i)),x=cf(d,A,1e3),A.I=Math.round(.5*d.wa)+Math.round(.5*d.wa*Math.random()),Lo(d.h,A),be(A,O,x)}function Xs(d,x){d.H&&Ae(d.H,function(A,O){Mt(x,O,A)}),d.l&&ou({},function(A,O){Mt(x,O,A)})}function cf(d,x,A){A=Math.min(d.i.length,A);var O=d.l?_(d.l.Na,d.l,d):null;e:{var re=d.i;let pe=-1;for(;;){const De=["count="+A];pe==-1?0<A?(pe=re[0].g,De.push("ofs="+pe)):pe=0:De.push("ofs="+pe);let pt=!0;for(let xn=0;xn<A;xn++){let gt=re[xn].g;const Cn=re[xn].map;if(gt-=pe,0>gt)pe=Math.max(0,re[xn].g-100),pt=!1;else try{Ci(Cn,De,"req"+gt+"_")}catch{O&&O(Cn)}}if(pt){O=De.join("&");break e}}}return d=d.i.splice(0,A),x.D=d,O}function ff(d){if(!d.g&&!d.u){d.Y=1;var x=d.Fa;Re||Q(),ze||(Re(),ze=!0),Ye.add(x,d),d.v=0}}function pu(d){return d.g||d.u||3<=d.v?!1:(d.Y++,d.u=Xt(_(d.Fa,d),gu(d,d.v)),d.v++,!0)}t.Fa=function(){if(this.u=null,hf(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var d=2*this.R;this.j.info("BP detection timer enabled: "+d),this.A=Xt(_(this.ab,this),d)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,Ht(10),Go(this),hf(this))};function Ys(d){d.A!=null&&(f.clearTimeout(d.A),d.A=null)}function hf(d){d.g=new me(d,d.j,"rpc",d.Y),d.m===null&&(d.g.H=d.o),d.g.O=0;var x=Cr(d.qa);Mt(x,"RID","rpc"),Mt(x,"SID",d.K),Mt(x,"AID",d.T),Mt(x,"CI",d.F?"0":"1"),!d.F&&d.ja&&Mt(x,"TO",d.ja),Mt(x,"TYPE","xmlhttp"),Xs(d,x),d.m&&d.o&&Rn(x,d.m,d.o),d.L&&(d.g.I=d.L);var A=d.g;d=d.ia,A.L=1,A.v=Us(Cr(x)),A.m=null,A.P=!0,Ie(A,d)}t.Za=function(){this.C!=null&&(this.C=null,Go(this),pu(this),Ht(19))};function $o(d){d.C!=null&&(f.clearTimeout(d.C),d.C=null)}function df(d,x){var A=null;if(d.g==x){$o(d),Ys(d),d.g=null;var O=2}else if(or(d.h,x))A=x.D,lr(d.h,x),O=1;else return;if(d.G!=0){if(x.o)if(O==1){A=x.m?x.m.length:0,x=Date.now()-x.F;var re=d.B;O=wi(),xt(O,new an(O,A)),qo(d)}else ff(d);else if(re=x.s,re==3||re==0&&0<x.X||!(O==1&&td(d,x)||O==2&&pu(d)))switch(A&&0<A.length&&(x=d.h,x.i=x.i.concat(A)),re){case 1:sa(d,5);break;case 4:sa(d,10);break;case 3:sa(d,6);break;default:sa(d,2)}}}function gu(d,x){let A=d.Ta+Math.floor(Math.random()*d.cb);return d.isActive()||(A*=2),A*x}function sa(d,x){if(d.j.info("Error code "+x),x==2){var A=_(d.fb,d),O=d.Xa;const re=!O;O=new cn(O||"//www.google.com/images/cleardot.gif"),f.location&&f.location.protocol=="http"||Bs(O,"https"),Us(O),re?zs(O.toString(),A):oi(O.toString(),A)}else Ht(2);d.G=0,d.l&&d.l.sa(x),mf(d),uf(d)}t.fb=function(d){d?(this.j.info("Successfully pinged google.com"),Ht(2)):(this.j.info("Failed to ping google.com"),Ht(1))};function mf(d){if(d.G=0,d.ka=[],d.l){const x=su(d.h);(x.length!=0||d.i.length!=0)&&(b(d.ka,x),b(d.ka,d.i),d.h.i.length=0,T(d.i),d.i.length=0),d.l.ra()}}function pf(d,x,A){var O=A instanceof cn?Cr(A):new cn(A);if(O.g!="")x&&(O.g=x+"."+O.g),Ua(O,O.s);else{var re=f.location;O=re.protocol,x=x?x+"."+re.hostname:re.hostname,re=+re.port;var pe=new cn(null);O&&Bs(pe,O),x&&(pe.g=x),re&&Ua(pe,re),A&&(pe.l=A),O=pe}return A=d.D,x=d.ya,A&&x&&Mt(O,A,x),Mt(O,"VER",d.la),Xs(d,O),O}function gf(d,x,A){if(x&&!d.J)throw Error("Can't create secondary domain capable XhrIo object.");return x=d.Ca&&!d.pa?new bt(new ja({eb:A})):new bt(d.pa),x.Ha(d.J),x}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function vf(){}t=vf.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function Xo(){}Xo.prototype.g=function(d,x){return new ur(d,x)};function ur(d,x){zt.call(this),this.g=new Ho(x),this.l=d,this.h=x&&x.messageUrlParams||null,d=x&&x.messageHeaders||null,x&&x.clientProtocolHeaderRequired&&(d?d["X-Client-Protocol"]="webchannel":d={"X-Client-Protocol":"webchannel"}),this.g.o=d,d=x&&x.initMessageHeaders||null,x&&x.messageContentType&&(d?d["X-WebChannel-Content-Type"]=x.messageContentType:d={"X-WebChannel-Content-Type":x.messageContentType}),x&&x.va&&(d?d["X-WebChannel-Client-Profile"]=x.va:d={"X-WebChannel-Client-Profile":x.va}),this.g.S=d,(d=x&&x.Sb)&&!q(d)&&(this.g.m=d),this.v=x&&x.supportsCrossDomainXhr||!1,this.u=x&&x.sendRawJson||!1,(x=x&&x.httpSessionIdParam)&&!q(x)&&(this.g.D=x,d=this.h,d!==null&&x in d&&(d=this.h,x in d&&delete d[x])),this.j=new Oi(this)}w(ur,zt),ur.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},ur.prototype.close=function(){du(this.g)},ur.prototype.o=function(d){var x=this.g;if(typeof d=="string"){var A={};A.__data__=d,d=A}else this.u&&(A={},A.__data__=gr(d),d=A);x.i.push(new Si(x.Ya++,d)),x.G==3&&qo(x)},ur.prototype.N=function(){this.g.l=null,delete this.j,du(this.g),delete this.g,ur.aa.N.call(this)};function _f(d){si.call(this),d.__headers__&&(this.headers=d.__headers__,this.statusCode=d.__status__,delete d.__headers__,delete d.__status__);var x=d.__sm__;if(x){e:{for(const A in x){d=A;break e}d=void 0}(this.i=d)&&(d=this.i,x=x!==null&&d in x?x[d]:void 0),this.data=x}else this.data=d}w(_f,si);function yf(){Ti.call(this),this.status=1}w(yf,Ti);function Oi(d){this.g=d}w(Oi,vf),Oi.prototype.ua=function(){xt(this.g,"a")},Oi.prototype.ta=function(d){xt(this.g,new _f(d))},Oi.prototype.sa=function(d){xt(this.g,new yf)},Oi.prototype.ra=function(){xt(this.g,"b")},Xo.prototype.createWebChannel=Xo.prototype.g,ur.prototype.send=ur.prototype.o,ur.prototype.open=ur.prototype.m,ur.prototype.close=ur.prototype.close,GE=function(){return new Xo},HE=function(){return wi()},zE=jr,Ip={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},L.NO_ERROR=0,L.TIMEOUT=8,L.HTTP_ERROR=6,kh=L,j.COMPLETE="complete",jE=j,Va.EventType=ai,ai.OPEN="a",ai.CLOSE="b",ai.ERROR="c",ai.MESSAGE="d",zt.prototype.listen=zt.prototype.K,uc=Va,bt.prototype.listenOnce=bt.prototype.L,bt.prototype.getLastError=bt.prototype.Ka,bt.prototype.getLastErrorCode=bt.prototype.Ba,bt.prototype.getStatus=bt.prototype.Z,bt.prototype.getResponseJson=bt.prototype.Oa,bt.prototype.getResponseText=bt.prototype.oa,bt.prototype.send=bt.prototype.ea,bt.prototype.setWithCredentials=bt.prototype.Ha,UE=bt}).apply(typeof Eh<"u"?Eh:typeof self<"u"?self:typeof window<"u"?window:{});const fx="@firebase/firestore",hx="4.8.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class er{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}er.UNAUTHENTICATED=new er(null),er.GOOGLE_CREDENTIALS=new er("google-credentials-uid"),er.FIRST_PARTY=new er("first-party-uid"),er.MOCK_USER=new er("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Ql="11.10.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const vo=new ug("@firebase/firestore");function Sl(){return vo.logLevel}function je(t,...e){if(vo.logLevel<=yt.DEBUG){const n=e.map(hg);vo.debug(`Firestore (${Ql}): ${t}`,...n)}}function Ia(t,...e){if(vo.logLevel<=yt.ERROR){const n=e.map(hg);vo.error(`Firestore (${Ql}): ${t}`,...n)}}function Es(t,...e){if(vo.logLevel<=yt.WARN){const n=e.map(hg);vo.warn(`Firestore (${Ql}): ${t}`,...n)}}function hg(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ke(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,qE(t,r,n)}function qE(t,e,n){let r=`FIRESTORE (${Ql}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw Ia(r),new Error(r)}function Rt(t,e,n,r){let a="Unexpected state";typeof n=="string"?a=n:r=n,t||qE(e,a,r)}function tt(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _e={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ke extends Fs{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ta{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $E{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class RC{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(er.UNAUTHENTICATED))}shutdown(){}}class CC{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class IC{constructor(e){this.t=e,this.currentUser=er.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Rt(this.o===void 0,42304);let r=this.i;const a=h=>this.i!==r?(r=this.i,n(h)):Promise.resolve();let o=new Ta;this.o=()=>{this.i++,this.currentUser=this.u(),o.resolve(),o=new Ta,e.enqueueRetryable(()=>a(this.currentUser))};const u=()=>{const h=o;e.enqueueRetryable(async()=>{await h.promise,await a(this.currentUser)})},f=h=>{je("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=h,this.o&&(this.auth.addAuthTokenListener(this.o),u())};this.t.onInit(h=>f(h)),setTimeout(()=>{if(!this.auth){const h=this.t.getImmediate({optional:!0});h?f(h):(je("FirebaseAuthCredentialsProvider","Auth not yet detected"),o.resolve(),o=new Ta)}},0),u()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(je("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Rt(typeof r.accessToken=="string",31837,{l:r}),new $E(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Rt(e===null||typeof e=="string",2055,{h:e}),new er(e)}}class NC{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=er.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class DC{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new NC(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(er.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class dx{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class OC{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,hC(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Rt(this.o===void 0,3512);const r=o=>{o.error!=null&&je("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${o.error.message}`);const u=o.token!==this.m;return this.m=o.token,je("FirebaseAppCheckTokenProvider",`Received ${u?"new":"existing"} token.`),u?n(o.token):Promise.resolve()};this.o=o=>{e.enqueueRetryable(()=>r(o))};const a=o=>{je("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=o,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(o=>a(o)),setTimeout(()=>{if(!this.appCheck){const o=this.V.getImmediate({optional:!0});o?a(o):je("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new dx(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Rt(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new dx(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function FC(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function XE(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dg{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const a=FC(40);for(let o=0;o<a.length;++o)r.length<20&&a[o]<n&&(r+=e.charAt(a[o]%62))}return r}}function st(t,e){return t<e?-1:t>e?1:0}function Np(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),a=e.codePointAt(n);if(r!==a){if(r<128&&a<128)return st(r,a);{const o=XE(),u=MC(o.encode(mx(t,n)),o.encode(mx(e,n)));return u!==0?u:st(r,a)}}n+=r>65535?2:1}return st(t.length,e.length)}function mx(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function MC(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return st(t[n],e[n]);return st(t.length,e.length)}function Ul(t,e,n){return t.length===e.length&&t.every((r,a)=>n(r,e[a]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const px="__name__";class ji{constructor(e,n,r){n===void 0?n=0:n>e.length&&Ke(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Ke(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return ji.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof ji?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let a=0;a<r;a++){const o=ji.compareSegments(e.get(a),n.get(a));if(o!==0)return o}return st(e.length,n.length)}static compareSegments(e,n){const r=ji.isNumericId(e),a=ji.isNumericId(n);return r&&!a?-1:!r&&a?1:r&&a?ji.extractNumericId(e).compare(ji.extractNumericId(n)):Np(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return ps.fromString(e.substring(4,e.length-2))}}class jt extends ji{construct(e,n,r){return new jt(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new ke(_e.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(a=>a.length>0))}return new jt(n)}static emptyPath(){return new jt([])}}const PC=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Hn extends ji{construct(e,n,r){return new Hn(e,n,r)}static isValidIdentifier(e){return PC.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Hn.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===px}static keyField(){return new Hn([px])}static fromServerFormat(e){const n=[];let r="",a=0;const o=()=>{if(r.length===0)throw new ke(_e.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let u=!1;for(;a<e.length;){const f=e[a];if(f==="\\"){if(a+1===e.length)throw new ke(_e.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const h=e[a+1];if(h!=="\\"&&h!=="."&&h!=="`")throw new ke(_e.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=h,a+=2}else f==="`"?(u=!u,a++):f!=="."||u?(r+=f,a++):(o(),a++)}if(o(),u)throw new ke(_e.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Hn(n)}static emptyPath(){return new Hn([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $e{constructor(e){this.path=e}static fromPath(e){return new $e(jt.fromString(e))}static fromName(e){return new $e(jt.fromString(e).popFirst(5))}static empty(){return new $e(jt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&jt.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return jt.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new $e(new jt(e.slice()))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YE(t,e,n){if(!n)throw new ke(_e.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function kC(t,e,n,r){if(e===!0&&r===!0)throw new ke(_e.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function gx(t){if(!$e.isDocumentKey(t))throw new ke(_e.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function vx(t){if($e.isDocumentKey(t))throw new ke(_e.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function WE(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null)}function A0(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Ke(12329,{type:typeof t})}function Ts(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new ke(_e.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=A0(t);throw new ke(_e.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gn(t,e){const n={typeString:t};return e&&(n.value=e),n}function $c(t,e){if(!WE(t))throw new ke(_e.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in e)if(e[r]){const a=e[r].typeString,o="value"in e[r]?{value:e[r].value}:void 0;if(!(r in t)){n=`JSON missing required field: '${r}'`;break}const u=t[r];if(a&&typeof u!==a){n=`JSON field '${r}' must be a ${a}.`;break}if(o!==void 0&&u!==o.value){n=`Expected '${r}' field to equal '${o.value}'`;break}}if(n)throw new ke(_e.INVALID_ARGUMENT,n);return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _x=-62135596800,yx=1e6;class qt{static now(){return qt.fromMillis(Date.now())}static fromDate(e){return qt.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*yx);return new qt(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new ke(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new ke(_e.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<_x)throw new ke(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ke(_e.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/yx}_compareTo(e){return this.seconds===e.seconds?st(this.nanoseconds,e.nanoseconds):st(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:qt._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if($c(e,qt._jsonSchema))return new qt(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-_x;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}qt._jsonSchemaVersion="firestore/timestamp/1.0",qt._jsonSchema={type:gn("string",qt._jsonSchemaVersion),seconds:gn("number"),nanoseconds:gn("number")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class et{static fromTimestamp(e){return new et(e)}static min(){return new et(new qt(0,0))}static max(){return new et(new qt(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Rc=-1;function LC(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,a=et.fromTimestamp(r===1e9?new qt(n+1,0):new qt(n,r));return new ws(a,$e.empty(),e)}function VC(t){return new ws(t.readTime,t.key,Rc)}class ws{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new ws(et.min(),$e.empty(),Rc)}static max(){return new ws(et.max(),$e.empty(),Rc)}}function BC(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=$e.comparator(t.documentKey,e.documentKey),n!==0?n:st(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const UC="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class jC{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Zl(t){if(t.code!==_e.FAILED_PRECONDITION||t.message!==UC)throw t;je("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class we{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Ke(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new we((r,a)=>{this.nextCallback=o=>{this.wrapSuccess(e,o).next(r,a)},this.catchCallback=o=>{this.wrapFailure(n,o).next(r,a)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof we?n:we.resolve(n)}catch(n){return we.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):we.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):we.reject(n)}static resolve(e){return new we((n,r)=>{n(e)})}static reject(e){return new we((n,r)=>{r(e)})}static waitFor(e){return new we((n,r)=>{let a=0,o=0,u=!1;e.forEach(f=>{++a,f.next(()=>{++o,u&&o===a&&n()},h=>r(h))}),u=!0,o===a&&n()})}static or(e){let n=we.resolve(!1);for(const r of e)n=n.next(a=>a?we.resolve(a):r());return n}static forEach(e,n){const r=[];return e.forEach((a,o)=>{r.push(n.call(this,a,o))}),this.waitFor(r)}static mapArray(e,n){return new we((r,a)=>{const o=e.length,u=new Array(o);let f=0;for(let h=0;h<o;h++){const m=h;n(e[m]).next(g=>{u[m]=g,++f,f===o&&r(u)},g=>a(g))}})}static doWhile(e,n){return new we((r,a)=>{const o=()=>{e()===!0?n().next(()=>{o()},a):r()};o()})}}function zC(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Jl(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class S0{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this._e(r),this.ae=r=>n.writeSequenceNumber(r))}_e(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ae&&this.ae(e),e}}S0.ue=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mg=-1;function b0(t){return t==null}function $h(t){return t===0&&1/t==-1/0}function HC(t){return typeof t=="number"&&Number.isInteger(t)&&!$h(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const KE="";function GC(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=xx(e)),e=qC(t.get(n),e);return xx(e)}function qC(t,e){let n=e;const r=t.length;for(let a=0;a<r;a++){const o=t.charAt(a);switch(o){case"\0":n+="";break;case KE:n+="";break;default:n+=o}}return n}function xx(t){return t+KE+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ex(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Ao(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function QE(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Zt{constructor(e,n){this.comparator=e,this.root=n||zn.EMPTY}insert(e,n){return new Zt(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,zn.BLACK,null,null))}remove(e){return new Zt(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zn.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const a=this.comparator(e,r.key);if(a===0)return n+r.left.size;a<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Th(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Th(this.root,e,this.comparator,!1)}getReverseIterator(){return new Th(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Th(this.root,e,this.comparator,!0)}}class Th{constructor(e,n,r,a){this.isReverse=a,this.nodeStack=[];let o=1;for(;!e.isEmpty();)if(o=n?r(e.key,n):1,n&&a&&(o*=-1),o<0)e=this.isReverse?e.left:e.right;else{if(o===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zn{constructor(e,n,r,a,o){this.key=e,this.value=n,this.color=r??zn.RED,this.left=a??zn.EMPTY,this.right=o??zn.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,a,o){return new zn(e??this.key,n??this.value,r??this.color,a??this.left,o??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let a=this;const o=r(e,a.key);return a=o<0?a.copy(null,null,null,a.left.insert(e,n,r),null):o===0?a.copy(null,n,null,null,null):a.copy(null,null,null,null,a.right.insert(e,n,r)),a.fixUp()}removeMin(){if(this.left.isEmpty())return zn.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,a=this;if(n(e,a.key)<0)a.left.isEmpty()||a.left.isRed()||a.left.left.isRed()||(a=a.moveRedLeft()),a=a.copy(null,null,null,a.left.remove(e,n),null);else{if(a.left.isRed()&&(a=a.rotateRight()),a.right.isEmpty()||a.right.isRed()||a.right.left.isRed()||(a=a.moveRedRight()),n(e,a.key)===0){if(a.right.isEmpty())return zn.EMPTY;r=a.right.min(),a=a.copy(r.key,r.value,null,null,a.right.removeMin())}a=a.copy(null,null,null,null,a.right.remove(e,n))}return a.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zn.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zn.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Ke(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Ke(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Ke(27949);return e+(this.isRed()?0:1)}}zn.EMPTY=null,zn.RED=!0,zn.BLACK=!1;zn.EMPTY=new class{constructor(){this.size=0}get key(){throw Ke(57766)}get value(){throw Ke(16141)}get color(){throw Ke(16727)}get left(){throw Ke(29726)}get right(){throw Ke(36894)}copy(e,n,r,a,o){return this}insert(e,n,r){return new zn(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sn{constructor(e){this.comparator=e,this.data=new Zt(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const a=r.getNext();if(this.comparator(a.key,e[1])>=0)return;n(a.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new Tx(this.data.getIterator())}getIteratorFrom(e){return new Tx(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof Sn)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(this.comparator(a,o)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new Sn(this.comparator);return n.data=e,n}}class Tx{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mi{constructor(e){this.fields=e,e.sort(Hn.comparator)}static empty(){return new mi([])}unionWith(e){let n=new Sn(Hn.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new mi(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Ul(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZE extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xn{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(a){try{return atob(a)}catch(o){throw typeof DOMException<"u"&&o instanceof DOMException?new ZE("Invalid base64 string: "+o):o}}(e);return new Xn(n)}static fromUint8Array(e){const n=function(a){let o="";for(let u=0;u<a.length;++u)o+=String.fromCharCode(a[u]);return o}(e);return new Xn(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return st(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Xn.EMPTY_BYTE_STRING=new Xn("");const $C=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function As(t){if(Rt(!!t,39018),typeof t=="string"){let e=0;const n=$C.exec(t);if(Rt(!!n,46558,{timestamp:t}),n[1]){let a=n[1];a=(a+"000000000").substr(0,9),e=Number(a)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ln(t.seconds),nanos:ln(t.nanos)}}function ln(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Ss(t){return typeof t=="string"?Xn.fromBase64String(t):Xn.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const JE="server_timestamp",eT="__type__",tT="__previous_value__",nT="__local_write_time__";function R0(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[eT])===null||n===void 0?void 0:n.stringValue)===JE}function C0(t){const e=t.mapValue.fields[tT];return R0(e)?C0(e):e}function Cc(t){const e=As(t.mapValue.fields[nT].timestampValue);return new qt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XC{constructor(e,n,r,a,o,u,f,h,m,g){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=a,this.ssl=o,this.forceLongPolling=u,this.autoDetectLongPolling=f,this.longPollingOptions=h,this.useFetchStreams=m,this.isUsingEmulator=g}}const Xh="(default)";class Ic{constructor(e,n){this.projectId=e,this.database=n||Xh}static empty(){return new Ic("","")}get isDefaultDatabase(){return this.database===Xh}isEqual(e){return e instanceof Ic&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const rT="__type__",YC="__max__",wh={mapValue:{}},iT="__vector__",Yh="value";function bs(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?R0(t)?4:KC(t)?9007199254740991:WC(t)?10:11:Ke(28295,{value:t})}function Wi(t,e){if(t===e)return!0;const n=bs(t);if(n!==bs(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Cc(t).isEqual(Cc(e));case 3:return function(a,o){if(typeof a.timestampValue=="string"&&typeof o.timestampValue=="string"&&a.timestampValue.length===o.timestampValue.length)return a.timestampValue===o.timestampValue;const u=As(a.timestampValue),f=As(o.timestampValue);return u.seconds===f.seconds&&u.nanos===f.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(a,o){return Ss(a.bytesValue).isEqual(Ss(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(a,o){return ln(a.geoPointValue.latitude)===ln(o.geoPointValue.latitude)&&ln(a.geoPointValue.longitude)===ln(o.geoPointValue.longitude)}(t,e);case 2:return function(a,o){if("integerValue"in a&&"integerValue"in o)return ln(a.integerValue)===ln(o.integerValue);if("doubleValue"in a&&"doubleValue"in o){const u=ln(a.doubleValue),f=ln(o.doubleValue);return u===f?$h(u)===$h(f):isNaN(u)&&isNaN(f)}return!1}(t,e);case 9:return Ul(t.arrayValue.values||[],e.arrayValue.values||[],Wi);case 10:case 11:return function(a,o){const u=a.mapValue.fields||{},f=o.mapValue.fields||{};if(Ex(u)!==Ex(f))return!1;for(const h in u)if(u.hasOwnProperty(h)&&(f[h]===void 0||!Wi(u[h],f[h])))return!1;return!0}(t,e);default:return Ke(52216,{left:t})}}function Nc(t,e){return(t.values||[]).find(n=>Wi(n,e))!==void 0}function jl(t,e){if(t===e)return 0;const n=bs(t),r=bs(e);if(n!==r)return st(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return st(t.booleanValue,e.booleanValue);case 2:return function(o,u){const f=ln(o.integerValue||o.doubleValue),h=ln(u.integerValue||u.doubleValue);return f<h?-1:f>h?1:f===h?0:isNaN(f)?isNaN(h)?0:-1:1}(t,e);case 3:return wx(t.timestampValue,e.timestampValue);case 4:return wx(Cc(t),Cc(e));case 5:return Np(t.stringValue,e.stringValue);case 6:return function(o,u){const f=Ss(o),h=Ss(u);return f.compareTo(h)}(t.bytesValue,e.bytesValue);case 7:return function(o,u){const f=o.split("/"),h=u.split("/");for(let m=0;m<f.length&&m<h.length;m++){const g=st(f[m],h[m]);if(g!==0)return g}return st(f.length,h.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,u){const f=st(ln(o.latitude),ln(u.latitude));return f!==0?f:st(ln(o.longitude),ln(u.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return Ax(t.arrayValue,e.arrayValue);case 10:return function(o,u){var f,h,m,g;const y=o.fields||{},_=u.fields||{},E=(f=y[Yh])===null||f===void 0?void 0:f.arrayValue,w=(h=_[Yh])===null||h===void 0?void 0:h.arrayValue,T=st(((m=E?.values)===null||m===void 0?void 0:m.length)||0,((g=w?.values)===null||g===void 0?void 0:g.length)||0);return T!==0?T:Ax(E,w)}(t.mapValue,e.mapValue);case 11:return function(o,u){if(o===wh.mapValue&&u===wh.mapValue)return 0;if(o===wh.mapValue)return 1;if(u===wh.mapValue)return-1;const f=o.fields||{},h=Object.keys(f),m=u.fields||{},g=Object.keys(m);h.sort(),g.sort();for(let y=0;y<h.length&&y<g.length;++y){const _=Np(h[y],g[y]);if(_!==0)return _;const E=jl(f[h[y]],m[g[y]]);if(E!==0)return E}return st(h.length,g.length)}(t.mapValue,e.mapValue);default:throw Ke(23264,{le:n})}}function wx(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return st(t,e);const n=As(t),r=As(e),a=st(n.seconds,r.seconds);return a!==0?a:st(n.nanos,r.nanos)}function Ax(t,e){const n=t.values||[],r=e.values||[];for(let a=0;a<n.length&&a<r.length;++a){const o=jl(n[a],r[a]);if(o)return o}return st(n.length,r.length)}function zl(t){return Dp(t)}function Dp(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=As(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Ss(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return $e.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",a=!0;for(const o of n.values||[])a?a=!1:r+=",",r+=Dp(o);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let a="{",o=!0;for(const u of r)o?o=!1:a+=",",a+=`${u}:${Dp(n.fields[u])}`;return a+"}"}(t.mapValue):Ke(61005,{value:t})}function Lh(t){switch(bs(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=C0(t);return e?16+Lh(e):16;case 5:return 2*t.stringValue.length;case 6:return Ss(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((a,o)=>a+Lh(o),0)}(t.arrayValue);case 10:case 11:return function(r){let a=0;return Ao(r.fields,(o,u)=>{a+=o.length+Lh(u)}),a}(t.mapValue);default:throw Ke(13486,{value:t})}}function Wh(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function Op(t){return!!t&&"integerValue"in t}function pg(t){return!!t&&"arrayValue"in t}function Sx(t){return!!t&&"nullValue"in t}function bx(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Vh(t){return!!t&&"mapValue"in t}function WC(t){var e,n;return((n=(((e=t?.mapValue)===null||e===void 0?void 0:e.fields)||{})[rT])===null||n===void 0?void 0:n.stringValue)===iT}function pc(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return Ao(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=pc(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=pc(t.arrayValue.values[n]);return e}return Object.assign({},t)}function KC(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===YC}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ti{constructor(e){this.value=e}static empty(){return new ti({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!Vh(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=pc(n)}setAll(e){let n=Hn.emptyPath(),r={},a=[];e.forEach((u,f)=>{if(!n.isImmediateParentOf(f)){const h=this.getFieldsMap(n);this.applyChanges(h,r,a),r={},a=[],n=f.popLast()}u?r[f.lastSegment()]=pc(u):a.push(f.lastSegment())});const o=this.getFieldsMap(n);this.applyChanges(o,r,a)}delete(e){const n=this.field(e.popLast());Vh(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Wi(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let a=n.mapValue.fields[e.get(r)];Vh(a)&&a.mapValue.fields||(a={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=a),n=a}return n.mapValue.fields}applyChanges(e,n,r){Ao(n,(a,o)=>e[a]=o);for(const a of r)delete e[a]}clone(){return new ti(pc(this.value))}}function aT(t){const e=[];return Ao(t.fields,(n,r)=>{const a=new Hn([n]);if(Vh(r)){const o=aT(r.mapValue).fields;if(o.length===0)e.push(a);else for(const u of o)e.push(a.child(u))}else e.push(a)}),new mi(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class tr{constructor(e,n,r,a,o,u,f){this.key=e,this.documentType=n,this.version=r,this.readTime=a,this.createTime=o,this.data=u,this.documentState=f}static newInvalidDocument(e){return new tr(e,0,et.min(),et.min(),et.min(),ti.empty(),0)}static newFoundDocument(e,n,r,a){return new tr(e,1,n,et.min(),r,a,0)}static newNoDocument(e,n){return new tr(e,2,n,et.min(),et.min(),ti.empty(),0)}static newUnknownDocument(e,n){return new tr(e,3,n,et.min(),et.min(),ti.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(et.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ti.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ti.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=et.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof tr&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new tr(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hl{constructor(e,n){this.position=e,this.inclusive=n}}function Rx(t,e,n){let r=0;for(let a=0;a<t.position.length;a++){const o=e[a],u=t.position[a];if(o.field.isKeyField()?r=$e.comparator($e.fromName(u.referenceValue),n.key):r=jl(u,n.data.field(o.field)),o.dir==="desc"&&(r*=-1),r!==0)break}return r}function Cx(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Wi(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dc{constructor(e,n="asc"){this.field=e,this.dir=n}}function QC(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sT{}class pn extends sT{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new JC(e,n,r):n==="array-contains"?new nI(e,r):n==="in"?new rI(e,r):n==="not-in"?new iI(e,r):n==="array-contains-any"?new aI(e,r):new pn(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new eI(e,r):new tI(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(jl(n,this.value)):n!==null&&bs(this.value)===bs(n)&&this.matchesComparison(jl(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Ke(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class vi extends sT{constructor(e,n){super(),this.filters=e,this.op=n,this.he=null}static create(e,n){return new vi(e,n)}matches(e){return oT(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.he!==null||(this.he=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.he}getFilters(){return Object.assign([],this.filters)}}function oT(t){return t.op==="and"}function lT(t){return ZC(t)&&oT(t)}function ZC(t){for(const e of t.filters)if(e instanceof vi)return!1;return!0}function Fp(t){if(t instanceof pn)return t.field.canonicalString()+t.op.toString()+zl(t.value);if(lT(t))return t.filters.map(e=>Fp(e)).join(",");{const e=t.filters.map(n=>Fp(n)).join(",");return`${t.op}(${e})`}}function uT(t,e){return t instanceof pn?function(r,a){return a instanceof pn&&r.op===a.op&&r.field.isEqual(a.field)&&Wi(r.value,a.value)}(t,e):t instanceof vi?function(r,a){return a instanceof vi&&r.op===a.op&&r.filters.length===a.filters.length?r.filters.reduce((o,u,f)=>o&&uT(u,a.filters[f]),!0):!1}(t,e):void Ke(19439)}function cT(t){return t instanceof pn?function(n){return`${n.field.canonicalString()} ${n.op} ${zl(n.value)}`}(t):t instanceof vi?function(n){return n.op.toString()+" {"+n.getFilters().map(cT).join(" ,")+"}"}(t):"Filter"}class JC extends pn{constructor(e,n,r){super(e,n,r),this.key=$e.fromName(r.referenceValue)}matches(e){const n=$e.comparator(e.key,this.key);return this.matchesComparison(n)}}class eI extends pn{constructor(e,n){super(e,"in",n),this.keys=fT("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class tI extends pn{constructor(e,n){super(e,"not-in",n),this.keys=fT("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function fT(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>$e.fromName(r.referenceValue))}class nI extends pn{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return pg(n)&&Nc(n.arrayValue,this.value)}}class rI extends pn{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&Nc(this.value.arrayValue,n)}}class iI extends pn{constructor(e,n){super(e,"not-in",n)}matches(e){if(Nc(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!Nc(this.value.arrayValue,n)}}class aI extends pn{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!pg(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>Nc(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sI{constructor(e,n=null,r=[],a=[],o=null,u=null,f=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=a,this.limit=o,this.startAt=u,this.endAt=f,this.Pe=null}}function Ix(t,e=null,n=[],r=[],a=null,o=null,u=null){return new sI(t,e,n,r,a,o,u)}function gg(t){const e=tt(t);if(e.Pe===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Fp(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(o){return o.field.canonicalString()+o.dir}(r)).join(","),b0(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>zl(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>zl(r)).join(",")),e.Pe=n}return e.Pe}function vg(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!QC(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!uT(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!Cx(t.startAt,e.startAt)&&Cx(t.endAt,e.endAt)}function Mp(t){return $e.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class So{constructor(e,n=null,r=[],a=[],o=null,u="F",f=null,h=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=a,this.limit=o,this.limitType=u,this.startAt=f,this.endAt=h,this.Te=null,this.Ie=null,this.de=null,this.startAt,this.endAt}}function oI(t,e,n,r,a,o,u,f){return new So(t,e,n,r,a,o,u,f)}function _g(t){return new So(t)}function Nx(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function yg(t){return t.collectionGroup!==null}function Ol(t){const e=tt(t);if(e.Te===null){e.Te=[];const n=new Set;for(const o of e.explicitOrderBy)e.Te.push(o),n.add(o.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(u){let f=new Sn(Hn.comparator);return u.filters.forEach(h=>{h.getFlattenedFilters().forEach(m=>{m.isInequality()&&(f=f.add(m.field))})}),f})(e).forEach(o=>{n.has(o.canonicalString())||o.isKeyField()||e.Te.push(new Dc(o,r))}),n.has(Hn.keyField().canonicalString())||e.Te.push(new Dc(Hn.keyField(),r))}return e.Te}function Hi(t){const e=tt(t);return e.Ie||(e.Ie=lI(e,Ol(t))),e.Ie}function lI(t,e){if(t.limitType==="F")return Ix(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(a=>{const o=a.dir==="desc"?"asc":"desc";return new Dc(a.field,o)});const n=t.endAt?new Hl(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new Hl(t.startAt.position,t.startAt.inclusive):null;return Ix(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Pp(t,e){const n=t.filters.concat([e]);return new So(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Kh(t,e,n){return new So(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function I0(t,e){return vg(Hi(t),Hi(e))&&t.limitType===e.limitType}function hT(t){return`${gg(Hi(t))}|lt:${t.limitType}`}function bl(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(a=>cT(a)).join(", ")}]`),b0(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(a=>function(u){return`${u.field.canonicalString()} (${u.dir})`}(a)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(a=>zl(a)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(a=>zl(a)).join(",")),`Target(${r})`}(Hi(t))}; limitType=${t.limitType})`}function N0(t,e){return e.isFoundDocument()&&function(r,a){const o=a.key.path;return r.collectionGroup!==null?a.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(o):$e.isDocumentKey(r.path)?r.path.isEqual(o):r.path.isImmediateParentOf(o)}(t,e)&&function(r,a){for(const o of Ol(r))if(!o.field.isKeyField()&&a.data.field(o.field)===null)return!1;return!0}(t,e)&&function(r,a){for(const o of r.filters)if(!o.matches(a))return!1;return!0}(t,e)&&function(r,a){return!(r.startAt&&!function(u,f,h){const m=Rx(u,f,h);return u.inclusive?m<=0:m<0}(r.startAt,Ol(r),a)||r.endAt&&!function(u,f,h){const m=Rx(u,f,h);return u.inclusive?m>=0:m>0}(r.endAt,Ol(r),a))}(t,e)}function uI(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function dT(t){return(e,n)=>{let r=!1;for(const a of Ol(t)){const o=cI(a,e,n);if(o!==0)return o;r=r||a.field.isKeyField()}return 0}}function cI(t,e,n){const r=t.field.isKeyField()?$e.comparator(e.key,n.key):function(o,u,f){const h=u.data.field(o),m=f.data.field(o);return h!==null&&m!==null?jl(h,m):Ke(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Ke(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bo{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[a,o]of r)if(this.equalsFn(a,e))return o}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),a=this.inner[r];if(a===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let o=0;o<a.length;o++)if(this.equalsFn(a[o][0],e))return void(a[o]=[e,n]);a.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let a=0;a<r.length;a++)if(this.equalsFn(r[a][0],e))return r.length===1?delete this.inner[n]:r.splice(a,1),this.innerSize--,!0;return!1}forEach(e){Ao(this.inner,(n,r)=>{for(const[a,o]of r)e(a,o)})}isEmpty(){return QE(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fI=new Zt($e.comparator);function Na(){return fI}const mT=new Zt($e.comparator);function cc(...t){let e=mT;for(const n of t)e=e.insert(n.key,n);return e}function pT(t){let e=mT;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function ho(){return gc()}function gT(){return gc()}function gc(){return new bo(t=>t.toString(),(t,e)=>t.isEqual(e))}const hI=new Zt($e.comparator),dI=new Sn($e.comparator);function ht(...t){let e=dI;for(const n of t)e=e.add(n);return e}const mI=new Sn(st);function pI(){return mI}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xg(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$h(e)?"-0":e}}function vT(t){return{integerValue:""+t}}function gI(t,e){return HC(e)?vT(e):xg(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class D0{constructor(){this._=void 0}}function vI(t,e,n){return t instanceof Qh?function(a,o){const u={fields:{[eT]:{stringValue:JE},[nT]:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return o&&R0(o)&&(o=C0(o)),o&&(u.fields[tT]=o),{mapValue:u}}(n,e):t instanceof Oc?yT(t,e):t instanceof Fc?xT(t,e):function(a,o){const u=_T(a,o),f=Dx(u)+Dx(a.Ee);return Op(u)&&Op(a.Ee)?vT(f):xg(a.serializer,f)}(t,e)}function _I(t,e,n){return t instanceof Oc?yT(t,e):t instanceof Fc?xT(t,e):n}function _T(t,e){return t instanceof Zh?function(r){return Op(r)||function(o){return!!o&&"doubleValue"in o}(r)}(e)?e:{integerValue:0}:null}class Qh extends D0{}class Oc extends D0{constructor(e){super(),this.elements=e}}function yT(t,e){const n=ET(e);for(const r of t.elements)n.some(a=>Wi(a,r))||n.push(r);return{arrayValue:{values:n}}}class Fc extends D0{constructor(e){super(),this.elements=e}}function xT(t,e){let n=ET(e);for(const r of t.elements)n=n.filter(a=>!Wi(a,r));return{arrayValue:{values:n}}}class Zh extends D0{constructor(e,n){super(),this.serializer=e,this.Ee=n}}function Dx(t){return ln(t.integerValue||t.doubleValue)}function ET(t){return pg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}function yI(t,e){return t.field.isEqual(e.field)&&function(r,a){return r instanceof Oc&&a instanceof Oc||r instanceof Fc&&a instanceof Fc?Ul(r.elements,a.elements,Wi):r instanceof Zh&&a instanceof Zh?Wi(r.Ee,a.Ee):r instanceof Qh&&a instanceof Qh}(t.transform,e.transform)}class xI{constructor(e,n){this.version=e,this.transformResults=n}}class Gi{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new Gi}static exists(e){return new Gi(void 0,e)}static updateTime(e){return new Gi(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Bh(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class O0{}function TT(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new Eg(t.key,Gi.none()):new Xc(t.key,t.data,Gi.none());{const n=t.data,r=ti.empty();let a=new Sn(Hn.comparator);for(let o of e.fields)if(!a.has(o)){let u=n.field(o);u===null&&o.length>1&&(o=o.popLast(),u=n.field(o)),u===null?r.delete(o):r.set(o,u),a=a.add(o)}return new Ro(t.key,r,new mi(a.toArray()),Gi.none())}}function EI(t,e,n){t instanceof Xc?function(a,o,u){const f=a.value.clone(),h=Fx(a.fieldTransforms,o,u.transformResults);f.setAll(h),o.convertToFoundDocument(u.version,f).setHasCommittedMutations()}(t,e,n):t instanceof Ro?function(a,o,u){if(!Bh(a.precondition,o))return void o.convertToUnknownDocument(u.version);const f=Fx(a.fieldTransforms,o,u.transformResults),h=o.data;h.setAll(wT(a)),h.setAll(f),o.convertToFoundDocument(u.version,h).setHasCommittedMutations()}(t,e,n):function(a,o,u){o.convertToNoDocument(u.version).setHasCommittedMutations()}(0,e,n)}function vc(t,e,n,r){return t instanceof Xc?function(o,u,f,h){if(!Bh(o.precondition,u))return f;const m=o.value.clone(),g=Mx(o.fieldTransforms,h,u);return m.setAll(g),u.convertToFoundDocument(u.version,m).setHasLocalMutations(),null}(t,e,n,r):t instanceof Ro?function(o,u,f,h){if(!Bh(o.precondition,u))return f;const m=Mx(o.fieldTransforms,h,u),g=u.data;return g.setAll(wT(o)),g.setAll(m),u.convertToFoundDocument(u.version,g).setHasLocalMutations(),f===null?null:f.unionWith(o.fieldMask.fields).unionWith(o.fieldTransforms.map(y=>y.field))}(t,e,n,r):function(o,u,f){return Bh(o.precondition,u)?(u.convertToNoDocument(u.version).setHasLocalMutations(),null):f}(t,e,n)}function TI(t,e){let n=null;for(const r of t.fieldTransforms){const a=e.data.field(r.field),o=_T(r.transform,a||null);o!=null&&(n===null&&(n=ti.empty()),n.set(r.field,o))}return n||null}function Ox(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,a){return r===void 0&&a===void 0||!(!r||!a)&&Ul(r,a,(o,u)=>yI(o,u))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class Xc extends O0{constructor(e,n,r,a=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=a,this.type=0}getFieldMask(){return null}}class Ro extends O0{constructor(e,n,r,a,o=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=a,this.fieldTransforms=o,this.type=1}getFieldMask(){return this.fieldMask}}function wT(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function Fx(t,e,n){const r=new Map;Rt(t.length===n.length,32656,{Ae:n.length,Re:t.length});for(let a=0;a<n.length;a++){const o=t[a],u=o.transform,f=e.data.field(o.field);r.set(o.field,_I(u,f,n[a]))}return r}function Mx(t,e,n){const r=new Map;for(const a of t){const o=a.transform,u=n.data.field(a.field);r.set(a.field,vI(o,u,e))}return r}class Eg extends O0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class wI extends O0{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AI{constructor(e,n,r,a){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=a}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let a=0;a<this.mutations.length;a++){const o=this.mutations[a];o.key.isEqual(e.key)&&EI(o,e,r[a])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=vc(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=vc(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=gT();return this.mutations.forEach(a=>{const o=e.get(a.key),u=o.overlayedDocument;let f=this.applyToLocalView(u,o.mutatedFields);f=n.has(a.key)?null:f;const h=TT(u,f);h!==null&&r.set(a.key,h),u.isValidDocument()||u.convertToNoDocument(et.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),ht())}isEqual(e){return this.batchId===e.batchId&&Ul(this.mutations,e.mutations,(n,r)=>Ox(n,r))&&Ul(this.baseMutations,e.baseMutations,(n,r)=>Ox(n,r))}}class Tg{constructor(e,n,r,a){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=a}static from(e,n,r){Rt(e.mutations.length===r.length,58842,{Ve:e.mutations.length,me:r.length});let a=function(){return hI}();const o=e.mutations;for(let u=0;u<o.length;u++)a=a.insert(o[u].key,r[u].version);return new Tg(e,n,r,a)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SI{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bI{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mn,_t;function RI(t){switch(t){case _e.OK:return Ke(64938);case _e.CANCELLED:case _e.UNKNOWN:case _e.DEADLINE_EXCEEDED:case _e.RESOURCE_EXHAUSTED:case _e.INTERNAL:case _e.UNAVAILABLE:case _e.UNAUTHENTICATED:return!1;case _e.INVALID_ARGUMENT:case _e.NOT_FOUND:case _e.ALREADY_EXISTS:case _e.PERMISSION_DENIED:case _e.FAILED_PRECONDITION:case _e.ABORTED:case _e.OUT_OF_RANGE:case _e.UNIMPLEMENTED:case _e.DATA_LOSS:return!0;default:return Ke(15467,{code:t})}}function AT(t){if(t===void 0)return Ia("GRPC error has no .code"),_e.UNKNOWN;switch(t){case mn.OK:return _e.OK;case mn.CANCELLED:return _e.CANCELLED;case mn.UNKNOWN:return _e.UNKNOWN;case mn.DEADLINE_EXCEEDED:return _e.DEADLINE_EXCEEDED;case mn.RESOURCE_EXHAUSTED:return _e.RESOURCE_EXHAUSTED;case mn.INTERNAL:return _e.INTERNAL;case mn.UNAVAILABLE:return _e.UNAVAILABLE;case mn.UNAUTHENTICATED:return _e.UNAUTHENTICATED;case mn.INVALID_ARGUMENT:return _e.INVALID_ARGUMENT;case mn.NOT_FOUND:return _e.NOT_FOUND;case mn.ALREADY_EXISTS:return _e.ALREADY_EXISTS;case mn.PERMISSION_DENIED:return _e.PERMISSION_DENIED;case mn.FAILED_PRECONDITION:return _e.FAILED_PRECONDITION;case mn.ABORTED:return _e.ABORTED;case mn.OUT_OF_RANGE:return _e.OUT_OF_RANGE;case mn.UNIMPLEMENTED:return _e.UNIMPLEMENTED;case mn.DATA_LOSS:return _e.DATA_LOSS;default:return Ke(39323,{code:t})}}(_t=mn||(mn={}))[_t.OK=0]="OK",_t[_t.CANCELLED=1]="CANCELLED",_t[_t.UNKNOWN=2]="UNKNOWN",_t[_t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",_t[_t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",_t[_t.NOT_FOUND=5]="NOT_FOUND",_t[_t.ALREADY_EXISTS=6]="ALREADY_EXISTS",_t[_t.PERMISSION_DENIED=7]="PERMISSION_DENIED",_t[_t.UNAUTHENTICATED=16]="UNAUTHENTICATED",_t[_t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",_t[_t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",_t[_t.ABORTED=10]="ABORTED",_t[_t.OUT_OF_RANGE=11]="OUT_OF_RANGE",_t[_t.UNIMPLEMENTED=12]="UNIMPLEMENTED",_t[_t.INTERNAL=13]="INTERNAL",_t[_t.UNAVAILABLE=14]="UNAVAILABLE",_t[_t.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CI=new ps([4294967295,4294967295],0);function Px(t){const e=XE().encode(t),n=new BE;return n.update(e),new Uint8Array(n.digest())}function kx(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),a=e.getUint32(8,!0),o=e.getUint32(12,!0);return[new ps([n,r],0),new ps([a,o],0)]}class wg{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new fc(`Invalid padding: ${n}`);if(r<0)throw new fc(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new fc(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new fc(`Invalid padding when bitmap length is 0: ${n}`);this.fe=8*e.length-n,this.ge=ps.fromNumber(this.fe)}pe(e,n,r){let a=e.add(n.multiply(ps.fromNumber(r)));return a.compare(CI)===1&&(a=new ps([a.getBits(0),a.getBits(1)],0)),a.modulo(this.ge).toNumber()}ye(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.fe===0)return!1;const n=Px(e),[r,a]=kx(n);for(let o=0;o<this.hashCount;o++){const u=this.pe(r,a,o);if(!this.ye(u))return!1}return!0}static create(e,n,r){const a=e%8==0?0:8-e%8,o=new Uint8Array(Math.ceil(e/8)),u=new wg(o,a,n);return r.forEach(f=>u.insert(f)),u}insert(e){if(this.fe===0)return;const n=Px(e),[r,a]=kx(n);for(let o=0;o<this.hashCount;o++){const u=this.pe(r,a,o);this.we(u)}}we(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class fc extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class F0{constructor(e,n,r,a,o){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=a,this.resolvedLimboDocuments=o}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const a=new Map;return a.set(e,Yc.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new F0(et.min(),a,new Zt(st),Na(),ht())}}class Yc{constructor(e,n,r,a,o){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=a,this.removedDocuments=o}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new Yc(r,n,ht(),ht(),ht())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uh{constructor(e,n,r,a){this.Se=e,this.removedTargetIds=n,this.key=r,this.be=a}}class ST{constructor(e,n){this.targetId=e,this.De=n}}class bT{constructor(e,n,r=Xn.EMPTY_BYTE_STRING,a=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=a}}class Lx{constructor(){this.ve=0,this.Ce=Vx(),this.Fe=Xn.EMPTY_BYTE_STRING,this.Me=!1,this.xe=!0}get current(){return this.Me}get resumeToken(){return this.Fe}get Oe(){return this.ve!==0}get Ne(){return this.xe}Be(e){e.approximateByteSize()>0&&(this.xe=!0,this.Fe=e)}Le(){let e=ht(),n=ht(),r=ht();return this.Ce.forEach((a,o)=>{switch(o){case 0:e=e.add(a);break;case 2:n=n.add(a);break;case 1:r=r.add(a);break;default:Ke(38017,{changeType:o})}}),new Yc(this.Fe,this.Me,e,n,r)}ke(){this.xe=!1,this.Ce=Vx()}qe(e,n){this.xe=!0,this.Ce=this.Ce.insert(e,n)}Qe(e){this.xe=!0,this.Ce=this.Ce.remove(e)}$e(){this.ve+=1}Ue(){this.ve-=1,Rt(this.ve>=0,3241,{ve:this.ve})}Ke(){this.xe=!0,this.Me=!0}}class II{constructor(e){this.We=e,this.Ge=new Map,this.ze=Na(),this.je=Ah(),this.Je=Ah(),this.He=new Zt(st)}Ye(e){for(const n of e.Se)e.be&&e.be.isFoundDocument()?this.Ze(n,e.be):this.Xe(n,e.key,e.be);for(const n of e.removedTargetIds)this.Xe(n,e.key,e.be)}et(e){this.forEachTarget(e,n=>{const r=this.tt(n);switch(e.state){case 0:this.nt(n)&&r.Be(e.resumeToken);break;case 1:r.Ue(),r.Oe||r.ke(),r.Be(e.resumeToken);break;case 2:r.Ue(),r.Oe||this.removeTarget(n);break;case 3:this.nt(n)&&(r.Ke(),r.Be(e.resumeToken));break;case 4:this.nt(n)&&(this.rt(n),r.Be(e.resumeToken));break;default:Ke(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.Ge.forEach((r,a)=>{this.nt(a)&&n(a)})}it(e){const n=e.targetId,r=e.De.count,a=this.st(n);if(a){const o=a.target;if(Mp(o))if(r===0){const u=new $e(o.path);this.Xe(n,u,tr.newNoDocument(u,et.min()))}else Rt(r===1,20013,{expectedCount:r});else{const u=this.ot(n);if(u!==r){const f=this._t(e),h=f?this.ut(f,e,u):1;if(h!==0){this.rt(n);const m=h===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.He=this.He.insert(n,m)}}}}}_t(e){const n=e.De.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:a=0},hashCount:o=0}=n;let u,f;try{u=Ss(r).toUint8Array()}catch(h){if(h instanceof ZE)return Es("Decoding the base64 bloom filter in existence filter failed ("+h.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw h}try{f=new wg(u,a,o)}catch(h){return Es(h instanceof fc?"BloomFilter error: ":"Applying bloom filter failed: ",h),null}return f.fe===0?null:f}ut(e,n,r){return n.De.count===r-this.ht(e,n.targetId)?0:2}ht(e,n){const r=this.We.getRemoteKeysForTarget(n);let a=0;return r.forEach(o=>{const u=this.We.lt(),f=`projects/${u.projectId}/databases/${u.database}/documents/${o.path.canonicalString()}`;e.mightContain(f)||(this.Xe(n,o,null),a++)}),a}Pt(e){const n=new Map;this.Ge.forEach((o,u)=>{const f=this.st(u);if(f){if(o.current&&Mp(f.target)){const h=new $e(f.target.path);this.Tt(h).has(u)||this.It(u,h)||this.Xe(u,h,tr.newNoDocument(h,e))}o.Ne&&(n.set(u,o.Le()),o.ke())}});let r=ht();this.Je.forEach((o,u)=>{let f=!0;u.forEachWhile(h=>{const m=this.st(h);return!m||m.purpose==="TargetPurposeLimboResolution"||(f=!1,!1)}),f&&(r=r.add(o))}),this.ze.forEach((o,u)=>u.setReadTime(e));const a=new F0(e,n,this.He,this.ze,r);return this.ze=Na(),this.je=Ah(),this.Je=Ah(),this.He=new Zt(st),a}Ze(e,n){if(!this.nt(e))return;const r=this.It(e,n.key)?2:0;this.tt(e).qe(n.key,r),this.ze=this.ze.insert(n.key,n),this.je=this.je.insert(n.key,this.Tt(n.key).add(e)),this.Je=this.Je.insert(n.key,this.dt(n.key).add(e))}Xe(e,n,r){if(!this.nt(e))return;const a=this.tt(e);this.It(e,n)?a.qe(n,1):a.Qe(n),this.Je=this.Je.insert(n,this.dt(n).delete(e)),this.Je=this.Je.insert(n,this.dt(n).add(e)),r&&(this.ze=this.ze.insert(n,r))}removeTarget(e){this.Ge.delete(e)}ot(e){const n=this.tt(e).Le();return this.We.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}$e(e){this.tt(e).$e()}tt(e){let n=this.Ge.get(e);return n||(n=new Lx,this.Ge.set(e,n)),n}dt(e){let n=this.Je.get(e);return n||(n=new Sn(st),this.Je=this.Je.insert(e,n)),n}Tt(e){let n=this.je.get(e);return n||(n=new Sn(st),this.je=this.je.insert(e,n)),n}nt(e){const n=this.st(e)!==null;return n||je("WatchChangeAggregator","Detected inactive target",e),n}st(e){const n=this.Ge.get(e);return n&&n.Oe?null:this.We.Et(e)}rt(e){this.Ge.set(e,new Lx),this.We.getRemoteKeysForTarget(e).forEach(n=>{this.Xe(e,n,null)})}It(e,n){return this.We.getRemoteKeysForTarget(e).has(n)}}function Ah(){return new Zt($e.comparator)}function Vx(){return new Zt($e.comparator)}const NI={asc:"ASCENDING",desc:"DESCENDING"},DI={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},OI={and:"AND",or:"OR"};class FI{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function kp(t,e){return t.useProto3Json||b0(e)?e:{value:e}}function Jh(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function RT(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function MI(t,e){return Jh(t,e.toTimestamp())}function qi(t){return Rt(!!t,49232),et.fromTimestamp(function(n){const r=As(n);return new qt(r.seconds,r.nanos)}(t))}function Ag(t,e){return Lp(t,e).canonicalString()}function Lp(t,e){const n=function(a){return new jt(["projects",a.projectId,"databases",a.database])}(t).child("documents");return e===void 0?n:n.child(e)}function CT(t){const e=jt.fromString(t);return Rt(FT(e),10190,{key:e.toString()}),e}function Vp(t,e){return Ag(t.databaseId,e.path)}function ip(t,e){const n=CT(e);if(n.get(1)!==t.databaseId.projectId)throw new ke(_e.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new ke(_e.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new $e(NT(n))}function IT(t,e){return Ag(t.databaseId,e)}function PI(t){const e=CT(t);return e.length===4?jt.emptyPath():NT(e)}function Bp(t){return new jt(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function NT(t){return Rt(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function Bx(t,e,n){return{name:Vp(t,e),fields:n.value.mapValue.fields}}function kI(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(m){return m==="NO_CHANGE"?0:m==="ADD"?1:m==="REMOVE"?2:m==="CURRENT"?3:m==="RESET"?4:Ke(39313,{state:m})}(e.targetChange.targetChangeType||"NO_CHANGE"),a=e.targetChange.targetIds||[],o=function(m,g){return m.useProto3Json?(Rt(g===void 0||typeof g=="string",58123),Xn.fromBase64String(g||"")):(Rt(g===void 0||g instanceof Buffer||g instanceof Uint8Array,16193),Xn.fromUint8Array(g||new Uint8Array))}(t,e.targetChange.resumeToken),u=e.targetChange.cause,f=u&&function(m){const g=m.code===void 0?_e.UNKNOWN:AT(m.code);return new ke(g,m.message||"")}(u);n=new bT(r,a,o,f||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const a=ip(t,r.document.name),o=qi(r.document.updateTime),u=r.document.createTime?qi(r.document.createTime):et.min(),f=new ti({mapValue:{fields:r.document.fields}}),h=tr.newFoundDocument(a,o,u,f),m=r.targetIds||[],g=r.removedTargetIds||[];n=new Uh(m,g,h.key,h)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const a=ip(t,r.document),o=r.readTime?qi(r.readTime):et.min(),u=tr.newNoDocument(a,o),f=r.removedTargetIds||[];n=new Uh([],f,u.key,u)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const a=ip(t,r.document),o=r.removedTargetIds||[];n=new Uh([],o,a,null)}else{if(!("filter"in e))return Ke(11601,{At:e});{e.filter;const r=e.filter;r.targetId;const{count:a=0,unchangedNames:o}=r,u=new bI(a,o),f=r.targetId;n=new ST(f,u)}}return n}function LI(t,e){let n;if(e instanceof Xc)n={update:Bx(t,e.key,e.value)};else if(e instanceof Eg)n={delete:Vp(t,e.key)};else if(e instanceof Ro)n={update:Bx(t,e.key,e.data),updateMask:$I(e.fieldMask)};else{if(!(e instanceof wI))return Ke(16599,{Rt:e.type});n={verify:Vp(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(o,u){const f=u.transform;if(f instanceof Qh)return{fieldPath:u.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(f instanceof Oc)return{fieldPath:u.field.canonicalString(),appendMissingElements:{values:f.elements}};if(f instanceof Fc)return{fieldPath:u.field.canonicalString(),removeAllFromArray:{values:f.elements}};if(f instanceof Zh)return{fieldPath:u.field.canonicalString(),increment:f.Ee};throw Ke(20930,{transform:u.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(a,o){return o.updateTime!==void 0?{updateTime:MI(a,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:Ke(27497)}(t,e.precondition)),n}function VI(t,e){return t&&t.length>0?(Rt(e!==void 0,14353),t.map(n=>function(a,o){let u=a.updateTime?qi(a.updateTime):qi(o);return u.isEqual(et.min())&&(u=qi(o)),new xI(u,a.transformResults||[])}(n,e))):[]}function BI(t,e){return{documents:[IT(t,e.path)]}}function UI(t,e){const n={structuredQuery:{}},r=e.path;let a;e.collectionGroup!==null?(a=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(a=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=IT(t,a);const o=function(m){if(m.length!==0)return OT(vi.create(m,"and"))}(e.filters);o&&(n.structuredQuery.where=o);const u=function(m){if(m.length!==0)return m.map(g=>function(_){return{field:Rl(_.field),direction:HI(_.dir)}}(g))}(e.orderBy);u&&(n.structuredQuery.orderBy=u);const f=kp(t,e.limit);return f!==null&&(n.structuredQuery.limit=f),e.startAt&&(n.structuredQuery.startAt=function(m){return{before:m.inclusive,values:m.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(m){return{before:!m.inclusive,values:m.position}}(e.endAt)),{Vt:n,parent:a}}function jI(t){let e=PI(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let a=null;if(r>0){Rt(r===1,65062);const g=n.from[0];g.allDescendants?a=g.collectionId:e=e.child(g.collectionId)}let o=[];n.where&&(o=function(y){const _=DT(y);return _ instanceof vi&&lT(_)?_.getFilters():[_]}(n.where));let u=[];n.orderBy&&(u=function(y){return y.map(_=>function(w){return new Dc(Cl(w.field),function(b){switch(b){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(w.direction))}(_))}(n.orderBy));let f=null;n.limit&&(f=function(y){let _;return _=typeof y=="object"?y.value:y,b0(_)?null:_}(n.limit));let h=null;n.startAt&&(h=function(y){const _=!!y.before,E=y.values||[];return new Hl(E,_)}(n.startAt));let m=null;return n.endAt&&(m=function(y){const _=!y.before,E=y.values||[];return new Hl(E,_)}(n.endAt)),oI(e,a,u,o,f,"F",h,m)}function zI(t,e){const n=function(a){switch(a){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Ke(28987,{purpose:a})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function DT(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Cl(n.unaryFilter.field);return pn.create(r,"==",{doubleValue:NaN});case"IS_NULL":const a=Cl(n.unaryFilter.field);return pn.create(a,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const o=Cl(n.unaryFilter.field);return pn.create(o,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const u=Cl(n.unaryFilter.field);return pn.create(u,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Ke(61313);default:return Ke(60726)}}(t):t.fieldFilter!==void 0?function(n){return pn.create(Cl(n.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Ke(58110);default:return Ke(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return vi.create(n.compositeFilter.filters.map(r=>DT(r)),function(a){switch(a){case"AND":return"and";case"OR":return"or";default:return Ke(1026)}}(n.compositeFilter.op))}(t):Ke(30097,{filter:t})}function HI(t){return NI[t]}function GI(t){return DI[t]}function qI(t){return OI[t]}function Rl(t){return{fieldPath:t.canonicalString()}}function Cl(t){return Hn.fromServerFormat(t.fieldPath)}function OT(t){return t instanceof pn?function(n){if(n.op==="=="){if(bx(n.value))return{unaryFilter:{field:Rl(n.field),op:"IS_NAN"}};if(Sx(n.value))return{unaryFilter:{field:Rl(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(bx(n.value))return{unaryFilter:{field:Rl(n.field),op:"IS_NOT_NAN"}};if(Sx(n.value))return{unaryFilter:{field:Rl(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Rl(n.field),op:GI(n.op),value:n.value}}}(t):t instanceof vi?function(n){const r=n.getFilters().map(a=>OT(a));return r.length===1?r[0]:{compositeFilter:{op:qI(n.op),filters:r}}}(t):Ke(54877,{filter:t})}function $I(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function FT(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class cs{constructor(e,n,r,a,o=et.min(),u=et.min(),f=Xn.EMPTY_BYTE_STRING,h=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=a,this.snapshotVersion=o,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=f,this.expectedCount=h}withSequenceNumber(e){return new cs(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new cs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e){this.gt=e}}function YI(t){const e=jI({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Kh(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WI{constructor(){this.Dn=new KI}addToCollectionParentIndex(e,n){return this.Dn.add(n),we.resolve()}getCollectionParents(e,n){return we.resolve(this.Dn.getEntries(n))}addFieldIndex(e,n){return we.resolve()}deleteFieldIndex(e,n){return we.resolve()}deleteAllFieldIndexes(e){return we.resolve()}createTargetIndexes(e,n){return we.resolve()}getDocumentsMatchingTarget(e,n){return we.resolve(null)}getIndexType(e,n){return we.resolve(0)}getFieldIndexes(e,n){return we.resolve([])}getNextCollectionGroupToUpdate(e){return we.resolve(null)}getMinOffset(e,n){return we.resolve(ws.min())}getMinOffsetFromCollectionGroup(e,n){return we.resolve(ws.min())}updateCollectionGroup(e,n,r){return we.resolve()}updateIndexEntries(e,n){return we.resolve()}}class KI{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n]||new Sn(jt.comparator),o=!a.has(r);return this.index[n]=a.add(r),o}has(e){const n=e.lastSegment(),r=e.popLast(),a=this.index[n];return a&&a.has(r)}getEntries(e){return(this.index[e]||new Sn(jt.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ux={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},MT=41943040;class Tr{static withCacheSize(e){return new Tr(e,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Tr.DEFAULT_COLLECTION_PERCENTILE=10,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Tr.DEFAULT=new Tr(MT,Tr.DEFAULT_COLLECTION_PERCENTILE,Tr.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Tr.DISABLED=new Tr(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gl{constructor(e){this._r=e}next(){return this._r+=2,this._r}static ar(){return new Gl(0)}static ur(){return new Gl(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const jx="LruGarbageCollector",QI=1048576;function zx([t,e],[n,r]){const a=st(t,n);return a===0?st(e,r):a}class ZI{constructor(e){this.Tr=e,this.buffer=new Sn(zx),this.Ir=0}dr(){return++this.Ir}Er(e){const n=[e,this.dr()];if(this.buffer.size<this.Tr)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();zx(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class JI{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Ar=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Rr(6e4)}stop(){this.Ar&&(this.Ar.cancel(),this.Ar=null)}get started(){return this.Ar!==null}Rr(e){je(jx,`Garbage collection scheduled in ${e}ms`),this.Ar=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Ar=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){Jl(n)?je(jx,"Ignoring IndexedDB error during garbage collection: ",n):await Zl(n)}await this.Rr(3e5)})}}class eN{constructor(e,n){this.Vr=e,this.params=n}calculateTargetCount(e,n){return this.Vr.mr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return we.resolve(S0.ue);const r=new ZI(n);return this.Vr.forEachTarget(e,a=>r.Er(a.sequenceNumber)).next(()=>this.Vr.gr(e,a=>r.Er(a))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.Vr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.Vr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(je("LruGarbageCollector","Garbage collection skipped; disabled"),we.resolve(Ux)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(je("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ux):this.pr(e,n))}getCacheSize(e){return this.Vr.getCacheSize(e)}pr(e,n){let r,a,o,u,f,h,m;const g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(y=>(y>this.params.maximumSequenceNumbersToCollect?(je("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${y}`),a=this.params.maximumSequenceNumbersToCollect):a=y,u=Date.now(),this.nthSequenceNumber(e,a))).next(y=>(r=y,f=Date.now(),this.removeTargets(e,r,n))).next(y=>(o=y,h=Date.now(),this.removeOrphanedDocuments(e,r))).next(y=>(m=Date.now(),Sl()<=yt.DEBUG&&je("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${u-g}ms
	Determined least recently used ${a} in `+(f-u)+`ms
	Removed ${o} targets in `+(h-f)+`ms
	Removed ${y} documents in `+(m-h)+`ms
Total Duration: ${m-g}ms`),we.resolve({didRun:!0,sequenceNumbersCollected:a,targetsRemoved:o,documentsRemoved:y})))}}function tN(t,e){return new eN(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nN{constructor(){this.changes=new bo(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,tr.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?we.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rN{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iN{constructor(e,n,r,a){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=a}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(a=>(r=a,this.remoteDocumentCache.getEntry(e,n))).next(a=>(r!==null&&vc(r.mutation,a,mi.empty(),qt.now()),a))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,ht()).next(()=>r))}getLocalViewOfDocuments(e,n,r=ht()){const a=ho();return this.populateOverlays(e,a,n).next(()=>this.computeViews(e,n,a,r).next(o=>{let u=cc();return o.forEach((f,h)=>{u=u.insert(f,h.overlayedDocument)}),u}))}getOverlayedDocuments(e,n){const r=ho();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,ht()))}populateOverlays(e,n,r){const a=[];return r.forEach(o=>{n.has(o)||a.push(o)}),this.documentOverlayCache.getOverlays(e,a).next(o=>{o.forEach((u,f)=>{n.set(u,f)})})}computeViews(e,n,r,a){let o=Na();const u=gc(),f=function(){return gc()}();return n.forEach((h,m)=>{const g=r.get(m.key);a.has(m.key)&&(g===void 0||g.mutation instanceof Ro)?o=o.insert(m.key,m):g!==void 0?(u.set(m.key,g.mutation.getFieldMask()),vc(g.mutation,m,g.mutation.getFieldMask(),qt.now())):u.set(m.key,mi.empty())}),this.recalculateAndSaveOverlays(e,o).next(h=>(h.forEach((m,g)=>u.set(m,g)),n.forEach((m,g)=>{var y;return f.set(m,new rN(g,(y=u.get(m))!==null&&y!==void 0?y:null))}),f))}recalculateAndSaveOverlays(e,n){const r=gc();let a=new Zt((u,f)=>u-f),o=ht();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(u=>{for(const f of u)f.keys().forEach(h=>{const m=n.get(h);if(m===null)return;let g=r.get(h)||mi.empty();g=f.applyToLocalView(m,g),r.set(h,g);const y=(a.get(f.batchId)||ht()).add(h);a=a.insert(f.batchId,y)})}).next(()=>{const u=[],f=a.getReverseIterator();for(;f.hasNext();){const h=f.getNext(),m=h.key,g=h.value,y=gT();g.forEach(_=>{if(!o.has(_)){const E=TT(n.get(_),r.get(_));E!==null&&y.set(_,E),o=o.add(_)}}),u.push(this.documentOverlayCache.saveOverlays(e,m,y))}return we.waitFor(u)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,a){return function(u){return $e.isDocumentKey(u.path)&&u.collectionGroup===null&&u.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):yg(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,a):this.getDocumentsMatchingCollectionQuery(e,n,r,a)}getNextDocuments(e,n,r,a){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,a).next(o=>{const u=a-o.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,a-o.size):we.resolve(ho());let f=Rc,h=o;return u.next(m=>we.forEach(m,(g,y)=>(f<y.largestBatchId&&(f=y.largestBatchId),o.get(g)?we.resolve():this.remoteDocumentCache.getEntry(e,g).next(_=>{h=h.insert(g,_)}))).next(()=>this.populateOverlays(e,m,o)).next(()=>this.computeViews(e,h,m,ht())).next(g=>({batchId:f,changes:pT(g)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new $e(n)).next(r=>{let a=cc();return r.isFoundDocument()&&(a=a.insert(r.key,r)),a})}getDocumentsMatchingCollectionGroupQuery(e,n,r,a){const o=n.collectionGroup;let u=cc();return this.indexManager.getCollectionParents(e,o).next(f=>we.forEach(f,h=>{const m=function(y,_){return new So(_,null,y.explicitOrderBy.slice(),y.filters.slice(),y.limit,y.limitType,y.startAt,y.endAt)}(n,h.child(o));return this.getDocumentsMatchingCollectionQuery(e,m,r,a).next(g=>{g.forEach((y,_)=>{u=u.insert(y,_)})})}).next(()=>u))}getDocumentsMatchingCollectionQuery(e,n,r,a){let o;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(u=>(o=u,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,o,a))).next(u=>{o.forEach((h,m)=>{const g=m.getKey();u.get(g)===null&&(u=u.insert(g,tr.newInvalidDocument(g)))});let f=cc();return u.forEach((h,m)=>{const g=o.get(h);g!==void 0&&vc(g.mutation,m,mi.empty(),qt.now()),N0(n,m)&&(f=f.insert(h,m))}),f})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aN{constructor(e){this.serializer=e,this.Br=new Map,this.Lr=new Map}getBundleMetadata(e,n){return we.resolve(this.Br.get(n))}saveBundleMetadata(e,n){return this.Br.set(n.id,function(a){return{id:a.id,version:a.version,createTime:qi(a.createTime)}}(n)),we.resolve()}getNamedQuery(e,n){return we.resolve(this.Lr.get(n))}saveNamedQuery(e,n){return this.Lr.set(n.name,function(a){return{name:a.name,query:YI(a.bundledQuery),readTime:qi(a.readTime)}}(n)),we.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class sN{constructor(){this.overlays=new Zt($e.comparator),this.kr=new Map}getOverlay(e,n){return we.resolve(this.overlays.get(n))}getOverlays(e,n){const r=ho();return we.forEach(n,a=>this.getOverlay(e,a).next(o=>{o!==null&&r.set(a,o)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((a,o)=>{this.wt(e,n,o)}),we.resolve()}removeOverlaysForBatchId(e,n,r){const a=this.kr.get(r);return a!==void 0&&(a.forEach(o=>this.overlays=this.overlays.remove(o)),this.kr.delete(r)),we.resolve()}getOverlaysForCollection(e,n,r){const a=ho(),o=n.length+1,u=new $e(n.child("")),f=this.overlays.getIteratorFrom(u);for(;f.hasNext();){const h=f.getNext().value,m=h.getKey();if(!n.isPrefixOf(m.path))break;m.path.length===o&&h.largestBatchId>r&&a.set(h.getKey(),h)}return we.resolve(a)}getOverlaysForCollectionGroup(e,n,r,a){let o=new Zt((m,g)=>m-g);const u=this.overlays.getIterator();for(;u.hasNext();){const m=u.getNext().value;if(m.getKey().getCollectionGroup()===n&&m.largestBatchId>r){let g=o.get(m.largestBatchId);g===null&&(g=ho(),o=o.insert(m.largestBatchId,g)),g.set(m.getKey(),m)}}const f=ho(),h=o.getIterator();for(;h.hasNext()&&(h.getNext().value.forEach((m,g)=>f.set(m,g)),!(f.size()>=a)););return we.resolve(f)}wt(e,n,r){const a=this.overlays.get(r.key);if(a!==null){const u=this.kr.get(a.largestBatchId).delete(r.key);this.kr.set(a.largestBatchId,u)}this.overlays=this.overlays.insert(r.key,new SI(n,r));let o=this.kr.get(n);o===void 0&&(o=ht(),this.kr.set(n,o)),this.kr.set(n,o.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oN{constructor(){this.sessionToken=Xn.EMPTY_BYTE_STRING}getSessionToken(e){return we.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,we.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Sg{constructor(){this.qr=new Sn(On.Qr),this.$r=new Sn(On.Ur)}isEmpty(){return this.qr.isEmpty()}addReference(e,n){const r=new On(e,n);this.qr=this.qr.add(r),this.$r=this.$r.add(r)}Kr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.Wr(new On(e,n))}Gr(e,n){e.forEach(r=>this.removeReference(r,n))}zr(e){const n=new $e(new jt([])),r=new On(n,e),a=new On(n,e+1),o=[];return this.$r.forEachInRange([r,a],u=>{this.Wr(u),o.push(u.key)}),o}jr(){this.qr.forEach(e=>this.Wr(e))}Wr(e){this.qr=this.qr.delete(e),this.$r=this.$r.delete(e)}Jr(e){const n=new $e(new jt([])),r=new On(n,e),a=new On(n,e+1);let o=ht();return this.$r.forEachInRange([r,a],u=>{o=o.add(u.key)}),o}containsKey(e){const n=new On(e,0),r=this.qr.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class On{constructor(e,n){this.key=e,this.Hr=n}static Qr(e,n){return $e.comparator(e.key,n.key)||st(e.Hr,n.Hr)}static Ur(e,n){return st(e.Hr,n.Hr)||$e.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lN{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.er=1,this.Yr=new Sn(On.Qr)}checkEmpty(e){return we.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,a){const o=this.er;this.er++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const u=new AI(o,n,r,a);this.mutationQueue.push(u);for(const f of a)this.Yr=this.Yr.add(new On(f.key,o)),this.indexManager.addToCollectionParentIndex(e,f.key.path.popLast());return we.resolve(u)}lookupMutationBatch(e,n){return we.resolve(this.Zr(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,a=this.Xr(r),o=a<0?0:a;return we.resolve(this.mutationQueue.length>o?this.mutationQueue[o]:null)}getHighestUnacknowledgedBatchId(){return we.resolve(this.mutationQueue.length===0?mg:this.er-1)}getAllMutationBatches(e){return we.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new On(n,0),a=new On(n,Number.POSITIVE_INFINITY),o=[];return this.Yr.forEachInRange([r,a],u=>{const f=this.Zr(u.Hr);o.push(f)}),we.resolve(o)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new Sn(st);return n.forEach(a=>{const o=new On(a,0),u=new On(a,Number.POSITIVE_INFINITY);this.Yr.forEachInRange([o,u],f=>{r=r.add(f.Hr)})}),we.resolve(this.ei(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,a=r.length+1;let o=r;$e.isDocumentKey(o)||(o=o.child(""));const u=new On(new $e(o),0);let f=new Sn(st);return this.Yr.forEachWhile(h=>{const m=h.key.path;return!!r.isPrefixOf(m)&&(m.length===a&&(f=f.add(h.Hr)),!0)},u),we.resolve(this.ei(f))}ei(e){const n=[];return e.forEach(r=>{const a=this.Zr(r);a!==null&&n.push(a)}),n}removeMutationBatch(e,n){Rt(this.ti(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Yr;return we.forEach(n.mutations,a=>{const o=new On(a.key,n.batchId);return r=r.delete(o),this.referenceDelegate.markPotentiallyOrphaned(e,a.key)}).next(()=>{this.Yr=r})}rr(e){}containsKey(e,n){const r=new On(n,0),a=this.Yr.firstAfterOrEqual(r);return we.resolve(n.isEqual(a&&a.key))}performConsistencyCheck(e){return this.mutationQueue.length,we.resolve()}ti(e,n){return this.Xr(e)}Xr(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}Zr(e){const n=this.Xr(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uN{constructor(e){this.ni=e,this.docs=function(){return new Zt($e.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,a=this.docs.get(r),o=a?a.size:0,u=this.ni(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:u}),this.size+=u-o,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return we.resolve(r?r.document.mutableCopy():tr.newInvalidDocument(n))}getEntries(e,n){let r=Na();return n.forEach(a=>{const o=this.docs.get(a);r=r.insert(a,o?o.document.mutableCopy():tr.newInvalidDocument(a))}),we.resolve(r)}getDocumentsMatchingQuery(e,n,r,a){let o=Na();const u=n.path,f=new $e(u.child("__id-9223372036854775808__")),h=this.docs.getIteratorFrom(f);for(;h.hasNext();){const{key:m,value:{document:g}}=h.getNext();if(!u.isPrefixOf(m.path))break;m.path.length>u.length+1||BC(VC(g),r)<=0||(a.has(g.key)||N0(n,g))&&(o=o.insert(g.key,g.mutableCopy()))}return we.resolve(o)}getAllFromCollectionGroup(e,n,r,a){Ke(9500)}ri(e,n){return we.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new cN(this)}getSize(e){return we.resolve(this.size)}}class cN extends nN{constructor(e){super(),this.Or=e}applyChanges(e){const n=[];return this.changes.forEach((r,a)=>{a.isValidDocument()?n.push(this.Or.addEntry(e,a)):this.Or.removeEntry(r)}),we.waitFor(n)}getFromCache(e,n){return this.Or.getEntry(e,n)}getAllFromCache(e,n){return this.Or.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fN{constructor(e){this.persistence=e,this.ii=new bo(n=>gg(n),vg),this.lastRemoteSnapshotVersion=et.min(),this.highestTargetId=0,this.si=0,this.oi=new Sg,this.targetCount=0,this._i=Gl.ar()}forEachTarget(e,n){return this.ii.forEach((r,a)=>n(a)),we.resolve()}getLastRemoteSnapshotVersion(e){return we.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return we.resolve(this.si)}allocateTargetId(e){return this.highestTargetId=this._i.next(),we.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.si&&(this.si=n),we.resolve()}hr(e){this.ii.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this._i=new Gl(n),this.highestTargetId=n),e.sequenceNumber>this.si&&(this.si=e.sequenceNumber)}addTargetData(e,n){return this.hr(n),this.targetCount+=1,we.resolve()}updateTargetData(e,n){return this.hr(n),we.resolve()}removeTargetData(e,n){return this.ii.delete(n.target),this.oi.zr(n.targetId),this.targetCount-=1,we.resolve()}removeTargets(e,n,r){let a=0;const o=[];return this.ii.forEach((u,f)=>{f.sequenceNumber<=n&&r.get(f.targetId)===null&&(this.ii.delete(u),o.push(this.removeMatchingKeysForTargetId(e,f.targetId)),a++)}),we.waitFor(o).next(()=>a)}getTargetCount(e){return we.resolve(this.targetCount)}getTargetData(e,n){const r=this.ii.get(n)||null;return we.resolve(r)}addMatchingKeys(e,n,r){return this.oi.Kr(n,r),we.resolve()}removeMatchingKeys(e,n,r){this.oi.Gr(n,r);const a=this.persistence.referenceDelegate,o=[];return a&&n.forEach(u=>{o.push(a.markPotentiallyOrphaned(e,u))}),we.waitFor(o)}removeMatchingKeysForTargetId(e,n){return this.oi.zr(n),we.resolve()}getMatchingKeysForTargetId(e,n){const r=this.oi.Jr(n);return we.resolve(r)}containsKey(e,n){return we.resolve(this.oi.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PT{constructor(e,n){this.ai={},this.overlays={},this.ui=new S0(0),this.ci=!1,this.ci=!0,this.li=new oN,this.referenceDelegate=e(this),this.hi=new fN(this),this.indexManager=new WI,this.remoteDocumentCache=function(a){return new uN(a)}(r=>this.referenceDelegate.Pi(r)),this.serializer=new XI(n),this.Ti=new aN(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.ci=!1,Promise.resolve()}get started(){return this.ci}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new sN,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ai[e.toKey()];return r||(r=new lN(n,this.referenceDelegate),this.ai[e.toKey()]=r),r}getGlobalsCache(){return this.li}getTargetCache(){return this.hi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ti}runTransaction(e,n,r){je("MemoryPersistence","Starting transaction:",e);const a=new hN(this.ui.next());return this.referenceDelegate.Ii(),r(a).next(o=>this.referenceDelegate.di(a).next(()=>o)).toPromise().then(o=>(a.raiseOnCommittedEvent(),o))}Ei(e,n){return we.or(Object.values(this.ai).map(r=>()=>r.containsKey(e,n)))}}class hN extends jC{constructor(e){super(),this.currentSequenceNumber=e}}class bg{constructor(e){this.persistence=e,this.Ai=new Sg,this.Ri=null}static Vi(e){return new bg(e)}get mi(){if(this.Ri)return this.Ri;throw Ke(60996)}addReference(e,n,r){return this.Ai.addReference(r,n),this.mi.delete(r.toString()),we.resolve()}removeReference(e,n,r){return this.Ai.removeReference(r,n),this.mi.add(r.toString()),we.resolve()}markPotentiallyOrphaned(e,n){return this.mi.add(n.toString()),we.resolve()}removeTarget(e,n){this.Ai.zr(n.targetId).forEach(a=>this.mi.add(a.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(a=>{a.forEach(o=>this.mi.add(o.toString()))}).next(()=>r.removeTargetData(e,n))}Ii(){this.Ri=new Set}di(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return we.forEach(this.mi,r=>{const a=$e.fromPath(r);return this.fi(e,a).next(o=>{o||n.removeEntry(a,et.min())})}).next(()=>(this.Ri=null,n.apply(e)))}updateLimboDocument(e,n){return this.fi(e,n).next(r=>{r?this.mi.delete(n.toString()):this.mi.add(n.toString())})}Pi(e){return 0}fi(e,n){return we.or([()=>we.resolve(this.Ai.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ei(e,n)])}}class e0{constructor(e,n){this.persistence=e,this.gi=new bo(r=>GC(r.path),(r,a)=>r.isEqual(a)),this.garbageCollector=tN(this,n)}static Vi(e,n){return new e0(e,n)}Ii(){}di(e){return we.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}mr(e){const n=this.yr(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(a=>r+a))}yr(e){let n=0;return this.gr(e,r=>{n++}).next(()=>n)}gr(e,n){return we.forEach(this.gi,(r,a)=>this.Sr(e,r,a).next(o=>o?we.resolve():n(a)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const a=this.persistence.getRemoteDocumentCache(),o=a.newChangeBuffer();return a.ri(e,u=>this.Sr(e,u,n).next(f=>{f||(r++,o.removeEntry(u,et.min()))})).next(()=>o.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.gi.set(n,e.currentSequenceNumber),we.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),we.resolve()}removeReference(e,n,r){return this.gi.set(r,e.currentSequenceNumber),we.resolve()}updateLimboDocument(e,n){return this.gi.set(n,e.currentSequenceNumber),we.resolve()}Pi(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=Lh(e.data.value)),n}Sr(e,n,r){return we.or([()=>this.persistence.Ei(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const a=this.gi.get(n);return we.resolve(a!==void 0&&a>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rg{constructor(e,n,r,a){this.targetId=e,this.fromCache=n,this.Is=r,this.ds=a}static Es(e,n){let r=ht(),a=ht();for(const o of n.docChanges)switch(o.type){case 0:r=r.add(o.doc.key);break;case 1:a=a.add(o.doc.key)}return new Rg(e,n.fromCache,r,a)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dN{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class mN{constructor(){this.As=!1,this.Rs=!1,this.Vs=100,this.fs=function(){return oR()?8:zC(iR())>0?6:4}()}initialize(e,n){this.gs=e,this.indexManager=n,this.As=!0}getDocumentsMatchingQuery(e,n,r,a){const o={result:null};return this.ps(e,n).next(u=>{o.result=u}).next(()=>{if(!o.result)return this.ys(e,n,a,r).next(u=>{o.result=u})}).next(()=>{if(o.result)return;const u=new dN;return this.ws(e,n,u).next(f=>{if(o.result=f,this.Rs)return this.Ss(e,n,u,f.size)})}).next(()=>o.result)}Ss(e,n,r,a){return r.documentReadCount<this.Vs?(Sl()<=yt.DEBUG&&je("QueryEngine","SDK will not create cache indexes for query:",bl(n),"since it only creates cache indexes for collection contains","more than or equal to",this.Vs,"documents"),we.resolve()):(Sl()<=yt.DEBUG&&je("QueryEngine","Query:",bl(n),"scans",r.documentReadCount,"local documents and returns",a,"documents as results."),r.documentReadCount>this.fs*a?(Sl()<=yt.DEBUG&&je("QueryEngine","The SDK decides to create cache indexes for query:",bl(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hi(n))):we.resolve())}ps(e,n){if(Nx(n))return we.resolve(null);let r=Hi(n);return this.indexManager.getIndexType(e,r).next(a=>a===0?null:(n.limit!==null&&a===1&&(n=Kh(n,null,"F"),r=Hi(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(o=>{const u=ht(...o);return this.gs.getDocuments(e,u).next(f=>this.indexManager.getMinOffset(e,r).next(h=>{const m=this.bs(n,f);return this.Ds(n,m,u,h.readTime)?this.ps(e,Kh(n,null,"F")):this.vs(e,m,n,h)}))})))}ys(e,n,r,a){return Nx(n)||a.isEqual(et.min())?we.resolve(null):this.gs.getDocuments(e,r).next(o=>{const u=this.bs(n,o);return this.Ds(n,u,r,a)?we.resolve(null):(Sl()<=yt.DEBUG&&je("QueryEngine","Re-using previous result from %s to execute query: %s",a.toString(),bl(n)),this.vs(e,u,n,LC(a,Rc)).next(f=>f))})}bs(e,n){let r=new Sn(dT(e));return n.forEach((a,o)=>{N0(e,o)&&(r=r.add(o))}),r}Ds(e,n,r,a){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const o=e.limitType==="F"?n.last():n.first();return!!o&&(o.hasPendingWrites||o.version.compareTo(a)>0)}ws(e,n,r){return Sl()<=yt.DEBUG&&je("QueryEngine","Using full collection scan to execute query:",bl(n)),this.gs.getDocumentsMatchingQuery(e,n,ws.min(),r)}vs(e,n,r,a){return this.gs.getDocumentsMatchingQuery(e,r,a).next(o=>(n.forEach(u=>{o=o.insert(u.key,u)}),o))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cg="LocalStore",pN=3e8;class gN{constructor(e,n,r,a){this.persistence=e,this.Cs=n,this.serializer=a,this.Fs=new Zt(st),this.Ms=new bo(o=>gg(o),vg),this.xs=new Map,this.Os=e.getRemoteDocumentCache(),this.hi=e.getTargetCache(),this.Ti=e.getBundleCache(),this.Ns(r)}Ns(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new iN(this.Os,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Os.setIndexManager(this.indexManager),this.Cs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.Fs))}}function vN(t,e,n,r){return new gN(t,e,n,r)}async function kT(t,e){const n=tt(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let a;return n.mutationQueue.getAllMutationBatches(r).next(o=>(a=o,n.Ns(e),n.mutationQueue.getAllMutationBatches(r))).next(o=>{const u=[],f=[];let h=ht();for(const m of a){u.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}for(const m of o){f.push(m.batchId);for(const g of m.mutations)h=h.add(g.key)}return n.localDocuments.getDocuments(r,h).next(m=>({Bs:m,removedBatchIds:u,addedBatchIds:f}))})})}function _N(t,e){const n=tt(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const a=e.batch.keys(),o=n.Os.newChangeBuffer({trackRemovals:!0});return function(f,h,m,g){const y=m.batch,_=y.keys();let E=we.resolve();return _.forEach(w=>{E=E.next(()=>g.getEntry(h,w)).next(T=>{const b=m.docVersions.get(w);Rt(b!==null,48541),T.version.compareTo(b)<0&&(y.applyToRemoteDocument(T,m),T.isValidDocument()&&(T.setReadTime(m.commitVersion),g.addEntry(T)))})}),E.next(()=>f.mutationQueue.removeMutationBatch(h,y))}(n,r,e,o).next(()=>o.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,a,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(f){let h=ht();for(let m=0;m<f.mutationResults.length;++m)f.mutationResults[m].transformResults.length>0&&(h=h.add(f.batch.mutations[m].key));return h}(e))).next(()=>n.localDocuments.getDocuments(r,a))})}function LT(t){const e=tt(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.hi.getLastRemoteSnapshotVersion(n))}function yN(t,e){const n=tt(t),r=e.snapshotVersion;let a=n.Fs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",o=>{const u=n.Os.newChangeBuffer({trackRemovals:!0});a=n.Fs;const f=[];e.targetChanges.forEach((g,y)=>{const _=a.get(y);if(!_)return;f.push(n.hi.removeMatchingKeys(o,g.removedDocuments,y).next(()=>n.hi.addMatchingKeys(o,g.addedDocuments,y)));let E=_.withSequenceNumber(o.currentSequenceNumber);e.targetMismatches.get(y)!==null?E=E.withResumeToken(Xn.EMPTY_BYTE_STRING,et.min()).withLastLimboFreeSnapshotVersion(et.min()):g.resumeToken.approximateByteSize()>0&&(E=E.withResumeToken(g.resumeToken,r)),a=a.insert(y,E),function(T,b,k){return T.resumeToken.approximateByteSize()===0||b.snapshotVersion.toMicroseconds()-T.snapshotVersion.toMicroseconds()>=pN?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(_,E,g)&&f.push(n.hi.updateTargetData(o,E))});let h=Na(),m=ht();if(e.documentUpdates.forEach(g=>{e.resolvedLimboDocuments.has(g)&&f.push(n.persistence.referenceDelegate.updateLimboDocument(o,g))}),f.push(xN(o,u,e.documentUpdates).next(g=>{h=g.Ls,m=g.ks})),!r.isEqual(et.min())){const g=n.hi.getLastRemoteSnapshotVersion(o).next(y=>n.hi.setTargetsMetadata(o,o.currentSequenceNumber,r));f.push(g)}return we.waitFor(f).next(()=>u.apply(o)).next(()=>n.localDocuments.getLocalViewOfDocuments(o,h,m)).next(()=>h)}).then(o=>(n.Fs=a,o))}function xN(t,e,n){let r=ht(),a=ht();return n.forEach(o=>r=r.add(o)),e.getEntries(t,r).next(o=>{let u=Na();return n.forEach((f,h)=>{const m=o.get(f);h.isFoundDocument()!==m.isFoundDocument()&&(a=a.add(f)),h.isNoDocument()&&h.version.isEqual(et.min())?(e.removeEntry(f,h.readTime),u=u.insert(f,h)):!m.isValidDocument()||h.version.compareTo(m.version)>0||h.version.compareTo(m.version)===0&&m.hasPendingWrites?(e.addEntry(h),u=u.insert(f,h)):je(Cg,"Ignoring outdated watch update for ",f,". Current version:",m.version," Watch version:",h.version)}),{Ls:u,ks:a}})}function EN(t,e){const n=tt(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=mg),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function TN(t,e){const n=tt(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let a;return n.hi.getTargetData(r,e).next(o=>o?(a=o,we.resolve(a)):n.hi.allocateTargetId(r).next(u=>(a=new cs(e,u,"TargetPurposeListen",r.currentSequenceNumber),n.hi.addTargetData(r,a).next(()=>a))))}).then(r=>{const a=n.Fs.get(r.targetId);return(a===null||r.snapshotVersion.compareTo(a.snapshotVersion)>0)&&(n.Fs=n.Fs.insert(r.targetId,r),n.Ms.set(e,r.targetId)),r})}async function Up(t,e,n){const r=tt(t),a=r.Fs.get(e),o=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",o,u=>r.persistence.referenceDelegate.removeTarget(u,a))}catch(u){if(!Jl(u))throw u;je(Cg,`Failed to update sequence numbers for target ${e}: ${u}`)}r.Fs=r.Fs.remove(e),r.Ms.delete(a.target)}function Hx(t,e,n){const r=tt(t);let a=et.min(),o=ht();return r.persistence.runTransaction("Execute query","readwrite",u=>function(h,m,g){const y=tt(h),_=y.Ms.get(g);return _!==void 0?we.resolve(y.Fs.get(_)):y.hi.getTargetData(m,g)}(r,u,Hi(e)).next(f=>{if(f)return a=f.lastLimboFreeSnapshotVersion,r.hi.getMatchingKeysForTargetId(u,f.targetId).next(h=>{o=h})}).next(()=>r.Cs.getDocumentsMatchingQuery(u,e,n?a:et.min(),n?o:ht())).next(f=>(wN(r,uI(e),f),{documents:f,qs:o})))}function wN(t,e,n){let r=t.xs.get(e)||et.min();n.forEach((a,o)=>{o.readTime.compareTo(r)>0&&(r=o.readTime)}),t.xs.set(e,r)}class Gx{constructor(){this.activeTargetIds=pI()}Gs(e){this.activeTargetIds=this.activeTargetIds.add(e)}zs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Ws(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class AN{constructor(){this.Fo=new Gx,this.Mo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.Fo.Gs(e),this.Mo[e]||"not-current"}updateQueryState(e,n,r){this.Mo[e]=n}removeLocalQueryTarget(e){this.Fo.zs(e)}isLocalQueryTarget(e){return this.Fo.activeTargetIds.has(e)}clearQueryState(e){delete this.Mo[e]}getAllActiveQueryTargets(){return this.Fo.activeTargetIds}isActiveQueryTarget(e){return this.Fo.activeTargetIds.has(e)}start(){return this.Fo=new Gx,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class SN{xo(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const qx="ConnectivityMonitor";class $x{constructor(){this.Oo=()=>this.No(),this.Bo=()=>this.Lo(),this.ko=[],this.qo()}xo(e){this.ko.push(e)}shutdown(){window.removeEventListener("online",this.Oo),window.removeEventListener("offline",this.Bo)}qo(){window.addEventListener("online",this.Oo),window.addEventListener("offline",this.Bo)}No(){je(qx,"Network connectivity changed: AVAILABLE");for(const e of this.ko)e(0)}Lo(){je(qx,"Network connectivity changed: UNAVAILABLE");for(const e of this.ko)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let Sh=null;function jp(){return Sh===null?Sh=function(){return 268435456+Math.round(2147483648*Math.random())}():Sh++,"0x"+Sh.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ap="RestConnection",bN={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class RN{get Qo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),a=encodeURIComponent(this.databaseId.database);this.$o=n+"://"+e.host,this.Uo=`projects/${r}/databases/${a}`,this.Ko=this.databaseId.database===Xh?`project_id=${r}`:`project_id=${r}&database_id=${a}`}Wo(e,n,r,a,o){const u=jp(),f=this.Go(e,n.toUriEncodedString());je(ap,`Sending RPC '${e}' ${u}:`,f,r);const h={"google-cloud-resource-prefix":this.Uo,"x-goog-request-params":this.Ko};this.zo(h,a,o);const{host:m}=new URL(f),g=lg(m);return this.jo(e,f,h,r,g).then(y=>(je(ap,`Received RPC '${e}' ${u}: `,y),y),y=>{throw Es(ap,`RPC '${e}' ${u} failed with error: `,y,"url: ",f,"request:",r),y})}Jo(e,n,r,a,o,u){return this.Wo(e,n,r,a,o)}zo(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Ql}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((a,o)=>e[o]=a),r&&r.headers.forEach((a,o)=>e[o]=a)}Go(e,n){const r=bN[e];return`${this.$o}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class CN{constructor(e){this.Ho=e.Ho,this.Yo=e.Yo}Zo(e){this.Xo=e}e_(e){this.t_=e}n_(e){this.r_=e}onMessage(e){this.i_=e}close(){this.Yo()}send(e){this.Ho(e)}s_(){this.Xo()}o_(){this.t_()}__(e){this.r_(e)}a_(e){this.i_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Jn="WebChannelConnection";class IN extends RN{constructor(e){super(e),this.u_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}jo(e,n,r,a,o){const u=jp();return new Promise((f,h)=>{const m=new UE;m.setWithCredentials(!0),m.listenOnce(jE.COMPLETE,()=>{try{switch(m.getLastErrorCode()){case kh.NO_ERROR:const y=m.getResponseJson();je(Jn,`XHR for RPC '${e}' ${u} received:`,JSON.stringify(y)),f(y);break;case kh.TIMEOUT:je(Jn,`RPC '${e}' ${u} timed out`),h(new ke(_e.DEADLINE_EXCEEDED,"Request time out"));break;case kh.HTTP_ERROR:const _=m.getStatus();if(je(Jn,`RPC '${e}' ${u} failed with status:`,_,"response text:",m.getResponseText()),_>0){let E=m.getResponseJson();Array.isArray(E)&&(E=E[0]);const w=E?.error;if(w&&w.status&&w.message){const T=function(k){const q=k.toLowerCase().replace(/_/g,"-");return Object.values(_e).indexOf(q)>=0?q:_e.UNKNOWN}(w.status);h(new ke(T,w.message))}else h(new ke(_e.UNKNOWN,"Server responded with status "+m.getStatus()))}else h(new ke(_e.UNAVAILABLE,"Connection failed."));break;default:Ke(9055,{c_:e,streamId:u,l_:m.getLastErrorCode(),h_:m.getLastError()})}}finally{je(Jn,`RPC '${e}' ${u} completed.`)}});const g=JSON.stringify(a);je(Jn,`RPC '${e}' ${u} sending request:`,a),m.send(n,"POST",g,r,15)})}P_(e,n,r){const a=jp(),o=[this.$o,"/","google.firestore.v1.Firestore","/",e,"/channel"],u=GE(),f=HE(),h={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},m=this.longPollingOptions.timeoutSeconds;m!==void 0&&(h.longPollingTimeout=Math.round(1e3*m)),this.useFetchStreams&&(h.useFetchStreams=!0),this.zo(h.initMessageHeaders,n,r),h.encodeInitMessageHeaders=!0;const g=o.join("");je(Jn,`Creating RPC '${e}' stream ${a}: ${g}`,h);const y=u.createWebChannel(g,h);this.T_(y);let _=!1,E=!1;const w=new CN({Ho:b=>{E?je(Jn,`Not sending because RPC '${e}' stream ${a} is closed:`,b):(_||(je(Jn,`Opening RPC '${e}' stream ${a} transport.`),y.open(),_=!0),je(Jn,`RPC '${e}' stream ${a} sending:`,b),y.send(b))},Yo:()=>y.close()}),T=(b,k,q)=>{b.listen(k,X=>{try{q(X)}catch(ee){setTimeout(()=>{throw ee},0)}})};return T(y,uc.EventType.OPEN,()=>{E||(je(Jn,`RPC '${e}' stream ${a} transport opened.`),w.s_())}),T(y,uc.EventType.CLOSE,()=>{E||(E=!0,je(Jn,`RPC '${e}' stream ${a} transport closed`),w.__(),this.I_(y))}),T(y,uc.EventType.ERROR,b=>{E||(E=!0,Es(Jn,`RPC '${e}' stream ${a} transport errored. Name:`,b.name,"Message:",b.message),w.__(new ke(_e.UNAVAILABLE,"The operation could not be completed")))}),T(y,uc.EventType.MESSAGE,b=>{var k;if(!E){const q=b.data[0];Rt(!!q,16349);const X=q,ee=X?.error||((k=X[0])===null||k===void 0?void 0:k.error);if(ee){je(Jn,`RPC '${e}' stream ${a} received error:`,ee);const he=ee.status;let Ae=function(R){const M=mn[R];if(M!==void 0)return AT(M)}(he),N=ee.message;Ae===void 0&&(Ae=_e.INTERNAL,N="Unknown error status: "+he+" with message "+ee.message),E=!0,w.__(new ke(Ae,N)),y.close()}else je(Jn,`RPC '${e}' stream ${a} received:`,q),w.a_(q)}}),T(f,zE.STAT_EVENT,b=>{b.stat===Ip.PROXY?je(Jn,`RPC '${e}' stream ${a} detected buffering proxy`):b.stat===Ip.NOPROXY&&je(Jn,`RPC '${e}' stream ${a} detected no buffering proxy`)}),setTimeout(()=>{w.o_()},0),w}terminate(){this.u_.forEach(e=>e.close()),this.u_=[]}T_(e){this.u_.push(e)}I_(e){this.u_=this.u_.filter(n=>n===e)}}function sp(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function M0(t){return new FI(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VT{constructor(e,n,r=1e3,a=1.5,o=6e4){this.Fi=e,this.timerId=n,this.d_=r,this.E_=a,this.A_=o,this.R_=0,this.V_=null,this.m_=Date.now(),this.reset()}reset(){this.R_=0}f_(){this.R_=this.A_}g_(e){this.cancel();const n=Math.floor(this.R_+this.p_()),r=Math.max(0,Date.now()-this.m_),a=Math.max(0,n-r);a>0&&je("ExponentialBackoff",`Backing off for ${a} ms (base delay: ${this.R_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.V_=this.Fi.enqueueAfterDelay(this.timerId,a,()=>(this.m_=Date.now(),e())),this.R_*=this.E_,this.R_<this.d_&&(this.R_=this.d_),this.R_>this.A_&&(this.R_=this.A_)}y_(){this.V_!==null&&(this.V_.skipDelay(),this.V_=null)}cancel(){this.V_!==null&&(this.V_.cancel(),this.V_=null)}p_(){return(Math.random()-.5)*this.R_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Xx="PersistentStream";class BT{constructor(e,n,r,a,o,u,f,h){this.Fi=e,this.w_=r,this.S_=a,this.connection=o,this.authCredentialsProvider=u,this.appCheckCredentialsProvider=f,this.listener=h,this.state=0,this.b_=0,this.D_=null,this.v_=null,this.stream=null,this.C_=0,this.F_=new VT(e,n)}M_(){return this.state===1||this.state===5||this.x_()}x_(){return this.state===2||this.state===3}start(){this.C_=0,this.state!==4?this.auth():this.O_()}async stop(){this.M_()&&await this.close(0)}N_(){this.state=0,this.F_.reset()}B_(){this.x_()&&this.D_===null&&(this.D_=this.Fi.enqueueAfterDelay(this.w_,6e4,()=>this.L_()))}k_(e){this.q_(),this.stream.send(e)}async L_(){if(this.x_())return this.close(0)}q_(){this.D_&&(this.D_.cancel(),this.D_=null)}Q_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,n){this.q_(),this.Q_(),this.F_.cancel(),this.b_++,e!==4?this.F_.reset():n&&n.code===_e.RESOURCE_EXHAUSTED?(Ia(n.toString()),Ia("Using maximum backoff delay to prevent overloading the backend."),this.F_.f_()):n&&n.code===_e.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.U_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.n_(n)}U_(){}auth(){this.state=1;const e=this.K_(this.b_),n=this.b_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,a])=>{this.b_===n&&this.W_(r,a)},r=>{e(()=>{const a=new ke(_e.UNKNOWN,"Fetching auth token failed: "+r.message);return this.G_(a)})})}W_(e,n){const r=this.K_(this.b_);this.stream=this.z_(e,n),this.stream.Zo(()=>{r(()=>this.listener.Zo())}),this.stream.e_(()=>{r(()=>(this.state=2,this.v_=this.Fi.enqueueAfterDelay(this.S_,1e4,()=>(this.x_()&&(this.state=3),Promise.resolve())),this.listener.e_()))}),this.stream.n_(a=>{r(()=>this.G_(a))}),this.stream.onMessage(a=>{r(()=>++this.C_==1?this.j_(a):this.onNext(a))})}O_(){this.state=5,this.F_.g_(async()=>{this.state=0,this.start()})}G_(e){return je(Xx,`close with error: ${e}`),this.stream=null,this.close(4,e)}K_(e){return n=>{this.Fi.enqueueAndForget(()=>this.b_===e?n():(je(Xx,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class NN extends BT{constructor(e,n,r,a,o,u){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}z_(e,n){return this.connection.P_("Listen",e,n)}j_(e){return this.onNext(e)}onNext(e){this.F_.reset();const n=kI(this.serializer,e),r=function(o){if(!("targetChange"in o))return et.min();const u=o.targetChange;return u.targetIds&&u.targetIds.length?et.min():u.readTime?qi(u.readTime):et.min()}(e);return this.listener.J_(n,r)}H_(e){const n={};n.database=Bp(this.serializer),n.addTarget=function(o,u){let f;const h=u.target;if(f=Mp(h)?{documents:BI(o,h)}:{query:UI(o,h).Vt},f.targetId=u.targetId,u.resumeToken.approximateByteSize()>0){f.resumeToken=RT(o,u.resumeToken);const m=kp(o,u.expectedCount);m!==null&&(f.expectedCount=m)}else if(u.snapshotVersion.compareTo(et.min())>0){f.readTime=Jh(o,u.snapshotVersion.toTimestamp());const m=kp(o,u.expectedCount);m!==null&&(f.expectedCount=m)}return f}(this.serializer,e);const r=zI(this.serializer,e);r&&(n.labels=r),this.k_(n)}Y_(e){const n={};n.database=Bp(this.serializer),n.removeTarget=e,this.k_(n)}}class DN extends BT{constructor(e,n,r,a,o,u){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,a,u),this.serializer=o}get Z_(){return this.C_>0}start(){this.lastStreamToken=void 0,super.start()}U_(){this.Z_&&this.X_([])}z_(e,n){return this.connection.P_("Write",e,n)}j_(e){return Rt(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Rt(!e.writeResults||e.writeResults.length===0,55816),this.listener.ea()}onNext(e){Rt(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.F_.reset();const n=VI(e.writeResults,e.commitTime),r=qi(e.commitTime);return this.listener.ta(r,n)}na(){const e={};e.database=Bp(this.serializer),this.k_(e)}X_(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>LI(this.serializer,r))};this.k_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ON{}class FN extends ON{constructor(e,n,r,a){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=a,this.ra=!1}ia(){if(this.ra)throw new ke(_e.FAILED_PRECONDITION,"The client has already been terminated.")}Wo(e,n,r,a){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,u])=>this.connection.Wo(e,Lp(n,r),a,o,u)).catch(o=>{throw o.name==="FirebaseError"?(o.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new ke(_e.UNKNOWN,o.toString())})}Jo(e,n,r,a,o){return this.ia(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([u,f])=>this.connection.Jo(e,Lp(n,r),a,u,f,o)).catch(u=>{throw u.name==="FirebaseError"?(u.code===_e.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),u):new ke(_e.UNKNOWN,u.toString())})}terminate(){this.ra=!0,this.connection.terminate()}}class MN{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.sa=0,this.oa=null,this._a=!0}aa(){this.sa===0&&(this.ua("Unknown"),this.oa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.oa=null,this.ca("Backend didn't respond within 10 seconds."),this.ua("Offline"),Promise.resolve())))}la(e){this.state==="Online"?this.ua("Unknown"):(this.sa++,this.sa>=1&&(this.ha(),this.ca(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ua("Offline")))}set(e){this.ha(),this.sa=0,e==="Online"&&(this._a=!1),this.ua(e)}ua(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ca(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this._a?(Ia(n),this._a=!1):je("OnlineStateTracker",n)}ha(){this.oa!==null&&(this.oa.cancel(),this.oa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _o="RemoteStore";class PN{constructor(e,n,r,a,o){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Pa=[],this.Ta=new Map,this.Ia=new Set,this.da=[],this.Ea=o,this.Ea.xo(u=>{r.enqueueAndForget(async()=>{Co(this)&&(je(_o,"Restarting streams for network reachability change."),await async function(h){const m=tt(h);m.Ia.add(4),await Wc(m),m.Aa.set("Unknown"),m.Ia.delete(4),await P0(m)}(this))})}),this.Aa=new MN(r,a)}}async function P0(t){if(Co(t))for(const e of t.da)await e(!0)}async function Wc(t){for(const e of t.da)await e(!1)}function UT(t,e){const n=tt(t);n.Ta.has(e.targetId)||(n.Ta.set(e.targetId,e),Og(n)?Dg(n):eu(n).x_()&&Ng(n,e))}function Ig(t,e){const n=tt(t),r=eu(n);n.Ta.delete(e),r.x_()&&jT(n,e),n.Ta.size===0&&(r.x_()?r.B_():Co(n)&&n.Aa.set("Unknown"))}function Ng(t,e){if(t.Ra.$e(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(et.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}eu(t).H_(e)}function jT(t,e){t.Ra.$e(e),eu(t).Y_(e)}function Dg(t){t.Ra=new II({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Et:e=>t.Ta.get(e)||null,lt:()=>t.datastore.serializer.databaseId}),eu(t).start(),t.Aa.aa()}function Og(t){return Co(t)&&!eu(t).M_()&&t.Ta.size>0}function Co(t){return tt(t).Ia.size===0}function zT(t){t.Ra=void 0}async function kN(t){t.Aa.set("Online")}async function LN(t){t.Ta.forEach((e,n)=>{Ng(t,e)})}async function VN(t,e){zT(t),Og(t)?(t.Aa.la(e),Dg(t)):t.Aa.set("Unknown")}async function BN(t,e,n){if(t.Aa.set("Online"),e instanceof bT&&e.state===2&&e.cause)try{await async function(a,o){const u=o.cause;for(const f of o.targetIds)a.Ta.has(f)&&(await a.remoteSyncer.rejectListen(f,u),a.Ta.delete(f),a.Ra.removeTarget(f))}(t,e)}catch(r){je(_o,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await t0(t,r)}else if(e instanceof Uh?t.Ra.Ye(e):e instanceof ST?t.Ra.it(e):t.Ra.et(e),!n.isEqual(et.min()))try{const r=await LT(t.localStore);n.compareTo(r)>=0&&await function(o,u){const f=o.Ra.Pt(u);return f.targetChanges.forEach((h,m)=>{if(h.resumeToken.approximateByteSize()>0){const g=o.Ta.get(m);g&&o.Ta.set(m,g.withResumeToken(h.resumeToken,u))}}),f.targetMismatches.forEach((h,m)=>{const g=o.Ta.get(h);if(!g)return;o.Ta.set(h,g.withResumeToken(Xn.EMPTY_BYTE_STRING,g.snapshotVersion)),jT(o,h);const y=new cs(g.target,h,m,g.sequenceNumber);Ng(o,y)}),o.remoteSyncer.applyRemoteEvent(f)}(t,n)}catch(r){je(_o,"Failed to raise snapshot:",r),await t0(t,r)}}async function t0(t,e,n){if(!Jl(e))throw e;t.Ia.add(1),await Wc(t),t.Aa.set("Offline"),n||(n=()=>LT(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{je(_o,"Retrying IndexedDB access"),await n(),t.Ia.delete(1),await P0(t)})}function HT(t,e){return e().catch(n=>t0(t,n,e))}async function k0(t){const e=tt(t),n=Rs(e);let r=e.Pa.length>0?e.Pa[e.Pa.length-1].batchId:mg;for(;UN(e);)try{const a=await EN(e.localStore,r);if(a===null){e.Pa.length===0&&n.B_();break}r=a.batchId,jN(e,a)}catch(a){await t0(e,a)}GT(e)&&qT(e)}function UN(t){return Co(t)&&t.Pa.length<10}function jN(t,e){t.Pa.push(e);const n=Rs(t);n.x_()&&n.Z_&&n.X_(e.mutations)}function GT(t){return Co(t)&&!Rs(t).M_()&&t.Pa.length>0}function qT(t){Rs(t).start()}async function zN(t){Rs(t).na()}async function HN(t){const e=Rs(t);for(const n of t.Pa)e.X_(n.mutations)}async function GN(t,e,n){const r=t.Pa.shift(),a=Tg.from(r,e,n);await HT(t,()=>t.remoteSyncer.applySuccessfulWrite(a)),await k0(t)}async function qN(t,e){e&&Rs(t).Z_&&await async function(r,a){if(function(u){return RI(u)&&u!==_e.ABORTED}(a.code)){const o=r.Pa.shift();Rs(r).N_(),await HT(r,()=>r.remoteSyncer.rejectFailedWrite(o.batchId,a)),await k0(r)}}(t,e),GT(t)&&qT(t)}async function Yx(t,e){const n=tt(t);n.asyncQueue.verifyOperationInProgress(),je(_o,"RemoteStore received new credentials");const r=Co(n);n.Ia.add(3),await Wc(n),r&&n.Aa.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.Ia.delete(3),await P0(n)}async function $N(t,e){const n=tt(t);e?(n.Ia.delete(2),await P0(n)):e||(n.Ia.add(2),await Wc(n),n.Aa.set("Unknown"))}function eu(t){return t.Va||(t.Va=function(n,r,a){const o=tt(n);return o.ia(),new NN(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:kN.bind(null,t),e_:LN.bind(null,t),n_:VN.bind(null,t),J_:BN.bind(null,t)}),t.da.push(async e=>{e?(t.Va.N_(),Og(t)?Dg(t):t.Aa.set("Unknown")):(await t.Va.stop(),zT(t))})),t.Va}function Rs(t){return t.ma||(t.ma=function(n,r,a){const o=tt(n);return o.ia(),new DN(r,o.connection,o.authCredentials,o.appCheckCredentials,o.serializer,a)}(t.datastore,t.asyncQueue,{Zo:()=>Promise.resolve(),e_:zN.bind(null,t),n_:qN.bind(null,t),ea:HN.bind(null,t),ta:GN.bind(null,t)}),t.da.push(async e=>{e?(t.ma.N_(),await k0(t)):(await t.ma.stop(),t.Pa.length>0&&(je(_o,`Stopping write stream with ${t.Pa.length} pending writes`),t.Pa=[]))})),t.ma}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fg{constructor(e,n,r,a,o){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=a,this.removalCallback=o,this.deferred=new Ta,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(u=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,a,o){const u=Date.now()+r,f=new Fg(e,n,u,a,o);return f.start(r),f}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new ke(_e.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Mg(t,e){if(Ia("AsyncQueue",`${e}: ${t}`),Jl(t))return new ke(_e.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fl{static emptySet(e){return new Fl(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||$e.comparator(n.key,r.key):(n,r)=>$e.comparator(n.key,r.key),this.keyedMap=cc(),this.sortedSet=new Zt(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Fl)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const a=n.getNext().key,o=r.getNext().key;if(!a.isEqual(o))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Fl;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wx{constructor(){this.fa=new Zt($e.comparator)}track(e){const n=e.doc.key,r=this.fa.get(n);r?e.type!==0&&r.type===3?this.fa=this.fa.insert(n,e):e.type===3&&r.type!==1?this.fa=this.fa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.fa=this.fa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.fa=this.fa.remove(n):e.type===1&&r.type===2?this.fa=this.fa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.fa=this.fa.insert(n,{type:2,doc:e.doc}):Ke(63341,{At:e,ga:r}):this.fa=this.fa.insert(n,e)}pa(){const e=[];return this.fa.inorderTraversal((n,r)=>{e.push(r)}),e}}class ql{constructor(e,n,r,a,o,u,f,h,m){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=a,this.mutatedKeys=o,this.fromCache=u,this.syncStateChanged=f,this.excludesMetadataChanges=h,this.hasCachedResults=m}static fromInitialDocuments(e,n,r,a,o){const u=[];return n.forEach(f=>{u.push({type:0,doc:f})}),new ql(e,n,Fl.emptySet(n),u,r,a,!0,!1,o)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&I0(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let a=0;a<n.length;a++)if(n[a].type!==r[a].type||!n[a].doc.isEqual(r[a].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XN{constructor(){this.ya=void 0,this.wa=[]}Sa(){return this.wa.some(e=>e.ba())}}class YN{constructor(){this.queries=Kx(),this.onlineState="Unknown",this.Da=new Set}terminate(){(function(n,r){const a=tt(n),o=a.queries;a.queries=Kx(),o.forEach((u,f)=>{for(const h of f.wa)h.onError(r)})})(this,new ke(_e.ABORTED,"Firestore shutting down"))}}function Kx(){return new bo(t=>hT(t),I0)}async function $T(t,e){const n=tt(t);let r=3;const a=e.query;let o=n.queries.get(a);o?!o.Sa()&&e.ba()&&(r=2):(o=new XN,r=e.ba()?0:1);try{switch(r){case 0:o.ya=await n.onListen(a,!0);break;case 1:o.ya=await n.onListen(a,!1);break;case 2:await n.onFirstRemoteStoreListen(a)}}catch(u){const f=Mg(u,`Initialization of query '${bl(e.query)}' failed`);return void e.onError(f)}n.queries.set(a,o),o.wa.push(e),e.va(n.onlineState),o.ya&&e.Ca(o.ya)&&Pg(n)}async function XT(t,e){const n=tt(t),r=e.query;let a=3;const o=n.queries.get(r);if(o){const u=o.wa.indexOf(e);u>=0&&(o.wa.splice(u,1),o.wa.length===0?a=e.ba()?0:1:!o.Sa()&&e.ba()&&(a=2))}switch(a){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function WN(t,e){const n=tt(t);let r=!1;for(const a of e){const o=a.query,u=n.queries.get(o);if(u){for(const f of u.wa)f.Ca(a)&&(r=!0);u.ya=a}}r&&Pg(n)}function KN(t,e,n){const r=tt(t),a=r.queries.get(e);if(a)for(const o of a.wa)o.onError(n);r.queries.delete(e)}function Pg(t){t.Da.forEach(e=>{e.next()})}var zp,Qx;(Qx=zp||(zp={})).Fa="default",Qx.Cache="cache";class YT{constructor(e,n,r){this.query=e,this.Ma=n,this.xa=!1,this.Oa=null,this.onlineState="Unknown",this.options=r||{}}Ca(e){if(!this.options.includeMetadataChanges){const r=[];for(const a of e.docChanges)a.type!==3&&r.push(a);e=new ql(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.xa?this.Na(e)&&(this.Ma.next(e),n=!0):this.Ba(e,this.onlineState)&&(this.La(e),n=!0),this.Oa=e,n}onError(e){this.Ma.error(e)}va(e){this.onlineState=e;let n=!1;return this.Oa&&!this.xa&&this.Ba(this.Oa,e)&&(this.La(this.Oa),n=!0),n}Ba(e,n){if(!e.fromCache||!this.ba())return!0;const r=n!=="Offline";return(!this.options.ka||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}Na(e){if(e.docChanges.length>0)return!0;const n=this.Oa&&this.Oa.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}La(e){e=ql.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.xa=!0,this.Ma.next(e)}ba(){return this.options.source!==zp.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WT{constructor(e){this.key=e}}class KT{constructor(e){this.key=e}}class QN{constructor(e,n){this.query=e,this.Ha=n,this.Ya=null,this.hasCachedResults=!1,this.current=!1,this.Za=ht(),this.mutatedKeys=ht(),this.Xa=dT(e),this.eu=new Fl(this.Xa)}get tu(){return this.Ha}nu(e,n){const r=n?n.ru:new Wx,a=n?n.eu:this.eu;let o=n?n.mutatedKeys:this.mutatedKeys,u=a,f=!1;const h=this.query.limitType==="F"&&a.size===this.query.limit?a.last():null,m=this.query.limitType==="L"&&a.size===this.query.limit?a.first():null;if(e.inorderTraversal((g,y)=>{const _=a.get(g),E=N0(this.query,y)?y:null,w=!!_&&this.mutatedKeys.has(_.key),T=!!E&&(E.hasLocalMutations||this.mutatedKeys.has(E.key)&&E.hasCommittedMutations);let b=!1;_&&E?_.data.isEqual(E.data)?w!==T&&(r.track({type:3,doc:E}),b=!0):this.iu(_,E)||(r.track({type:2,doc:E}),b=!0,(h&&this.Xa(E,h)>0||m&&this.Xa(E,m)<0)&&(f=!0)):!_&&E?(r.track({type:0,doc:E}),b=!0):_&&!E&&(r.track({type:1,doc:_}),b=!0,(h||m)&&(f=!0)),b&&(E?(u=u.add(E),o=T?o.add(g):o.delete(g)):(u=u.delete(g),o=o.delete(g)))}),this.query.limit!==null)for(;u.size>this.query.limit;){const g=this.query.limitType==="F"?u.last():u.first();u=u.delete(g.key),o=o.delete(g.key),r.track({type:1,doc:g})}return{eu:u,ru:r,Ds:f,mutatedKeys:o}}iu(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,a){const o=this.eu;this.eu=e.eu,this.mutatedKeys=e.mutatedKeys;const u=e.ru.pa();u.sort((g,y)=>function(E,w){const T=b=>{switch(b){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Ke(20277,{At:b})}};return T(E)-T(w)}(g.type,y.type)||this.Xa(g.doc,y.doc)),this.su(r),a=a!=null&&a;const f=n&&!a?this.ou():[],h=this.Za.size===0&&this.current&&!a?1:0,m=h!==this.Ya;return this.Ya=h,u.length!==0||m?{snapshot:new ql(this.query,e.eu,o,u,e.mutatedKeys,h===0,m,!1,!!r&&r.resumeToken.approximateByteSize()>0),_u:f}:{_u:f}}va(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({eu:this.eu,ru:new Wx,mutatedKeys:this.mutatedKeys,Ds:!1},!1)):{_u:[]}}au(e){return!this.Ha.has(e)&&!!this.eu.has(e)&&!this.eu.get(e).hasLocalMutations}su(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}ou(){if(!this.current)return[];const e=this.Za;this.Za=ht(),this.eu.forEach(r=>{this.au(r.key)&&(this.Za=this.Za.add(r.key))});const n=[];return e.forEach(r=>{this.Za.has(r)||n.push(new KT(r))}),this.Za.forEach(r=>{e.has(r)||n.push(new WT(r))}),n}uu(e){this.Ha=e.qs,this.Za=ht();const n=this.nu(e.documents);return this.applyChanges(n,!0)}cu(){return ql.fromInitialDocuments(this.query,this.eu,this.mutatedKeys,this.Ya===0,this.hasCachedResults)}}const kg="SyncEngine";class ZN{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class JN{constructor(e){this.key=e,this.lu=!1}}class eD{constructor(e,n,r,a,o,u){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=a,this.currentUser=o,this.maxConcurrentLimboResolutions=u,this.hu={},this.Pu=new bo(f=>hT(f),I0),this.Tu=new Map,this.Iu=new Set,this.du=new Zt($e.comparator),this.Eu=new Map,this.Au=new Sg,this.Ru={},this.Vu=new Map,this.mu=Gl.ur(),this.onlineState="Unknown",this.fu=void 0}get isPrimaryClient(){return this.fu===!0}}async function tD(t,e,n=!0){const r=nw(t);let a;const o=r.Pu.get(e);return o?(r.sharedClientState.addLocalQueryTarget(o.targetId),a=o.view.cu()):a=await QT(r,e,n,!0),a}async function nD(t,e){const n=nw(t);await QT(n,e,!0,!1)}async function QT(t,e,n,r){const a=await TN(t.localStore,Hi(e)),o=a.targetId,u=t.sharedClientState.addLocalQueryTarget(o,n);let f;return r&&(f=await rD(t,e,o,u==="current",a.resumeToken)),t.isPrimaryClient&&n&&UT(t.remoteStore,a),f}async function rD(t,e,n,r,a){t.gu=(y,_,E)=>async function(T,b,k,q){let X=b.view.nu(k);X.Ds&&(X=await Hx(T.localStore,b.query,!1).then(({documents:N})=>b.view.nu(N,X)));const ee=q&&q.targetChanges.get(b.targetId),he=q&&q.targetMismatches.get(b.targetId)!=null,Ae=b.view.applyChanges(X,T.isPrimaryClient,ee,he);return Jx(T,b.targetId,Ae._u),Ae.snapshot}(t,y,_,E);const o=await Hx(t.localStore,e,!0),u=new QN(e,o.qs),f=u.nu(o.documents),h=Yc.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",a),m=u.applyChanges(f,t.isPrimaryClient,h);Jx(t,n,m._u);const g=new ZN(e,n,u);return t.Pu.set(e,g),t.Tu.has(n)?t.Tu.get(n).push(e):t.Tu.set(n,[e]),m.snapshot}async function iD(t,e,n){const r=tt(t),a=r.Pu.get(e),o=r.Tu.get(a.targetId);if(o.length>1)return r.Tu.set(a.targetId,o.filter(u=>!I0(u,e))),void r.Pu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(a.targetId),r.sharedClientState.isActiveQueryTarget(a.targetId)||await Up(r.localStore,a.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(a.targetId),n&&Ig(r.remoteStore,a.targetId),Hp(r,a.targetId)}).catch(Zl)):(Hp(r,a.targetId),await Up(r.localStore,a.targetId,!0))}async function aD(t,e){const n=tt(t),r=n.Pu.get(e),a=n.Tu.get(r.targetId);n.isPrimaryClient&&a.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),Ig(n.remoteStore,r.targetId))}async function sD(t,e,n){const r=dD(t);try{const a=await function(u,f){const h=tt(u),m=qt.now(),g=f.reduce((E,w)=>E.add(w.key),ht());let y,_;return h.persistence.runTransaction("Locally write mutations","readwrite",E=>{let w=Na(),T=ht();return h.Os.getEntries(E,g).next(b=>{w=b,w.forEach((k,q)=>{q.isValidDocument()||(T=T.add(k))})}).next(()=>h.localDocuments.getOverlayedDocuments(E,w)).next(b=>{y=b;const k=[];for(const q of f){const X=TI(q,y.get(q.key).overlayedDocument);X!=null&&k.push(new Ro(q.key,X,aT(X.value.mapValue),Gi.exists(!0)))}return h.mutationQueue.addMutationBatch(E,m,k,f)}).next(b=>{_=b;const k=b.applyToLocalDocumentSet(y,T);return h.documentOverlayCache.saveOverlays(E,b.batchId,k)})}).then(()=>({batchId:_.batchId,changes:pT(y)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(a.batchId),function(u,f,h){let m=u.Ru[u.currentUser.toKey()];m||(m=new Zt(st)),m=m.insert(f,h),u.Ru[u.currentUser.toKey()]=m}(r,a.batchId,n),await Kc(r,a.changes),await k0(r.remoteStore)}catch(a){const o=Mg(a,"Failed to persist write");n.reject(o)}}async function ZT(t,e){const n=tt(t);try{const r=await yN(n.localStore,e);e.targetChanges.forEach((a,o)=>{const u=n.Eu.get(o);u&&(Rt(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1,22616),a.addedDocuments.size>0?u.lu=!0:a.modifiedDocuments.size>0?Rt(u.lu,14607):a.removedDocuments.size>0&&(Rt(u.lu,42227),u.lu=!1))}),await Kc(n,r,e)}catch(r){await Zl(r)}}function Zx(t,e,n){const r=tt(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const a=[];r.Pu.forEach((o,u)=>{const f=u.view.va(e);f.snapshot&&a.push(f.snapshot)}),function(u,f){const h=tt(u);h.onlineState=f;let m=!1;h.queries.forEach((g,y)=>{for(const _ of y.wa)_.va(f)&&(m=!0)}),m&&Pg(h)}(r.eventManager,e),a.length&&r.hu.J_(a),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function oD(t,e,n){const r=tt(t);r.sharedClientState.updateQueryState(e,"rejected",n);const a=r.Eu.get(e),o=a&&a.key;if(o){let u=new Zt($e.comparator);u=u.insert(o,tr.newNoDocument(o,et.min()));const f=ht().add(o),h=new F0(et.min(),new Map,new Zt(st),u,f);await ZT(r,h),r.du=r.du.remove(o),r.Eu.delete(e),Lg(r)}else await Up(r.localStore,e,!1).then(()=>Hp(r,e,n)).catch(Zl)}async function lD(t,e){const n=tt(t),r=e.batch.batchId;try{const a=await _N(n.localStore,e);ew(n,r,null),JT(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Kc(n,a)}catch(a){await Zl(a)}}async function uD(t,e,n){const r=tt(t);try{const a=await function(u,f){const h=tt(u);return h.persistence.runTransaction("Reject batch","readwrite-primary",m=>{let g;return h.mutationQueue.lookupMutationBatch(m,f).next(y=>(Rt(y!==null,37113),g=y.keys(),h.mutationQueue.removeMutationBatch(m,y))).next(()=>h.mutationQueue.performConsistencyCheck(m)).next(()=>h.documentOverlayCache.removeOverlaysForBatchId(m,g,f)).next(()=>h.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(m,g)).next(()=>h.localDocuments.getDocuments(m,g))})}(r.localStore,e);ew(r,e,n),JT(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await Kc(r,a)}catch(a){await Zl(a)}}function JT(t,e){(t.Vu.get(e)||[]).forEach(n=>{n.resolve()}),t.Vu.delete(e)}function ew(t,e,n){const r=tt(t);let a=r.Ru[r.currentUser.toKey()];if(a){const o=a.get(e);o&&(n?o.reject(n):o.resolve(),a=a.remove(e)),r.Ru[r.currentUser.toKey()]=a}}function Hp(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Tu.get(e))t.Pu.delete(r),n&&t.hu.pu(r,n);t.Tu.delete(e),t.isPrimaryClient&&t.Au.zr(e).forEach(r=>{t.Au.containsKey(r)||tw(t,r)})}function tw(t,e){t.Iu.delete(e.path.canonicalString());const n=t.du.get(e);n!==null&&(Ig(t.remoteStore,n),t.du=t.du.remove(e),t.Eu.delete(n),Lg(t))}function Jx(t,e,n){for(const r of n)r instanceof WT?(t.Au.addReference(r.key,e),cD(t,r)):r instanceof KT?(je(kg,"Document no longer in limbo: "+r.key),t.Au.removeReference(r.key,e),t.Au.containsKey(r.key)||tw(t,r.key)):Ke(19791,{yu:r})}function cD(t,e){const n=e.key,r=n.path.canonicalString();t.du.get(n)||t.Iu.has(r)||(je(kg,"New document in limbo: "+n),t.Iu.add(r),Lg(t))}function Lg(t){for(;t.Iu.size>0&&t.du.size<t.maxConcurrentLimboResolutions;){const e=t.Iu.values().next().value;t.Iu.delete(e);const n=new $e(jt.fromString(e)),r=t.mu.next();t.Eu.set(r,new JN(n)),t.du=t.du.insert(n,r),UT(t.remoteStore,new cs(Hi(_g(n.path)),r,"TargetPurposeLimboResolution",S0.ue))}}async function Kc(t,e,n){const r=tt(t),a=[],o=[],u=[];r.Pu.isEmpty()||(r.Pu.forEach((f,h)=>{u.push(r.gu(h,e,n).then(m=>{var g;if((m||n)&&r.isPrimaryClient){const y=m?!m.fromCache:(g=n?.targetChanges.get(h.targetId))===null||g===void 0?void 0:g.current;r.sharedClientState.updateQueryState(h.targetId,y?"current":"not-current")}if(m){a.push(m);const y=Rg.Es(h.targetId,m);o.push(y)}}))}),await Promise.all(u),r.hu.J_(a),await async function(h,m){const g=tt(h);try{await g.persistence.runTransaction("notifyLocalViewChanges","readwrite",y=>we.forEach(m,_=>we.forEach(_.Is,E=>g.persistence.referenceDelegate.addReference(y,_.targetId,E)).next(()=>we.forEach(_.ds,E=>g.persistence.referenceDelegate.removeReference(y,_.targetId,E)))))}catch(y){if(!Jl(y))throw y;je(Cg,"Failed to update sequence numbers: "+y)}for(const y of m){const _=y.targetId;if(!y.fromCache){const E=g.Fs.get(_),w=E.snapshotVersion,T=E.withLastLimboFreeSnapshotVersion(w);g.Fs=g.Fs.insert(_,T)}}}(r.localStore,o))}async function fD(t,e){const n=tt(t);if(!n.currentUser.isEqual(e)){je(kg,"User change. New user:",e.toKey());const r=await kT(n.localStore,e);n.currentUser=e,function(o,u){o.Vu.forEach(f=>{f.forEach(h=>{h.reject(new ke(_e.CANCELLED,u))})}),o.Vu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await Kc(n,r.Bs)}}function hD(t,e){const n=tt(t),r=n.Eu.get(e);if(r&&r.lu)return ht().add(r.key);{let a=ht();const o=n.Tu.get(e);if(!o)return a;for(const u of o){const f=n.Pu.get(u);a=a.unionWith(f.view.tu)}return a}}function nw(t){const e=tt(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=ZT.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=hD.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=oD.bind(null,e),e.hu.J_=WN.bind(null,e.eventManager),e.hu.pu=KN.bind(null,e.eventManager),e}function dD(t){const e=tt(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=lD.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=uD.bind(null,e),e}class n0{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=M0(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Du(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Cu(e,this.localStore),this.indexBackfillerScheduler=this.Fu(e,this.localStore)}Cu(e,n){return null}Fu(e,n){return null}vu(e){return vN(this.persistence,new mN,e.initialUser,this.serializer)}Du(e){return new PT(bg.Vi,this.serializer)}bu(e){return new AN}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}n0.provider={build:()=>new n0};class mD extends n0{constructor(e){super(),this.cacheSizeBytes=e}Cu(e,n){Rt(this.persistence.referenceDelegate instanceof e0,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new JI(r,e.asyncQueue,n)}Du(e){const n=this.cacheSizeBytes!==void 0?Tr.withCacheSize(this.cacheSizeBytes):Tr.DEFAULT;return new PT(r=>e0.Vi(r,n),this.serializer)}}class Gp{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>Zx(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=fD.bind(null,this.syncEngine),await $N(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new YN}()}createDatastore(e){const n=M0(e.databaseInfo.databaseId),r=function(o){return new IN(o)}(e.databaseInfo);return function(o,u,f,h){return new FN(o,u,f,h)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,a,o,u,f){return new PN(r,a,o,u,f)}(this.localStore,this.datastore,e.asyncQueue,n=>Zx(this.syncEngine,n,0),function(){return $x.C()?new $x:new SN}())}createSyncEngine(e,n){return function(a,o,u,f,h,m,g){const y=new eD(a,o,u,f,h,m);return g&&(y.fu=!0),y}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(a){const o=tt(a);je(_o,"RemoteStore shutting down."),o.Ia.add(5),await Wc(o),o.Ea.shutdown(),o.Aa.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}Gp.provider={build:()=>new Gp};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rw{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.xu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.xu(this.observer.error,e):Ia("Uncaught Error in snapshot listener:",e.toString()))}Ou(){this.muted=!0}xu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cs="FirestoreClient";class pD{constructor(e,n,r,a,o){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=a,this.user=er.UNAUTHENTICATED,this.clientId=dg.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=o,this.authCredentials.start(r,async u=>{je(Cs,"Received user=",u.uid),await this.authCredentialListener(u),this.user=u}),this.appCheckCredentials.start(r,u=>(je(Cs,"Received new app check token=",u),this.appCheckCredentialListener(u,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new Ta;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=Mg(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function op(t,e){t.asyncQueue.verifyOperationInProgress(),je(Cs,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async a=>{r.isEqual(a)||(await kT(e.localStore,a),r=a)}),e.persistence.setDatabaseDeletedListener(()=>{Es("Terminating Firestore due to IndexedDb database deletion"),t.terminate().then(()=>{je("Terminating Firestore due to IndexedDb database deletion completed successfully")}).catch(a=>{Es("Terminating Firestore due to IndexedDb database deletion failed",a)})}),t._offlineComponents=e}async function e2(t,e){t.asyncQueue.verifyOperationInProgress();const n=await gD(t);je(Cs,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>Yx(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,a)=>Yx(e.remoteStore,a)),t._onlineComponents=e}async function gD(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){je(Cs,"Using user provided OfflineComponentProvider");try{await op(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(a){return a.name==="FirebaseError"?a.code===_e.FAILED_PRECONDITION||a.code===_e.UNIMPLEMENTED:!(typeof DOMException<"u"&&a instanceof DOMException)||a.code===22||a.code===20||a.code===11}(n))throw n;Es("Error using user provided cache. Falling back to memory cache: "+n),await op(t,new n0)}}else je(Cs,"Using default OfflineComponentProvider"),await op(t,new mD(void 0));return t._offlineComponents}async function iw(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(je(Cs,"Using user provided OnlineComponentProvider"),await e2(t,t._uninitializedComponentsProvider._online)):(je(Cs,"Using default OnlineComponentProvider"),await e2(t,new Gp))),t._onlineComponents}function vD(t){return iw(t).then(e=>e.syncEngine)}async function aw(t){const e=await iw(t),n=e.eventManager;return n.onListen=tD.bind(null,e.syncEngine),n.onUnlisten=iD.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=nD.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=aD.bind(null,e.syncEngine),n}function _D(t,e,n={}){const r=new Ta;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,f,h,m){const g=new rw({next:_=>{g.Ou(),u.enqueueAndForget(()=>XT(o,y));const E=_.docs.has(f);!E&&_.fromCache?m.reject(new ke(_e.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&_.fromCache&&h&&h.source==="server"?m.reject(new ke(_e.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):m.resolve(_)},error:_=>m.reject(_)}),y=new YT(_g(f.path),g,{includeMetadataChanges:!0,ka:!0});return $T(o,y)}(await aw(t),t.asyncQueue,e,n,r)),r.promise}function yD(t,e,n={}){const r=new Ta;return t.asyncQueue.enqueueAndForget(async()=>function(o,u,f,h,m){const g=new rw({next:_=>{g.Ou(),u.enqueueAndForget(()=>XT(o,y)),_.fromCache&&h.source==="server"?m.reject(new ke(_e.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):m.resolve(_)},error:_=>m.reject(_)}),y=new YT(f,g,{includeMetadataChanges:!0,ka:!0});return $T(o,y)}(await aw(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sw(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t2=new Map;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ow="firestore.googleapis.com",n2=!0;class r2{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new ke(_e.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=ow,this.ssl=n2}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:n2;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=MT;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<QI)throw new ke(_e.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}kC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=sw((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(o){if(o.timeoutSeconds!==void 0){if(isNaN(o.timeoutSeconds))throw new ke(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (must not be NaN)`);if(o.timeoutSeconds<5)throw new ke(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (minimum allowed value is 5)`);if(o.timeoutSeconds>30)throw new ke(_e.INVALID_ARGUMENT,`invalid long polling timeout: ${o.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,a){return r.timeoutSeconds===a.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class L0{constructor(e,n,r,a){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=a,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new r2({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ke(_e.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new ke(_e.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new r2(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new RC;switch(r.type){case"firstParty":return new DC(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new ke(_e.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=t2.get(n);r&&(je("ComponentProvider","Removing Datastore"),t2.delete(n),r.terminate())}(this),Promise.resolve()}}function xD(t,e,n,r={}){var a;t=Ts(t,L0);const o=lg(e),u=t._getSettings(),f=Object.assign(Object.assign({},u),{emulatorOptions:t._getEmulatorOptions()}),h=`${e}:${n}`;o&&(J3(`https://${h}`),rR("Firestore",!0)),u.host!==ow&&u.host!==h&&Es("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const m=Object.assign(Object.assign({},u),{host:h,ssl:o,emulatorOptions:r});if(!Gh(m,f)&&(t._setSettings(m),r.mockUserToken)){let g,y;if(typeof r.mockUserToken=="string")g=r.mockUserToken,y=er.MOCK_USER;else{g=eR(r.mockUserToken,(a=t._app)===null||a===void 0?void 0:a.options.projectId);const _=r.mockUserToken.sub||r.mockUserToken.user_id;if(!_)throw new ke(_e.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");y=new er(_)}t._authCredentials=new CC(new $E(g,y))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fa{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new Fa(this.firestore,e,this._query)}}class vn{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new gs(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vn(this.firestore,e,this._key)}toJSON(){return{type:vn._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,n,r){if($c(n,vn._jsonSchema))return new vn(e,r||null,new $e(jt.fromString(n.referencePath)))}}vn._jsonSchemaVersion="firestore/documentReference/1.0",vn._jsonSchema={type:gn("string",vn._jsonSchemaVersion),referencePath:gn("string")};class gs extends Fa{constructor(e,n,r){super(e,n,_g(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vn(this.firestore,null,new $e(e))}withConverter(e){return new gs(this.firestore,e,this._path)}}function i2(t,e,...n){if(t=ys(t),YE("collection","path",e),t instanceof L0){const r=jt.fromString(e,...n);return vx(r),new gs(t,null,r)}{if(!(t instanceof vn||t instanceof gs))throw new ke(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(jt.fromString(e,...n));return vx(r),new gs(t.firestore,null,r)}}function $l(t,e,...n){if(t=ys(t),arguments.length===1&&(e=dg.newId()),YE("doc","path",e),t instanceof L0){const r=jt.fromString(e,...n);return gx(r),new vn(t,null,new $e(r))}{if(!(t instanceof vn||t instanceof gs))throw new ke(_e.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(jt.fromString(e,...n));return gx(r),new vn(t.firestore,t instanceof gs?t.converter:null,new $e(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const a2="AsyncQueue";class s2{constructor(e=Promise.resolve()){this.Zu=[],this.Xu=!1,this.ec=[],this.tc=null,this.nc=!1,this.rc=!1,this.sc=[],this.F_=new VT(this,"async_queue_retry"),this.oc=()=>{const r=sp();r&&je(a2,"Visibility state changed to "+r.visibilityState),this.F_.y_()},this._c=e;const n=sp();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.oc)}get isShuttingDown(){return this.Xu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.ac(),this.uc(e)}enterRestrictedMode(e){if(!this.Xu){this.Xu=!0,this.rc=e||!1;const n=sp();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.oc)}}enqueue(e){if(this.ac(),this.Xu)return new Promise(()=>{});const n=new Ta;return this.uc(()=>this.Xu&&this.rc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Zu.push(e),this.cc()))}async cc(){if(this.Zu.length!==0){try{await this.Zu[0](),this.Zu.shift(),this.F_.reset()}catch(e){if(!Jl(e))throw e;je(a2,"Operation failed with retryable error: "+e)}this.Zu.length>0&&this.F_.g_(()=>this.cc())}}uc(e){const n=this._c.then(()=>(this.nc=!0,e().catch(r=>{throw this.tc=r,this.nc=!1,Ia("INTERNAL UNHANDLED ERROR: ",o2(r)),r}).then(r=>(this.nc=!1,r))));return this._c=n,n}enqueueAfterDelay(e,n,r){this.ac(),this.sc.indexOf(e)>-1&&(n=0);const a=Fg.createAndSchedule(this,e,n,r,o=>this.lc(o));return this.ec.push(a),a}ac(){this.tc&&Ke(47125,{hc:o2(this.tc)})}verifyOperationInProgress(){}async Pc(){let e;do e=this._c,await e;while(e!==this._c)}Tc(e){for(const n of this.ec)if(n.timerId===e)return!0;return!1}Ic(e){return this.Pc().then(()=>{this.ec.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.ec)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.Pc()})}dc(e){this.sc.push(e)}lc(e){const n=this.ec.indexOf(e);this.ec.splice(n,1)}}function o2(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}class Qc extends L0{constructor(e,n,r,a){super(e,n,r,a),this.type="firestore",this._queue=new s2,this._persistenceKey=a?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new s2(e),this._firestoreClient=void 0,await e}}}function ED(t,e){const n=typeof t=="object"?t:gC(),r=typeof t=="string"?t:Xh,a=fg(n,"firestore").getImmediate({identifier:r});if(!a._initialized){const o=Q3("firestore");o&&xD(a,...o)}return a}function Vg(t){if(t._terminated)throw new ke(_e.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||TD(t),t._firestoreClient}function TD(t){var e,n,r;const a=t._freezeSettings(),o=function(f,h,m,g){return new XC(f,h,m,g.host,g.ssl,g.experimentalForceLongPolling,g.experimentalAutoDetectLongPolling,sw(g.experimentalLongPollingOptions),g.useFetchStreams,g.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,a);t._componentsProvider||!((n=a.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=a.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:a.localCache._offlineComponentProvider,_online:a.localCache._onlineComponentProvider}),t._firestoreClient=new pD(t._authCredentials,t._appCheckCredentials,t._queue,o,t._componentsProvider&&function(f){const h=f?._online.build();return{_offline:f?._offline.build(h),_online:h}}(t._componentsProvider))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ni{constructor(e){this._byteString=e}static fromBase64String(e){try{return new ni(Xn.fromBase64String(e))}catch(n){throw new ke(_e.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new ni(Xn.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:ni._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if($c(e,ni._jsonSchema))return ni.fromBase64String(e.bytes)}}ni._jsonSchemaVersion="firestore/bytes/1.0",ni._jsonSchema={type:gn("string",ni._jsonSchemaVersion),bytes:gn("string")};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bg{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new ke(_e.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Hn(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lw{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $i{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new ke(_e.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new ke(_e.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return st(this._lat,e._lat)||st(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:$i._jsonSchemaVersion}}static fromJSON(e){if($c(e,$i._jsonSchema))return new $i(e.latitude,e.longitude)}}$i._jsonSchemaVersion="firestore/geoPoint/1.0",$i._jsonSchema={type:gn("string",$i._jsonSchemaVersion),latitude:gn("number"),longitude:gn("number")};/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Xi{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,a){if(r.length!==a.length)return!1;for(let o=0;o<r.length;++o)if(r[o]!==a[o])return!1;return!0}(this._values,e._values)}toJSON(){return{type:Xi._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if($c(e,Xi._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every(n=>typeof n=="number"))return new Xi(e.vectorValues);throw new ke(_e.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}Xi._jsonSchemaVersion="firestore/vectorValue/1.0",Xi._jsonSchema={type:gn("string",Xi._jsonSchemaVersion),vectorValues:gn("object")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wD=/^__.*__$/;class AD{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new Ro(e,this.data,this.fieldMask,n,this.fieldTransforms):new Xc(e,this.data,n,this.fieldTransforms)}}function uw(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Ke(40011,{Ec:t})}}class Ug{constructor(e,n,r,a,o,u){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=a,o===void 0&&this.Ac(),this.fieldTransforms=o||[],this.fieldMask=u||[]}get path(){return this.settings.path}get Ec(){return this.settings.Ec}Rc(e){return new Ug(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Vc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Rc({path:r,mc:!1});return a.fc(e),a}gc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),a=this.Rc({path:r,mc:!1});return a.Ac(),a}yc(e){return this.Rc({path:void 0,mc:!0})}wc(e){return r0(e,this.settings.methodName,this.settings.Sc||!1,this.path,this.settings.bc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ac(){if(this.path)for(let e=0;e<this.path.length;e++)this.fc(this.path.get(e))}fc(e){if(e.length===0)throw this.wc("Document fields must not be empty");if(uw(this.Ec)&&wD.test(e))throw this.wc('Document fields cannot begin and end with "__"')}}class SD{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||M0(e)}Dc(e,n,r,a=!1){return new Ug({Ec:e,methodName:n,bc:r,path:Hn.emptyPath(),mc:!1,Sc:a},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function jg(t){const e=t._freezeSettings(),n=M0(t._databaseId);return new SD(t._databaseId,!!e.ignoreUndefinedProperties,n)}function bD(t,e,n,r,a,o={}){const u=t.Dc(o.merge||o.mergeFields?2:0,e,n,a);dw("Data must be an object, but it was:",u,r);const f=fw(r,u);let h,m;if(o.merge)h=new mi(u.fieldMask),m=u.fieldTransforms;else if(o.mergeFields){const g=[];for(const y of o.mergeFields){const _=RD(e,y,n);if(!u.contains(_))throw new ke(_e.INVALID_ARGUMENT,`Field '${_}' is specified in your field mask but missing from your input data.`);ID(g,_)||g.push(_)}h=new mi(g),m=u.fieldTransforms.filter(y=>h.covers(y.field))}else h=null,m=u.fieldTransforms;return new AD(new ti(f),h,m)}function cw(t,e,n,r=!1){return zg(n,t.Dc(r?4:3,e))}function zg(t,e){if(hw(t=ys(t)))return dw("Unsupported field value:",e,t),fw(t,e);if(t instanceof lw)return function(r,a){if(!uw(a.Ec))throw a.wc(`${r._methodName}() can only be used with update() and set()`);if(!a.path)throw a.wc(`${r._methodName}() is not currently supported inside arrays`);const o=r._toFieldTransform(a);o&&a.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.mc&&e.Ec!==4)throw e.wc("Nested arrays are not supported");return function(r,a){const o=[];let u=0;for(const f of r){let h=zg(f,a.yc(u));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),u++}return{arrayValue:{values:o}}}(t,e)}return function(r,a){if((r=ys(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return gI(a.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const o=qt.fromDate(r);return{timestampValue:Jh(a.serializer,o)}}if(r instanceof qt){const o=new qt(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:Jh(a.serializer,o)}}if(r instanceof $i)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof ni)return{bytesValue:RT(a.serializer,r._byteString)};if(r instanceof vn){const o=a.databaseId,u=r.firestore._databaseId;if(!u.isEqual(o))throw a.wc(`Document reference is for database ${u.projectId}/${u.database} but should be for database ${o.projectId}/${o.database}`);return{referenceValue:Ag(r.firestore._databaseId||a.databaseId,r._key.path)}}if(r instanceof Xi)return function(u,f){return{mapValue:{fields:{[rT]:{stringValue:iT},[Yh]:{arrayValue:{values:u.toArray().map(m=>{if(typeof m!="number")throw f.wc("VectorValues must only contain numeric values.");return xg(f.serializer,m)})}}}}}}(r,a);throw a.wc(`Unsupported field value: ${A0(r)}`)}(t,e)}function fw(t,e){const n={};return QE(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Ao(t,(r,a)=>{const o=zg(a,e.Vc(r));o!=null&&(n[r]=o)}),{mapValue:{fields:n}}}function hw(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof qt||t instanceof $i||t instanceof ni||t instanceof vn||t instanceof lw||t instanceof Xi)}function dw(t,e,n){if(!hw(n)||!WE(n)){const r=A0(n);throw r==="an object"?e.wc(t+" a custom object"):e.wc(t+" "+r)}}function RD(t,e,n){if((e=ys(e))instanceof Bg)return e._internalPath;if(typeof e=="string")return mw(t,e);throw r0("Field path arguments must be of type string or ",t,!1,void 0,n)}const CD=new RegExp("[~\\*/\\[\\]]");function mw(t,e,n){if(e.search(CD)>=0)throw r0(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new Bg(...e.split("."))._internalPath}catch{throw r0(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function r0(t,e,n,r,a){const o=r&&!r.isEmpty(),u=a!==void 0;let f=`Function ${e}() called with invalid data`;n&&(f+=" (via `toFirestore()`)"),f+=". ";let h="";return(o||u)&&(h+=" (found",o&&(h+=` in field ${r}`),u&&(h+=` in document ${a}`),h+=")"),new ke(_e.INVALID_ARGUMENT,f+t+h)}function ID(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hg{constructor(e,n,r,a,o){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=a,this._converter=o}get id(){return this._key.path.lastSegment()}get ref(){return new vn(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new ND(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(Gg("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class ND extends Hg{data(){return super.data()}}function Gg(t,e){return typeof e=="string"?mw(t,e):e instanceof Bg?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DD(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new ke(_e.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class qg{}class V0 extends qg{}function l2(t,e,...n){let r=[];e instanceof qg&&r.push(e),r=r.concat(n),function(o){const u=o.filter(h=>h instanceof Xg).length,f=o.filter(h=>h instanceof $g).length;if(u>1||u>0&&f>0)throw new ke(_e.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const a of r)t=a._apply(t);return t}class $g extends V0{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new $g(e,n,r)}_apply(e){const n=this._parse(e);return pw(e._query,n),new Fa(e.firestore,e.converter,Pp(e._query,n))}_parse(e){const n=jg(e.firestore);return function(o,u,f,h,m,g,y){let _;if(m.isKeyField()){if(g==="array-contains"||g==="array-contains-any")throw new ke(_e.INVALID_ARGUMENT,`Invalid Query. You can't perform '${g}' queries on documentId().`);if(g==="in"||g==="not-in"){h2(y,g);const w=[];for(const T of y)w.push(f2(h,o,T));_={arrayValue:{values:w}}}else _=f2(h,o,y)}else g!=="in"&&g!=="not-in"&&g!=="array-contains-any"||h2(y,g),_=cw(f,u,y,g==="in"||g==="not-in");return pn.create(m,g,_)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}class Xg extends qg{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new Xg(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:vi.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(a,o){let u=a;const f=o.getFlattenedFilters();for(const h of f)pw(u,h),u=Pp(u,h)}(e._query,n),new Fa(e.firestore,e.converter,Pp(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}class Yg extends V0{constructor(e,n){super(),this._field=e,this._direction=n,this.type="orderBy"}static _create(e,n){return new Yg(e,n)}_apply(e){const n=function(a,o,u){if(a.startAt!==null)throw new ke(_e.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(a.endAt!==null)throw new ke(_e.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Dc(o,u)}(e._query,this._field,this._direction);return new Fa(e.firestore,e.converter,function(a,o){const u=a.explicitOrderBy.concat([o]);return new So(a.path,a.collectionGroup,u,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(e._query,n))}}function u2(t,e="asc"){const n=e,r=Gg("orderBy",t);return Yg._create(r,n)}class Wg extends V0{constructor(e,n,r){super(),this.type=e,this._limit=n,this._limitType=r}static _create(e,n,r){return new Wg(e,n,r)}_apply(e){return new Fa(e.firestore,e.converter,Kh(e._query,this._limit,this._limitType))}}function c2(t){return Wg._create("limit",t,"F")}class Kg extends V0{constructor(e,n,r){super(),this.type=e,this._docOrFields=n,this._inclusive=r}static _create(e,n,r){return new Kg(e,n,r)}_apply(e){const n=FD(e,this.type,this._docOrFields,this._inclusive);return new Fa(e.firestore,e.converter,function(a,o){return new So(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),a.limit,a.limitType,o,a.endAt)}(e._query,n))}}function OD(...t){return Kg._create("startAfter",t,!1)}function FD(t,e,n,r){if(n[0]=ys(n[0]),n[0]instanceof Hg)return function(o,u,f,h,m){if(!h)throw new ke(_e.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${f}().`);const g=[];for(const y of Ol(o))if(y.field.isKeyField())g.push(Wh(u,h.key));else{const _=h.data.field(y.field);if(R0(_))throw new ke(_e.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+y.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(_===null){const E=y.field.canonicalString();throw new ke(_e.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${E}' (used as the orderBy) does not exist.`)}g.push(_)}return new Hl(g,m)}(t._query,t.firestore._databaseId,e,n[0]._document,r);{const a=jg(t.firestore);return function(u,f,h,m,g,y){const _=u.explicitOrderBy;if(g.length>_.length)throw new ke(_e.INVALID_ARGUMENT,`Too many arguments provided to ${m}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const E=[];for(let w=0;w<g.length;w++){const T=g[w];if(_[w].field.isKeyField()){if(typeof T!="string")throw new ke(_e.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${m}(), but got a ${typeof T}`);if(!yg(u)&&T.indexOf("/")!==-1)throw new ke(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${m}() must be a plain document ID, but '${T}' contains a slash.`);const b=u.path.child(jt.fromString(T));if(!$e.isDocumentKey(b))throw new ke(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${m}() must result in a valid document path, but '${b}' is not because it contains an odd number of segments.`);const k=new $e(b);E.push(Wh(f,k))}else{const b=cw(h,m,T);E.push(b)}}return new Hl(E,y)}(t._query,t.firestore._databaseId,a,e,n,r)}}function f2(t,e,n){if(typeof(n=ys(n))=="string"){if(n==="")throw new ke(_e.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!yg(e)&&n.indexOf("/")!==-1)throw new ke(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(jt.fromString(n));if(!$e.isDocumentKey(r))throw new ke(_e.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Wh(t,new $e(r))}if(n instanceof vn)return Wh(t,n._key);throw new ke(_e.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${A0(n)}.`)}function h2(t,e){if(!Array.isArray(t)||t.length===0)throw new ke(_e.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function pw(t,e){const n=function(a,o){for(const u of a)for(const f of u.getFlattenedFilters())if(o.indexOf(f.op)>=0)return f.op;return null}(t.filters,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new ke(_e.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new ke(_e.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class MD{convertValue(e,n="none"){switch(bs(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ln(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Ss(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Ke(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return Ao(e,(a,o)=>{r[a]=this.convertValue(o,n)}),r}convertVectorValue(e){var n,r,a;const o=(a=(r=(n=e.fields)===null||n===void 0?void 0:n[Yh].arrayValue)===null||r===void 0?void 0:r.values)===null||a===void 0?void 0:a.map(u=>ln(u.doubleValue));return new Xi(o)}convertGeoPoint(e){return new $i(ln(e.latitude),ln(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=C0(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Cc(e));default:return null}}convertTimestamp(e){const n=As(e);return new qt(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=jt.fromString(e);Rt(FT(r),9688,{name:e});const a=new Ic(r.get(1),r.get(3)),o=new $e(r.popFirst(5));return a.isEqual(n)||Ia(`Document ${o} contains a document reference within a different database (${a.projectId}/${a.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),o}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PD(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}class hc{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class po extends Hg{constructor(e,n,r,a,o,u){super(e,n,r,a,u),this._firestore=e,this._firestoreImpl=e,this.metadata=o}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new jh(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(Gg("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(_e.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,n={};return n.type=po._jsonSchemaVersion,n.bundle="",n.bundleSource="DocumentSnapshot",n.bundleName=this._key.toString(),!e||!e.isValidDocument()||!e.isFoundDocument()?n:(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),n.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),n)}}po._jsonSchemaVersion="firestore/documentSnapshot/1.0",po._jsonSchema={type:gn("string",po._jsonSchemaVersion),bundleSource:gn("string","DocumentSnapshot"),bundleName:gn("string"),bundle:gn("string")};class jh extends po{data(e={}){return super.data(e)}}class Ml{constructor(e,n,r,a){this._firestore=e,this._userDataWriter=n,this._snapshot=a,this.metadata=new hc(a.hasPendingWrites,a.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new jh(this._firestore,this._userDataWriter,r.key,r,new hc(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new ke(_e.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(a,o){if(a._snapshot.oldDocs.isEmpty()){let u=0;return a._snapshot.docChanges.map(f=>{const h=new jh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new hc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);return f.doc,{type:"added",doc:h,oldIndex:-1,newIndex:u++}})}{let u=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(f=>o||f.type!==3).map(f=>{const h=new jh(a._firestore,a._userDataWriter,f.doc.key,f.doc,new hc(a._snapshot.mutatedKeys.has(f.doc.key),a._snapshot.fromCache),a.query.converter);let m=-1,g=-1;return f.type!==0&&(m=u.indexOf(f.doc.key),u=u.delete(f.doc.key)),f.type!==1&&(u=u.add(f.doc),g=u.indexOf(f.doc.key)),{type:kD(f.type),doc:h,oldIndex:m,newIndex:g}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new ke(_e.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=Ml._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=dg.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const n=[],r=[],a=[];return this.docs.forEach(o=>{o._document!==null&&(n.push(o._document),r.push(this._userDataWriter.convertObjectMap(o._document.data.value.mapValue.fields,"previous")),a.push(o.ref.path))}),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function kD(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Ke(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gw(t){t=Ts(t,vn);const e=Ts(t.firestore,Qc);return _D(Vg(e),t._key).then(n=>VD(e,t,n))}Ml._jsonSchemaVersion="firestore/querySnapshot/1.0",Ml._jsonSchema={type:gn("string",Ml._jsonSchemaVersion),bundleSource:gn("string","QuerySnapshot"),bundleName:gn("string"),bundle:gn("string")};class vw extends MD{constructor(e){super(),this.firestore=e}convertBytes(e){return new ni(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new vn(this.firestore,null,n)}}function d2(t){t=Ts(t,Fa);const e=Ts(t.firestore,Qc),n=Vg(e),r=new vw(e);return DD(t._query),yD(n,t._query).then(a=>new Ml(e,r,t,a))}function Mc(t,e,n){t=Ts(t,vn);const r=Ts(t.firestore,Qc),a=PD(t.converter,e,n);return _w(r,[bD(jg(r),"setDoc",t._key,a,t.converter!==null,n).toMutation(t._key,Gi.none())])}function LD(t){return _w(Ts(t.firestore,Qc),[new Eg(t._key,Gi.none())])}function _w(t,e){return function(r,a){const o=new Ta;return r.asyncQueue.enqueueAndForget(async()=>sD(await vD(r),a,o)),o.promise}(Vg(t),e)}function VD(t,e,n){const r=n.docs.get(e._key),a=new vw(t);return new po(t,a,e._key,r,new hc(n.hasPendingWrites,n.fromCache),e.converter)}(function(e,n=!0){(function(a){Ql=a})(pC),xs(new Ra("firestore",(r,{instanceIdentifier:a,options:o})=>{const u=r.getProvider("app").getImmediate(),f=new Qc(new IC(r.getProvider("auth-internal")),new OC(u,r.getProvider("app-check-internal")),function(m,g){if(!Object.prototype.hasOwnProperty.apply(m.options,["projectId"]))throw new ke(_e.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Ic(m.options.projectId,g)}(u,a),u);return o=Object.assign({useFetchStreams:n},o),f._setSettings(o),f},"PUBLIC").setMultipleInstances(!0)),zi(fx,hx,e),zi(fx,hx,"esm2017")})();var BD="firebase",UD="11.10.0";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */zi(BD,UD,"app");const jD=(t,e)=>e.some(n=>t instanceof n);let m2,p2;function zD(){return m2||(m2=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function HD(){return p2||(p2=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const yw=new WeakMap,qp=new WeakMap,xw=new WeakMap,lp=new WeakMap,Qg=new WeakMap;function GD(t){const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("success",o),t.removeEventListener("error",u)},o=()=>{n(vs(t.result)),a()},u=()=>{r(t.error),a()};t.addEventListener("success",o),t.addEventListener("error",u)});return e.then(n=>{n instanceof IDBCursor&&yw.set(n,t)}).catch(()=>{}),Qg.set(e,t),e}function qD(t){if(qp.has(t))return;const e=new Promise((n,r)=>{const a=()=>{t.removeEventListener("complete",o),t.removeEventListener("error",u),t.removeEventListener("abort",u)},o=()=>{n(),a()},u=()=>{r(t.error||new DOMException("AbortError","AbortError")),a()};t.addEventListener("complete",o),t.addEventListener("error",u),t.addEventListener("abort",u)});qp.set(t,e)}let $p={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return qp.get(t);if(e==="objectStoreNames")return t.objectStoreNames||xw.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return vs(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function $D(t){$p=t($p)}function XD(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(up(this),e,...n);return xw.set(r,e.sort?e.sort():[e]),vs(r)}:HD().includes(t)?function(...e){return t.apply(up(this),e),vs(yw.get(this))}:function(...e){return vs(t.apply(up(this),e))}}function YD(t){return typeof t=="function"?XD(t):(t instanceof IDBTransaction&&qD(t),jD(t,zD())?new Proxy(t,$p):t)}function vs(t){if(t instanceof IDBRequest)return GD(t);if(lp.has(t))return lp.get(t);const e=YD(t);return e!==t&&(lp.set(t,e),Qg.set(e,t)),e}const up=t=>Qg.get(t);function WD(t,e,{blocked:n,upgrade:r,blocking:a,terminated:o}={}){const u=indexedDB.open(t,e),f=vs(u);return r&&u.addEventListener("upgradeneeded",h=>{r(vs(u.result),h.oldVersion,h.newVersion,vs(u.transaction),h)}),n&&u.addEventListener("blocked",h=>n(h.oldVersion,h.newVersion,h)),f.then(h=>{o&&h.addEventListener("close",()=>o()),a&&h.addEventListener("versionchange",m=>a(m.oldVersion,m.newVersion,m))}).catch(()=>{}),f}const KD=["get","getKey","getAll","getAllKeys","count"],QD=["put","add","delete","clear"],cp=new Map;function g2(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(cp.get(e))return cp.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,a=QD.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(a||KD.includes(n)))return;const o=async function(u,...f){const h=this.transaction(u,a?"readwrite":"readonly");let m=h.store;return r&&(m=m.index(f.shift())),(await Promise.all([m[n](...f),a&&h.done]))[0]};return cp.set(e,o),o}$D(t=>({...t,get:(e,n,r)=>g2(e,n)||t.get(e,n,r),has:(e,n)=>!!g2(e,n)||t.has(e,n)}));const Ew="@firebase/installations",Zg="0.6.18";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Tw=1e4,ww=`w:${Zg}`,Aw="FIS_v2",ZD="https://firebaseinstallations.googleapis.com/v1",JD=60*60*1e3,e6="installations",t6="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n6={"missing-app-config-values":'Missing App configuration value: "{$valueName}"',"not-registered":"Firebase Installation is not registered.","installation-not-found":"Firebase Installation not found.","request-failed":'{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',"app-offline":"Could not process request. Application offline.","delete-pending-registration":"Can't delete installation while there is a pending registration request."},yo=new w0(e6,t6,n6);function Sw(t){return t instanceof Fs&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bw({projectId:t}){return`${ZD}/projects/${t}/installations`}function Rw(t){return{token:t.token,requestStatus:2,expiresIn:i6(t.expiresIn),creationTime:Date.now()}}async function Cw(t,e){const r=(await e.json()).error;return yo.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})}function Iw({apiKey:t}){return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":t})}function r6(t,{refreshToken:e}){const n=Iw(t);return n.append("Authorization",a6(e)),n}async function Nw(t){const e=await t();return e.status>=500&&e.status<600?t():e}function i6(t){return Number(t.replace("s","000"))}function a6(t){return`${Aw} ${t}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function s6({appConfig:t,heartbeatServiceProvider:e},{fid:n}){const r=bw(t),a=Iw(t),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const u={fid:n,authVersion:Aw,appId:t.appId,sdkVersion:ww},f={method:"POST",headers:a,body:JSON.stringify(u)},h=await Nw(()=>fetch(r,f));if(h.ok){const m=await h.json();return{fid:m.fid||n,registrationStatus:2,refreshToken:m.refreshToken,authToken:Rw(m.authToken)}}else throw await Cw("Create Installation",h)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Dw(t){return new Promise(e=>{setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function o6(t){return btoa(String.fromCharCode(...t)).replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const l6=/^[cdef][\w-]{21}$/,Xp="";function u6(){try{const t=new Uint8Array(17);(self.crypto||self.msCrypto).getRandomValues(t),t[0]=112+t[0]%16;const n=c6(t);return l6.test(n)?n:Xp}catch{return Xp}}function c6(t){return o6(t).substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function B0(t){return`${t.appName}!${t.appId}`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ow=new Map;function Fw(t,e){const n=B0(t);Mw(n,e),f6(n,e)}function Mw(t,e){const n=Ow.get(t);if(n)for(const r of n)r(e)}function f6(t,e){const n=h6();n&&n.postMessage({key:t,fid:e}),d6()}let mo=null;function h6(){return!mo&&"BroadcastChannel"in self&&(mo=new BroadcastChannel("[Firebase] FID Change"),mo.onmessage=t=>{Mw(t.data.key,t.data.fid)}),mo}function d6(){Ow.size===0&&mo&&(mo.close(),mo=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const m6="firebase-installations-database",p6=1,xo="firebase-installations-store";let fp=null;function Jg(){return fp||(fp=WD(m6,p6,{upgrade:(t,e)=>{switch(e){case 0:t.createObjectStore(xo)}}})),fp}async function i0(t,e){const n=B0(t),a=(await Jg()).transaction(xo,"readwrite"),o=a.objectStore(xo),u=await o.get(n);return await o.put(e,n),await a.done,(!u||u.fid!==e.fid)&&Fw(t,e.fid),e}async function Pw(t){const e=B0(t),r=(await Jg()).transaction(xo,"readwrite");await r.objectStore(xo).delete(e),await r.done}async function U0(t,e){const n=B0(t),a=(await Jg()).transaction(xo,"readwrite"),o=a.objectStore(xo),u=await o.get(n),f=e(u);return f===void 0?await o.delete(n):await o.put(f,n),await a.done,f&&(!u||u.fid!==f.fid)&&Fw(t,f.fid),f}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function e1(t){let e;const n=await U0(t.appConfig,r=>{const a=g6(r),o=v6(t,a);return e=o.registrationPromise,o.installationEntry});return n.fid===Xp?{installationEntry:await e}:{installationEntry:n,registrationPromise:e}}function g6(t){const e=t||{fid:u6(),registrationStatus:0};return kw(e)}function v6(t,e){if(e.registrationStatus===0){if(!navigator.onLine){const a=Promise.reject(yo.create("app-offline"));return{installationEntry:e,registrationPromise:a}}const n={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},r=_6(t,n);return{installationEntry:n,registrationPromise:r}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:y6(t)}:{installationEntry:e}}async function _6(t,e){try{const n=await s6(t,e);return i0(t.appConfig,n)}catch(n){throw Sw(n)&&n.customData.serverCode===409?await Pw(t.appConfig):await i0(t.appConfig,{fid:e.fid,registrationStatus:0}),n}}async function y6(t){let e=await v2(t.appConfig);for(;e.registrationStatus===1;)await Dw(100),e=await v2(t.appConfig);if(e.registrationStatus===0){const{installationEntry:n,registrationPromise:r}=await e1(t);return r||n}return e}function v2(t){return U0(t,e=>{if(!e)throw yo.create("installation-not-found");return kw(e)})}function kw(t){return x6(t)?{fid:t.fid,registrationStatus:0}:t}function x6(t){return t.registrationStatus===1&&t.registrationTime+Tw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function E6({appConfig:t,heartbeatServiceProvider:e},n){const r=T6(t,n),a=r6(t,n),o=e.getImmediate({optional:!0});if(o){const m=await o.getHeartbeatsHeader();m&&a.append("x-firebase-client",m)}const u={installation:{sdkVersion:ww,appId:t.appId}},f={method:"POST",headers:a,body:JSON.stringify(u)},h=await Nw(()=>fetch(r,f));if(h.ok){const m=await h.json();return Rw(m)}else throw await Cw("Generate Auth Token",h)}function T6(t,{fid:e}){return`${bw(t)}/${e}/authTokens:generate`}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function t1(t,e=!1){let n;const r=await U0(t.appConfig,o=>{if(!Lw(o))throw yo.create("not-registered");const u=o.authToken;if(!e&&S6(u))return o;if(u.requestStatus===1)return n=w6(t,e),o;{if(!navigator.onLine)throw yo.create("app-offline");const f=R6(o);return n=A6(t,f),f}});return n?await n:r.authToken}async function w6(t,e){let n=await _2(t.appConfig);for(;n.authToken.requestStatus===1;)await Dw(100),n=await _2(t.appConfig);const r=n.authToken;return r.requestStatus===0?t1(t,e):r}function _2(t){return U0(t,e=>{if(!Lw(e))throw yo.create("not-registered");const n=e.authToken;return C6(n)?Object.assign(Object.assign({},e),{authToken:{requestStatus:0}}):e})}async function A6(t,e){try{const n=await E6(t,e),r=Object.assign(Object.assign({},e),{authToken:n});return await i0(t.appConfig,r),n}catch(n){if(Sw(n)&&(n.customData.serverCode===401||n.customData.serverCode===404))await Pw(t.appConfig);else{const r=Object.assign(Object.assign({},e),{authToken:{requestStatus:0}});await i0(t.appConfig,r)}throw n}}function Lw(t){return t!==void 0&&t.registrationStatus===2}function S6(t){return t.requestStatus===2&&!b6(t)}function b6(t){const e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+JD}function R6(t){const e={requestStatus:1,requestTime:Date.now()};return Object.assign(Object.assign({},t),{authToken:e})}function C6(t){return t.requestStatus===1&&t.requestTime+Tw<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function I6(t){const e=t,{installationEntry:n,registrationPromise:r}=await e1(e);return r?r.catch(console.error):t1(e).catch(console.error),n.fid}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function N6(t,e=!1){const n=t;return await D6(n),(await t1(n,e)).token}async function D6(t){const{registrationPromise:e}=await e1(t);e&&await e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function O6(t){if(!t||!t.options)throw hp("App Configuration");if(!t.name)throw hp("App Name");const e=["projectId","apiKey","appId"];for(const n of e)if(!t.options[n])throw hp(n);return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function hp(t){return yo.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Vw="installations",F6="installations-internal",M6=t=>{const e=t.getProvider("app").getImmediate(),n=O6(e),r=fg(e,"heartbeat");return{app:e,appConfig:n,heartbeatServiceProvider:r,_delete:()=>Promise.resolve()}},P6=t=>{const e=t.getProvider("app").getImmediate(),n=fg(e,Vw).getImmediate();return{getId:()=>I6(n),getToken:a=>N6(n,a)}};function k6(){xs(new Ra(Vw,M6,"PUBLIC")),xs(new Ra(F6,P6,"PRIVATE"))}k6();zi(Ew,Zg);zi(Ew,Zg,"esm2017");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const y2="analytics",L6="firebase_id",V6="origin",B6=60*1e3,U6="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",n1="https://www.googletagmanager.com/gtag/js";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wr=new ug("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const j6={"already-exists":"A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.","already-initialized":"initializeAnalytics() cannot be called again with different options than those it was initially called with. It can be called again with the same options to return the existing instance, or getAnalytics() can be used to get a reference to the already-initialized instance.","already-initialized-settings":"Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.","interop-component-reg-failed":"Firebase Analytics Interop Component failed to instantiate: {$reason}","invalid-analytics-context":"Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","indexeddb-unavailable":"IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}","fetch-throttle":"The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.","config-fetch-failed":"Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}","no-api-key":'The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',"no-app-id":'The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',"no-client-id":'The "client_id" field is empty.',"invalid-gtag-resource":"Trusted Types detected an invalid gtag resource: {$gtagURL}."},ri=new w0("analytics","Analytics",j6);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function z6(t){if(!t.startsWith(n1)){const e=ri.create("invalid-gtag-resource",{gtagURL:t});return wr.warn(e.message),""}return t}function Bw(t){return Promise.all(t.map(e=>e.catch(n=>n)))}function H6(t,e){let n;return window.trustedTypes&&(n=window.trustedTypes.createPolicy(t,e)),n}function G6(t,e){const n=H6("firebase-js-sdk-policy",{createScriptURL:z6}),r=document.createElement("script"),a=`${n1}?l=${t}&id=${e}`;r.src=n?n?.createScriptURL(a):a,r.async=!0,document.head.appendChild(r)}function q6(t){let e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}async function $6(t,e,n,r,a,o){const u=r[a];try{if(u)await e[u];else{const h=(await Bw(n)).find(m=>m.measurementId===a);h&&await e[h.appId]}}catch(f){wr.error(f)}t("config",a,o)}async function X6(t,e,n,r,a){try{let o=[];if(a&&a.send_to){let u=a.send_to;Array.isArray(u)||(u=[u]);const f=await Bw(n);for(const h of u){const m=f.find(y=>y.measurementId===h),g=m&&e[m.appId];if(g)o.push(g);else{o=[];break}}}o.length===0&&(o=Object.values(e)),await Promise.all(o),t("event",r,a||{})}catch(o){wr.error(o)}}function Y6(t,e,n,r){async function a(o,...u){try{if(o==="event"){const[f,h]=u;await X6(t,e,n,f,h)}else if(o==="config"){const[f,h]=u;await $6(t,e,n,r,f,h)}else if(o==="consent"){const[f,h]=u;t("consent",f,h)}else if(o==="get"){const[f,h,m]=u;t("get",f,h,m)}else if(o==="set"){const[f]=u;t("set",f)}else t(o,...u)}catch(f){wr.error(f)}}return a}function W6(t,e,n,r,a){let o=function(...u){window[r].push(arguments)};return window[a]&&typeof window[a]=="function"&&(o=window[a]),window[a]=Y6(o,t,e,n),{gtagCore:o,wrappedGtag:window[a]}}function K6(t){const e=window.document.getElementsByTagName("script");for(const n of Object.values(e))if(n.src&&n.src.includes(n1)&&n.src.includes(t))return n;return null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Q6=30,Z6=1e3;class J6{constructor(e={},n=Z6){this.throttleMetadata=e,this.intervalMillis=n}getThrottleMetadata(e){return this.throttleMetadata[e]}setThrottleMetadata(e,n){this.throttleMetadata[e]=n}deleteThrottleMetadata(e){delete this.throttleMetadata[e]}}const Uw=new J6;function eO(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}async function tO(t){var e;const{appId:n,apiKey:r}=t,a={method:"GET",headers:eO(r)},o=U6.replace("{app-id}",n),u=await fetch(o,a);if(u.status!==200&&u.status!==304){let f="";try{const h=await u.json();!((e=h.error)===null||e===void 0)&&e.message&&(f=h.error.message)}catch{}throw ri.create("config-fetch-failed",{httpStatus:u.status,responseMessage:f})}return u.json()}async function nO(t,e=Uw,n){const{appId:r,apiKey:a,measurementId:o}=t.options;if(!r)throw ri.create("no-app-id");if(!a){if(o)return{measurementId:o,appId:r};throw ri.create("no-api-key")}const u=e.getThrottleMetadata(r)||{backoffCount:0,throttleEndTimeMillis:Date.now()},f=new aO;return setTimeout(async()=>{f.abort()},B6),jw({appId:r,apiKey:a,measurementId:o},u,f,e)}async function jw(t,{throttleEndTimeMillis:e,backoffCount:n},r,a=Uw){var o;const{appId:u,measurementId:f}=t;try{await rO(r,e)}catch(h){if(f)return wr.warn(`Timed out fetching this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${h?.message}]`),{appId:u,measurementId:f};throw h}try{const h=await tO(t);return a.deleteThrottleMetadata(u),h}catch(h){const m=h;if(!iO(m)){if(a.deleteThrottleMetadata(u),f)return wr.warn(`Failed to fetch this Firebase app's measurement ID from the server. Falling back to the measurement ID ${f} provided in the "measurementId" field in the local Firebase config. [${m?.message}]`),{appId:u,measurementId:f};throw h}const g=Number((o=m?.customData)===null||o===void 0?void 0:o.httpStatus)===503?tx(n,a.intervalMillis,Q6):tx(n,a.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:n+1};return a.setThrottleMetadata(u,y),wr.debug(`Calling attemptFetch again in ${g} millis`),jw(t,y,r,a)}}function rO(t,e){return new Promise((n,r)=>{const a=Math.max(e-Date.now(),0),o=setTimeout(n,a);t.addEventListener(()=>{clearTimeout(o),r(ri.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function iO(t){if(!(t instanceof Fs)||!t.customData)return!1;const e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}class aO{constructor(){this.listeners=[]}addEventListener(e){this.listeners.push(e)}abort(){this.listeners.forEach(e=>e())}}async function sO(t,e,n,r,a){if(a&&a.global){t("event",n,r);return}else{const o=await e,u=Object.assign(Object.assign({},r),{send_to:o});t("event",n,u)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function oO(){if(OE())try{await FE()}catch(t){return wr.warn(ri.create("indexeddb-unavailable",{errorInfo:t?.toString()}).message),!1}else return wr.warn(ri.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),!1;return!0}async function lO(t,e,n,r,a,o,u){var f;const h=nO(t);h.then(E=>{n[E.measurementId]=E.appId,t.options.measurementId&&E.measurementId!==t.options.measurementId&&wr.warn(`The measurement ID in the local Firebase config (${t.options.measurementId}) does not match the measurement ID fetched from the server (${E.measurementId}). To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.`)}).catch(E=>wr.error(E)),e.push(h);const m=oO().then(E=>{if(E)return r.getId()}),[g,y]=await Promise.all([h,m]);K6(o)||G6(o,g.measurementId),a("js",new Date);const _=(f=u?.config)!==null&&f!==void 0?f:{};return _[V6]="firebase",_.update=!0,y!=null&&(_[L6]=y),a("config",g.measurementId,_),g.measurementId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uO{constructor(e){this.app=e}_delete(){return delete _c[this.app.options.appId],Promise.resolve()}}let _c={},x2=[];const E2={};let dp="dataLayer",cO="gtag",T2,zw,w2=!1;function fO(){const t=[];if(sR()&&t.push("This is a browser extension environment."),lR()||t.push("Cookies are not available."),t.length>0){const e=t.map((r,a)=>`(${a+1}) ${r}`).join(" "),n=ri.create("invalid-analytics-context",{errorInfo:e});wr.warn(n.message)}}function hO(t,e,n){fO();const r=t.options.appId;if(!r)throw ri.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)wr.warn(`The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest measurement ID for this Firebase app. Falling back to the measurement ID ${t.options.measurementId} provided in the "measurementId" field in the local Firebase config.`);else throw ri.create("no-api-key");if(_c[r]!=null)throw ri.create("already-exists",{id:r});if(!w2){q6(dp);const{wrappedGtag:o,gtagCore:u}=W6(_c,x2,E2,dp,cO);zw=o,T2=u,w2=!0}return _c[r]=lO(t,x2,E2,e,T2,dp,n),new uO(t)}function dO(t,e,n,r){t=ys(t),sO(zw,_c[t.app.options.appId],e,n,r).catch(a=>wr.error(a))}const A2="@firebase/analytics",S2="0.10.17";function mO(){xs(new Ra(y2,(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),a=e.getProvider("installations-internal").getImmediate();return hO(r,a,n)},"PUBLIC")),xs(new Ra("analytics-internal",t,"PRIVATE")),zi(A2,S2),zi(A2,S2,"esm2017");function t(e){try{const n=e.getProvider(y2).getImmediate();return{logEvent:(r,a,o)=>dO(n,r,a,o)}}catch(n){throw ri.create("interop-component-reg-failed",{reason:n})}}}mO();const pO={apiKey:"AIzaSyA0F9MlLg9H36F2FCiclvRDGSrLMV9_f8c",authDomain:"dra-invoice.firebaseapp.com",projectId:"dra-invoice",storageBucket:"dra-invoice.firebasestorage.app",messagingSenderId:"818739283601",appId:"1:818739283601:web:81bf9d917ba9feba76a130",measurementId:"G-Q6S6EQRF86"},gO=kE(pO),_s=ED(gO);function j0(){const t=Os();return P.jsxs("nav",{className:"p-4 bg-yellow-600 text-white flex gap-4",children:[P.jsx(Dl,{to:"/",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/"?"bg-gray-600":""}`,children:"Dashboard"}),P.jsx(Dl,{to:"/create-new-invoice",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/create-new-invoice"?"bg-gray-600":""}`,children:"Create New Invoice"}),P.jsx(Dl,{to:"/brand-invoice",className:`hover:underline px-3 py-2 rounded ${t.pathname==="/brand-invoice"?"bg-gray-600":""}`,children:"Brand Invoice"})]})}const Xl=t=>{const e=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"],n=["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"],r=["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"];if(t===0)return"Zero";const a=u=>{let f="";if(u>=100&&(f+=e[Math.floor(u/100)]+" Hundred ",u%=100),u>=20)f+=r[Math.floor(u/10)]+" ",u%=10;else if(u>=10)return f+=n[u-10]+" ",f;return u>0&&(f+=e[u]+" "),f};let o="";return t>=1e7&&(o+=a(Math.floor(t/1e7))+"Crore ",t%=1e7),t>=1e5&&(o+=a(Math.floor(t/1e5))+"Lakh ",t%=1e5),t>=1e3&&(o+=a(Math.floor(t/1e3))+"Thousand ",t%=1e3),t>0&&(o+=a(t)),o.trim()};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var a0={};a0.version="0.18.5";var Hw=1252,vO=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Gw=function(t){vO.indexOf(t)!=-1&&(Hw=t)};function _O(){Gw(1252)}var Pc=function(t){Gw(t)};function yO(){Pc(1200),_O()}var bh=function(e){return String.fromCharCode(e)},b2=function(e){return String.fromCharCode(e)},s0,fs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function kc(t){for(var e="",n=0,r=0,a=0,o=0,u=0,f=0,h=0,m=0;m<t.length;)n=t.charCodeAt(m++),o=n>>2,r=t.charCodeAt(m++),u=(n&3)<<4|r>>4,a=t.charCodeAt(m++),f=(r&15)<<2|a>>6,h=a&63,isNaN(r)?f=h=64:isNaN(a)&&(h=64),e+=fs.charAt(o)+fs.charAt(u)+fs.charAt(f)+fs.charAt(h);return e}function Da(t){var e="",n=0,r=0,a=0,o=0,u=0,f=0,h=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var m=0;m<t.length;)o=fs.indexOf(t.charAt(m++)),u=fs.indexOf(t.charAt(m++)),n=o<<2|u>>4,e+=String.fromCharCode(n),f=fs.indexOf(t.charAt(m++)),r=(u&15)<<4|f>>2,f!==64&&(e+=String.fromCharCode(r)),h=fs.indexOf(t.charAt(m++)),a=(f&3)<<6|h,h!==64&&(e+=String.fromCharCode(a));return e}var St=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Ma=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(e,n){return n?new Buffer(e,n):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function Eo(t){return St?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function R2(t){return St?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var di=function(e){return St?Ma(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)&255})};function z0(t){if(typeof ArrayBuffer>"u")return di(t);for(var e=new ArrayBuffer(t.length),n=new Uint8Array(e),r=0;r!=t.length;++r)n[r]=t.charCodeAt(r)&255;return e}function Zc(t){if(Array.isArray(t))return t.map(function(r){return String.fromCharCode(r)}).join("");for(var e=[],n=0;n<t.length;++n)e[n]=String.fromCharCode(t[n]);return e.join("")}function xO(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var Gn=St?function(t){return Buffer.concat(t.map(function(e){return Buffer.isBuffer(e)?e:Ma(e)}))}:function(t){if(typeof Uint8Array<"u"){var e=0,n=0;for(e=0;e<t.length;++e)n+=t[e].length;var r=new Uint8Array(n),a=0;for(e=0,n=0;e<t.length;n+=a,++e)if(a=t[e].length,t[e]instanceof Uint8Array)r.set(t[e],n);else{if(typeof t[e]=="string")throw"wtf";r.set(new Uint8Array(t[e]),n)}return r}return[].concat.apply([],t.map(function(o){return Array.isArray(o)?o:[].slice.call(o)}))};function EO(t){for(var e=[],n=0,r=t.length+250,a=Eo(t.length+255),o=0;o<t.length;++o){var u=t.charCodeAt(o);if(u<128)a[n++]=u;else if(u<2048)a[n++]=192|u>>6&31,a[n++]=128|u&63;else if(u>=55296&&u<57344){u=(u&1023)+64;var f=t.charCodeAt(++o)&1023;a[n++]=240|u>>8&7,a[n++]=128|u>>2&63,a[n++]=128|f>>6&15|(u&3)<<4,a[n++]=128|f&63}else a[n++]=224|u>>12&15,a[n++]=128|u>>6&63,a[n++]=128|u&63;n>r&&(e.push(a.slice(0,n)),n=0,a=Eo(65535),r=65530)}return e.push(a.slice(0,n)),Gn(e)}var yc=/\u0000/g,Rh=/[\u0001-\u0006]/g;function Pl(t){for(var e="",n=t.length-1;n>=0;)e+=t.charAt(n--);return e}function pi(t,e){var n=""+t;return n.length>=e?n:tn("0",e-n.length)+n}function r1(t,e){var n=""+t;return n.length>=e?n:tn(" ",e-n.length)+n}function o0(t,e){var n=""+t;return n.length>=e?n:n+tn(" ",e-n.length)}function TO(t,e){var n=""+Math.round(t);return n.length>=e?n:tn("0",e-n.length)+n}function wO(t,e){var n=""+t;return n.length>=e?n:tn("0",e-n.length)+n}var C2=Math.pow(2,32);function Tl(t,e){if(t>C2||t<-C2)return TO(t,e);var n=Math.round(t);return wO(n,e)}function l0(t,e){return e=e||0,t.length>=7+e&&(t.charCodeAt(e)|32)===103&&(t.charCodeAt(e+1)|32)===101&&(t.charCodeAt(e+2)|32)===110&&(t.charCodeAt(e+3)|32)===101&&(t.charCodeAt(e+4)|32)===114&&(t.charCodeAt(e+5)|32)===97&&(t.charCodeAt(e+6)|32)===108}var I2=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],mp=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function AO(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var nn={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},N2={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SO={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function u0(t,e,n){for(var r=t<0?-1:1,a=t*r,o=0,u=1,f=0,h=1,m=0,g=0,y=Math.floor(a);m<e&&(y=Math.floor(a),f=y*u+o,g=y*m+h,!(a-y<5e-8));)a=1/(a-y),o=u,u=f,h=m,m=g;if(g>e&&(m>e?(g=h,f=o):(g=m,f=u)),!n)return[0,r*f,g];var _=Math.floor(r*f/g);return[_,r*f-_*g,g]}function Ch(t,e,n){if(t>2958465||t<0)return null;var r=t|0,a=Math.floor(86400*(t-r)),o=0,u=[],f={D:r,T:a,u:86400*(t-r)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(f.u)<1e-6&&(f.u=0),e&&e.date1904&&(r+=1462),f.u>.9999&&(f.u=0,++a==86400&&(f.T=a=0,++r,++f.D)),r===60)u=n?[1317,10,29]:[1900,2,29],o=3;else if(r===0)u=n?[1317,8,29]:[1900,1,0],o=6;else{r>60&&--r;var h=new Date(1900,0,1);h.setDate(h.getDate()+r-1),u=[h.getFullYear(),h.getMonth()+1,h.getDate()],o=h.getDay(),r<60&&(o=(o+6)%7),n&&(o=OO(h,u))}return f.y=u[0],f.m=u[1],f.d=u[2],f.S=a%60,a=Math.floor(a/60),f.M=a%60,a=Math.floor(a/60),f.H=a,f.q=o,f}var qw=new Date(1899,11,31,0,0,0),bO=qw.getTime(),RO=new Date(1900,2,1,0,0,0);function $w(t,e){var n=t.getTime();return e?n-=1461*24*60*60*1e3:t>=RO&&(n+=24*60*60*1e3),(n-(bO+(t.getTimezoneOffset()-qw.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function i1(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function CO(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function IO(t){var e=t<0?12:11,n=i1(t.toFixed(12));return n.length<=e||(n=t.toPrecision(10),n.length<=e)?n:t.toExponential(5)}function NO(t){var e=i1(t.toFixed(11));return e.length>(t<0?12:11)||e==="0"||e==="-0"?t.toPrecision(6):e}function DO(t){var e=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),n;return e>=-4&&e<=-1?n=t.toPrecision(10+e):Math.abs(e)<=9?n=IO(t):e===10?n=t.toFixed(10).substr(0,12):n=NO(t),i1(CO(n.toUpperCase()))}function Yp(t,e){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):DO(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return Is(14,$w(t,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+t)}function OO(t,e){e[0]-=581;var n=t.getDay();return t<60&&(n=(n+6)%7),n}function FO(t,e,n,r){var a="",o=0,u=0,f=n.y,h,m=0;switch(t){case 98:f=n.y+543;case 121:switch(e.length){case 1:case 2:h=f%100,m=2;break;default:h=f%1e4,m=4;break}break;case 109:switch(e.length){case 1:case 2:h=n.m,m=e.length;break;case 3:return mp[n.m-1][1];case 5:return mp[n.m-1][0];default:return mp[n.m-1][2]}break;case 100:switch(e.length){case 1:case 2:h=n.d,m=e.length;break;case 3:return I2[n.q][0];default:return I2[n.q][1]}break;case 104:switch(e.length){case 1:case 2:h=1+(n.H+11)%12,m=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:h=n.H,m=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:h=n.M,m=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return n.u===0&&(e=="s"||e=="ss")?pi(n.S,e.length):(r>=2?u=r===3?1e3:100:u=r===1?10:1,o=Math.round(u*(n.S+n.u)),o>=60*u&&(o=0),e==="s"?o===0?"0":""+o/u:(a=pi(o,2+r),e==="ss"?a.substr(0,2):"."+a.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":h=n.D*24+n.H;break;case"[m]":case"[mm]":h=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":h=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+e}m=e.length===3?1:2;break;case 101:h=f,m=1;break}var g=m>0?pi(h,m):"";return g}function hs(t){var e=3;if(t.length<=e)return t;for(var n=t.length%e,r=t.substr(0,n);n!=t.length;n+=e)r+=(r.length>0?",":"")+t.substr(n,e);return r}var Xw=/%/g;function MO(t,e,n){var r=e.replace(Xw,""),a=e.length-r.length;return wa(t,r,n*Math.pow(10,2*a))+tn("%",a)}function PO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return wa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function Yw(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Yw(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(e/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),n.indexOf("e")===-1){var u=Math.floor(Math.log(e)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(u-n.length+o):n+="E+"+(u-o);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,a)+"."+n.substr(2+a),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,h,m,g){return h+m+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var Ww=/# (\?+)( ?)\/( ?)(\d+)/;function kO(t,e,n){var r=parseInt(t[4],10),a=Math.round(e*r),o=Math.floor(a/r),u=a-o*r,f=r;return n+(o===0?"":""+o)+" "+(u===0?tn(" ",t[1].length+1+t[4].length):r1(u,t[1].length)+t[2]+"/"+t[3]+pi(f,t[4].length))}function LO(t,e,n){return n+(e===0?"":""+e)+tn(" ",t[1].length+2+t[4].length)}var Kw=/^#*0*\.([0#]+)/,Qw=/\).*[0#]/,Zw=/\(###\) ###\\?-####/;function fr(t){for(var e="",n,r=0;r!=t.length;++r)switch(n=t.charCodeAt(r)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(n)}return e}function D2(t,e){var n=Math.pow(10,e);return""+Math.round(t*n)/n}function O2(t,e){var n=t-Math.floor(t),r=Math.pow(10,e);return e<(""+Math.round(n*r)).length?0:Math.round(n*r)}function VO(t,e){return e<(""+Math.round((t-Math.floor(t))*Math.pow(10,e))).length?1:0}function BO(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Jr(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Qw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Jr("n",r,n):"("+Jr("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return PO(t,e,n);if(e.indexOf("%")!==-1)return MO(t,e,n);if(e.indexOf("E")!==-1)return Yw(e,n);if(e.charCodeAt(0)===36)return"$"+Jr(t,e.substr(e.charAt(1)==" "?2:1),n);var a,o,u,f,h=Math.abs(n),m=n<0?"-":"";if(e.match(/^00+$/))return m+Tl(h,e.length);if(e.match(/^[#?]+$/))return a=Tl(n,0),a==="0"&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(Ww))return kO(o,h,m);if(e.match(/^#+0+$/))return m+Tl(h,e.length-e.indexOf("0"));if(o=e.match(Kw))return a=D2(n,o[1].length).replace(/^([^\.]+)$/,"$1."+fr(o[1])).replace(/\.$/,"."+fr(o[1])).replace(/\.(\d*)$/,function(w,T){return"."+T+tn("0",fr(o[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+D2(h,o[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+hs(Tl(h,0));if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Jr(t,e,-n):hs(""+(Math.floor(n)+VO(n,o[1].length)))+"."+pi(O2(n,o[1].length),o[1].length);if(o=e.match(/^#,#*,#0/))return Jr(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pl(Jr(t,e.replace(/[\\-]/g,""),n)),u=0,Pl(Pl(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<a.length?a.charAt(u++):w==="0"?"0":""}));if(e.match(Zw))return a=Jr(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),f=u0(h,Math.pow(10,u)-1,!1),a=""+m,g=wa("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=o0(f[2],u),g.length<o[4].length&&(g=fr(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),f=u0(h,Math.pow(10,u)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?r1(f[1],u)+o[2]+"/"+o[3]+o0(f[2],u):tn(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=Tl(n,0),e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0?]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=a.indexOf(".");var y=e.indexOf(".")-u,_=e.length-a.length-y;return fr(e.substr(0,y)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return u=O2(n,o[1].length),n<0?"-"+Jr(t,e,-n):hs(BO(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pi(0,3-w.length):"")+w})+"."+pi(u,o[1].length);switch(e){case"###,##0.00":return Jr(t,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var E=hs(Tl(h,0));return E!=="0"?m+E:"";case"###,###.00":return Jr(t,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return Jr(t,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function UO(t,e,n){for(var r=e.length-1;e.charCodeAt(r-1)===44;)--r;return wa(t,e.substr(0,r),n/Math.pow(10,3*(e.length-r)))}function jO(t,e,n){var r=e.replace(Xw,""),a=e.length-r.length;return wa(t,r,n*Math.pow(10,2*a))+tn("%",a)}function Jw(t,e){var n,r=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+Jw(t,-e);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var o=Math.floor(Math.log(e)*Math.LOG10E)%a;if(o<0&&(o+=a),n=(e/Math.pow(10,o)).toPrecision(r+1+(a+o)%a),!n.match(/[Ee]/)){var u=Math.floor(Math.log(e)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(u-n.length+o):n+="E+"+(u-o),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(f,h,m,g){return h+m+g.substr(0,(a+o)%a)+"."+g.substr(o)+"E"})}else n=e.toExponential(r);return t.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),t.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Bi(t,e,n){if(t.charCodeAt(0)===40&&!e.match(Qw)){var r=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Bi("n",r,n):"("+Bi("n",r,-n)+")"}if(e.charCodeAt(e.length-1)===44)return UO(t,e,n);if(e.indexOf("%")!==-1)return jO(t,e,n);if(e.indexOf("E")!==-1)return Jw(e,n);if(e.charCodeAt(0)===36)return"$"+Bi(t,e.substr(e.charAt(1)==" "?2:1),n);var a,o,u,f,h=Math.abs(n),m=n<0?"-":"";if(e.match(/^00+$/))return m+pi(h,e.length);if(e.match(/^[#?]+$/))return a=""+n,n===0&&(a=""),a.length>e.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(Ww))return LO(o,h,m);if(e.match(/^#+0+$/))return m+pi(h,e.length-e.indexOf("0"));if(o=e.match(Kw))return a=(""+n).replace(/^([^\.]+)$/,"$1."+fr(o[1])).replace(/\.$/,"."+fr(o[1])),a=a.replace(/\.(\d*)$/,function(w,T){return"."+T+tn("0",fr(o[1]).length-T.length)}),e.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),o=e.match(/^(0*)\.(#*)$/))return m+(""+h).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,o[1].length?"0.":".");if(o=e.match(/^#{1,3},##0(\.?)$/))return m+hs(""+h);if(o=e.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Bi(t,e,-n):hs(""+n)+"."+tn("0",o[1].length);if(o=e.match(/^#,#*,#0/))return Bi(t,e.replace(/^#,#*,/,""),n);if(o=e.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Pl(Bi(t,e.replace(/[\\-]/g,""),n)),u=0,Pl(Pl(e.replace(/\\/g,"")).replace(/[0#]/g,function(w){return u<a.length?a.charAt(u++):w==="0"?"0":""}));if(e.match(Zw))return a=Bi(t,"##########",n),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var g="";if(o=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(o[4].length,7),f=u0(h,Math.pow(10,u)-1,!1),a=""+m,g=wa("n",o[1],f[1]),g.charAt(g.length-1)==" "&&(g=g.substr(0,g.length-1)+"0"),a+=g+o[2]+"/"+o[3],g=o0(f[2],u),g.length<o[4].length&&(g=fr(o[4].substr(o[4].length-g.length))+g),a+=g,a;if(o=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return u=Math.min(Math.max(o[1].length,o[4].length),7),f=u0(h,Math.pow(10,u)-1,!0),m+(f[0]||(f[1]?"":"0"))+" "+(f[1]?r1(f[1],u)+o[2]+"/"+o[3]+o0(f[2],u):tn(" ",2*u+1+o[2].length+o[3].length));if(o=e.match(/^[#0?]+$/))return a=""+n,e.length<=a.length?a:fr(e.substr(0,e.length-a.length))+a;if(o=e.match(/^([#0]+)\.([#0]+)$/)){a=""+n.toFixed(Math.min(o[2].length,10)).replace(/([^0])0+$/,"$1"),u=a.indexOf(".");var y=e.indexOf(".")-u,_=e.length-a.length-y;return fr(e.substr(0,y)+a+e.substr(e.length-_))}if(o=e.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Bi(t,e,-n):hs(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(w){return"00,"+(w.length<3?pi(0,3-w.length):"")+w})+"."+pi(0,o[1].length);switch(e){case"###,###":case"##,###":case"#,###":var E=hs(""+h);return E!=="0"?m+E:"";default:if(e.match(/\.[0#?]*$/))return Bi(t,e.slice(0,e.lastIndexOf(".")),n)+fr(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function wa(t,e,n){return(n|0)===n?Bi(t,e,n):Jr(t,e,n)}function zO(t){for(var e=[],n=!1,r=0,a=0;r<t.length;++r)switch(t.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:e[e.length]=t.substr(a,r-a),a=r+1}if(e[e.length]=t.substr(a),n===!0)throw new Error("Format |"+t+"| unterminated string ");return e}var eA=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function tA(t){for(var e=0,n="",r="";e<t.length;)switch(n=t.charAt(e)){case"G":l0(t,e)&&(e+=6),e++;break;case'"':for(;t.charCodeAt(++e)!==34&&e<t.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(t.charAt(e+1)==="1"||t.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(e,3).toUpperCase()==="A/P"||t.substr(e,5).toUpperCase()==="AM/PM"||t.substr(e,5).toUpperCase()==="/")return!0;++e;break;case"[":for(r=n;t.charAt(e++)!=="]"&&e<t.length;)r+=t.charAt(e);if(r.match(eA))return!0;break;case".":case"0":case"#":for(;e<t.length&&("0#?.,E+-%".indexOf(n=t.charAt(++e))>-1||n=="\\"&&t.charAt(e+1)=="-"&&"0#".indexOf(t.charAt(e+2))>-1););break;case"?":for(;t.charAt(++e)===n;);break;case"*":++e,(t.charAt(e)==" "||t.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<t.length&&"0123456789".indexOf(t.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function HO(t,e,n,r){for(var a=[],o="",u=0,f="",h="t",m,g,y,_="H";u<t.length;)switch(f=t.charAt(u)){case"G":if(!l0(t,u))throw new Error("unrecognized character "+f+" in "+t);a[a.length]={t:"G",v:"General"},u+=7;break;case'"':for(o="";(y=t.charCodeAt(++u))!==34&&u<t.length;)o+=String.fromCharCode(y);a[a.length]={t:"t",v:o},++u;break;case"\\":var E=t.charAt(++u),w=E==="("||E===")"?E:"t";a[a.length]={t:w,v:E},++u;break;case"_":a[a.length]={t:"t",v:" "},u+=2;break;case"@":a[a.length]={t:"T",v:e},++u;break;case"B":case"b":if(t.charAt(u+1)==="1"||t.charAt(u+1)==="2"){if(m==null&&(m=Ch(e,n,t.charAt(u+1)==="2"),m==null))return"";a[a.length]={t:"X",v:t.substr(u,2)},h=f,u+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":f=f.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||m==null&&(m=Ch(e,n),m==null))return"";for(o=f;++u<t.length&&t.charAt(u).toLowerCase()===f;)o+=f;f==="m"&&h.toLowerCase()==="h"&&(f="M"),f==="h"&&(f=_),a[a.length]={t:f,v:o},h=f;break;case"A":case"a":case"":var T={t:f,v:f};if(m==null&&(m=Ch(e,n)),t.substr(u,3).toUpperCase()==="A/P"?(m!=null&&(T.v=m.H>=12?"P":"A"),T.t="T",_="h",u+=3):t.substr(u,5).toUpperCase()==="AM/PM"?(m!=null&&(T.v=m.H>=12?"PM":"AM"),T.t="T",u+=5,_="h"):t.substr(u,5).toUpperCase()==="/"?(m!=null&&(T.v=m.H>=12?"":""),T.t="T",u+=5,_="h"):(T.t="t",++u),m==null&&T.t==="T")return"";a[a.length]=T,h=f;break;case"[":for(o=f;t.charAt(u++)!=="]"&&u<t.length;)o+=t.charAt(u);if(o.slice(-1)!=="]")throw'unterminated "[" block: |'+o+"|";if(o.match(eA)){if(m==null&&(m=Ch(e,n),m==null))return"";a[a.length]={t:"Z",v:o.toLowerCase()},h=o.charAt(1)}else o.indexOf("$")>-1&&(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",tA(t)||(a[a.length]={t:"t",v:o}));break;case".":if(m!=null){for(o=f;++u<t.length&&(f=t.charAt(u))==="0";)o+=f;a[a.length]={t:"s",v:o};break}case"0":case"#":for(o=f;++u<t.length&&"0#?.,E+-%".indexOf(f=t.charAt(u))>-1;)o+=f;a[a.length]={t:"n",v:o};break;case"?":for(o=f;t.charAt(++u)===f;)o+=f;a[a.length]={t:f,v:o},h=f;break;case"*":++u,(t.charAt(u)==" "||t.charAt(u)=="*")&&++u;break;case"(":case")":a[a.length]={t:r===1?"t":f,v:f},++u;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=f;u<t.length&&"0123456789".indexOf(t.charAt(++u))>-1;)o+=t.charAt(u);a[a.length]={t:"D",v:o};break;case" ":a[a.length]={t:f,v:f},++u;break;case"$":a[a.length]={t:"t",v:"$"},++u;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(f)===-1)throw new Error("unrecognized character "+f+" in "+t);a[a.length]={t:"t",v:f},++u;break}var b=0,k=0,q;for(u=a.length-1,h="t";u>=0;--u)switch(a[u].t){case"h":case"H":a[u].t=_,h="h",b<1&&(b=1);break;case"s":(q=a[u].v.match(/\.0+$/))&&(k=Math.max(k,q[0].length-1)),b<3&&(b=3);case"d":case"y":case"M":case"e":h=a[u].t;break;case"m":h==="s"&&(a[u].t="M",b<2&&(b=2));break;case"X":break;case"Z":b<1&&a[u].v.match(/[Hh]/)&&(b=1),b<2&&a[u].v.match(/[Mm]/)&&(b=2),b<3&&a[u].v.match(/[Ss]/)&&(b=3)}switch(b){case 0:break;case 1:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M),m.M>=60&&(m.M=0,++m.H);break;case 2:m.u>=.5&&(m.u=0,++m.S),m.S>=60&&(m.S=0,++m.M);break}var X="",ee;for(u=0;u<a.length;++u)switch(a[u].t){case"t":case"T":case" ":case"D":break;case"X":a[u].v="",a[u].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[u].v=FO(a[u].t.charCodeAt(0),a[u].v,m,k),a[u].t="t";break;case"n":case"?":for(ee=u+1;a[ee]!=null&&((f=a[ee].t)==="?"||f==="D"||(f===" "||f==="t")&&a[ee+1]!=null&&(a[ee+1].t==="?"||a[ee+1].t==="t"&&a[ee+1].v==="/")||a[u].t==="("&&(f===" "||f==="n"||f===")")||f==="t"&&(a[ee].v==="/"||a[ee].v===" "&&a[ee+1]!=null&&a[ee+1].t=="?"));)a[u].v+=a[ee].v,a[ee]={v:"",t:";"},++ee;X+=a[u].v,u=ee-1;break;case"G":a[u].t="t",a[u].v=Yp(e,n);break}var he="",Ae,N;if(X.length>0){X.charCodeAt(0)==40?(Ae=e<0&&X.charCodeAt(0)===45?-e:e,N=wa("n",X,Ae)):(Ae=e<0&&r>1?-e:e,N=wa("n",X,Ae),Ae<0&&a[0]&&a[0].t=="t"&&(N=N.substr(1),a[0].v="-"+a[0].v)),ee=N.length-1;var I=a.length;for(u=0;u<a.length;++u)if(a[u]!=null&&a[u].t!="t"&&a[u].v.indexOf(".")>-1){I=u;break}var R=a.length;if(I===a.length&&N.indexOf("E")===-1){for(u=a.length-1;u>=0;--u)a[u]==null||"n?".indexOf(a[u].t)===-1||(ee>=a[u].v.length-1?(ee-=a[u].v.length,a[u].v=N.substr(ee+1,a[u].v.length)):ee<0?a[u].v="":(a[u].v=N.substr(0,ee+1),ee=-1),a[u].t="t",R=u);ee>=0&&R<a.length&&(a[R].v=N.substr(0,ee+1)+a[R].v)}else if(I!==a.length&&N.indexOf("E")===-1){for(ee=N.indexOf(".")-1,u=I;u>=0;--u)if(!(a[u]==null||"n?".indexOf(a[u].t)===-1)){for(g=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")-1:a[u].v.length-1,he=a[u].v.substr(g+1);g>=0;--g)ee>=0&&(a[u].v.charAt(g)==="0"||a[u].v.charAt(g)==="#")&&(he=N.charAt(ee--)+he);a[u].v=he,a[u].t="t",R=u}for(ee>=0&&R<a.length&&(a[R].v=N.substr(0,ee+1)+a[R].v),ee=N.indexOf(".")+1,u=I;u<a.length;++u)if(!(a[u]==null||"n?(".indexOf(a[u].t)===-1&&u!==I)){for(g=a[u].v.indexOf(".")>-1&&u===I?a[u].v.indexOf(".")+1:0,he=a[u].v.substr(0,g);g<a[u].v.length;++g)ee<N.length&&(he+=N.charAt(ee++));a[u].v=he,a[u].t="t",R=u}}}for(u=0;u<a.length;++u)a[u]!=null&&"n?".indexOf(a[u].t)>-1&&(Ae=r>1&&e<0&&u>0&&a[u-1].v==="-"?-e:e,a[u].v=wa(a[u].t,a[u].v,Ae),a[u].t="t");var M="";for(u=0;u!==a.length;++u)a[u]!=null&&(M+=a[u].v);return M}var F2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function M2(t,e){if(e==null)return!1;var n=parseFloat(e[2]);switch(e[1]){case"=":if(t==n)return!0;break;case">":if(t>n)return!0;break;case"<":if(t<n)return!0;break;case"<>":if(t!=n)return!0;break;case">=":if(t>=n)return!0;break;case"<=":if(t<=n)return!0;break}return!1}function GO(t,e){var n=zO(t),r=n.length,a=n[r-1].indexOf("@");if(r<4&&a>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof e!="number")return[4,n.length===4||a>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=a>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=a>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=a>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var o=e>0?n[0]:e<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,o];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var u=n[0].match(F2),f=n[1].match(F2);return M2(e,u)?[r,n[0]]:M2(e,f)?[r,n[1]]:[r,n[u!=null&&f!=null?2:1]]}return[r,o]}function Is(t,e,n){n==null&&(n={});var r="";switch(typeof t){case"string":t=="m/d/yy"&&n.dateNF?r=n.dateNF:r=t;break;case"number":t==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:nn)[t],r==null&&(r=n.table&&n.table[N2[t]]||nn[N2[t]]),r==null&&(r=SO[t]||"General");break}if(l0(r,0))return Yp(e,n);e instanceof Date&&(e=$w(e,n.date1904));var a=GO(r,e);if(l0(a[1]))return Yp(e,n);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return HO(a[1],e,n,a[0])}function nA(t,e){if(typeof e!="number"){e=+e||-1;for(var n=0;n<392;++n){if(nn[n]==null){e<0&&(e=n);continue}if(nn[n]==t){e=n;break}}e<0&&(e=391)}return nn[e]=t,e}function H0(t){for(var e=0;e!=392;++e)t[e]!==void 0&&nA(t[e],e)}function G0(){nn=AO()}var rA=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function qO(t){var e=typeof t=="number"?nn[t]:t;return e=e.replace(rA,"(\\d+)"),new RegExp("^"+e+"$")}function $O(t,e,n){var r=-1,a=-1,o=-1,u=-1,f=-1,h=-1;(e.match(rA)||[]).forEach(function(y,_){var E=parseInt(n[_+1],10);switch(y.toLowerCase().charAt(0)){case"y":r=E;break;case"d":o=E;break;case"h":u=E;break;case"s":h=E;break;case"m":u>=0?f=E:a=E;break}}),h>=0&&f==-1&&a>=0&&(f=a,a=-1);var m=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(o>=1?o:1)).slice(-2);m.length==7&&(m="0"+m),m.length==8&&(m="20"+m);var g=("00"+(u>=0?u:0)).slice(-2)+":"+("00"+(f>=0?f:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2);return u==-1&&f==-1&&h==-1?m:r==-1&&a==-1&&o==-1?g:m+"T"+g}var XO=function(){var t={};t.version="1.2.0";function e(){for(var N=0,I=new Array(256),R=0;R!=256;++R)N=R,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[R]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var n=e();function r(N){var I=0,R=0,M=0,B=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)B[M]=N[M];for(M=0;M!=256;++M)for(R=N[M],I=256+M;I<4096;I+=256)R=B[I]=R>>>8^N[R&255];var H=[];for(M=1;M!=16;++M)H[M-1]=typeof Int32Array<"u"?B.subarray(M*256,M*256+256):B.slice(M*256,M*256+256);return H}var a=r(n),o=a[0],u=a[1],f=a[2],h=a[3],m=a[4],g=a[5],y=a[6],_=a[7],E=a[8],w=a[9],T=a[10],b=a[11],k=a[12],q=a[13],X=a[14];function ee(N,I){for(var R=I^-1,M=0,B=N.length;M<B;)R=R>>>8^n[(R^N.charCodeAt(M++))&255];return~R}function he(N,I){for(var R=I^-1,M=N.length-15,B=0;B<M;)R=X[N[B++]^R&255]^q[N[B++]^R>>8&255]^k[N[B++]^R>>16&255]^b[N[B++]^R>>>24]^T[N[B++]]^w[N[B++]]^E[N[B++]]^_[N[B++]]^y[N[B++]]^g[N[B++]]^m[N[B++]]^h[N[B++]]^f[N[B++]]^u[N[B++]]^o[N[B++]]^n[N[B++]];for(M+=15;B<M;)R=R>>>8^n[(R^N[B++])&255];return~R}function Ae(N,I){for(var R=I^-1,M=0,B=N.length,H=0,V=0;M<B;)H=N.charCodeAt(M++),H<128?R=R>>>8^n[(R^H)&255]:H<2048?(R=R>>>8^n[(R^(192|H>>6&31))&255],R=R>>>8^n[(R^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,V=N.charCodeAt(M++)&1023,R=R>>>8^n[(R^(240|H>>8&7))&255],R=R>>>8^n[(R^(128|H>>2&63))&255],R=R>>>8^n[(R^(128|V>>6&15|(H&3)<<4))&255],R=R>>>8^n[(R^(128|V&63))&255]):(R=R>>>8^n[(R^(224|H>>12&15))&255],R=R>>>8^n[(R^(128|H>>6&63))&255],R=R>>>8^n[(R^(128|H&63))&255]);return~R}return t.table=n,t.bstr=ee,t.buf=he,t.str=Ae,t}(),Vt=function(){var e={};e.version="1.2.1";function n(C,z){for(var F=C.split("/"),L=z.split("/"),j=0,G=0,ae=Math.min(F.length,L.length);j<ae;++j){if(G=F[j].length-L[j].length)return G;if(F[j]!=L[j])return F[j]<L[j]?-1:1}return F.length-L.length}function r(C){if(C.charAt(C.length-1)=="/")return C.slice(0,-1).indexOf("/")===-1?C:r(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(0,z+1)}function a(C){if(C.charAt(C.length-1)=="/")return a(C.slice(0,-1));var z=C.lastIndexOf("/");return z===-1?C:C.slice(z+1)}function o(C,z){typeof z=="string"&&(z=new Date(z));var F=z.getHours();F=F<<6|z.getMinutes(),F=F<<5|z.getSeconds()>>>1,C.write_shift(2,F);var L=z.getFullYear()-1980;L=L<<4|z.getMonth()+1,L=L<<5|z.getDate(),C.write_shift(2,L)}function u(C){var z=C.read_shift(2)&65535,F=C.read_shift(2)&65535,L=new Date,j=F&31;F>>>=5;var G=F&15;F>>>=4,L.setMilliseconds(0),L.setFullYear(F+1980),L.setMonth(G-1),L.setDate(j);var ae=z&31;z>>>=5;var me=z&63;return z>>>=6,L.setHours(z),L.setMinutes(me),L.setSeconds(ae<<1),L}function f(C){Lr(C,0);for(var z={},F=0;C.l<=C.length-4;){var L=C.read_shift(2),j=C.read_shift(2),G=C.l+j,ae={};switch(L){case 21589:F=C.read_shift(1),F&1&&(ae.mtime=C.read_shift(4)),j>5&&(F&2&&(ae.atime=C.read_shift(4)),F&4&&(ae.ctime=C.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}C.l=G,z[L]=ae}return z}var h;function m(){return h||(h={})}function g(C,z){if(C[0]==80&&C[1]==75)return Va(C,z);if((C[0]|32)==109&&(C[1]|32)==105)return ko(C,z);if(C.length<512)throw new Error("CFB file size "+C.length+" < 512");var F=3,L=512,j=0,G=0,ae=0,me=0,ne=0,oe=[],le=C.slice(0,512);Lr(le,0);var be=y(le);switch(F=be[0],F){case 3:L=512;break;case 4:L=4096;break;case 0:if(be[1]==0)return Va(C,z);default:throw new Error("Major Version: Expected 3 or 4 saw "+F)}L!==512&&(le=C.slice(0,L),Lr(le,28));var Ie=C.slice(0,L);_(le,F);var Ue=le.read_shift(4,"i");if(F===3&&Ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Ue);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),me=le.read_shift(4,"i"),j=le.read_shift(4,"i"),ne=le.read_shift(4,"i"),G=le.read_shift(4,"i");for(var Ce=-1,Pe=0;Pe<109&&(Ce=le.read_shift(4,"i"),!(Ce<0));++Pe)oe[Pe]=Ce;var Qe=E(C,L);b(ne,G,Qe,L,oe);var Et=q(Qe,ae,oe,L);Et[ae].name="!Directory",j>0&&me!==V&&(Et[me].name="!MiniFAT"),Et[oe[0]].name="!FAT",Et.fat_addrs=oe,Et.ssz=L;var dt={},mt=[],Rr=[],Si=[];X(ae,Et,Qe,mt,j,dt,Rr,me),w(Rr,Si,mt),mt.shift();var sr={FileIndex:Rr,FullPaths:Si};return z&&z.raw&&(sr.raw={header:Ie,sectors:Qe}),sr}function y(C){if(C[C.l]==80&&C[C.l+1]==75)return[0,0];C.chk(Je,"Header Signature: "),C.l+=16;var z=C.read_shift(2,"u");return[C.read_shift(2,"u"),z]}function _(C,z){var F=9;switch(C.l+=2,F=C.read_shift(2)){case 9:if(z!=3)throw new Error("Sector Shift: Expected 9 saw "+F);break;case 12:if(z!=4)throw new Error("Sector Shift: Expected 12 saw "+F);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+F)}C.chk("0600","Mini Sector Shift: "),C.chk("000000000000","Reserved: ")}function E(C,z){for(var F=Math.ceil(C.length/z)-1,L=[],j=1;j<F;++j)L[j-1]=C.slice(j*z,(j+1)*z);return L[F-1]=C.slice(F*z),L}function w(C,z,F){for(var L=0,j=0,G=0,ae=0,me=0,ne=F.length,oe=[],le=[];L<ne;++L)oe[L]=le[L]=L,z[L]=F[L];for(;me<le.length;++me)L=le[me],j=C[L].L,G=C[L].R,ae=C[L].C,oe[L]===L&&(j!==-1&&oe[j]!==j&&(oe[L]=oe[j]),G!==-1&&oe[G]!==G&&(oe[L]=oe[G])),ae!==-1&&(oe[ae]=L),j!==-1&&L!=oe[L]&&(oe[j]=oe[L],le.lastIndexOf(j)<me&&le.push(j)),G!==-1&&L!=oe[L]&&(oe[G]=oe[L],le.lastIndexOf(G)<me&&le.push(G));for(L=1;L<ne;++L)oe[L]===L&&(G!==-1&&oe[G]!==G?oe[L]=oe[G]:j!==-1&&oe[j]!==j&&(oe[L]=oe[j]));for(L=1;L<ne;++L)if(C[L].type!==0){if(me=L,me!=oe[me])do me=oe[me],z[L]=z[me]+"/"+z[L];while(me!==0&&oe[me]!==-1&&me!=oe[me]);oe[L]=-1}for(z[0]+="/",L=1;L<ne;++L)C[L].type!==2&&(z[L]+="/")}function T(C,z,F){for(var L=C.start,j=C.size,G=[],ae=L;F&&j>0&&ae>=0;)G.push(z.slice(ae*H,ae*H+H)),j-=H,ae=fo(F,ae*4);return G.length===0?ge(0):Gn(G).slice(0,C.size)}function b(C,z,F,L,j){var G=V;if(C===V){if(z!==0)throw new Error("DIFAT chain shorter than expected")}else if(C!==-1){var ae=F[C],me=(L>>>2)-1;if(!ae)return;for(var ne=0;ne<me&&(G=fo(ae,ne*4))!==V;++ne)j.push(G);b(fo(ae,L-4),z-1,F,L,j)}}function k(C,z,F,L,j){var G=[],ae=[];j||(j=[]);var me=L-1,ne=0,oe=0;for(ne=z;ne>=0;){j[ne]=!0,G[G.length]=ne,ae.push(C[ne]);var le=F[Math.floor(ne*4/L)];if(oe=ne*4&me,L<4+oe)throw new Error("FAT boundary crossed: "+ne+" 4 "+L);if(!C[le])break;ne=fo(C[le],oe)}return{nodes:G,data:z2([ae])}}function q(C,z,F,L){var j=C.length,G=[],ae=[],me=[],ne=[],oe=L-1,le=0,be=0,Ie=0,Ue=0;for(le=0;le<j;++le)if(me=[],Ie=le+z,Ie>=j&&(Ie-=j),!ae[Ie]){ne=[];var Ce=[];for(be=Ie;be>=0;){Ce[be]=!0,ae[be]=!0,me[me.length]=be,ne.push(C[be]);var Pe=F[Math.floor(be*4/L)];if(Ue=be*4&oe,L<4+Ue)throw new Error("FAT boundary crossed: "+be+" 4 "+L);if(!C[Pe]||(be=fo(C[Pe],Ue),Ce[be]))break}G[Ie]={nodes:me,data:z2([ne])}}return G}function X(C,z,F,L,j,G,ae,me){for(var ne=0,oe=L.length?2:0,le=z[C].data,be=0,Ie=0,Ue;be<le.length;be+=128){var Ce=le.slice(be,be+128);Lr(Ce,64),Ie=Ce.read_shift(2),Ue=u1(Ce,0,Ie-oe),L.push(Ue);var Pe={name:Ue,type:Ce.read_shift(1),color:Ce.read_shift(1),L:Ce.read_shift(4,"i"),R:Ce.read_shift(4,"i"),C:Ce.read_shift(4,"i"),clsid:Ce.read_shift(16),state:Ce.read_shift(4,"i"),start:0,size:0},Qe=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Qe!==0&&(Pe.ct=ee(Ce,Ce.l-8));var Et=Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2)+Ce.read_shift(2);Et!==0&&(Pe.mt=ee(Ce,Ce.l-8)),Pe.start=Ce.read_shift(4,"i"),Pe.size=Ce.read_shift(4,"i"),Pe.size<0&&Pe.start<0&&(Pe.size=Pe.type=0,Pe.start=V,Pe.name=""),Pe.type===5?(ne=Pe.start,j>0&&ne!==V&&(z[ne].name="!StreamData")):Pe.size>=4096?(Pe.storage="fat",z[Pe.start]===void 0&&(z[Pe.start]=k(F,Pe.start,z.fat_addrs,z.ssz)),z[Pe.start].name=Pe.name,Pe.content=z[Pe.start].data.slice(0,Pe.size)):(Pe.storage="minifat",Pe.size<0?Pe.size=0:ne!==V&&Pe.start!==V&&z[ne]&&(Pe.content=T(Pe,z[ne].data,(z[me]||{}).data))),Pe.content&&Lr(Pe.content,0),G[Ue]=Pe,ae.push(Pe)}}function ee(C,z){return new Date((Br(C,z+4)/1e7*Math.pow(2,32)+Br(C,z)/1e7-11644473600)*1e3)}function he(C,z){return m(),g(h.readFileSync(C),z)}function Ae(C,z){var F=z&&z.type;switch(F||St&&Buffer.isBuffer(C)&&(F="buffer"),F||"base64"){case"file":return he(C,z);case"base64":return g(di(Da(C)),z);case"binary":return g(di(C),z)}return g(C,z)}function N(C,z){var F=z||{},L=F.root||"Root Entry";if(C.FullPaths||(C.FullPaths=[]),C.FileIndex||(C.FileIndex=[]),C.FullPaths.length!==C.FileIndex.length)throw new Error("inconsistent CFB structure");C.FullPaths.length===0&&(C.FullPaths[0]=L+"/",C.FileIndex[0]={name:L,type:5}),F.CLSID&&(C.FileIndex[0].clsid=F.CLSID),I(C)}function I(C){var z="Sh33tJ5";if(!Vt.find(C,"/"+z)){var F=ge(4);F[0]=55,F[1]=F[3]=50,F[2]=54,C.FileIndex.push({name:z,type:2,content:F,size:4,L:69,R:69,C:69}),C.FullPaths.push(C.FullPaths[0]+z),R(C)}}function R(C,z){N(C);for(var F=!1,L=!1,j=C.FullPaths.length-1;j>=0;--j){var G=C.FileIndex[j];switch(G.type){case 0:L?F=!0:(C.FileIndex.pop(),C.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(G.R*G.L*G.C)&&(F=!0),G.R>-1&&G.L>-1&&G.R==G.L&&(F=!0);break;default:F=!0;break}}if(!(!F&&!z)){var ae=new Date(1987,1,19),me=0,ne=Object.create?Object.create(null):{},oe=[];for(j=0;j<C.FullPaths.length;++j)ne[C.FullPaths[j]]=!0,C.FileIndex[j].type!==0&&oe.push([C.FullPaths[j],C.FileIndex[j]]);for(j=0;j<oe.length;++j){var le=r(oe[j][0]);L=ne[le],L||(oe.push([le,{name:a(le).replace("/",""),type:1,clsid:de,ct:ae,mt:ae,content:null}]),ne[le]=!0)}for(oe.sort(function(Ue,Ce){return n(Ue[0],Ce[0])}),C.FullPaths=[],C.FileIndex=[],j=0;j<oe.length;++j)C.FullPaths[j]=oe[j][0],C.FileIndex[j]=oe[j][1];for(j=0;j<oe.length;++j){var be=C.FileIndex[j],Ie=C.FullPaths[j];if(be.name=a(Ie).replace("/",""),be.L=be.R=be.C=-(be.color=1),be.size=be.content?be.content.length:0,be.start=0,be.clsid=be.clsid||de,j===0)be.C=oe.length>1?1:-1,be.size=0,be.type=5;else if(Ie.slice(-1)=="/"){for(me=j+1;me<oe.length&&r(C.FullPaths[me])!=Ie;++me);for(be.C=me>=oe.length?-1:me,me=j+1;me<oe.length&&r(C.FullPaths[me])!=r(Ie);++me);be.R=me>=oe.length?-1:me,be.type=1}else r(C.FullPaths[j+1]||"")==r(Ie)&&(be.R=j+1),be.type=2}}}function M(C,z){var F=z||{};if(F.fileType=="mad")return Ht(C,F);switch(R(C),F.fileType){case"zip":return si(C,F)}var L=function(Ue){for(var Ce=0,Pe=0,Qe=0;Qe<Ue.FileIndex.length;++Qe){var Et=Ue.FileIndex[Qe];if(Et.content){var dt=Et.content.length;dt>0&&(dt<4096?Ce+=dt+63>>6:Pe+=dt+511>>9)}}for(var mt=Ue.FullPaths.length+3>>2,Rr=Ce+7>>3,Si=Ce+127>>7,sr=Rr+Pe+mt+Si,_r=sr+127>>7,bi=_r<=109?0:Math.ceil((_r-109)/127);sr+_r+bi+127>>7>_r;)bi=++_r<=109?0:Math.ceil((_r-109)/127);var or=[1,bi,_r,Si,mt,Pe,Ce,0];return Ue.FileIndex[0].size=Ce<<6,or[7]=(Ue.FileIndex[0].start=or[0]+or[1]+or[2]+or[3]+or[4]+or[5])+(or[6]+7>>3),or}(C),j=ge(L[7]<<9),G=0,ae=0;{for(G=0;G<8;++G)j.write_shift(1,He[G]);for(G=0;G<8;++G)j.write_shift(2,0);for(j.write_shift(2,62),j.write_shift(2,3),j.write_shift(2,65534),j.write_shift(2,9),j.write_shift(2,6),G=0;G<3;++G)j.write_shift(2,0);for(j.write_shift(4,0),j.write_shift(4,L[2]),j.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),j.write_shift(4,0),j.write_shift(4,4096),j.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:V),j.write_shift(4,L[3]),j.write_shift(-4,L[1]?L[0]-1:V),j.write_shift(4,L[1]),G=0;G<109;++G)j.write_shift(-4,G<L[2]?L[1]+G:-1)}if(L[1])for(ae=0;ae<L[1];++ae){for(;G<236+ae*127;++G)j.write_shift(-4,G<L[2]?L[1]+G:-1);j.write_shift(-4,ae===L[1]-1?V:ae+1)}var me=function(Ue){for(ae+=Ue;G<ae-1;++G)j.write_shift(-4,G+1);Ue&&(++G,j.write_shift(-4,V))};for(ae=G=0,ae+=L[1];G<ae;++G)j.write_shift(-4,Re.DIFSECT);for(ae+=L[2];G<ae;++G)j.write_shift(-4,Re.FATSECT);me(L[3]),me(L[4]);for(var ne=0,oe=0,le=C.FileIndex[0];ne<C.FileIndex.length;++ne)le=C.FileIndex[ne],le.content&&(oe=le.content.length,!(oe<4096)&&(le.start=ae,me(oe+511>>9)));for(me(L[6]+7>>3);j.l&511;)j.write_shift(-4,Re.ENDOFCHAIN);for(ae=G=0,ne=0;ne<C.FileIndex.length;++ne)le=C.FileIndex[ne],le.content&&(oe=le.content.length,!(!oe||oe>=4096)&&(le.start=ae,me(oe+63>>6)));for(;j.l&511;)j.write_shift(-4,Re.ENDOFCHAIN);for(G=0;G<L[4]<<2;++G){var be=C.FullPaths[G];if(!be||be.length===0){for(ne=0;ne<17;++ne)j.write_shift(4,0);for(ne=0;ne<3;++ne)j.write_shift(4,-1);for(ne=0;ne<12;++ne)j.write_shift(4,0);continue}le=C.FileIndex[G],G===0&&(le.start=le.size?le.start-1:V);var Ie=G===0&&F.root||le.name;if(oe=2*(Ie.length+1),j.write_shift(64,Ie,"utf16le"),j.write_shift(2,oe),j.write_shift(1,le.type),j.write_shift(1,le.color),j.write_shift(-4,le.L),j.write_shift(-4,le.R),j.write_shift(-4,le.C),le.clsid)j.write_shift(16,le.clsid,"hex");else for(ne=0;ne<4;++ne)j.write_shift(4,0);j.write_shift(4,le.state||0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,0),j.write_shift(4,le.start),j.write_shift(4,le.size),j.write_shift(4,0)}for(G=1;G<C.FileIndex.length;++G)if(le=C.FileIndex[G],le.size>=4096)if(j.l=le.start+1<<9,St&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+511&-512;else{for(ne=0;ne<le.size;++ne)j.write_shift(1,le.content[ne]);for(;ne&511;++ne)j.write_shift(1,0)}for(G=1;G<C.FileIndex.length;++G)if(le=C.FileIndex[G],le.size>0&&le.size<4096)if(St&&Buffer.isBuffer(le.content))le.content.copy(j,j.l,0,le.size),j.l+=le.size+63&-64;else{for(ne=0;ne<le.size;++ne)j.write_shift(1,le.content[ne]);for(;ne&63;++ne)j.write_shift(1,0)}if(St)j.l=j.length;else for(;j.l<j.length;)j.write_shift(1,0);return j}function B(C,z){var F=C.FullPaths.map(function(ne){return ne.toUpperCase()}),L=F.map(function(ne){var oe=ne.split("/");return oe[oe.length-(ne.slice(-1)=="/"?2:1)]}),j=!1;z.charCodeAt(0)===47?(j=!0,z=F[0].slice(0,-1)+z):j=z.indexOf("/")!==-1;var G=z.toUpperCase(),ae=j===!0?F.indexOf(G):L.indexOf(G);if(ae!==-1)return C.FileIndex[ae];var me=!G.match(Rh);for(G=G.replace(yc,""),me&&(G=G.replace(Rh,"!")),ae=0;ae<F.length;++ae)if((me?F[ae].replace(Rh,"!"):F[ae]).replace(yc,"")==G||(me?L[ae].replace(Rh,"!"):L[ae]).replace(yc,"")==G)return C.FileIndex[ae];return null}var H=64,V=-2,Je="d0cf11e0a1b11ae1",He=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",Re={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:V,FREESECT:-1,HEADER_SIGNATURE:Je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ze(C,z,F){m();var L=M(C,F);h.writeFileSync(z,L)}function Ye(C){for(var z=new Array(C.length),F=0;F<C.length;++F)z[F]=String.fromCharCode(C[F]);return z.join("")}function Q(C,z){var F=M(C,z);switch(z&&z.type||"buffer"){case"file":return m(),h.writeFileSync(z.filename,F),F;case"binary":return typeof F=="string"?F:Ye(F);case"base64":return kc(typeof F=="string"?F:Ye(F));case"buffer":if(St)return Buffer.isBuffer(F)?F:Ma(F);case"array":return typeof F=="string"?di(F):F}return F}var xe;function U(C){try{var z=C.InflateRaw,F=new z;if(F._processChunk(new Uint8Array([3,0]),F._finishFlushFlag),F.bytesRead)xe=C;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function W(C,z){if(!xe)return ka(C,z);var F=xe.InflateRaw,L=new F,j=L._processChunk(C.slice(C.l),L._finishFlushFlag);return C.l+=L.bytesRead,j}function K(C){return xe?xe.deflateRawSync(C):Ps(C)}var Z=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ce=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Le=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Fe(C){var z=(C<<1|C<<11)&139536|(C<<5|C<<15)&558144;return(z>>16|z>>8|z)&255}for(var Be=typeof Uint8Array<"u",Me=Be?new Uint8Array(256):[],ut=0;ut<256;++ut)Me[ut]=Fe(ut);function nt(C,z){var F=Me[C&255];return z<=8?F>>>8-z:(F=F<<8|Me[C>>8&255],z<=16?F>>>16-z:(F=F<<8|Me[C>>16&255],F>>>24-z))}function Wt(C,z){var F=z&7,L=z>>>3;return(C[L]|(F<=6?0:C[L+1]<<8))>>>F&3}function ot(C,z){var F=z&7,L=z>>>3;return(C[L]|(F<=5?0:C[L+1]<<8))>>>F&7}function ir(C,z){var F=z&7,L=z>>>3;return(C[L]|(F<=4?0:C[L+1]<<8))>>>F&15}function Bt(C,z){var F=z&7,L=z>>>3;return(C[L]|(F<=3?0:C[L+1]<<8))>>>F&31}function Ve(C,z){var F=z&7,L=z>>>3;return(C[L]|(F<=1?0:C[L+1]<<8))>>>F&127}function Wn(C,z,F){var L=z&7,j=z>>>3,G=(1<<F)-1,ae=C[j]>>>L;return F<8-L||(ae|=C[j+1]<<8-L,F<16-L)||(ae|=C[j+2]<<16-L,F<24-L)||(ae|=C[j+3]<<24-L),ae&G}function ar(C,z,F){var L=z&7,j=z>>>3;return L<=5?C[j]|=(F&7)<<L:(C[j]|=F<<L&255,C[j+1]=(F&7)>>8-L),z+3}function mr(C,z,F){var L=z&7,j=z>>>3;return F=(F&1)<<L,C[j]|=F,z+1}function pr(C,z,F){var L=z&7,j=z>>>3;return F<<=L,C[j]|=F&255,F>>>=8,C[j+1]=F,z+8}function Mo(C,z,F){var L=z&7,j=z>>>3;return F<<=L,C[j]|=F&255,F>>>=8,C[j+1]=F&255,C[j+2]=F>>>8,z+16}function _i(C,z){var F=C.length,L=2*F>z?2*F:z+5,j=0;if(F>=z)return C;if(St){var G=R2(L);if(C.copy)C.copy(G);else for(;j<C.length;++j)G[j]=C[j];return G}else if(Be){var ae=new Uint8Array(L);if(ae.set)ae.set(C);else for(;j<F;++j)ae[j]=C[j];return ae}return C.length=L,C}function Kn(C){for(var z=new Array(C),F=0;F<C;++F)z[F]=0;return z}function Ji(C,z,F){var L=1,j=0,G=0,ae=0,me=0,ne=C.length,oe=Be?new Uint16Array(32):Kn(32);for(G=0;G<32;++G)oe[G]=0;for(G=ne;G<F;++G)C[G]=0;ne=C.length;var le=Be?new Uint16Array(ne):Kn(ne);for(G=0;G<ne;++G)oe[j=C[G]]++,L<j&&(L=j),le[G]=0;for(oe[0]=0,G=1;G<=L;++G)oe[G+16]=me=me+oe[G-1]<<1;for(G=0;G<ne;++G)me=C[G],me!=0&&(le[G]=oe[me+16]++);var be=0;for(G=0;G<ne;++G)if(be=C[G],be!=0)for(me=nt(le[G],L)>>L-be,ae=(1<<L+4-be)-1;ae>=0;--ae)z[me|ae<<be]=be&15|G<<4;return L}var zt=Be?new Uint16Array(512):Kn(512),xt=Be?new Uint16Array(32):Kn(32);if(!Be){for(var rn=0;rn<512;++rn)zt[rn]=0;for(rn=0;rn<32;++rn)xt[rn]=0}(function(){for(var C=[],z=0;z<32;z++)C.push(5);Ji(C,xt,32);var F=[];for(z=0;z<=143;z++)F.push(8);for(;z<=255;z++)F.push(9);for(;z<=279;z++)F.push(7);for(;z<=287;z++)F.push(8);Ji(F,zt,288)})();var bn=function(){for(var z=Be?new Uint8Array(32768):[],F=0,L=0;F<Le.length-1;++F)for(;L<Le[F+1];++L)z[L]=F;for(;L<32768;++L)z[L]=29;var j=Be?new Uint8Array(259):[];for(F=0,L=0;F<ce.length-1;++F)for(;L<ce[F+1];++L)j[L]=F;function G(me,ne){for(var oe=0;oe<me.length;){var le=Math.min(65535,me.length-oe),be=oe+le==me.length;for(ne.write_shift(1,+be),ne.write_shift(2,le),ne.write_shift(2,~le&65535);le-- >0;)ne[ne.l++]=me[oe++]}return ne.l}function ae(me,ne){for(var oe=0,le=0,be=Be?new Uint16Array(32768):[];le<me.length;){var Ie=Math.min(65535,me.length-le);if(Ie<10){for(oe=ar(ne,oe,+(le+Ie==me.length)),oe&7&&(oe+=8-(oe&7)),ne.l=oe/8|0,ne.write_shift(2,Ie),ne.write_shift(2,~Ie&65535);Ie-- >0;)ne[ne.l++]=me[le++];oe=ne.l*8;continue}oe=ar(ne,oe,+(le+Ie==me.length)+2);for(var Ue=0;Ie-- >0;){var Ce=me[le];Ue=(Ue<<5^Ce)&32767;var Pe=-1,Qe=0;if((Pe=be[Ue])&&(Pe|=le&-32768,Pe>le&&(Pe-=32768),Pe<le))for(;me[Pe+Qe]==me[le+Qe]&&Qe<250;)++Qe;if(Qe>2){Ce=j[Qe],Ce<=22?oe=pr(ne,oe,Me[Ce+1]>>1)-1:(pr(ne,oe,3),oe+=5,pr(ne,oe,Me[Ce-23]>>5),oe+=3);var Et=Ce<8?0:Ce-4>>2;Et>0&&(Mo(ne,oe,Qe-ce[Ce]),oe+=Et),Ce=z[le-Pe],oe=pr(ne,oe,Me[Ce]>>3),oe-=3;var dt=Ce<4?0:Ce-2>>1;dt>0&&(Mo(ne,oe,le-Pe-Le[Ce]),oe+=dt);for(var mt=0;mt<Qe;++mt)be[Ue]=le&32767,Ue=(Ue<<5^me[le])&32767,++le;Ie-=Qe-1}else Ce<=143?Ce=Ce+48:oe=mr(ne,oe,1),oe=pr(ne,oe,Me[Ce]),be[Ue]=le&32767,++le}oe=pr(ne,oe,0)-1}return ne.l=(oe+7)/8|0,ne.l}return function(ne,oe){return ne.length<8?G(ne,oe):ae(ne,oe)}}();function Ps(C){var z=ge(50+Math.floor(C.length*1.1)),F=bn(C,z);return z.slice(0,F)}var Po=Be?new Uint16Array(32768):Kn(32768),yi=Be?new Uint16Array(32768):Kn(32768),xi=Be?new Uint16Array(128):Kn(128),Ei=1,gr=1;function Pa(C,z){var F=Bt(C,z)+257;z+=5;var L=Bt(C,z)+1;z+=5;var j=ir(C,z)+4;z+=4;for(var G=0,ae=Be?new Uint8Array(19):Kn(19),me=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ne=1,oe=Be?new Uint8Array(8):Kn(8),le=Be?new Uint8Array(8):Kn(8),be=ae.length,Ie=0;Ie<j;++Ie)ae[Z[Ie]]=G=ot(C,z),ne<G&&(ne=G),oe[G]++,z+=3;var Ue=0;for(oe[0]=0,Ie=1;Ie<=ne;++Ie)le[Ie]=Ue=Ue+oe[Ie-1]<<1;for(Ie=0;Ie<be;++Ie)(Ue=ae[Ie])!=0&&(me[Ie]=le[Ue]++);var Ce=0;for(Ie=0;Ie<be;++Ie)if(Ce=ae[Ie],Ce!=0){Ue=Me[me[Ie]]>>8-Ce;for(var Pe=(1<<7-Ce)-1;Pe>=0;--Pe)xi[Ue|Pe<<Ce]=Ce&7|Ie<<3}var Qe=[];for(ne=1;Qe.length<F+L;)switch(Ue=xi[Ve(C,z)],z+=Ue&7,Ue>>>=3){case 16:for(G=3+Wt(C,z),z+=2,Ue=Qe[Qe.length-1];G-- >0;)Qe.push(Ue);break;case 17:for(G=3+ot(C,z),z+=3;G-- >0;)Qe.push(0);break;case 18:for(G=11+Ve(C,z),z+=7;G-- >0;)Qe.push(0);break;default:Qe.push(Ue),ne<Ue&&(ne=Ue);break}var Et=Qe.slice(0,F),dt=Qe.slice(F);for(Ie=F;Ie<286;++Ie)Et[Ie]=0;for(Ie=L;Ie<30;++Ie)dt[Ie]=0;return Ei=Ji(Et,Po,286),gr=Ji(dt,yi,30),z}function ea(C,z){if(C[0]==3&&!(C[1]&3))return[Eo(z),2];for(var F=0,L=0,j=R2(z||1<<18),G=0,ae=j.length>>>0,me=0,ne=0;(L&1)==0;){if(L=ot(C,F),F+=3,L>>>1)L>>1==1?(me=9,ne=5):(F=Pa(C,F),me=Ei,ne=gr);else{F&7&&(F+=8-(F&7));var oe=C[F>>>3]|C[(F>>>3)+1]<<8;if(F+=32,oe>0)for(!z&&ae<G+oe&&(j=_i(j,G+oe),ae=j.length);oe-- >0;)j[G++]=C[F>>>3],F+=8;continue}for(;;){!z&&ae<G+32767&&(j=_i(j,G+32767),ae=j.length);var le=Wn(C,F,me),be=L>>>1==1?zt[le]:Po[le];if(F+=be&15,be>>>=4,(be>>>8&255)===0)j[G++]=be;else{if(be==256)break;be-=257;var Ie=be<8?0:be-4>>2;Ie>5&&(Ie=0);var Ue=G+ce[be];Ie>0&&(Ue+=Wn(C,F,Ie),F+=Ie),le=Wn(C,F,ne),be=L>>>1==1?xt[le]:yi[le],F+=be&15,be>>>=4;var Ce=be<4?0:be-2>>1,Pe=Le[be];for(Ce>0&&(Pe+=Wn(C,F,Ce),F+=Ce),!z&&ae<Ue&&(j=_i(j,Ue+100),ae=j.length);G<Ue;)j[G]=j[G-Pe],++G}}}return z?[j,F+7>>>3]:[j.slice(0,G),F+7>>>3]}function ka(C,z){var F=C.slice(C.l||0),L=ea(F,z);return C.l+=L[1],L[0]}function La(C,z){if(C)typeof console<"u"&&console.error(z);else throw new Error(z)}function Va(C,z){var F=C;Lr(F,0);var L=[],j=[],G={FileIndex:L,FullPaths:j};N(G,{root:z.root});for(var ae=F.length-4;(F[ae]!=80||F[ae+1]!=75||F[ae+2]!=5||F[ae+3]!=6)&&ae>=0;)--ae;F.l=ae+4,F.l+=4;var me=F.read_shift(2);F.l+=6;var ne=F.read_shift(4);for(F.l=ne,ae=0;ae<me;++ae){F.l+=20;var oe=F.read_shift(4),le=F.read_shift(4),be=F.read_shift(2),Ie=F.read_shift(2),Ue=F.read_shift(2);F.l+=8;var Ce=F.read_shift(4),Pe=f(F.slice(F.l+be,F.l+be+Ie));F.l+=be+Ie+Ue;var Qe=F.l;F.l=Ce+4,ai(F,oe,le,G,Pe),F.l=Qe}return G}function ai(C,z,F,L,j){C.l+=2;var G=C.read_shift(2),ae=C.read_shift(2),me=u(C);if(G&8257)throw new Error("Unsupported ZIP encryption");for(var ne=C.read_shift(4),oe=C.read_shift(4),le=C.read_shift(4),be=C.read_shift(2),Ie=C.read_shift(2),Ue="",Ce=0;Ce<be;++Ce)Ue+=String.fromCharCode(C[C.l++]);if(Ie){var Pe=f(C.slice(C.l,C.l+Ie));(Pe[21589]||{}).mt&&(me=Pe[21589].mt),((j||{})[21589]||{}).mt&&(me=j[21589].mt)}C.l+=Ie;var Qe=C.slice(C.l,C.l+oe);switch(ae){case 8:Qe=W(C,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Et=!1;G&8&&(ne=C.read_shift(4),ne==134695760&&(ne=C.read_shift(4),Et=!0),oe=C.read_shift(4),le=C.read_shift(4)),oe!=z&&La(Et,"Bad compressed size: "+z+" != "+oe),le!=F&&La(Et,"Bad uncompressed size: "+F+" != "+le),Xt(L,Ue,Qe,{unsafe:!0,mt:me})}function si(C,z){var F=z||{},L=[],j=[],G=ge(1),ae=F.compression?8:0,me=0,ne=0,oe=0,le=0,be=0,Ie=C.FullPaths[0],Ue=Ie,Ce=C.FileIndex[0],Pe=[],Qe=0;for(ne=1;ne<C.FullPaths.length;++ne)if(Ue=C.FullPaths[ne].slice(Ie.length),Ce=C.FileIndex[ne],!(!Ce.size||!Ce.content||Ue=="Sh33tJ5")){var Et=le,dt=ge(Ue.length);for(oe=0;oe<Ue.length;++oe)dt.write_shift(1,Ue.charCodeAt(oe)&127);dt=dt.slice(0,dt.l),Pe[be]=XO.buf(Ce.content,0);var mt=Ce.content;ae==8&&(mt=K(mt)),G=ge(30),G.write_shift(4,67324752),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,ae),Ce.mt?o(G,Ce.mt):G.write_shift(4,0),G.write_shift(-4,Pe[be]),G.write_shift(4,mt.length),G.write_shift(4,Ce.content.length),G.write_shift(2,dt.length),G.write_shift(2,0),le+=G.length,L.push(G),le+=dt.length,L.push(dt),le+=mt.length,L.push(mt),G=ge(46),G.write_shift(4,33639248),G.write_shift(2,0),G.write_shift(2,20),G.write_shift(2,me),G.write_shift(2,ae),G.write_shift(4,0),G.write_shift(-4,Pe[be]),G.write_shift(4,mt.length),G.write_shift(4,Ce.content.length),G.write_shift(2,dt.length),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(4,0),G.write_shift(4,Et),Qe+=G.l,j.push(G),Qe+=dt.length,j.push(dt),++be}return G=ge(22),G.write_shift(4,101010256),G.write_shift(2,0),G.write_shift(2,0),G.write_shift(2,be),G.write_shift(2,be),G.write_shift(4,Qe),G.write_shift(4,le),G.write_shift(2,0),Gn([Gn(L),Gn(j),G])}var Ti={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function jr(C,z){if(C.ctype)return C.ctype;var F=C.name||"",L=F.match(/\.([^\.]+)$/);return L&&Ti[L[1]]||z&&(L=(F=z).match(/[\.\\]([^\.\\])+$/),L&&Ti[L[1]])?Ti[L[1]]:"application/octet-stream"}function ks(C){for(var z=kc(C),F=[],L=0;L<z.length;L+=76)F.push(z.slice(L,L+76));return F.join(`\r
`)+`\r
`}function wi(C){var z=C.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(oe){var le=oe.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});z=z.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),z.charAt(0)==`
`&&(z="=0D"+z.slice(1)),z=z.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var F=[],L=z.split(`\r
`),j=0;j<L.length;++j){var G=L[j];if(G.length==0){F.push("");continue}for(var ae=0;ae<G.length;){var me=76,ne=G.slice(ae,ae+me);ne.charAt(me-1)=="="?me--:ne.charAt(me-2)=="="?me-=2:ne.charAt(me-3)=="="&&(me-=3),ne=G.slice(ae,ae+me),ae+=me,ae<G.length&&(ne+="="),F.push(ne)}}return F.join(`\r
`)}function Ba(C){for(var z=[],F=0;F<C.length;++F){for(var L=C[F];F<=C.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+C[++F];z.push(L)}for(var j=0;j<z.length;++j)z[j]=z[j].replace(/[=][0-9A-Fa-f]{2}/g,function(G){return String.fromCharCode(parseInt(G.slice(1),16))});return di(z.join(`\r
`))}function Ai(C,z,F){for(var L="",j="",G="",ae,me=0;me<10;++me){var ne=z[me];if(!ne||ne.match(/^\s*$/))break;var oe=ne.match(/^(.*?):\s*([^\s].*)$/);if(oe)switch(oe[1].toLowerCase()){case"content-location":L=oe[2].trim();break;case"content-type":G=oe[2].trim();break;case"content-transfer-encoding":j=oe[2].trim();break}}switch(++me,j.toLowerCase()){case"base64":ae=di(Da(z.slice(me).join("")));break;case"quoted-printable":ae=Ba(z.slice(me));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+j)}var le=Xt(C,L.slice(F.length),ae,{unsafe:!0});G&&(le.ctype=G)}function ko(C,z){if(Ye(C.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var F=z&&z.root||"",L=(St&&Buffer.isBuffer(C)?C.toString("binary"):Ye(C)).split(`\r
`),j=0,G="";for(j=0;j<L.length;++j)if(G=L[j],!!/^Content-Location:/i.test(G)&&(G=G.slice(G.indexOf("file")),F||(F=G.slice(0,G.lastIndexOf("/")+1)),G.slice(0,F.length)!=F))for(;F.length>0&&(F=F.slice(0,F.length-1),F=F.slice(0,F.lastIndexOf("/")+1),G.slice(0,F.length)!=F););var ae=(L[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var me="--"+(ae[1]||""),ne=[],oe=[],le={FileIndex:ne,FullPaths:oe};N(le);var be,Ie=0;for(j=0;j<L.length;++j){var Ue=L[j];Ue!==me&&Ue!==me+"--"||(Ie++&&Ai(le,L.slice(be,j),F),be=j)}return le}function Ht(C,z){var F=z||{},L=F.boundary||"SheetJS";L="------="+L;for(var j=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],G=C.FullPaths[0],ae=G,me=C.FileIndex[0],ne=1;ne<C.FullPaths.length;++ne)if(ae=C.FullPaths[ne].slice(G.length),me=C.FileIndex[ne],!(!me.size||!me.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Qe){return"_x"+Qe.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Qe){return"_u"+Qe.charCodeAt(0).toString(16)+"_"});for(var oe=me.content,le=St&&Buffer.isBuffer(oe)?oe.toString("binary"):Ye(oe),be=0,Ie=Math.min(1024,le.length),Ue=0,Ce=0;Ce<=Ie;++Ce)(Ue=le.charCodeAt(Ce))>=32&&Ue<128&&++be;var Pe=be>=Ie*4/5;j.push(L),j.push("Content-Location: "+(F.root||"file:///C:/SheetJS/")+ae),j.push("Content-Transfer-Encoding: "+(Pe?"quoted-printable":"base64")),j.push("Content-Type: "+jr(me,ae)),j.push(""),j.push(Pe?wi(le):ks(le))}return j.push(L+`--\r
`),j.join(`\r
`)}function an(C){var z={};return N(z,C),z}function Xt(C,z,F,L){var j=L&&L.unsafe;j||N(C);var G=!j&&Vt.find(C,z);if(!G){var ae=C.FullPaths[0];z.slice(0,ae.length)==ae?ae=z:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+z).replace("//","/")),G={name:a(z),type:2},C.FileIndex.push(G),C.FullPaths.push(ae),j||Vt.utils.cfb_gc(C)}return G.content=F,G.size=F?F.length:0,L&&(L.CLSID&&(G.clsid=L.CLSID),L.mt&&(G.mt=L.mt),L.ct&&(G.ct=L.ct)),G}function vr(C,z){N(C);var F=Vt.find(C,z);if(F){for(var L=0;L<C.FileIndex.length;++L)if(C.FileIndex[L]==F)return C.FileIndex.splice(L,1),C.FullPaths.splice(L,1),!0}return!1}function Ls(C,z,F){N(C);var L=Vt.find(C,z);if(L){for(var j=0;j<C.FileIndex.length;++j)if(C.FileIndex[j]==L)return C.FileIndex[j].name=a(F),C.FullPaths[j]=F,!0}return!1}function au(C){R(C,!0)}return e.find=B,e.read=Ae,e.parse=g,e.write=Q,e.writeFile=ze,e.utils={cfb_new:an,cfb_add:Xt,cfb_del:vr,cfb_mov:Ls,cfb_gc:au,ReadShift:Ec,CheckField:EA,prep_blob:Lr,bconcat:Gn,use_zlib:U,_deflateRaw:Ps,_inflateRaw:ka,consts:Re},e}();function YO(t){return typeof t=="string"?z0(t):Array.isArray(t)?xO(t):t}function Jc(t,e,n){if(typeof Deno<"u"){if(n&&typeof e=="string")switch(n){case"utf8":e=new TextEncoder(n).encode(e);break;case"binary":e=z0(e);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(t,e)}var r=n=="utf8"?Vc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,t);if(typeof Blob<"u"){var a=new Blob([YO(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var o=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),chrome.downloads.download({url:o,filename:t,saveAs:!0});var u=document.createElement("a");if(u.download!=null)return u.download=t,u.href=o,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(o)},6e4),o}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var f=File(t);return f.open("w"),f.encoding="binary",Array.isArray(e)&&(e=Zc(e)),f.write(e),f.close(),e}catch(h){if(!h.message||!h.message.match(/onstruct/))throw h}throw new Error("cannot save file "+t)}function Yn(t){for(var e=Object.keys(t),n=[],r=0;r<e.length;++r)Object.prototype.hasOwnProperty.call(t,e[r])&&n.push(e[r]);return n}function P2(t,e){for(var n=[],r=Yn(t),a=0;a!==r.length;++a)n[t[r[a]][e]]==null&&(n[t[r[a]][e]]=r[a]);return n}function a1(t){for(var e=[],n=Yn(t),r=0;r!==n.length;++r)e[t[n[r]]]=n[r];return e}function q0(t){for(var e=[],n=Yn(t),r=0;r!==n.length;++r)e[t[n[r]]]=parseInt(n[r],10);return e}function WO(t){for(var e=[],n=Yn(t),r=0;r!==n.length;++r)e[t[n[r]]]==null&&(e[t[n[r]]]=[]),e[t[n[r]]].push(n[r]);return e}var c0=new Date(1899,11,30,0,0,0);function Sr(t,e){var n=t.getTime(),r=c0.getTime()+(t.getTimezoneOffset()-c0.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var iA=new Date,KO=c0.getTime()+(iA.getTimezoneOffset()-c0.getTimezoneOffset())*6e4,k2=iA.getTimezoneOffset();function aA(t){var e=new Date;return e.setTime(t*24*60*60*1e3+KO),e.getTimezoneOffset()!==k2&&e.setTime(e.getTime()+(e.getTimezoneOffset()-k2)*6e4),e}var L2=new Date("2017-02-19T19:06:09.000Z"),sA=isNaN(L2.getFullYear())?new Date("2/19/17"):L2,QO=sA.getFullYear()==2017;function dr(t,e){var n=new Date(t);if(QO)return e>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):e<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(t instanceof Date)return t;if(sA.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return t.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],o=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-o.getTimezoneOffset()*60*1e3)),o}function $0(t,e){if(St&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(o){return n[o]||o})}catch{}for(var r=[],a=0;a!=t.length;++a)r.push(String.fromCharCode(t[a]));return r.join("")}function br(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=br(t[n]));return e}function tn(t,e){for(var n="";n.length<e;)n+=t;return n}function Aa(t){var e=Number(t);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(t))return e;var n=1,r=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(e=Number(r))||(r=r.replace(/[(](.*)[)]/,function(a,o){return n=-n,o}),!isNaN(e=Number(r)))?e/n:e}var ZO=["january","february","march","april","may","june","july","august","september","october","november","december"];function Lc(t){var e=new Date(t),n=new Date(NaN),r=e.getYear(),a=e.getMonth(),o=e.getDate();if(isNaN(o))return n;var u=t.toLowerCase();if(u.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(u=u.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),u.length>3&&ZO.indexOf(u)==-1)return n}else if(u.match(/[a-z]/))return n;return r<0||r>8099?n:(a>0||o>1)&&r!=101?e:t.match(/[^-0-9:,\/\\]/)?n:e}function it(t,e,n){if(t.FullPaths){if(typeof n=="string"){var r;return St?r=Ma(n):r=EO(n),Vt.utils.cfb_add(t,e,r)}Vt.utils.cfb_add(t,e,n)}else t.file(e,n)}function s1(){return Vt.utils.cfb_new()}var yn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,JO={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},o1=a1(JO),l1=/[&<>'"]/g,e8=/[\u0000-\u0008\u000b-\u001f]/g;function Ot(t){var e=t+"";return e.replace(l1,function(n){return o1[n]}).replace(e8,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function V2(t){return Ot(t).replace(/ /g,"_x0020_")}var oA=/[\u0000-\u001f]/g;function t8(t){var e=t+"";return e.replace(l1,function(n){return o1[n]}).replace(/\n/g,"<br/>").replace(oA,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function n8(t){var e=t+"";return e.replace(l1,function(n){return o1[n]}).replace(oA,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}function r8(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function i8(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function pp(t){for(var e="",n=0,r=0,a=0,o=0,u=0,f=0;n<t.length;){if(r=t.charCodeAt(n++),r<128){e+=String.fromCharCode(r);continue}if(a=t.charCodeAt(n++),r>191&&r<224){u=(r&31)<<6,u|=a&63,e+=String.fromCharCode(u);continue}if(o=t.charCodeAt(n++),r<240){e+=String.fromCharCode((r&15)<<12|(a&63)<<6|o&63);continue}u=t.charCodeAt(n++),f=((r&7)<<18|(a&63)<<12|(o&63)<<6|u&63)-65536,e+=String.fromCharCode(55296+(f>>>10&1023)),e+=String.fromCharCode(56320+(f&1023))}return e}function B2(t){var e=Eo(2*t.length),n,r,a=1,o=0,u=0,f;for(r=0;r<t.length;r+=a)a=1,(f=t.charCodeAt(r))<128?n=f:f<224?(n=(f&31)*64+(t.charCodeAt(r+1)&63),a=2):f<240?(n=(f&15)*4096+(t.charCodeAt(r+1)&63)*64+(t.charCodeAt(r+2)&63),a=3):(a=4,n=(f&7)*262144+(t.charCodeAt(r+1)&63)*4096+(t.charCodeAt(r+2)&63)*64+(t.charCodeAt(r+3)&63),n-=65536,u=55296+(n>>>10&1023),n=56320+(n&1023)),u!==0&&(e[o++]=u&255,e[o++]=u>>>8,u=0),e[o++]=n%256,e[o++]=n>>>8;return e.slice(0,o).toString("ucs2")}function U2(t){return Ma(t,"binary").toString("utf8")}var Ih="foo bar baz",xc=St&&(U2(Ih)==pp(Ih)&&U2||B2(Ih)==pp(Ih)&&B2)||pp,Vc=St?function(t){return Ma(t,"utf8").toString("binary")}:function(t){for(var e=[],n=0,r=0,a=0;n<t.length;)switch(r=t.charCodeAt(n++),!0){case r<128:e.push(String.fromCharCode(r));break;case r<2048:e.push(String.fromCharCode(192+(r>>6))),e.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,a=t.charCodeAt(n++)-56320+(r<<10),e.push(String.fromCharCode(240+(a>>18&7))),e.push(String.fromCharCode(144+(a>>12&63))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)));break;default:e.push(String.fromCharCode(224+(r>>12))),e.push(String.fromCharCode(128+(r>>6&63))),e.push(String.fromCharCode(128+(r&63)))}return e.join("")},a8=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)r=r.replace(t[a][0],t[a][1]);return r}}(),lA=/(^\s|\s$|\n)/;function qn(t,e){return"<"+t+(e.match(lA)?' xml:space="preserve"':"")+">"+e+"</"+t+">"}function Bc(t){return Yn(t).map(function(e){return" "+e+'="'+t[e]+'"'}).join("")}function Ne(t,e,n){return"<"+t+(n!=null?Bc(n):"")+(e!=null?(e.match(lA)?' xml:space="preserve"':"")+">"+e+"</"+t:"/")+">"}function Wp(t,e){try{return t.toISOString().replace(/\.\d*/,"")}catch(n){if(e)throw n}return""}function s8(t,e){switch(typeof t){case"string":var n=Ne("vt:lpwstr",Ot(t));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Ne((t|0)==t?"vt:i4":"vt:r8",Ot(String(t)));case"boolean":return Ne("vt:bool",t?"true":"false")}if(t instanceof Date)return Ne("vt:filetime",Wp(t));throw new Error("Unable to serialize "+t)}var Fn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},tu=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Vr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function o8(t,e){for(var n=1-2*(t[e+7]>>>7),r=((t[e+7]&127)<<4)+(t[e+6]>>>4&15),a=t[e+6]&15,o=5;o>=0;--o)a=a*256+t[e+o];return r==2047?a==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,a+=Math.pow(2,52)),n*Math.pow(2,r-52)*a)}function l8(t,e,n){var r=(e<0||1/e==-1/0?1:0)<<7,a=0,o=0,u=r?-e:e;isFinite(u)?u==0?a=o=0:(a=Math.floor(Math.log(u)/Math.LN2),o=u*Math.pow(2,52-a),a<=-1023&&(!isFinite(o)||o<Math.pow(2,52))?a=-1022:(o-=Math.pow(2,52),a+=1023)):(a=2047,o=isNaN(e)?26985:0);for(var f=0;f<=5;++f,o/=256)t[n+f]=o&255;t[n+6]=(a&15)<<4|o&15,t[n+7]=a>>4|r}var j2=function(t){for(var e=[],n=10240,r=0;r<t[0].length;++r)if(t[0][r])for(var a=0,o=t[0][r].length;a<o;a+=n)e.push.apply(e,t[0][r].slice(a,a+n));return e},z2=St?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(e){return Buffer.isBuffer(e)?e:Ma(e)})):j2(t)}:j2,H2=function(t,e,n){for(var r=[],a=e;a<n;a+=2)r.push(String.fromCharCode(dc(t,a)));return r.join("").replace(yc,"")},u1=St?function(t,e,n){return Buffer.isBuffer(t)?t.toString("utf16le",e,n).replace(yc,""):H2(t,e,n)}:H2,G2=function(t,e,n){for(var r=[],a=e;a<e+n;++a)r.push(("0"+t[a].toString(16)).slice(-2));return r.join("")},uA=St?function(t,e,n){return Buffer.isBuffer(t)?t.toString("hex",e,e+n):G2(t,e,n)}:G2,q2=function(t,e,n){for(var r=[],a=e;a<n;a++)r.push(String.fromCharCode(Il(t,a)));return r.join("")},ef=St?function(e,n,r){return Buffer.isBuffer(e)?e.toString("utf8",n,r):q2(e,n,r)}:q2,cA=function(t,e){var n=Br(t,e);return n>0?ef(t,e+4,e+4+n-1):""},fA=cA,hA=function(t,e){var n=Br(t,e);return n>0?ef(t,e+4,e+4+n-1):""},dA=hA,mA=function(t,e){var n=2*Br(t,e);return n>0?ef(t,e+4,e+4+n-1):""},pA=mA,gA=function(e,n){var r=Br(e,n);return r>0?u1(e,n+4,n+4+r):""},vA=gA,_A=function(t,e){var n=Br(t,e);return n>0?ef(t,e+4,e+4+n):""},yA=_A,xA=function(t,e){return o8(t,e)},f0=xA,c1=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};St&&(fA=function(e,n){if(!Buffer.isBuffer(e))return cA(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},dA=function(e,n){if(!Buffer.isBuffer(e))return hA(e,n);var r=e.readUInt32LE(n);return r>0?e.toString("utf8",n+4,n+4+r-1):""},pA=function(e,n){if(!Buffer.isBuffer(e))return mA(e,n);var r=2*e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r-1)},vA=function(e,n){if(!Buffer.isBuffer(e))return gA(e,n);var r=e.readUInt32LE(n);return e.toString("utf16le",n+4,n+4+r)},yA=function(e,n){if(!Buffer.isBuffer(e))return _A(e,n);var r=e.readUInt32LE(n);return e.toString("utf8",n+4,n+4+r)},f0=function(e,n){return Buffer.isBuffer(e)?e.readDoubleLE(n):xA(e,n)},c1=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var Il=function(t,e){return t[e]},dc=function(t,e){return t[e+1]*256+t[e]},u8=function(t,e){var n=t[e+1]*256+t[e];return n<32768?n:(65535-n+1)*-1},Br=function(t,e){return t[e+3]*(1<<24)+(t[e+2]<<16)+(t[e+1]<<8)+t[e]},fo=function(t,e){return t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e]},c8=function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]};function Ec(t,e){var n="",r,a,o=[],u,f,h,m;switch(e){case"dbcs":if(m=this.l,St&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*t).toString("utf16le");else for(h=0;h<t;++h)n+=String.fromCharCode(dc(this,m)),m+=2;t*=2;break;case"utf8":n=ef(this,this.l,this.l+t);break;case"utf16le":t*=2,n=u1(this,this.l,this.l+t);break;case"wstr":return Ec.call(this,t,"dbcs");case"lpstr-ansi":n=fA(this,this.l),t=4+Br(this,this.l);break;case"lpstr-cp":n=dA(this,this.l),t=4+Br(this,this.l);break;case"lpwstr":n=pA(this,this.l),t=4+2*Br(this,this.l);break;case"lpp4":t=4+Br(this,this.l),n=vA(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Br(this,this.l),n=yA(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,n="";(u=Il(this,this.l+t++))!==0;)o.push(bh(u));n=o.join("");break;case"_wstr":for(t=0,n="";(u=dc(this,this.l+t))!==0;)o.push(bh(u)),t+=2;t+=2,n=o.join("");break;case"dbcs-cont":for(n="",m=this.l,h=0;h<t;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return u=Il(this,m),this.l=m+1,f=Ec.call(this,t-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(bh(dc(this,m))),m+=2}n=o.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(n="",m=this.l,h=0;h!=t;++h){if(this.lens&&this.lens.indexOf(m)!==-1)return u=Il(this,m),this.l=m+1,f=Ec.call(this,t-h,u?"dbcs-cont":"sbcs-cont"),o.join("")+f;o.push(bh(Il(this,m))),m+=1}n=o.join("");break;default:switch(t){case 1:return r=Il(this,this.l),this.l++,r;case 2:return r=(e==="i"?u8:dc)(this,this.l),this.l+=2,r;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(r=(t>0?fo:c8)(this,this.l),this.l+=4,r):(a=Br(this,this.l),this.l+=4,a);case 8:case-8:if(e==="f")return t==8?a=f0(this,this.l):a=f0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:n=uA(this,this.l,t);break}}return this.l+=t,n}var f8=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255,t[n+2]=e>>>16&255,t[n+3]=e>>>24&255},h8=function(t,e,n){t[n]=e&255,t[n+1]=e>>8&255,t[n+2]=e>>16&255,t[n+3]=e>>24&255},d8=function(t,e,n){t[n]=e&255,t[n+1]=e>>>8&255};function m8(t,e,n){var r=0,a=0;if(n==="dbcs"){for(a=0;a!=e.length;++a)d8(this,e.charCodeAt(a),this.l+2*a);r=2*e.length}else if(n==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=e.length;++a)this[this.l+a]=e.charCodeAt(a)&255;r=e.length}else if(n==="hex"){for(;a<t;++a)this[this.l++]=parseInt(e.slice(2*a,2*a+2),16)||0;return this}else if(n==="utf16le"){var o=Math.min(this.l+t,this.length);for(a=0;a<Math.min(e.length,t);++a){var u=e.charCodeAt(a);this[this.l++]=u&255,this[this.l++]=u>>8}for(;this.l<o;)this[this.l++]=0;return this}else switch(t){case 1:r=1,this[this.l]=e&255;break;case 2:r=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:r=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:r=4,f8(this,e,this.l);break;case 8:if(r=8,n==="f"){l8(this,e,this.l);break}case 16:break;case-4:r=4,h8(this,e,this.l);break}return this.l+=r,this}function EA(t,e){var n=uA(this,this.l,t.length>>1);if(n!==t)throw new Error(e+"Expected "+t+" saw "+n);this.l+=t.length>>1}function Lr(t,e){t.l=e,t.read_shift=Ec,t.chk=EA,t.write_shift=m8}function Ki(t,e){t.l+=e}function ge(t){var e=Eo(t);return Lr(e,0),e}function Ar(){var t=[],e=St?256:2048,n=function(m){var g=ge(m);return Lr(g,0),g},r=n(e),a=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&t.push(r),r=null)},o=function(m){return r&&m<r.length-r.l?r:(a(),r=n(Math.max(m+1,e)))},u=function(){return a(),Gn(t)},f=function(m){a(),r=m,r.l==null&&(r.l=r.length),o(e)};return{next:o,push:f,end:u,_bufs:t}}function Se(t,e,n,r){var a=+e,o;if(!isNaN(a)){r||(r=ok[a].p||(n||[]).length||0),o=1+(a>=128?1:0)+1,r>=128&&++o,r>=16384&&++o,r>=2097152&&++o;var u=t.next(o);a<=127?u.write_shift(1,a):(u.write_shift(1,(a&127)+128),u.write_shift(1,a>>7));for(var f=0;f!=4;++f)if(r>=128)u.write_shift(1,(r&127)+128),r>>=7;else{u.write_shift(1,r);break}r>0&&c1(n)&&t.push(n)}}function Tc(t,e,n){var r=br(t);if(e.s?(r.cRel&&(r.c+=e.s.c),r.rRel&&(r.r+=e.s.r)):(r.cRel&&(r.c+=e.c),r.rRel&&(r.r+=e.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function $2(t,e,n){var r=br(t);return r.s=Tc(r.s,e.s,n),r.e=Tc(r.e,e.s,n),r}function wc(t,e){if(t.cRel&&t.c<0)for(t=br(t);t.c<0;)t.c+=e>8?16384:256;if(t.rRel&&t.r<0)for(t=br(t);t.r<0;)t.r+=e>8?1048576:e>5?65536:16384;var n=Ft(t);return!t.cRel&&t.cRel!=null&&(n=v8(n)),!t.rRel&&t.rRel!=null&&(n=p8(n)),n}function gp(t,e){return t.s.r==0&&!t.s.rRel&&t.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+nr(t.s.c)+":"+(t.e.cRel?"":"$")+nr(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(e.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+$n(t.s.r)+":"+(t.e.rRel?"":"$")+$n(t.e.r):wc(t.s,e.biff)+":"+wc(t.e,e.biff)}function f1(t){return parseInt(g8(t),10)-1}function $n(t){return""+(t+1)}function p8(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function g8(t){return t.replace(/\$(\d+)$/,"$1")}function h1(t){for(var e=_8(t),n=0,r=0;r!==e.length;++r)n=26*n+e.charCodeAt(r)-64;return n-1}function nr(t){if(t<0)throw new Error("invalid column "+t);var e="";for(++t;t;t=Math.floor((t-1)/26))e=String.fromCharCode((t-1)%26+65)+e;return e}function v8(t){return t.replace(/^([A-Z])/,"$$$1")}function _8(t){return t.replace(/^\$([A-Z])/,"$1")}function y8(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Mn(t){for(var e=0,n=0,r=0;r<t.length;++r){var a=t.charCodeAt(r);a>=48&&a<=57?e=10*e+(a-48):a>=65&&a<=90&&(n=26*n+(a-64))}return{c:n-1,r:e-1}}function Ft(t){for(var e=t.c+1,n="";e;e=(e-1)/26|0)n=String.fromCharCode((e-1)%26+65)+n;return n+(t.r+1)}function Ur(t){var e=t.indexOf(":");return e==-1?{s:Mn(t),e:Mn(t)}:{s:Mn(t.slice(0,e)),e:Mn(t.slice(e+1))}}function _n(t,e){return typeof e>"u"||typeof e=="number"?_n(t.s,t.e):(typeof t!="string"&&(t=Ft(t)),typeof e!="string"&&(e=Ft(e)),t==e?t:t+":"+e)}function $t(t){var e={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,a=0,o=t.length;for(n=0;r<o&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.s.c=--n,n=0;r<o&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;if(e.s.r=--n,r===o||a!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++r,n=0;r!=o&&!((a=t.charCodeAt(r)-64)<1||a>26);++r)n=26*n+a;for(e.e.c=--n,n=0;r!=o&&!((a=t.charCodeAt(r)-48)<0||a>9);++r)n=10*n+a;return e.e.r=--n,e}function X2(t,e){var n=t.t=="d"&&e instanceof Date;if(t.z!=null)try{return t.w=Is(t.z,n?Sr(e):e)}catch{}try{return t.w=Is((t.XF||{}).numFmtId||(n?14:0),n?Sr(e):e)}catch{return""+e}}function Oa(t,e,n){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&n&&n.dateNF&&(t.z=n.dateNF),t.t=="e"?tf[t.v]||t.v:e==null?X2(t,t.v):X2(t,e))}function Io(t,e){var n=e&&e.sheet?e.sheet:"Sheet1",r={};return r[n]=t,{SheetNames:[n],Sheets:r}}function TA(t,e,n){var r=n||{},a=t?Array.isArray(t):r.dense,o=t||(a?[]:{}),u=0,f=0;if(o&&r.origin!=null){if(typeof r.origin=="number")u=r.origin;else{var h=typeof r.origin=="string"?Mn(r.origin):r.origin;u=h.r,f=h.c}o["!ref"]||(o["!ref"]="A1:A1")}var m={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(o["!ref"]){var g=$t(o["!ref"]);m.s.c=g.s.c,m.s.r=g.s.r,m.e.c=Math.max(m.e.c,g.e.c),m.e.r=Math.max(m.e.r,g.e.r),u==-1&&(m.e.r=u=g.e.r+1)}for(var y=0;y!=e.length;++y)if(e[y]){if(!Array.isArray(e[y]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[y].length;++_)if(!(typeof e[y][_]>"u")){var E={v:e[y][_]},w=u+y,T=f+_;if(m.s.r>w&&(m.s.r=w),m.s.c>T&&(m.s.c=T),m.e.r<w&&(m.e.r=w),m.e.c<T&&(m.e.c=T),e[y][_]&&typeof e[y][_]=="object"&&!Array.isArray(e[y][_])&&!(e[y][_]instanceof Date))E=e[y][_];else if(Array.isArray(E.v)&&(E.f=e[y][_][1],E.v=E.v[0]),E.v===null)if(E.f)E.t="n";else if(r.nullError)E.t="e",E.v=0;else if(r.sheetStubs)E.t="z";else continue;else typeof E.v=="number"?E.t="n":typeof E.v=="boolean"?E.t="b":E.v instanceof Date?(E.z=r.dateNF||nn[14],r.cellDates?(E.t="d",E.w=Is(E.z,Sr(E.v))):(E.t="n",E.v=Sr(E.v),E.w=Is(E.z,E.v))):E.t="s";if(a)o[w]||(o[w]=[]),o[w][T]&&o[w][T].z&&(E.z=o[w][T].z),o[w][T]=E;else{var b=Ft({c:T,r:w});o[b]&&o[b].z&&(E.z=o[b].z),o[b]=E}}}return m.s.c<1e7&&(o["!ref"]=_n(m)),o}function nu(t,e){return TA(null,t,e)}function x8(t){return t.read_shift(4,"i")}function gi(t,e){return e||(e=ge(4)),e.write_shift(4,t),e}function rr(t){var e=t.read_shift(4);return e===0?"":t.read_shift(e,"dbcs")}function Pn(t,e){var n=!1;return e==null&&(n=!0,e=ge(4+2*t.length)),e.write_shift(4,t.length),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}function E8(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function T8(t,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function d1(t,e){var n=t.l,r=t.read_shift(1),a=rr(t),o=[],u={t:a,h:a};if((r&1)!==0){for(var f=t.read_shift(4),h=0;h!=f;++h)o.push(E8(t));u.r=o}else u.r=[{ich:0,ifnt:0}];return t.l=n+e,u}function w8(t,e){var n=!1;return e==null&&(n=!0,e=ge(15+4*t.t.length)),e.write_shift(1,0),Pn(t.t,e),n?e.slice(0,e.l):e}var A8=d1;function S8(t,e){var n=!1;return e==null&&(n=!0,e=ge(23+4*t.t.length)),e.write_shift(1,1),Pn(t.t,e),e.write_shift(4,1),T8({},e),n?e.slice(0,e.l):e}function ii(t){var e=t.read_shift(4),n=t.read_shift(2);return n+=t.read_shift(1)<<16,t.l++,{c:e,iStyleRef:n}}function No(t,e){return e==null&&(e=ge(8)),e.write_shift(-4,t.c),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}function Do(t){var e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:e}}function Oo(t,e){return e==null&&(e=ge(4)),e.write_shift(3,t.iStyleRef||t.s),e.write_shift(1,0),e}var b8=rr,wA=Pn;function m1(t){var e=t.read_shift(4);return e===0||e===4294967295?"":t.read_shift(e,"dbcs")}function h0(t,e){var n=!1;return e==null&&(n=!0,e=ge(127)),e.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&e.write_shift(0,t,"dbcs"),n?e.slice(0,e.l):e}var R8=rr,Kp=m1,p1=h0;function AA(t){var e=t.slice(t.l,t.l+4),n=e[0]&1,r=e[0]&2;t.l+=4;var a=r===0?f0([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):fo(e,0)>>2;return n?a/100:a}function SA(t,e){e==null&&(e=ge(4));var n=0,r=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?r=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(r=1,n=1),r)e.write_shift(-4,((n?a:t)<<2)+(n+2));else throw new Error("unsupported RkNumber "+t)}function bA(t){var e={s:{},e:{}};return e.s.r=t.read_shift(4),e.e.r=t.read_shift(4),e.s.c=t.read_shift(4),e.e.c=t.read_shift(4),e}function C8(t,e){return e||(e=ge(16)),e.write_shift(4,t.s.r),e.write_shift(4,t.e.r),e.write_shift(4,t.s.c),e.write_shift(4,t.e.c),e}var Fo=bA,ru=C8;function iu(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function To(t,e){return(e||ge(8)).write_shift(8,t,"f")}function I8(t){var e={},n=t.read_shift(1),r=n>>>1,a=t.read_shift(1),o=t.read_shift(2,"i"),u=t.read_shift(1),f=t.read_shift(1),h=t.read_shift(1);switch(t.l++,r){case 0:e.auto=1;break;case 1:e.index=a;var m=V8[a];m&&(e.rgb=iE(m));break;case 2:e.rgb=iE([u,f,h]);break;case 3:e.theme=a;break}return o!=0&&(e.tint=o>0?o/32767:o/32768),e}function d0(t,e){if(e||(e=ge(8)),!t||t.auto)return e.write_shift(4,0),e.write_shift(4,0),e;t.index!=null?(e.write_shift(1,2),e.write_shift(1,t.index)):t.theme!=null?(e.write_shift(1,6),e.write_shift(1,t.theme)):(e.write_shift(1,5),e.write_shift(1,0));var n=t.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),e.write_shift(2,n),!t.rgb||t.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var r=t.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),e.write_shift(1,parseInt(r.slice(0,2),16)),e.write_shift(1,parseInt(r.slice(2,4),16)),e.write_shift(1,parseInt(r.slice(4,6),16)),e.write_shift(1,255)}return e}function N8(t){var e=t.read_shift(1);t.l++;var n={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return n}function D8(t,e){e||(e=ge(2));var n=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return e.write_shift(1,n),e.write_shift(1,0),e}var RA=2,kr=3,Nh=11,m0=19,Dh=64,O8=65,F8=71,M8=4108,P8=4126,jn=80,Y2={1:{n:"CodePage",t:RA},2:{n:"Category",t:jn},3:{n:"PresentationFormat",t:jn},4:{n:"ByteCount",t:kr},5:{n:"LineCount",t:kr},6:{n:"ParagraphCount",t:kr},7:{n:"SlideCount",t:kr},8:{n:"NoteCount",t:kr},9:{n:"HiddenCount",t:kr},10:{n:"MultimediaClipCount",t:kr},11:{n:"ScaleCrop",t:Nh},12:{n:"HeadingPairs",t:M8},13:{n:"TitlesOfParts",t:P8},14:{n:"Manager",t:jn},15:{n:"Company",t:jn},16:{n:"LinksUpToDate",t:Nh},17:{n:"CharacterCount",t:kr},19:{n:"SharedDoc",t:Nh},22:{n:"HyperlinksChanged",t:Nh},23:{n:"AppVersion",t:kr,p:"version"},24:{n:"DigSig",t:O8},26:{n:"ContentType",t:jn},27:{n:"ContentStatus",t:jn},28:{n:"Language",t:jn},29:{n:"Version",t:jn},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}},W2={1:{n:"CodePage",t:RA},2:{n:"Title",t:jn},3:{n:"Subject",t:jn},4:{n:"Author",t:jn},5:{n:"Keywords",t:jn},6:{n:"Comments",t:jn},7:{n:"Template",t:jn},8:{n:"LastAuthor",t:jn},9:{n:"RevNumber",t:jn},10:{n:"EditTime",t:Dh},11:{n:"LastPrinted",t:Dh},12:{n:"CreatedDate",t:Dh},13:{n:"ModifiedDate",t:Dh},14:{n:"PageCount",t:kr},15:{n:"WordCount",t:kr},16:{n:"CharCount",t:kr},17:{n:"Thumbnail",t:F8},18:{n:"Application",t:jn},19:{n:"DocSecurity",t:kr},255:{},2147483648:{n:"Locale",t:m0},2147483651:{n:"Behavior",t:m0},1919054434:{}};function k8(t){return t.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var L8=k8([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),V8=br(L8),tf={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},B8={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Oh={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function CA(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function IA(t,e){var n=WO(B8),r=[],a;r[r.length]=yn,r[r.length]=Ne("Types",null,{xmlns:Fn.CT,"xmlns:xsd":Fn.xsd,"xmlns:xsi":Fn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(h){return Ne("Default",null,{Extension:h[0],ContentType:h[1]})}));var o=function(h){t[h]&&t[h].length>0&&(a=t[h][0],r[r.length]=Ne("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Oh[h][e.bookType]||Oh[h].xlsx}))},u=function(h){(t[h]||[]).forEach(function(m){r[r.length]=Ne("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:Oh[h][e.bookType]||Oh[h].xlsx})})},f=function(h){(t[h]||[]).forEach(function(m){r[r.length]=Ne("Override",null,{PartName:(m[0]=="/"?"":"/")+m,ContentType:n[h][0]})})};return o("workbooks"),u("sheets"),u("charts"),f("themes"),["strs","styles"].forEach(o),["coreprops","extprops","custprops"].forEach(f),f("vba"),f("comments"),f("threadedcomments"),f("drawings"),u("metadata"),f("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var wt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function NA(t){var e=t.lastIndexOf("/");return t.slice(0,e+1)+"_rels/"+t.slice(e+1)+".rels"}function kl(t){var e=[yn,Ne("Relationships",null,{xmlns:Fn.RELS})];return Yn(t["!id"]).forEach(function(n){e[e.length]=Ne("Relationship",null,t["!id"][n])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Dt(t,e,n,r,a,o){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),e<0)for(e=t["!idx"];t["!id"]["rId"+e];++e);if(t["!idx"]=e+1,a.Id="rId"+e,a.Type=r,a.Target=n,[wt.HLINK,wt.XPATH,wt.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+e);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,e}function U8(t){var e=[yn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<t.length;++n)e.push('  <manifest:file-entry manifest:full-path="'+t[n][0]+'" manifest:media-type="'+t[n][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function K2(t,e,n){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function j8(t,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function z8(t){var e=[yn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=t.length;++n)e.push(K2(t[n][0],t[n][1])),e.push(j8("",t[n][0]));return e.push(K2("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function DA(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+a0.version+"</meta:generator></office:meta></office:document-meta>"}var go=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function vp(t,e,n,r,a){a[t]!=null||e==null||e===""||(a[t]=e,e=Ot(e),r[r.length]=n?Ne(t,e,n):qn(t,e))}function OA(t,e){var n=e||{},r=[yn,Ne("cp:coreProperties",null,{"xmlns:cp":Fn.CORE_PROPS,"xmlns:dc":Fn.dc,"xmlns:dcterms":Fn.dcterms,"xmlns:dcmitype":Fn.dcmitype,"xmlns:xsi":Fn.xsi})],a={};if(!t&&!n.Props)return r.join("");t&&(t.CreatedDate!=null&&vp("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Wp(t.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a),t.ModifiedDate!=null&&vp("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Wp(t.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,a));for(var o=0;o!=go.length;++o){var u=go[o],f=n.Props&&n.Props[u[1]]!=null?n.Props[u[1]]:t?t[u[1]]:null;f===!0?f="1":f===!1?f="0":typeof f=="number"&&(f=String(f)),f!=null&&vp(u[0],f,null,r,a)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ll=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],FA=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function MA(t){var e=[],n=Ne;return t||(t={}),t.Application="SheetJS",e[e.length]=yn,e[e.length]=Ne("Properties",null,{xmlns:Fn.EXT_PROPS,"xmlns:vt":Fn.vt}),Ll.forEach(function(r){if(t[r[1]]!==void 0){var a;switch(r[2]){case"string":a=Ot(String(t[r[1]]));break;case"bool":a=t[r[1]]?"true":"false";break}a!==void 0&&(e[e.length]=n(r[0],a))}}),e[e.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=n("TitlesOfParts",n("vt:vector",t.SheetNames.map(function(r){return"<vt:lpstr>"+Ot(r)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function PA(t){var e=[yn,Ne("Properties",null,{xmlns:Fn.CUST_PROPS,"xmlns:vt":Fn.vt})];if(!t)return e.join("");var n=1;return Yn(t).forEach(function(a){++n,e[e.length]=Ne("property",s8(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:Ot(a)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var Q2={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function H8(t,e){var n=[];return Yn(Q2).map(function(r){for(var a=0;a<go.length;++a)if(go[a][1]==r)return go[a];for(a=0;a<Ll.length;++a)if(Ll[a][1]==r)return Ll[a];throw r}).forEach(function(r){if(t[r[1]]!=null){var a=e&&e.Props&&e.Props[r[1]]!=null?e.Props[r[1]]:t[r[1]];switch(r[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),n.push(qn(Q2[r[1]]||r[1],a))}}),Ne("DocumentProperties",n.join(""),{xmlns:Vr.o})}function G8(t,e){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",a=[];return t&&Yn(t).forEach(function(o){if(Object.prototype.hasOwnProperty.call(t,o)){for(var u=0;u<go.length;++u)if(o==go[u][1])return;for(u=0;u<Ll.length;++u)if(o==Ll[u][1])return;for(u=0;u<n.length;++u)if(o==n[u])return;var f=t[o],h="string";typeof f=="number"?(h="float",f=String(f)):f===!0||f===!1?(h="boolean",f=f?"1":"0"):f=String(f),a.push(Ne(V2(o),f,{"dt:dt":h}))}}),e&&Yn(e).forEach(function(o){if(Object.prototype.hasOwnProperty.call(e,o)&&!(t&&Object.prototype.hasOwnProperty.call(t,o))){var u=e[o],f="string";typeof u=="number"?(f="float",u=String(u)):u===!0||u===!1?(f="boolean",u=u?"1":"0"):u instanceof Date?(f="dateTime.tz",u=u.toISOString()):u=String(u),a.push(Ne(V2(o),u,{"dt:dt":f}))}}),"<"+r+' xmlns="'+Vr.o+'">'+a.join("")+"</"+r+">"}function q8(t){var e=typeof t=="string"?new Date(Date.parse(t)):t,n=e.getTime()/1e3+11644473600,r=n%Math.pow(2,32),a=(n-r)/Math.pow(2,32);r*=1e7,a*=1e7;var o=r/Math.pow(2,32)|0;o>0&&(r=r%Math.pow(2,32),a+=o);var u=ge(8);return u.write_shift(4,r),u.write_shift(4,a),u}function Z2(t,e){var n=ge(4),r=ge(4);switch(n.write_shift(4,t==80?31:t),t){case 3:r.write_shift(-4,e);break;case 5:r=ge(8),r.write_shift(8,e,"f");break;case 11:r.write_shift(4,e?1:0);break;case 64:r=q8(e);break;case 31:case 80:for(r=ge(4+2*(e.length+1)+(e.length%2?0:2)),r.write_shift(4,e.length+1),r.write_shift(0,e,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+e)}return Gn([n,r])}var kA=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function $8(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function J2(t,e,n){var r=ge(8),a=[],o=[],u=8,f=0,h=ge(8),m=ge(8);if(h.write_shift(4,2),h.write_shift(4,1200),m.write_shift(4,1),o.push(h),a.push(m),u+=8+h.length,!e){m=ge(8),m.write_shift(4,0),a.unshift(m);var g=[ge(4)];for(g[0].write_shift(4,t.length),f=0;f<t.length;++f){var y=t[f][0];for(h=ge(8+2*(y.length+1)+(y.length%2?0:2)),h.write_shift(4,f+2),h.write_shift(4,y.length+1),h.write_shift(0,y,"dbcs");h.l!=h.length;)h.write_shift(1,0);g.push(h)}h=Gn(g),o.unshift(h),u+=8+h.length}for(f=0;f<t.length;++f)if(!(e&&!e[t[f][0]])&&!(kA.indexOf(t[f][0])>-1||FA.indexOf(t[f][0])>-1)&&t[f][1]!=null){var _=t[f][1],E=0;if(e){E=+e[t[f][0]];var w=n[E];if(w.p=="version"&&typeof _=="string"){var T=_.split(".");_=(+T[0]<<16)+(+T[1]||0)}h=Z2(w.t,_)}else{var b=$8(_);b==-1&&(b=31,_=String(_)),h=Z2(b,_)}o.push(h),m=ge(8),m.write_shift(4,e?E:2+f),a.push(m),u+=8+h.length}var k=8*(o.length+1);for(f=0;f<o.length;++f)a[f].write_shift(4,k),k+=o[f].length;return r.write_shift(4,u),r.write_shift(4,o.length),Gn([r].concat(a).concat(o))}function eE(t,e,n,r,a,o){var u=ge(a?68:48),f=[u];u.write_shift(2,65534),u.write_shift(2,0),u.write_shift(4,842412599),u.write_shift(16,Vt.utils.consts.HEADER_CLSID,"hex"),u.write_shift(4,a?2:1),u.write_shift(16,e,"hex"),u.write_shift(4,a?68:48);var h=J2(t,n,r);if(f.push(h),a){var m=J2(a,null,null);u.write_shift(16,o,"hex"),u.write_shift(4,68+h.length),f.push(m)}return Gn(f)}function X8(t,e){e||(e=ge(t));for(var n=0;n<t;++n)e.write_shift(1,0);return e}function Y8(t,e){return t.read_shift(e)===1}function hr(t,e){return e||(e=ge(2)),e.write_shift(2,+!!t),e}function LA(t){return t.read_shift(2,"u")}function ei(t,e){return e||(e=ge(2)),e.write_shift(2,t),e}function VA(t,e,n){return n||(n=ge(2)),n.write_shift(1,e=="e"?+t:+!!t),n.write_shift(1,e=="e"?1:0),n}function BA(t,e,n){var r=t.read_shift(n&&n.biff>=12?2:1),a="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var o=t.read_shift(1);o&&(a="dbcs-cont")}else n.biff==12&&(a="wstr");n.biff>=2&&n.biff<=5&&(a="cpstr");var u=r?t.read_shift(r,a):"";return u}function W8(t){var e=t.t||"",n=ge(3);n.write_shift(2,e.length),n.write_shift(1,1);var r=ge(2*e.length);r.write_shift(2*e.length,e,"utf16le");var a=[n,r];return Gn(a)}function K8(t,e,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return t.read_shift(e,"cpstr");if(n.biff>=12)return t.read_shift(e,"dbcs-cont")}var a=t.read_shift(1);return a===0?r=t.read_shift(e,"sbcs-cont"):r=t.read_shift(e,"dbcs-cont"),r}function Q8(t,e,n){var r=t.read_shift(n&&n.biff==2?1:2);return r===0?(t.l++,""):K8(t,r,n)}function Z8(t,e,n){if(n.biff>5)return Q8(t,e,n);var r=t.read_shift(1);return r===0?(t.l++,""):t.read_shift(r,n.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function UA(t,e,n){return n||(n=ge(3+2*t.length)),n.write_shift(2,t.length),n.write_shift(1,1),n.write_shift(31,t,"utf16le"),n}function tE(t,e){e||(e=ge(6+t.length*2)),e.write_shift(4,1+t.length);for(var n=0;n<t.length;++n)e.write_shift(2,t.charCodeAt(n));return e.write_shift(2,0),e}function J8(t){var e=ge(512),n=0,r=t.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var a=r.indexOf("#"),o=a>-1?31:23;switch(r.charAt(0)){case"#":o=28;break;case".":o&=-3;break}e.write_shift(4,2),e.write_shift(4,o);var u=[8,6815827,6619237,4849780,83];for(n=0;n<u.length;++n)e.write_shift(4,u[n]);if(o==28)r=r.slice(1),tE(r,e);else if(o&2){for(u="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<u.length;++n)e.write_shift(1,parseInt(u[n],16));var f=a>-1?r.slice(0,a):r;for(e.write_shift(4,2*(f.length+1)),n=0;n<f.length;++n)e.write_shift(2,f.charCodeAt(n));e.write_shift(2,0),o&8&&tE(a>-1?r.slice(a+1):"",e)}else{for(u="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<u.length;++n)e.write_shift(1,parseInt(u[n],16));for(var h=0;r.slice(h*3,h*3+3)=="../"||r.slice(h*3,h*3+3)=="..\\";)++h;for(e.write_shift(2,h),e.write_shift(4,r.length-3*h+1),n=0;n<r.length-3*h;++n)e.write_shift(1,r.charCodeAt(n+3*h)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),n=0;n<6;++n)e.write_shift(4,0)}return e.slice(0,e.l)}function wo(t,e,n,r){return r||(r=ge(6)),r.write_shift(2,t),r.write_shift(2,e),r.write_shift(2,n||0),r}function e5(t,e,n){var r=n.biff>8?4:2,a=t.read_shift(r),o=t.read_shift(r,"i"),u=t.read_shift(r,"i");return[a,o,u]}function t5(t){var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(2),a=t.read_shift(2);return{s:{c:r,r:e},e:{c:a,r:n}}}function jA(t,e){return e||(e=ge(8)),e.write_shift(2,t.s.r),e.write_shift(2,t.e.r),e.write_shift(2,t.s.c),e.write_shift(2,t.e.c),e}function g1(t,e,n){var r=1536,a=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,a=8;break;case"biff4":r=4,a=6;break;case"biff3":r=3,a=6;break;case"biff2":r=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var o=ge(a);return o.write_shift(2,r),o.write_shift(2,e),a>4&&o.write_shift(2,29282),a>6&&o.write_shift(2,1997),a>8&&(o.write_shift(2,49161),o.write_shift(2,1),o.write_shift(2,1798),o.write_shift(2,0)),o}function n5(t,e){var n=!e||e.biff==8,r=ge(n?112:54);for(r.write_shift(e.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function r5(t,e){var n=!e||e.biff>=8?2:1,r=ge(8+n*t.name.length);r.write_shift(4,t.pos),r.write_shift(1,t.hs||0),r.write_shift(1,t.dt),r.write_shift(1,t.name.length),e.biff>=8&&r.write_shift(1,1),r.write_shift(n*t.name.length,t.name,e.biff<8?"sbcs":"utf16le");var a=r.slice(0,r.l);return a.l=r.l,a}function i5(t,e){var n=ge(8);n.write_shift(4,t.Count),n.write_shift(4,t.Unique);for(var r=[],a=0;a<t.length;++a)r[a]=W8(t[a]);var o=Gn([n].concat(r));return o.parts=[n.length].concat(r.map(function(u){return u.length})),o}function a5(){var t=ge(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function s5(t){var e=ge(18),n=1718;return t&&t.RTL&&(n|=64),e.write_shift(2,n),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function o5(t,e){var n=t.name||"Arial",r=e&&e.biff==5,a=r?15+n.length:16+2*n.length,o=ge(a);return o.write_shift(2,t.sz*20),o.write_shift(4,0),o.write_shift(2,400),o.write_shift(4,0),o.write_shift(2,0),o.write_shift(1,n.length),r||o.write_shift(1,1),o.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),o}function l5(t,e,n,r){var a=ge(10);return wo(t,e,r,a),a.write_shift(4,n),a}function u5(t,e,n,r,a){var o=!a||a.biff==8,u=ge(8+ +o+(1+o)*n.length);return wo(t,e,r,u),u.write_shift(2,n.length),o&&u.write_shift(1,1),u.write_shift((1+o)*n.length,n,o?"utf16le":"sbcs"),u}function c5(t,e,n,r){var a=n&&n.biff==5;r||(r=ge(a?3+e.length:5+2*e.length)),r.write_shift(2,t),r.write_shift(a?1:2,e.length),a||r.write_shift(1,1),r.write_shift((a?1:2)*e.length,e,a?"sbcs":"utf16le");var o=r.length>r.l?r.slice(0,r.l):r;return o.l==null&&(o.l=o.length),o}function f5(t,e){var n=e.biff==8||!e.biff?4:2,r=ge(2*n+6);return r.write_shift(n,t.s.r),r.write_shift(n,t.e.r+1),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c+1),r.write_shift(2,0),r}function nE(t,e,n,r){var a=n&&n.biff==5;r||(r=ge(a?16:20)),r.write_shift(2,0),t.style?(r.write_shift(2,t.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,t.numFmtId||0),r.write_shift(2,e<<4));var o=0;return t.numFmtId>0&&a&&(o|=1024),r.write_shift(4,o),r.write_shift(4,0),a||r.write_shift(4,0),r.write_shift(2,0),r}function h5(t){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function d5(t,e,n,r,a,o){var u=ge(8);return wo(t,e,r,u),VA(n,o,u),u}function m5(t,e,n,r){var a=ge(14);return wo(t,e,r,a),To(n,a),a}function p5(t,e,n){if(n.biff<8)return g5(t,e,n);for(var r=[],a=t.l+e,o=t.read_shift(n.biff>8?4:2);o--!==0;)r.push(e5(t,n.biff>8?12:6,n));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return r}function g5(t,e,n){t[t.l+1]==3&&t[t.l]++;var r=BA(t,e,n);return r.charCodeAt(0)==3?r.slice(1):r}function v5(t){var e=ge(2+t.length*8);e.write_shift(2,t.length);for(var n=0;n<t.length;++n)jA(t[n],e);return e}function _5(t){var e=ge(24),n=Mn(t[0]);e.write_shift(2,n.r),e.write_shift(2,n.r),e.write_shift(2,n.c),e.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)e.write_shift(1,parseInt(r[a],16));return Gn([e,J8(t[1])])}function y5(t){var e=t[1].Tooltip,n=ge(10+2*(e.length+1));n.write_shift(2,2048);var r=Mn(t[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var a=0;a<e.length;++a)n.write_shift(2,e.charCodeAt(a));return n.write_shift(2,0),n}function x5(t){return t||(t=ge(4)),t.write_shift(2,1),t.write_shift(2,1),t}function E5(t,e,n){if(!n.cellStyles)return Ki(t,e);var r=n&&n.biff>=12?4:2,a=t.read_shift(r),o=t.read_shift(r),u=t.read_shift(r),f=t.read_shift(r),h=t.read_shift(2);r==2&&(t.l+=2);var m={s:a,e:o,w:u,ixfe:f,flags:h};return(n.biff>=5||!n.biff)&&(m.level=h>>8&7),m}function T5(t,e){var n=ge(12);n.write_shift(2,e),n.write_shift(2,e),n.write_shift(2,t.width*256),n.write_shift(2,0);var r=0;return t.hidden&&(r|=1),n.write_shift(1,r),r=t.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function w5(t){for(var e=ge(2*t),n=0;n<t;++n)e.write_shift(2,n+1);return e}function A5(t,e,n){var r=ge(15);return rf(r,t,e),r.write_shift(8,n,"f"),r}function S5(t,e,n){var r=ge(9);return rf(r,t,e),r.write_shift(2,n),r}var b5=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=a1({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(f,h){var m=[],g=Eo(1);switch(h.type){case"base64":g=di(Da(f));break;case"binary":g=di(f);break;case"buffer":case"array":g=f;break}Lr(g,0);var y=g.read_shift(1),_=!!(y&136),E=!1,w=!1;switch(y){case 2:break;case 3:break;case 48:E=!0,_=!0;break;case 49:E=!0,_=!0;break;case 131:break;case 139:break;case 140:w=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+y.toString(16))}var T=0,b=521;y==2&&(T=g.read_shift(2)),g.l+=3,y!=2&&(T=g.read_shift(4)),T>1048576&&(T=1e6),y!=2&&(b=g.read_shift(2));var k=g.read_shift(2),q=h.codepage||1252;y!=2&&(g.l+=16,g.read_shift(1),g[g.l]!==0&&(q=t[g[g.l]]),g.l+=1,g.l+=2),w&&(g.l+=36);for(var X=[],ee={},he=Math.min(g.length,y==2?521:b-10-(E?264:0)),Ae=w?32:11;g.l<he&&g[g.l]!=13;)switch(ee={},ee.name=s0.utils.decode(q,g.slice(g.l,g.l+Ae)).replace(/[\u0000\r\n].*$/g,""),g.l+=Ae,ee.type=String.fromCharCode(g.read_shift(1)),y!=2&&!w&&(ee.offset=g.read_shift(4)),ee.len=g.read_shift(1),y==2&&(ee.offset=g.read_shift(2)),ee.dec=g.read_shift(1),ee.name.length&&X.push(ee),y!=2&&(g.l+=w?13:14),ee.type){case"B":(!E||ee.len!=8)&&h.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"G":case"P":h.WTF&&console.log("Skipping "+ee.name+":"+ee.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+ee.type)}if(g[g.l]!==13&&(g.l=b-1),g.read_shift(1)!==13)throw new Error("DBF Terminator not found "+g.l+" "+g[g.l]);g.l=b;var N=0,I=0;for(m[0]=[],I=0;I!=X.length;++I)m[0][I]=X[I].name;for(;T-- >0;){if(g[g.l]===42){g.l+=k;continue}for(++g.l,m[++N]=[],I=0,I=0;I!=X.length;++I){var R=g.slice(g.l,g.l+X[I].len);g.l+=X[I].len,Lr(R,0);var M=s0.utils.decode(q,R);switch(X[I].type){case"C":M.trim().length&&(m[N][I]=M.replace(/\s+$/,""));break;case"D":M.length===8?m[N][I]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):m[N][I]=M;break;case"F":m[N][I]=parseFloat(M.trim());break;case"+":case"I":m[N][I]=w?R.read_shift(-4,"i")^2147483648:R.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":m[N][I]=!0;break;case"N":case"F":m[N][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+y.toString(16));m[N][I]="##MEMO##"+(w?parseInt(M.trim(),10):R.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(m[N][I]=+M||0);break;case"@":m[N][I]=new Date(R.read_shift(-8,"f")-621356832e5);break;case"T":m[N][I]=new Date((R.read_shift(4)-2440588)*864e5+R.read_shift(4));break;case"Y":m[N][I]=R.read_shift(4,"i")/1e4+R.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":m[N][I]=-R.read_shift(-8,"f");break;case"B":if(E&&X[I].len==8){m[N][I]=R.read_shift(8,"f");break}case"G":case"P":R.l+=X[I].len;break;case"0":if(X[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+X[I].type)}}}if(y!=2&&g.l<g.length&&g[g.l++]!=26)throw new Error("DBF EOF Marker missing "+(g.l-1)+" of "+g.length+" "+g[g.l-1].toString(16));return h&&h.sheetRows&&(m=m.slice(0,h.sheetRows)),h.DBF=X,m}function r(f,h){var m=h||{};m.dateNF||(m.dateNF="yyyymmdd");var g=nu(n(f,m),m);return g["!cols"]=m.DBF.map(function(y){return{wch:y.len,DBF:y}}),delete m.DBF,g}function a(f,h){try{return Io(r(f,h),h)}catch(m){if(h&&h.WTF)throw m}return{SheetNames:[],Sheets:{}}}var o={B:8,C:250,L:1,D:8,"?":0,"":0};function u(f,h){var m=h||{};if(+m.codepage>=0&&Pc(+m.codepage),m.type=="string")throw new Error("Cannot write DBF to JS string");var g=Ar(),y=y0(f,{header:1,raw:!0,cellDates:!0}),_=y[0],E=y.slice(1),w=f["!cols"]||[],T=0,b=0,k=0,q=1;for(T=0;T<_.length;++T){if(((w[T]||{}).DBF||{}).name){_[T]=w[T].DBF.name,++k;continue}if(_[T]!=null){if(++k,typeof _[T]=="number"&&(_[T]=_[T].toString(10)),typeof _[T]!="string")throw new Error("DBF Invalid column name "+_[T]+" |"+typeof _[T]+"|");if(_.indexOf(_[T])!==T){for(b=0;b<1024;++b)if(_.indexOf(_[T]+"_"+b)==-1){_[T]+="_"+b;break}}}}var X=$t(f["!ref"]),ee=[],he=[],Ae=[];for(T=0;T<=X.e.c-X.s.c;++T){var N="",I="",R=0,M=[];for(b=0;b<E.length;++b)E[b][T]!=null&&M.push(E[b][T]);if(M.length==0||_[T]==null){ee[T]="?";continue}for(b=0;b<M.length;++b){switch(typeof M[b]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=M[b]instanceof Date?"D":"C";break;default:I="C"}R=Math.max(R,String(M[b]).length),N=N&&N!=I?"C":I}R>250&&(R=250),I=((w[T]||{}).DBF||{}).type,I=="C"&&w[T].DBF.len>R&&(R=w[T].DBF.len),N=="B"&&I=="N"&&(N="N",Ae[T]=w[T].DBF.dec,R=w[T].DBF.len),he[T]=N=="C"||I=="N"?R:o[N]||0,q+=he[T],ee[T]=N}var B=g.next(32);for(B.write_shift(4,318902576),B.write_shift(4,E.length),B.write_shift(2,296+32*k),B.write_shift(2,q),T=0;T<4;++T)B.write_shift(4,0);for(B.write_shift(4,0|(+e[Hw]||3)<<8),T=0,b=0;T<_.length;++T)if(_[T]!=null){var H=g.next(32),V=(_[T].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,V,"sbcs"),H.write_shift(1,ee[T]=="?"?"C":ee[T],"sbcs"),H.write_shift(4,b),H.write_shift(1,he[T]||o[ee[T]]||0),H.write_shift(1,Ae[T]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),b+=he[T]||o[ee[T]]||0}var Je=g.next(264);for(Je.write_shift(4,13),T=0;T<65;++T)Je.write_shift(4,0);for(T=0;T<E.length;++T){var He=g.next(q);for(He.write_shift(1,0),b=0;b<_.length;++b)if(_[b]!=null)switch(ee[b]){case"L":He.write_shift(1,E[T][b]==null?63:E[T][b]?84:70);break;case"B":He.write_shift(8,E[T][b]||0,"f");break;case"N":var de="0";for(typeof E[T][b]=="number"&&(de=E[T][b].toFixed(Ae[b]||0)),k=0;k<he[b]-de.length;++k)He.write_shift(1,32);He.write_shift(1,de,"sbcs");break;case"D":E[T][b]?(He.write_shift(4,("0000"+E[T][b].getFullYear()).slice(-4),"sbcs"),He.write_shift(2,("00"+(E[T][b].getMonth()+1)).slice(-2),"sbcs"),He.write_shift(2,("00"+E[T][b].getDate()).slice(-2),"sbcs")):He.write_shift(8,"00000000","sbcs");break;case"C":var Re=String(E[T][b]!=null?E[T][b]:"").slice(0,he[b]);for(He.write_shift(1,Re,"sbcs"),k=0;k<he[b]-Re.length;++k)He.write_shift(1,32);break}}return g.next(1).write_shift(1,26),g.end()}return{to_workbook:a,to_sheet:r,from_sheet:u}}(),R5=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Yn(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(_,E){var w=t[E];return typeof w=="number"?b2(w):w},r=function(_,E,w){var T=E.charCodeAt(0)-32<<4|w.charCodeAt(0)-48;return T==59?_:b2(T)};t["|"]=254;function a(_,E){switch(E.type){case"base64":return o(Da(_),E);case"binary":return o(_,E);case"buffer":return o(St&&Buffer.isBuffer(_)?_.toString("binary"):Zc(_),E);case"array":return o($0(_),E)}throw new Error("Unrecognized type "+E.type)}function o(_,E){var w=_.split(/[\n\r]+/),T=-1,b=-1,k=0,q=0,X=[],ee=[],he=null,Ae={},N=[],I=[],R=[],M=0,B;for(+E.codepage>=0&&Pc(+E.codepage);k!==w.length;++k){M=0;var H=w[k].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(e,n),V=H.replace(/;;/g,"\0").split(";").map(function(Z){return Z.replace(/\u0000/g,";")}),Je=V[0],He;if(H.length>0)switch(Je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":V[1].charAt(0)=="P"&&ee.push(H.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,Re=!1,ze=!1,Ye=!1,Q=-1,xe=-1;for(q=1;q<V.length;++q)switch(V[q].charAt(0)){case"A":break;case"X":b=parseInt(V[q].slice(1))-1,Re=!0;break;case"Y":for(T=parseInt(V[q].slice(1))-1,Re||(b=0),B=X.length;B<=T;++B)X[B]=[];break;case"K":He=V[q].slice(1),He.charAt(0)==='"'?He=He.slice(1,He.length-1):He==="TRUE"?He=!0:He==="FALSE"?He=!1:isNaN(Aa(He))?isNaN(Lc(He).getDate())||(He=dr(He)):(He=Aa(He),he!==null&&tA(he)&&(He=aA(He))),de=!0;break;case"E":Ye=!0;var U=SF(V[q].slice(1),{r:T,c:b});X[T][b]=[X[T][b],U];break;case"S":ze=!0,X[T][b]=[X[T][b],"S5S"];break;case"G":break;case"R":Q=parseInt(V[q].slice(1))-1;break;case"C":xe=parseInt(V[q].slice(1))-1;break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}if(de&&(X[T][b]&&X[T][b].length==2?X[T][b][0]=He:X[T][b]=He,he=null),ze){if(Ye)throw new Error("SYLK shared formula cannot have own formula");var W=Q>-1&&X[Q][xe];if(!W||!W[1])throw new Error("SYLK shared formula cannot find base");X[T][b][1]=bF(W[1],{r:T-Q,c:b-xe})}break;case"F":var K=0;for(q=1;q<V.length;++q)switch(V[q].charAt(0)){case"X":b=parseInt(V[q].slice(1))-1,++K;break;case"Y":for(T=parseInt(V[q].slice(1))-1,B=X.length;B<=T;++B)X[B]=[];break;case"M":M=parseInt(V[q].slice(1))/20;break;case"F":break;case"G":break;case"P":he=ee[parseInt(V[q].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(R=V[q].slice(1).split(" "),B=parseInt(R[0],10);B<=parseInt(R[1],10);++B)M=parseInt(R[2],10),I[B-1]=M===0?{hidden:!0}:{wch:M},v1(I[B-1]);break;case"C":b=parseInt(V[q].slice(1))-1,I[b]||(I[b]={});break;case"R":T=parseInt(V[q].slice(1))-1,N[T]||(N[T]={}),M>0?(N[T].hpt=M,N[T].hpx=$A(M)):M===0&&(N[T].hidden=!0);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}K<1&&(he=null);break;default:if(E&&E.WTF)throw new Error("SYLK bad record "+H)}}return N.length>0&&(Ae["!rows"]=N),I.length>0&&(Ae["!cols"]=I),E&&E.sheetRows&&(X=X.slice(0,E.sheetRows)),[X,Ae]}function u(_,E){var w=a(_,E),T=w[0],b=w[1],k=nu(T,E);return Yn(b).forEach(function(q){k[q]=b[q]}),k}function f(_,E){return Io(u(_,E),E)}function h(_,E,w,T){var b="C;Y"+(w+1)+";X"+(T+1)+";K";switch(_.t){case"n":b+=_.v||0,_.f&&!_.F&&(b+=";E"+y1(_.f,{r:w,c:T}));break;case"b":b+=_.v?"TRUE":"FALSE";break;case"e":b+=_.w||_.v;break;case"d":b+='"'+(_.w||_.v)+'"';break;case"s":b+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return b}function m(_,E){E.forEach(function(w,T){var b="F;W"+(T+1)+" "+(T+1)+" ";w.hidden?b+="0":(typeof w.width=="number"&&!w.wpx&&(w.wpx=p0(w.width)),typeof w.wpx=="number"&&!w.wch&&(w.wch=g0(w.wpx)),typeof w.wch=="number"&&(b+=Math.round(w.wch))),b.charAt(b.length-1)!=" "&&_.push(b)})}function g(_,E){E.forEach(function(w,T){var b="F;";w.hidden?b+="M0;":w.hpt?b+="M"+20*w.hpt+";":w.hpx&&(b+="M"+20*v0(w.hpx)+";"),b.length>2&&_.push(b+"R"+(T+1))})}function y(_,E){var w=["ID;PWXL;N;E"],T=[],b=$t(_["!ref"]),k,q=Array.isArray(_),X=`\r
`;w.push("P;PGeneral"),w.push("F;P0;DG0G8;M255"),_["!cols"]&&m(w,_["!cols"]),_["!rows"]&&g(w,_["!rows"]),w.push("B;Y"+(b.e.r-b.s.r+1)+";X"+(b.e.c-b.s.c+1)+";D"+[b.s.c,b.s.r,b.e.c,b.e.r].join(" "));for(var ee=b.s.r;ee<=b.e.r;++ee)for(var he=b.s.c;he<=b.e.c;++he){var Ae=Ft({r:ee,c:he});k=q?(_[ee]||[])[he]:_[Ae],!(!k||k.v==null&&(!k.f||k.F))&&T.push(h(k,_,ee,he))}return w.join(X)+X+T.join(X)+X+"E"+X}return{to_workbook:f,to_sheet:u,from_sheet:y}}(),C5=function(){function t(o,u){switch(u.type){case"base64":return e(Da(o),u);case"binary":return e(o,u);case"buffer":return e(St&&Buffer.isBuffer(o)?o.toString("binary"):Zc(o),u);case"array":return e($0(o),u)}throw new Error("Unrecognized type "+u.type)}function e(o,u){for(var f=o.split(`
`),h=-1,m=-1,g=0,y=[];g!==f.length;++g){if(f[g].trim()==="BOT"){y[++h]=[],m=0;continue}if(!(h<0)){var _=f[g].trim().split(","),E=_[0],w=_[1];++g;for(var T=f[g]||"";(T.match(/["]/g)||[]).length&1&&g<f.length-1;)T+=`
`+f[++g];switch(T=T.trim(),+E){case-1:if(T==="BOT"){y[++h]=[],m=0;continue}else if(T!=="EOD")throw new Error("Unrecognized DIF special command "+T);break;case 0:T==="TRUE"?y[h][m]=!0:T==="FALSE"?y[h][m]=!1:isNaN(Aa(w))?isNaN(Lc(w).getDate())?y[h][m]=w:y[h][m]=dr(w):y[h][m]=Aa(w),++m;break;case 1:T=T.slice(1,T.length-1),T=T.replace(/""/g,'"'),T&&T.match(/^=".*"$/)&&(T=T.slice(2,-1)),y[h][m++]=T!==""?T:null;break}if(T==="EOD")break}}return u&&u.sheetRows&&(y=y.slice(0,u.sheetRows)),y}function n(o,u){return nu(t(o,u),u)}function r(o,u){return Io(n(o,u),u)}var a=function(){var o=function(h,m,g,y,_){h.push(m),h.push(g+","+y),h.push('"'+_.replace(/"/g,'""')+'"')},u=function(h,m,g,y){h.push(m+","+g),h.push(m==1?'"'+y.replace(/"/g,'""')+'"':y)};return function(h){var m=[],g=$t(h["!ref"]),y,_=Array.isArray(h);o(m,"TABLE",0,1,"sheetjs"),o(m,"VECTORS",0,g.e.r-g.s.r+1,""),o(m,"TUPLES",0,g.e.c-g.s.c+1,""),o(m,"DATA",0,0,"");for(var E=g.s.r;E<=g.e.r;++E){u(m,-1,0,"BOT");for(var w=g.s.c;w<=g.e.c;++w){var T=Ft({r:E,c:w});if(y=_?(h[E]||[])[w]:h[T],!y){u(m,1,0,"");continue}switch(y.t){case"n":var b=y.w;!b&&y.v!=null&&(b=y.v),b==null?y.f&&!y.F?u(m,1,0,"="+y.f):u(m,1,0,""):u(m,0,b,"V");break;case"b":u(m,0,y.v?1:0,y.v?"TRUE":"FALSE");break;case"s":u(m,1,0,isNaN(y.v)?y.v:'="'+y.v+'"');break;case"d":y.w||(y.w=Is(y.z||nn[14],Sr(dr(y.v)))),u(m,0,y.w,"V");break;default:u(m,1,0,"")}}}u(m,-1,0,"EOD");var k=`\r
`,q=m.join(k);return q}}();return{to_workbook:r,to_sheet:n,from_sheet:a}}(),zA=function(){function t(y){return y.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(y){return y.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(y,_){for(var E=y.split(`
`),w=-1,T=-1,b=0,k=[];b!==E.length;++b){var q=E[b].trim().split(":");if(q[0]==="cell"){var X=Mn(q[1]);if(k.length<=X.r)for(w=k.length;w<=X.r;++w)k[w]||(k[w]=[]);switch(w=X.r,T=X.c,q[2]){case"t":k[w][T]=t(q[3]);break;case"v":k[w][T]=+q[3];break;case"vtf":var ee=q[q.length-1];case"vtc":switch(q[3]){case"nl":k[w][T]=!!+q[4];break;default:k[w][T]=+q[4];break}q[2]=="vtf"&&(k[w][T]=[k[w][T],ee])}}}return _&&_.sheetRows&&(k=k.slice(0,_.sheetRows)),k}function r(y,_){return nu(n(y,_),_)}function a(y,_){return Io(r(y,_),_)}var o=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),u=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,f=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),h="--SocialCalcSpreadsheetControlSave--";function m(y){if(!y||!y["!ref"])return"";for(var _=[],E=[],w,T="",b=Ur(y["!ref"]),k=Array.isArray(y),q=b.s.r;q<=b.e.r;++q)for(var X=b.s.c;X<=b.e.c;++X)if(T=Ft({r:q,c:X}),w=k?(y[q]||[])[X]:y[T],!(!w||w.v==null||w.t==="z")){switch(E=["cell",T,"t"],w.t){case"s":case"str":E.push(e(w.v));break;case"n":w.f?(E[2]="vtf",E[3]="n",E[4]=w.v,E[5]=e(w.f)):(E[2]="v",E[3]=w.v);break;case"b":E[2]="vt"+(w.f?"f":"c"),E[3]="nl",E[4]=w.v?"1":"0",E[5]=e(w.f||(w.v?"TRUE":"FALSE"));break;case"d":var ee=Sr(dr(w.v));E[2]="vtc",E[3]="nd",E[4]=""+ee,E[5]=w.w||Is(w.z||nn[14],ee);break;case"e":continue}_.push(E.join(":"))}return _.push("sheet:c:"+(b.e.c-b.s.c+1)+":r:"+(b.e.r-b.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function g(y){return[o,u,f,u,m(y),h].join(`
`)}return{to_workbook:a,to_sheet:r,from_sheet:g}}(),I5=function(){function t(g,y,_,E,w){w.raw?y[_][E]=g:g===""||(g==="TRUE"?y[_][E]=!0:g==="FALSE"?y[_][E]=!1:isNaN(Aa(g))?isNaN(Lc(g).getDate())?y[_][E]=g:y[_][E]=dr(g):y[_][E]=Aa(g))}function e(g,y){var _=y||{},E=[];if(!g||g.length===0)return E;for(var w=g.split(/[\r\n]/),T=w.length-1;T>=0&&w[T].length===0;)--T;for(var b=10,k=0,q=0;q<=T;++q)k=w[q].indexOf(" "),k==-1?k=w[q].length:k++,b=Math.max(b,k);for(q=0;q<=T;++q){E[q]=[];var X=0;for(t(w[q].slice(0,b).trim(),E,q,X,_),X=1;X<=(w[q].length-b)/10+1;++X)t(w[q].slice(b+(X-1)*10,b+X*10).trim(),E,q,X,_)}return _.sheetRows&&(E=E.slice(0,_.sheetRows)),E}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function a(g){for(var y={},_=!1,E=0,w=0;E<g.length;++E)(w=g.charCodeAt(E))==34?_=!_:!_&&w in n&&(y[w]=(y[w]||0)+1);w=[];for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E]);if(!w.length){y=r;for(E in y)Object.prototype.hasOwnProperty.call(y,E)&&w.push([y[E],E])}return w.sort(function(T,b){return T[0]-b[0]||r[T[1]]-r[b[1]]}),n[w.pop()[1]]||44}function o(g,y){var _=y||{},E="",w=_.dense?[]:{},T={s:{c:0,r:0},e:{c:0,r:0}};g.slice(0,4)=="sep="?g.charCodeAt(5)==13&&g.charCodeAt(6)==10?(E=g.charAt(4),g=g.slice(7)):g.charCodeAt(5)==13||g.charCodeAt(5)==10?(E=g.charAt(4),g=g.slice(6)):E=a(g.slice(0,1024)):_&&_.FS?E=_.FS:E=a(g.slice(0,1024));var b=0,k=0,q=0,X=0,ee=0,he=E.charCodeAt(0),Ae=!1,N=0,I=g.charCodeAt(0);g=g.replace(/\r\n/mg,`
`);var R=_.dateNF!=null?qO(_.dateNF):null;function M(){var B=g.slice(X,ee),H={};if(B.charAt(0)=='"'&&B.charAt(B.length-1)=='"'&&(B=B.slice(1,-1).replace(/""/g,'"')),B.length===0)H.t="z";else if(_.raw)H.t="s",H.v=B;else if(B.trim().length===0)H.t="s",H.v=B;else if(B.charCodeAt(0)==61)B.charCodeAt(1)==34&&B.charCodeAt(B.length-1)==34?(H.t="s",H.v=B.slice(2,-1).replace(/""/g,'"')):RF(B)?(H.t="n",H.f=B.slice(1)):(H.t="s",H.v=B);else if(B=="TRUE")H.t="b",H.v=!0;else if(B=="FALSE")H.t="b",H.v=!1;else if(!isNaN(q=Aa(B)))H.t="n",_.cellText!==!1&&(H.w=B),H.v=q;else if(!isNaN(Lc(B).getDate())||R&&B.match(R)){H.z=_.dateNF||nn[14];var V=0;R&&B.match(R)&&(B=$O(B,_.dateNF,B.match(R)||[]),V=1),_.cellDates?(H.t="d",H.v=dr(B,V)):(H.t="n",H.v=Sr(dr(B,V))),_.cellText!==!1&&(H.w=Is(H.z,H.v instanceof Date?Sr(H.v):H.v)),_.cellNF||delete H.z}else H.t="s",H.v=B;if(H.t=="z"||(_.dense?(w[b]||(w[b]=[]),w[b][k]=H):w[Ft({c:k,r:b})]=H),X=ee+1,I=g.charCodeAt(X),T.e.c<k&&(T.e.c=k),T.e.r<b&&(T.e.r=b),N==he)++k;else if(k=0,++b,_.sheetRows&&_.sheetRows<=b)return!0}e:for(;ee<g.length;++ee)switch(N=g.charCodeAt(ee)){case 34:I===34&&(Ae=!Ae);break;case he:case 10:case 13:if(!Ae&&M())break e;break}return ee-X>0&&M(),w["!ref"]=_n(T),w}function u(g,y){return!(y&&y.PRN)||y.FS||g.slice(0,4)=="sep="||g.indexOf("	")>=0||g.indexOf(",")>=0||g.indexOf(";")>=0?o(g,y):nu(e(g,y),y)}function f(g,y){var _="",E=y.type=="string"?[0,0,0,0]:jk(g,y);switch(y.type){case"base64":_=Da(g);break;case"binary":_=g;break;case"buffer":y.codepage==65001?_=g.toString("utf8"):y.codepage&&typeof s0<"u"||(_=St&&Buffer.isBuffer(g)?g.toString("binary"):Zc(g));break;case"array":_=$0(g);break;case"string":_=g;break;default:throw new Error("Unrecognized type "+y.type)}return E[0]==239&&E[1]==187&&E[2]==191?_=xc(_.slice(3)):y.type!="string"&&y.type!="buffer"&&y.codepage==65001?_=xc(_):y.type=="binary"&&typeof s0<"u",_.slice(0,19)=="socialcalc:version:"?zA.to_sheet(y.type=="string"?_:xc(_),y):u(_,y)}function h(g,y){return Io(f(g,y),y)}function m(g){for(var y=[],_=$t(g["!ref"]),E,w=Array.isArray(g),T=_.s.r;T<=_.e.r;++T){for(var b=[],k=_.s.c;k<=_.e.c;++k){var q=Ft({r:T,c:k});if(E=w?(g[T]||[])[k]:g[q],!E||E.v==null){b.push("          ");continue}for(var X=(E.w||(Oa(E),E.w)||"").slice(0,10);X.length<10;)X+=" ";b.push(X+(k===0?" ":""))}y.push(b.join(""))}return y.join(`
`)}return{to_workbook:h,to_sheet:f,from_sheet:m}}(),rE=function(){function t(U,W,K){if(U){Lr(U,U.l||0);for(var Z=K.Enum||Q;U.l<U.length;){var ce=U.read_shift(2),Le=Z[ce]||Z[65535],Fe=U.read_shift(2),Be=U.l+Fe,Me=Le.f&&Le.f(U,Fe,K);if(U.l=Be,W(Me,Le,ce))return}}}function e(U,W){switch(W.type){case"base64":return n(di(Da(U)),W);case"binary":return n(di(U),W);case"buffer":case"array":return n(U,W)}throw"Unsupported type "+W.type}function n(U,W){if(!U)return U;var K=W||{},Z=K.dense?[]:{},ce="Sheet1",Le="",Fe=0,Be={},Me=[],ut=[],nt={s:{r:0,c:0},e:{r:0,c:0}},Wt=K.sheetRows||0;if(U[2]==0&&(U[3]==8||U[3]==9)&&U.length>=16&&U[14]==5&&U[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(U[2]==2)K.Enum=Q,t(U,function(Ve,Wn,ar){switch(ar){case 0:K.vers=Ve,Ve>=4096&&(K.qpro=!0);break;case 6:nt=Ve;break;case 204:Ve&&(Le=Ve);break;case 222:Le=Ve;break;case 15:case 51:K.qpro||(Ve[1].v=Ve[1].v.slice(1));case 13:case 14:case 16:ar==14&&(Ve[2]&112)==112&&(Ve[2]&15)>1&&(Ve[2]&15)<15&&(Ve[1].z=K.dateNF||nn[14],K.cellDates&&(Ve[1].t="d",Ve[1].v=aA(Ve[1].v))),K.qpro&&Ve[3]>Fe&&(Z["!ref"]=_n(nt),Be[ce]=Z,Me.push(ce),Z=K.dense?[]:{},nt={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ve[3],ce=Le||"Sheet"+(Fe+1),Le="");var mr=K.dense?(Z[Ve[0].r]||[])[Ve[0].c]:Z[Ft(Ve[0])];if(mr){mr.t=Ve[1].t,mr.v=Ve[1].v,Ve[1].z!=null&&(mr.z=Ve[1].z),Ve[1].f!=null&&(mr.f=Ve[1].f);break}K.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[Ft(Ve[0])]=Ve[1];break}},K);else if(U[2]==26||U[2]==14)K.Enum=xe,U[2]==14&&(K.qpro=!0,U.l=0),t(U,function(Ve,Wn,ar){switch(ar){case 204:ce=Ve;break;case 22:Ve[1].v=Ve[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Ve[3]>Fe&&(Z["!ref"]=_n(nt),Be[ce]=Z,Me.push(ce),Z=K.dense?[]:{},nt={s:{r:0,c:0},e:{r:0,c:0}},Fe=Ve[3],ce="Sheet"+(Fe+1)),Wt>0&&Ve[0].r>=Wt)break;K.dense?(Z[Ve[0].r]||(Z[Ve[0].r]=[]),Z[Ve[0].r][Ve[0].c]=Ve[1]):Z[Ft(Ve[0])]=Ve[1],nt.e.c<Ve[0].c&&(nt.e.c=Ve[0].c),nt.e.r<Ve[0].r&&(nt.e.r=Ve[0].r);break;case 27:Ve[14e3]&&(ut[Ve[14e3][0]]=Ve[14e3][1]);break;case 1537:ut[Ve[0]]=Ve[1],Ve[0]==Fe&&(ce=Ve[1]);break}},K);else throw new Error("Unrecognized LOTUS BOF "+U[2]);if(Z["!ref"]=_n(nt),Be[Le||ce]=Z,Me.push(Le||ce),!ut.length)return{SheetNames:Me,Sheets:Be};for(var ot={},ir=[],Bt=0;Bt<ut.length;++Bt)Be[Me[Bt]]?(ir.push(ut[Bt]||Me[Bt]),ot[ut[Bt]]=Be[ut[Bt]]||Be[Me[Bt]]):(ir.push(ut[Bt]),ot[ut[Bt]]={"!ref":"A1"});return{SheetNames:ir,Sheets:ot}}function r(U,W){var K=W||{};if(+K.codepage>=0&&Pc(+K.codepage),K.type=="string")throw new Error("Cannot write WK1 to JS string");var Z=Ar(),ce=$t(U["!ref"]),Le=Array.isArray(U),Fe=[];Oe(Z,0,o(1030)),Oe(Z,6,h(ce));for(var Be=Math.min(ce.e.r,8191),Me=ce.s.r;Me<=Be;++Me)for(var ut=$n(Me),nt=ce.s.c;nt<=ce.e.c;++nt){Me===ce.s.r&&(Fe[nt]=nr(nt));var Wt=Fe[nt]+ut,ot=Le?(U[Me]||[])[nt]:U[Wt];if(!(!ot||ot.t=="z"))if(ot.t=="n")(ot.v|0)==ot.v&&ot.v>=-32768&&ot.v<=32767?Oe(Z,13,E(Me,nt,ot.v)):Oe(Z,14,T(Me,nt,ot.v));else{var ir=Oa(ot);Oe(Z,15,y(Me,nt,ir.slice(0,239)))}}return Oe(Z,1),Z.end()}function a(U,W){var K=W||{};if(+K.codepage>=0&&Pc(+K.codepage),K.type=="string")throw new Error("Cannot write WK3 to JS string");var Z=Ar();Oe(Z,0,u(U));for(var ce=0,Le=0;ce<U.SheetNames.length;++ce)(U.Sheets[U.SheetNames[ce]]||{})["!ref"]&&Oe(Z,27,Ye(U.SheetNames[ce],Le++));var Fe=0;for(ce=0;ce<U.SheetNames.length;++ce){var Be=U.Sheets[U.SheetNames[ce]];if(!(!Be||!Be["!ref"])){for(var Me=$t(Be["!ref"]),ut=Array.isArray(Be),nt=[],Wt=Math.min(Me.e.r,8191),ot=Me.s.r;ot<=Wt;++ot)for(var ir=$n(ot),Bt=Me.s.c;Bt<=Me.e.c;++Bt){ot===Me.s.r&&(nt[Bt]=nr(Bt));var Ve=nt[Bt]+ir,Wn=ut?(Be[ot]||[])[Bt]:Be[Ve];if(!(!Wn||Wn.t=="z"))if(Wn.t=="n")Oe(Z,23,M(ot,Bt,Fe,Wn.v));else{var ar=Oa(Wn);Oe(Z,22,N(ot,Bt,Fe,ar.slice(0,239)))}}++Fe}}return Oe(Z,1),Z.end()}function o(U){var W=ge(2);return W.write_shift(2,U),W}function u(U){var W=ge(26);W.write_shift(2,4096),W.write_shift(2,4),W.write_shift(4,0);for(var K=0,Z=0,ce=0,Le=0;Le<U.SheetNames.length;++Le){var Fe=U.SheetNames[Le],Be=U.Sheets[Fe];if(!(!Be||!Be["!ref"])){++ce;var Me=Ur(Be["!ref"]);K<Me.e.r&&(K=Me.e.r),Z<Me.e.c&&(Z=Me.e.c)}}return K>8191&&(K=8191),W.write_shift(2,K),W.write_shift(1,ce),W.write_shift(1,Z),W.write_shift(2,0),W.write_shift(2,0),W.write_shift(1,1),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(4,0),W}function f(U,W,K){var Z={s:{c:0,r:0},e:{c:0,r:0}};return W==8&&K.qpro?(Z.s.c=U.read_shift(1),U.l++,Z.s.r=U.read_shift(2),Z.e.c=U.read_shift(1),U.l++,Z.e.r=U.read_shift(2),Z):(Z.s.c=U.read_shift(2),Z.s.r=U.read_shift(2),W==12&&K.qpro&&(U.l+=2),Z.e.c=U.read_shift(2),Z.e.r=U.read_shift(2),W==12&&K.qpro&&(U.l+=2),Z.s.c==65535&&(Z.s.c=Z.e.c=Z.s.r=Z.e.r=0),Z)}function h(U){var W=ge(8);return W.write_shift(2,U.s.c),W.write_shift(2,U.s.r),W.write_shift(2,U.e.c),W.write_shift(2,U.e.r),W}function m(U,W,K){var Z=[{c:0,r:0},{t:"n",v:0},0,0];return K.qpro&&K.vers!=20768?(Z[0].c=U.read_shift(1),Z[3]=U.read_shift(1),Z[0].r=U.read_shift(2),U.l+=2):(Z[2]=U.read_shift(1),Z[0].c=U.read_shift(2),Z[0].r=U.read_shift(2)),Z}function g(U,W,K){var Z=U.l+W,ce=m(U,W,K);if(ce[1].t="s",K.vers==20768){U.l++;var Le=U.read_shift(1);return ce[1].v=U.read_shift(Le,"utf8"),ce}return K.qpro&&U.l++,ce[1].v=U.read_shift(Z-U.l,"cstr"),ce}function y(U,W,K){var Z=ge(7+K.length);Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(1,39);for(var ce=0;ce<Z.length;++ce){var Le=K.charCodeAt(ce);Z.write_shift(1,Le>=128?95:Le)}return Z.write_shift(1,0),Z}function _(U,W,K){var Z=m(U,W,K);return Z[1].v=U.read_shift(2,"i"),Z}function E(U,W,K){var Z=ge(7);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(2,K,"i"),Z}function w(U,W,K){var Z=m(U,W,K);return Z[1].v=U.read_shift(8,"f"),Z}function T(U,W,K){var Z=ge(13);return Z.write_shift(1,255),Z.write_shift(2,W),Z.write_shift(2,U),Z.write_shift(8,K,"f"),Z}function b(U,W,K){var Z=U.l+W,ce=m(U,W,K);if(ce[1].v=U.read_shift(8,"f"),K.qpro)U.l=Z;else{var Le=U.read_shift(2);ee(U.slice(U.l,U.l+Le),ce),U.l+=Le}return ce}function k(U,W,K){var Z=W&32768;return W&=-32769,W=(Z?U:0)+(W>=8192?W-16384:W),(Z?"":"$")+(K?nr(W):$n(W))}var q={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},X=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function ee(U,W){Lr(U,0);for(var K=[],Z=0,ce="",Le="",Fe="",Be="";U.l<U.length;){var Me=U[U.l++];switch(Me){case 0:K.push(U.read_shift(8,"f"));break;case 1:Le=k(W[0].c,U.read_shift(2),!0),ce=k(W[0].r,U.read_shift(2),!1),K.push(Le+ce);break;case 2:{var ut=k(W[0].c,U.read_shift(2),!0),nt=k(W[0].r,U.read_shift(2),!1);Le=k(W[0].c,U.read_shift(2),!0),ce=k(W[0].r,U.read_shift(2),!1),K.push(ut+nt+":"+Le+ce)}break;case 3:if(U.l<U.length){console.error("WK1 premature formula end");return}break;case 4:K.push("("+K.pop()+")");break;case 5:K.push(U.read_shift(2));break;case 6:{for(var Wt="";Me=U[U.l++];)Wt+=String.fromCharCode(Me);K.push('"'+Wt.replace(/"/g,'""')+'"')}break;case 8:K.push("-"+K.pop());break;case 23:K.push("+"+K.pop());break;case 22:K.push("NOT("+K.pop()+")");break;case 20:case 21:Be=K.pop(),Fe=K.pop(),K.push(["AND","OR"][Me-20]+"("+Fe+","+Be+")");break;default:if(Me<32&&X[Me])Be=K.pop(),Fe=K.pop(),K.push(Fe+X[Me]+Be);else if(q[Me]){if(Z=q[Me][1],Z==69&&(Z=U[U.l++]),Z>K.length){console.error("WK1 bad formula parse 0x"+Me.toString(16)+":|"+K.join("|")+"|");return}var ot=K.slice(-Z);K.length-=Z,K.push(q[Me][0]+"("+ot.join(",")+")")}else return Me<=7?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=24?console.error("WK1 unsupported op "+Me.toString(16)):Me<=30?console.error("WK1 invalid opcode "+Me.toString(16)):Me<=115?console.error("WK1 unsupported function opcode "+Me.toString(16)):console.error("WK1 unrecognized opcode "+Me.toString(16))}}K.length==1?W[1].f=""+K[0]:console.error("WK1 bad formula parse |"+K.join("|")+"|")}function he(U){var W=[{c:0,r:0},{t:"n",v:0},0];return W[0].r=U.read_shift(2),W[3]=U[U.l++],W[0].c=U[U.l++],W}function Ae(U,W){var K=he(U);return K[1].t="s",K[1].v=U.read_shift(W-4,"cstr"),K}function N(U,W,K,Z){var ce=ge(6+Z.length);ce.write_shift(2,U),ce.write_shift(1,K),ce.write_shift(1,W),ce.write_shift(1,39);for(var Le=0;Le<Z.length;++Le){var Fe=Z.charCodeAt(Le);ce.write_shift(1,Fe>=128?95:Fe)}return ce.write_shift(1,0),ce}function I(U,W){var K=he(U);K[1].v=U.read_shift(2);var Z=K[1].v>>1;if(K[1].v&1)switch(Z&7){case 0:Z=(Z>>3)*5e3;break;case 1:Z=(Z>>3)*500;break;case 2:Z=(Z>>3)/20;break;case 3:Z=(Z>>3)/200;break;case 4:Z=(Z>>3)/2e3;break;case 5:Z=(Z>>3)/2e4;break;case 6:Z=(Z>>3)/16;break;case 7:Z=(Z>>3)/64;break}return K[1].v=Z,K}function R(U,W){var K=he(U),Z=U.read_shift(4),ce=U.read_shift(4),Le=U.read_shift(2);if(Le==65535)return Z===0&&ce===3221225472?(K[1].t="e",K[1].v=15):Z===0&&ce===3489660928?(K[1].t="e",K[1].v=42):K[1].v=0,K;var Fe=Le&32768;return Le=(Le&32767)-16446,K[1].v=(1-Fe*2)*(ce*Math.pow(2,Le+32)+Z*Math.pow(2,Le)),K}function M(U,W,K,Z){var ce=ge(14);if(ce.write_shift(2,U),ce.write_shift(1,K),ce.write_shift(1,W),Z==0)return ce.write_shift(4,0),ce.write_shift(4,0),ce.write_shift(2,65535),ce;var Le=0,Fe=0,Be=0,Me=0;return Z<0&&(Le=1,Z=-Z),Fe=Math.log2(Z)|0,Z/=Math.pow(2,Fe-31),Me=Z>>>0,(Me&2147483648)==0&&(Z/=2,++Fe,Me=Z>>>0),Z-=Me,Me|=2147483648,Me>>>=0,Z*=Math.pow(2,32),Be=Z>>>0,ce.write_shift(4,Be),ce.write_shift(4,Me),Fe+=16383+(Le?32768:0),ce.write_shift(2,Fe),ce}function B(U,W){var K=R(U);return U.l+=W-14,K}function H(U,W){var K=he(U),Z=U.read_shift(4);return K[1].v=Z>>6,K}function V(U,W){var K=he(U),Z=U.read_shift(8,"f");return K[1].v=Z,K}function Je(U,W){var K=V(U);return U.l+=W-10,K}function He(U,W){return U[U.l+W-1]==0?U.read_shift(W,"cstr"):""}function de(U,W){var K=U[U.l++];K>W-1&&(K=W-1);for(var Z="";Z.length<K;)Z+=String.fromCharCode(U[U.l++]);return Z}function Re(U,W,K){if(!(!K.qpro||W<21)){var Z=U.read_shift(1);U.l+=17,U.l+=1,U.l+=2;var ce=U.read_shift(W-21,"cstr");return[Z,ce]}}function ze(U,W){for(var K={},Z=U.l+W;U.l<Z;){var ce=U.read_shift(2);if(ce==14e3){for(K[ce]=[0,""],K[ce][0]=U.read_shift(2);U[U.l];)K[ce][1]+=String.fromCharCode(U[U.l]),U.l++;U.l++}}return K}function Ye(U,W){var K=ge(5+U.length);K.write_shift(2,14e3),K.write_shift(2,W);for(var Z=0;Z<U.length;++Z){var ce=U.charCodeAt(Z);K[K.l++]=ce>127?95:ce}return K[K.l++]=0,K}var Q={0:{n:"BOF",f:LA},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:w},15:{n:"LABEL",f:g},16:{n:"FORMULA",f:b},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:g},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:He},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Ae},23:{n:"NUMBER17",f:R},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:B},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ze},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:V},40:{n:"FORMULA28",f:Je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:He},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Re},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:a,to_workbook:e}}(),N5=/^\s|\s$|[\t\n\r]/;function HA(t,e){if(!e.bookSST)return"";var n=[yn];n[n.length]=Ne("sst",null,{xmlns:tu[0],count:t.Count,uniqueCount:t.Unique});for(var r=0;r!=t.length;++r)if(t[r]!=null){var a=t[r],o="<si>";a.r?o+=a.r:(o+="<t",a.t||(a.t=""),a.t.match(N5)&&(o+=' xml:space="preserve"'),o+=">"+Ot(a.t)+"</t>"),o+="</si>",n[n.length]=o}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function D5(t){return[t.read_shift(4),t.read_shift(4)]}function O5(t,e){return e||(e=ge(8)),e.write_shift(4,t.Count),e.write_shift(4,t.Unique),e}var F5=w8;function M5(t){var e=Ar();Se(e,159,O5(t));for(var n=0;n<t.length;++n)Se(e,19,F5(t[n]));return Se(e,160),e.end()}function P5(t){for(var e=[],n=t.split(""),r=0;r<n.length;++r)e[r]=n[r].charCodeAt(0);return e}function GA(t){var e=0,n,r=P5(t),a=r.length+1,o,u,f,h,m;for(n=Eo(a),n[0]=r.length,o=1;o!=a;++o)n[o]=r[o-1];for(o=a-1;o>=0;--o)u=n[o],f=(e&16384)===0?0:1,h=e<<1&32767,m=f|h,e=m^u;return e^52811}var k5=function(){function t(a,o){switch(o.type){case"base64":return e(Da(a),o);case"binary":return e(a,o);case"buffer":return e(St&&Buffer.isBuffer(a)?a.toString("binary"):Zc(a),o);case"array":return e($0(a),o)}throw new Error("Unrecognized type "+o.type)}function e(a,o){var u=o||{},f=u.dense?[]:{},h=a.match(/\\trowd.*?\\row\b/g);if(!h.length)throw new Error("RTF missing table");var m={s:{c:0,r:0},e:{c:0,r:h.length-1}};return h.forEach(function(g,y){Array.isArray(f)&&(f[y]=[]);for(var _=/\\\w+\b/g,E=0,w,T=-1;w=_.exec(g);){switch(w[0]){case"\\cell":var b=g.slice(E,_.lastIndex-w[0].length);if(b[0]==" "&&(b=b.slice(1)),++T,b.length){var k={v:b,t:"s"};Array.isArray(f)?f[y][T]=k:f[Ft({r:y,c:T})]=k}break}E=_.lastIndex}T>m.e.c&&(m.e.c=T)}),f["!ref"]=_n(m),f}function n(a,o){return Io(t(a,o),o)}function r(a){for(var o=["{\\rtf1\\ansi"],u=$t(a["!ref"]),f,h=Array.isArray(a),m=u.s.r;m<=u.e.r;++m){o.push("\\trowd\\trautofit1");for(var g=u.s.c;g<=u.e.c;++g)o.push("\\cellx"+(g+1));for(o.push("\\pard\\intbl"),g=u.s.c;g<=u.e.c;++g){var y=Ft({r:m,c:g});f=h?(a[m]||[])[g]:a[y],!(!f||f.v==null&&(!f.f||f.F))&&(o.push(" "+(f.w||(Oa(f),f.w))),o.push("\\cell"))}o.push("\\pard\\intbl\\row")}return o.join("")+"}"}return{to_workbook:n,to_sheet:t,from_sheet:r}}();function iE(t){for(var e=0,n=1;e!=3;++e)n=n*256+(t[e]>255?255:t[e]<0?0:t[e]);return n.toString(16).toUpperCase().slice(1)}var L5=6,Sa=L5;function p0(t){return Math.floor((t+Math.round(128/Sa)/256)*Sa)}function g0(t){return Math.floor((t-5)/Sa*100+.5)/100}function Qp(t){return Math.round((t*Sa+5)/Sa*256)/256}function v1(t){t.width?(t.wpx=p0(t.width),t.wch=g0(t.wpx),t.MDW=Sa):t.wpx?(t.wch=g0(t.wpx),t.width=Qp(t.wch),t.MDW=Sa):typeof t.wch=="number"&&(t.width=Qp(t.wch),t.wpx=p0(t.width),t.MDW=Sa),t.customWidth&&delete t.customWidth}var V5=96,qA=V5;function v0(t){return t*96/qA}function $A(t){return t*qA/96}function B5(t){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)t[r]!=null&&(e[e.length]=Ne("numFmt",null,{numFmtId:r,formatCode:Ot(t[r])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ne("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function U5(t){var e=[];return e[e.length]=Ne("cellXfs",null),t.forEach(function(n){e[e.length]=Ne("xf",null,n)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ne("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function XA(t,e){var n=[yn,Ne("styleSheet",null,{xmlns:tu[0],"xmlns:vt":Fn.vt})],r;return t.SSF&&(r=B5(t.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=U5(e.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function j5(t,e){var n=t.read_shift(2),r=rr(t);return[n,r]}function z5(t,e,n){n||(n=ge(6+4*e.length)),n.write_shift(2,t),Pn(e,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function H5(t,e,n){var r={};r.sz=t.read_shift(2)/20;var a=N8(t);a.fItalic&&(r.italic=1),a.fCondense&&(r.condense=1),a.fExtend&&(r.extend=1),a.fShadow&&(r.shadow=1),a.fOutline&&(r.outline=1),a.fStrikeout&&(r.strike=1);var o=t.read_shift(2);switch(o===700&&(r.bold=1),t.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var u=t.read_shift(1);u!=0&&(r.underline=u);var f=t.read_shift(1);f>0&&(r.family=f);var h=t.read_shift(1);switch(h>0&&(r.charset=h),t.l++,r.color=I8(t),t.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=rr(t),r}function G5(t,e){e||(e=ge(25+4*32)),e.write_shift(2,t.sz*20),D8(t,e),e.write_shift(2,t.bold?700:400);var n=0;t.vertAlign=="superscript"?n=1:t.vertAlign=="subscript"&&(n=2),e.write_shift(2,n),e.write_shift(1,t.underline||0),e.write_shift(1,t.family||0),e.write_shift(1,t.charset||0),e.write_shift(1,0),d0(t.color,e);var r=0;return r=2,e.write_shift(1,r),Pn(t.name,e),e.length>e.l?e.slice(0,e.l):e}var q5=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],_p,$5=Ki;function aE(t,e){e||(e=ge(4*3+8*7+16*1)),_p||(_p=a1(q5));var n=_p[t.patternType];n==null&&(n=40),e.write_shift(4,n);var r=0;if(n!=40)for(d0({auto:1},e),d0({auto:1},e);r<12;++r)e.write_shift(4,0);else{for(;r<4;++r)e.write_shift(4,0);for(;r<12;++r)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function X5(t,e){var n=t.l+e,r=t.read_shift(2),a=t.read_shift(2);return t.l=n,{ixfe:r,numFmtId:a}}function YA(t,e,n){n||(n=ge(16)),n.write_shift(2,e||0),n.write_shift(2,t.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function oc(t,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var Y5=Ki;function W5(t,e){return e||(e=ge(51)),e.write_shift(1,0),oc(null,e),oc(null,e),oc(null,e),oc(null,e),oc(null,e),e.length>e.l?e.slice(0,e.l):e}function K5(t,e){return e||(e=ge(12+4*10)),e.write_shift(4,t.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),h0(t.name||"",e),e.length>e.l?e.slice(0,e.l):e}function Q5(t,e,n){var r=ge(2052);return r.write_shift(4,t),h0(e,r),h0(n,r),r.length>r.l?r.slice(0,r.l):r}function Z5(t,e){if(e){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&++n}),n!=0&&(Se(t,615,gi(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Se(t,44,z5(a,e[a]))}),Se(t,616))}}function J5(t){var e=1;Se(t,611,gi(e)),Se(t,43,G5({sz:12,color:{theme:1},name:"Calibri",family:2})),Se(t,612)}function eF(t){var e=2;Se(t,603,gi(e)),Se(t,45,aE({patternType:"none"})),Se(t,45,aE({patternType:"gray125"})),Se(t,604)}function tF(t){var e=1;Se(t,613,gi(e)),Se(t,46,W5()),Se(t,614)}function nF(t){var e=1;Se(t,626,gi(e)),Se(t,47,YA({numFmtId:0},65535)),Se(t,627)}function rF(t,e){Se(t,617,gi(e.length)),e.forEach(function(n){Se(t,47,YA(n,0))}),Se(t,618)}function iF(t){var e=1;Se(t,619,gi(e)),Se(t,48,K5({xfId:0,name:"Normal"})),Se(t,620)}function aF(t){var e=0;Se(t,505,gi(e)),Se(t,506)}function sF(t){var e=0;Se(t,508,Q5(e,"TableStyleMedium9","PivotStyleMedium4")),Se(t,509)}function oF(t,e){var n=Ar();return Se(n,278),Z5(n,t.SSF),J5(n),eF(n),tF(n),nF(n),rF(n,e.cellXfs),iF(n),aF(n),sF(n),Se(n,279),n.end()}function WA(t,e){if(e&&e.themeXLSX)return e.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var n=[yn];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function lF(t,e){return{flags:t.read_shift(4),version:t.read_shift(4),name:rr(t)}}function uF(t){var e=ge(12+2*t.name.length);return e.write_shift(4,t.flags),e.write_shift(4,t.version),Pn(t.name,e),e.slice(0,e.l)}function cF(t){for(var e=[],n=t.read_shift(4);n-- >0;)e.push([t.read_shift(4),t.read_shift(4)]);return e}function fF(t){var e=ge(4+8*t.length);e.write_shift(4,t.length);for(var n=0;n<t.length;++n)e.write_shift(4,t[n][0]),e.write_shift(4,t[n][1]);return e}function hF(t,e){var n=ge(8+2*e.length);return n.write_shift(4,t),Pn(e,n),n.slice(0,n.l)}function dF(t){return t.l+=4,t.read_shift(4)!=0}function mF(t,e){var n=ge(8);return n.write_shift(4,t),n.write_shift(4,1),n}function pF(){var t=Ar();return Se(t,332),Se(t,334,gi(1)),Se(t,335,uF({name:"XLDAPR",version:12e4,flags:3496657072})),Se(t,336),Se(t,339,hF(1,"XLDAPR")),Se(t,52),Se(t,35,gi(514)),Se(t,4096,gi(0)),Se(t,4097,ei(1)),Se(t,36),Se(t,53),Se(t,340),Se(t,337,mF(1)),Se(t,51,fF([[1,0]])),Se(t,338),Se(t,333),t.end()}function KA(){var t=[yn];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function gF(t){var e={};e.i=t.read_shift(4);var n={};n.r=t.read_shift(4),n.c=t.read_shift(4),e.r=Ft(n);var r=t.read_shift(1);return r&2&&(e.l="1"),r&8&&(e.a="1"),e}var Nl=1024;function QA(t,e){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),a=[Ne("xml",null,{"xmlns:v":Vr.v,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:mv":Vr.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Nl<t*1e3;)Nl+=1e3;return e.forEach(function(o){var u=Mn(o[0]),f={color2:"#BEFF82",type:"gradient"};f.type=="gradient"&&(f.angle="-180");var h=f.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,m=Ne("v:fill",h,f),g={on:"t",obscured:"t"};++Nl,a=a.concat(["<v:shape"+Bc({id:"_x0000_s"+Nl,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(o[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",m,Ne("v:shadow",null,g),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",qn("x:Anchor",[u.c+1,0,u.r+1,0,u.c+3,20,u.r+5,20].join(",")),qn("x:AutoFill","False"),qn("x:Row",String(u.r)),qn("x:Column",String(u.c)),o[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function ZA(t){var e=[yn,Ne("comments",null,{xmlns:tu[0]})],n=[];return e.push("<authors>"),t.forEach(function(r){r[1].forEach(function(a){var o=Ot(a.a);n.indexOf(o)==-1&&(n.push(o),e.push("<author>"+o+"</author>")),a.T&&a.ID&&n.indexOf("tc="+a.ID)==-1&&(n.push("tc="+a.ID),e.push("<author>tc="+a.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),t.forEach(function(r){var a=0,o=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?a=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(h){h.a&&(a=n.indexOf(Ot(h.a))),o.push(h.t||"")}),e.push('<comment ref="'+r[0]+'" authorId="'+a+'"><text>'),o.length<=1)e.push(qn("t",Ot(o[0]||"")));else{for(var u=`Comment:
    `+o[0]+`
`,f=1;f<o.length;++f)u+=`Reply:
    `+o[f]+`
`;e.push(qn("t",Ot(u)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function vF(t,e,n){var r=[yn,Ne("ThreadedComments",null,{xmlns:Fn.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var o="";(a[1]||[]).forEach(function(u,f){if(!u.T){delete u.ID;return}u.a&&e.indexOf(u.a)==-1&&e.push(u.a);var h={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};f==0?o=h.id:h.parentId=o,u.ID=h.id,u.a&&(h.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(u.a)).slice(-12)+"}"),r.push(Ne("threadedComment",qn("text",u.t||""),h))})}),r.push("</ThreadedComments>"),r.join("")}function _F(t){var e=[yn,Ne("personList",null,{xmlns:Fn.TCMNT,"xmlns:x":tu[0]}).replace(/[\/]>/,">")];return t.forEach(function(n,r){e.push(Ne("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),e.push("</personList>"),e.join("")}function yF(t){var e={};e.iauthor=t.read_shift(4);var n=Fo(t);return e.rfx=n.s,e.ref=Ft(n.s),t.l+=16,e}function xF(t,e){return e==null&&(e=ge(36)),e.write_shift(4,t[1].iauthor),ru(t[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var EF=rr;function TF(t){return Pn(t.slice(0,54))}function wF(t){var e=Ar(),n=[];return Se(e,628),Se(e,630),t.forEach(function(r){r[1].forEach(function(a){n.indexOf(a.a)>-1||(n.push(a.a.slice(0,54)),Se(e,632,TF(a.a)))})}),Se(e,631),Se(e,633),t.forEach(function(r){r[1].forEach(function(a){a.iauthor=n.indexOf(a.a);var o={s:Mn(r[0]),e:Mn(r[0])};Se(e,635,xF([o,a])),a.t&&a.t.length>0&&Se(e,637,S8(a)),Se(e,636),delete a.iauthor})}),Se(e,634),Se(e,629),e.end()}function AF(t,e){e.FullPaths.forEach(function(n,r){if(r!=0){var a=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Vt.utils.cfb_add(t,a,e.FileIndex[r].content)}})}var JA=["xlsb","xlsm","xlam","biff8","xla"],SF=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function n(r,a,o,u){var f=!1,h=!1;o.length==0?h=!0:o.charAt(0)=="["&&(h=!0,o=o.slice(1,-1)),u.length==0?f=!0:u.charAt(0)=="["&&(f=!0,u=u.slice(1,-1));var m=o.length>0?parseInt(o,10)|0:0,g=u.length>0?parseInt(u,10)|0:0;return f?g+=e.c:--g,h?m+=e.r:--m,a+(f?"":"$")+nr(g)+(h?"":"$")+$n(m)}return function(a,o){return e=o,a.replace(t,n)}}(),_1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,y1=function(){return function(e,n){return e.replace(_1,function(r,a,o,u,f,h){var m=h1(u)-(o?0:n.c),g=f1(h)-(f?0:n.r),y=g==0?"":f?g+1:"["+g+"]",_=m==0?"":o?m+1:"["+m+"]";return a+"R"+y+"C"+_})}}();function bF(t,e){return t.replace(_1,function(n,r,a,o,u,f){return r+(a=="$"?a+o:nr(h1(o)+e.c))+(u=="$"?u+f:$n(f1(f)+e.r))})}function RF(t){return t.length!=1}function dn(t){t.l+=1}function Ns(t,e){var n=t.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function eS(t,e,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return tS(t);n.biff==12&&(r=4)}var a=t.read_shift(r),o=t.read_shift(r),u=Ns(t),f=Ns(t);return{s:{r:a,c:u[0],cRel:u[1],rRel:u[2]},e:{r:o,c:f[0],cRel:f[1],rRel:f[2]}}}function tS(t){var e=Ns(t),n=Ns(t),r=t.read_shift(1),a=t.read_shift(1);return{s:{r:e[0],c:r,cRel:e[1],rRel:e[2]},e:{r:n[0],c:a,cRel:n[1],rRel:n[2]}}}function CF(t,e,n){if(n.biff<8)return tS(t);var r=t.read_shift(n.biff==12?4:2),a=t.read_shift(n.biff==12?4:2),o=Ns(t),u=Ns(t);return{s:{r,c:o[0],cRel:o[1],rRel:o[2]},e:{r:a,c:u[0],cRel:u[1],rRel:u[2]}}}function nS(t,e,n){if(n&&n.biff>=2&&n.biff<=5)return IF(t);var r=t.read_shift(n&&n.biff==12?4:2),a=Ns(t);return{r,c:a[0],cRel:a[1],rRel:a[2]}}function IF(t){var e=Ns(t),n=t.read_shift(1);return{r:e[0],c:n,cRel:e[1],rRel:e[2]}}function NF(t){var e=t.read_shift(2),n=t.read_shift(2);return{r:e,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function DF(t,e,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return OF(t);var a=t.read_shift(r>=12?4:2),o=t.read_shift(2),u=(o&16384)>>14,f=(o&32768)>>15;if(o&=16383,f==1)for(;a>524287;)a-=1048576;if(u==1)for(;o>8191;)o=o-16384;return{r:a,c:o,cRel:u,rRel:f}}function OF(t){var e=t.read_shift(2),n=t.read_shift(1),r=(e&32768)>>15,a=(e&16384)>>14;return e&=16383,r==1&&e>=8192&&(e=e-16384),a==1&&n>=128&&(n=n-256),{r:e,c:n,cRel:a,rRel:r}}function FF(t,e,n){var r=(t[t.l++]&96)>>5,a=eS(t,n.biff>=2&&n.biff<=5?6:8,n);return[r,a]}function MF(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}var u=eS(t,o,n);return[r,a,u]}function PF(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function kF(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),o=8;if(n)switch(n.biff){case 5:t.l+=12,o=6;break;case 12:o=12;break}return t.l+=o,[r,a]}function LF(t,e,n){var r=(t[t.l++]&96)>>5,a=CF(t,e-1,n);return[r,a]}function VF(t,e,n){var r=(t[t.l++]&96)>>5;return t.l+=n.biff==2?6:n.biff==12?14:7,[r]}function sE(t){var e=t[t.l+1]&1,n=1;return t.l+=4,[e,n]}function BF(t,e,n){t.l+=2;for(var r=t.read_shift(n&&n.biff==2?1:2),a=[],o=0;o<=r;++o)a.push(t.read_shift(n&&n.biff==2?1:2));return a}function UF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function jF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(n&&n.biff==2?1:2)]}function zF(t){var e=t[t.l+1]&255?1:0;return t.l+=2,[e,t.read_shift(2)]}function HF(t,e,n){var r=t[t.l+1]&255?1:0;return t.l+=n&&n.biff==2?3:4,[r]}function rS(t){var e=t.read_shift(1),n=t.read_shift(1);return[e,n]}function GF(t){return t.read_shift(2),rS(t)}function qF(t){return t.read_shift(2),rS(t)}function $F(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=nS(t,0,n);return[r,a]}function XF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=DF(t,0,n);return[r,a]}function YF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);n&&n.biff==5&&(t.l+=12);var o=nS(t,0,n);return[r,a,o]}function WF(t,e,n){var r=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(n&&n.biff<=3?1:2);return[WM[a],sS[a],r]}function KF(t,e,n){var r=t[t.l++],a=t.read_shift(1),o=n&&n.biff<=3?[r==88?-1:0,t.read_shift(1)]:QF(t);return[a,(o[0]===0?sS:YM)[o[1]]]}function QF(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function ZF(t,e,n){t.l+=n&&n.biff==2?3:4}function JF(t,e,n){if(t.l++,n&&n.biff==12)return[t.read_shift(4,"i"),0];var r=t.read_shift(2),a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function eM(t){return t.l++,tf[t.read_shift(1)]}function tM(t){return t.l++,t.read_shift(2)}function nM(t){return t.l++,t.read_shift(1)!==0}function rM(t){return t.l++,iu(t)}function iM(t,e,n){return t.l++,BA(t,e-1,n)}function aM(t,e){var n=[t.read_shift(1)];if(e==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=Y8(t,1)?"TRUE":"FALSE",e!=12&&(t.l+=7);break;case 37:case 16:n[1]=tf[t[t.l]],t.l+=e==12?4:8;break;case 0:t.l+=8;break;case 1:n[1]=iu(t);break;case 2:n[1]=Z8(t,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function sM(t,e,n){for(var r=t.read_shift(n.biff==12?4:2),a=[],o=0;o!=r;++o)a.push((n.biff==12?Fo:t5)(t));return a}function oM(t,e,n){var r=0,a=0;n.biff==12?(r=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),r=1+t.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--a==0&&(a=256));for(var o=0,u=[];o!=r&&(u[o]=[]);++o)for(var f=0;f!=a;++f)u[o][f]=aM(t,n.biff);return u}function lM(t,e,n){var r=t.read_shift(1)>>>5&3,a=!n||n.biff>=8?4:2,o=t.read_shift(a);switch(n.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[r,0,o]}function uM(t,e,n){if(n.biff==5)return cM(t);var r=t.read_shift(1)>>>5&3,a=t.read_shift(2),o=t.read_shift(4);return[r,a,o]}function cM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2,"i");t.l+=8;var r=t.read_shift(2);return t.l+=12,[e,n,r]}function fM(t,e,n){var r=t.read_shift(1)>>>5&3;t.l+=n&&n.biff==2?3:4;var a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function hM(t,e,n){var r=t.read_shift(1)>>>5&3,a=t.read_shift(n&&n.biff==2?1:2);return[r,a]}function dM(t,e,n){var r=t.read_shift(1)>>>5&3;return t.l+=4,n.biff<8&&t.l--,n.biff==12&&(t.l+=2),[r]}function mM(t,e,n){var r=(t[t.l++]&96)>>5,a=t.read_shift(2),o=4;if(n)switch(n.biff){case 5:o=15;break;case 12:o=6;break}return t.l+=o,[r,a]}var pM=Ki,gM=Ki,vM=Ki;function nf(t,e,n){return t.l+=2,[NF(t)]}function x1(t){return t.l+=6,[]}var _M=nf,yM=x1,xM=x1,EM=nf;function iS(t){return t.l+=2,[LA(t),t.read_shift(2)&1]}var TM=nf,wM=iS,AM=x1,SM=nf,bM=nf,RM=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function CM(t){t.l+=2;var e=t.read_shift(2),n=t.read_shift(2),r=t.read_shift(4),a=t.read_shift(2),o=t.read_shift(2),u=RM[n>>2&31];return{ixti:e,coltype:n&3,rt:u,idx:r,c:a,C:o}}function IM(t){return t.l+=2,[t.read_shift(4)]}function NM(t,e,n){return t.l+=5,t.l+=2,t.l+=n.biff==2?1:4,["PTGSHEET"]}function DM(t,e,n){return t.l+=n.biff==2?4:5,["PTGENDSHEET"]}function OM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function FM(t){var e=t.read_shift(1)>>>5&3,n=t.read_shift(2);return[e,n]}function MM(t){return t.l+=4,[0,0]}var oE={1:{n:"PtgExp",f:JF},2:{n:"PtgTbl",f:vM},3:{n:"PtgAdd",f:dn},4:{n:"PtgSub",f:dn},5:{n:"PtgMul",f:dn},6:{n:"PtgDiv",f:dn},7:{n:"PtgPower",f:dn},8:{n:"PtgConcat",f:dn},9:{n:"PtgLt",f:dn},10:{n:"PtgLe",f:dn},11:{n:"PtgEq",f:dn},12:{n:"PtgGe",f:dn},13:{n:"PtgGt",f:dn},14:{n:"PtgNe",f:dn},15:{n:"PtgIsect",f:dn},16:{n:"PtgUnion",f:dn},17:{n:"PtgRange",f:dn},18:{n:"PtgUplus",f:dn},19:{n:"PtgUminus",f:dn},20:{n:"PtgPercent",f:dn},21:{n:"PtgParen",f:dn},22:{n:"PtgMissArg",f:dn},23:{n:"PtgStr",f:iM},26:{n:"PtgSheet",f:NM},27:{n:"PtgEndSheet",f:DM},28:{n:"PtgErr",f:eM},29:{n:"PtgBool",f:nM},30:{n:"PtgInt",f:tM},31:{n:"PtgNum",f:rM},32:{n:"PtgArray",f:VF},33:{n:"PtgFunc",f:WF},34:{n:"PtgFuncVar",f:KF},35:{n:"PtgName",f:lM},36:{n:"PtgRef",f:$F},37:{n:"PtgArea",f:FF},38:{n:"PtgMemArea",f:fM},39:{n:"PtgMemErr",f:pM},40:{n:"PtgMemNoMem",f:gM},41:{n:"PtgMemFunc",f:hM},42:{n:"PtgRefErr",f:dM},43:{n:"PtgAreaErr",f:PF},44:{n:"PtgRefN",f:XF},45:{n:"PtgAreaN",f:LF},46:{n:"PtgMemAreaN",f:OM},47:{n:"PtgMemNoMemN",f:FM},57:{n:"PtgNameX",f:uM},58:{n:"PtgRef3d",f:YF},59:{n:"PtgArea3d",f:MF},60:{n:"PtgRefErr3d",f:mM},61:{n:"PtgAreaErr3d",f:kF},255:{}},PM={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},kM={1:{n:"PtgElfLel",f:iS},2:{n:"PtgElfRw",f:SM},3:{n:"PtgElfCol",f:_M},6:{n:"PtgElfRwV",f:bM},7:{n:"PtgElfColV",f:EM},10:{n:"PtgElfRadical",f:TM},11:{n:"PtgElfRadicalS",f:AM},13:{n:"PtgElfColS",f:yM},15:{n:"PtgElfColSV",f:xM},16:{n:"PtgElfRadicalLel",f:wM},25:{n:"PtgList",f:CM},29:{n:"PtgSxName",f:IM},255:{}},LM={0:{n:"PtgAttrNoop",f:MM},1:{n:"PtgAttrSemi",f:HF},2:{n:"PtgAttrIf",f:jF},4:{n:"PtgAttrChoose",f:BF},8:{n:"PtgAttrGoto",f:UF},16:{n:"PtgAttrSum",f:ZF},32:{n:"PtgAttrBaxcel",f:sE},33:{n:"PtgAttrBaxcel",f:sE},64:{n:"PtgAttrSpace",f:GF},65:{n:"PtgAttrSpaceSemi",f:qF},128:{n:"PtgAttrIfError",f:zF},255:{}};function VM(t,e,n,r){if(r.biff<8)return Ki(t,e);for(var a=t.l+e,o=[],u=0;u!==n.length;++u)switch(n[u][0]){case"PtgArray":n[u][1]=oM(t,0,r),o.push(n[u][1]);break;case"PtgMemArea":n[u][2]=sM(t,n[u][1],r),o.push(n[u][2]);break;case"PtgExp":r&&r.biff==12&&(n[u][1][1]=t.read_shift(4),o.push(n[u][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[u][0]}return e=a-t.l,e!==0&&o.push(Ki(t,e)),o}function BM(t,e,n){for(var r=t.l+e,a,o,u=[];r!=t.l;)e=r-t.l,o=t[t.l],a=oE[o]||oE[PM[o]],(o===24||o===25)&&(a=(o===24?kM:LM)[t[t.l+1]]),!a||!a.f?Ki(t,e):u.push([a.n,a.f(t,e,n)]);return u}function UM(t){for(var e=[],n=0;n<t.length;++n){for(var r=t[n],a=[],o=0;o<r.length;++o){var u=r[o];if(u)switch(u[0]){case 2:a.push('"'+u[1].replace(/"/g,'""')+'"');break;default:a.push(u[1])}else a.push("")}e.push(a.join(","))}return e.join(";")}var jM={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function zM(t,e){if(!t&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function aS(t,e,n){if(!t)return"SH33TJSERR0";if(n.biff>8&&(!t.XTI||!t.XTI[e]))return t.SheetNames[e];if(!t.XTI)return"SH33TJSERR6";var r=t.XTI[e];if(n.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":t.XTI[e-1];if(!r)return"SH33TJSERR1";var a="";if(n.biff>8)switch(t[r[0]][0]){case 357:return a=r[1]==-1?"#REF":t.SheetNames[r[1]],r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 358:return n.SID!=null?t.SheetNames[n.SID]:"SH33TJSSAME"+t[r[0]][0];case 355:default:return"SH33TJSSRC"+t[r[0]][0]}switch(t[r[0]][0][0]){case 1025:return a=r[1]==-1?"#REF":t.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?a:a+":"+t.SheetNames[r[2]];case 14849:return t[r[0]].slice(1).map(function(o){return o.Name}).join(";;");default:return t[r[0]][0][3]?(a=r[1]==-1?"#REF":t[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?a:a+":"+t[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function lE(t,e,n){var r=aS(t,e,n);return r=="#REF"?r:zM(r,n)}function Yl(t,e,n,r,a){var o=a&&a.biff||8,u={s:{c:0,r:0}},f=[],h,m,g,y=0,_=0,E,w="";if(!t[0]||!t[0][0])return"";for(var T=-1,b="",k=0,q=t[0].length;k<q;++k){var X=t[0][k];switch(X[0]){case"PtgUminus":f.push("-"+f.pop());break;case"PtgUplus":f.push("+"+f.pop());break;case"PtgPercent":f.push(f.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(h=f.pop(),m=f.pop(),T>=0){switch(t[0][T][1][0]){case 0:b=tn(" ",t[0][T][1][1]);break;case 1:b=tn("\r",t[0][T][1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}m=m+b,T=-1}f.push(m+jM[X[0]]+h);break;case"PtgIsect":h=f.pop(),m=f.pop(),f.push(m+" "+h);break;case"PtgUnion":h=f.pop(),m=f.pop(),f.push(m+","+h);break;case"PtgRange":h=f.pop(),m=f.pop(),f.push(m+":"+h);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":g=Tc(X[1][1],u,a),f.push(wc(g,o));break;case"PtgRefN":g=n?Tc(X[1][1],n,a):X[1][1],f.push(wc(g,o));break;case"PtgRef3d":y=X[1][1],g=Tc(X[1][2],u,a),w=lE(r,y,a),f.push(w+"!"+wc(g,o));break;case"PtgFunc":case"PtgFuncVar":var ee=X[1][0],he=X[1][1];ee||(ee=0),ee&=127;var Ae=ee==0?[]:f.slice(-ee);f.length-=ee,he==="User"&&(he=Ae.shift()),f.push(he+"("+Ae.join(",")+")");break;case"PtgBool":f.push(X[1]?"TRUE":"FALSE");break;case"PtgInt":f.push(X[1]);break;case"PtgNum":f.push(String(X[1]));break;case"PtgStr":f.push('"'+X[1].replace(/"/g,'""')+'"');break;case"PtgErr":f.push(X[1]);break;case"PtgAreaN":E=$2(X[1][1],n?{s:n}:u,a),f.push(gp(E,a));break;case"PtgArea":E=$2(X[1][1],u,a),f.push(gp(E,a));break;case"PtgArea3d":y=X[1][1],E=X[1][2],w=lE(r,y,a),f.push(w+"!"+gp(E,a));break;case"PtgAttrSum":f.push("SUM("+f.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=X[1][2];var N=(r.names||[])[_-1]||(r[0]||[])[_],I=N?N.Name:"SH33TJSNAME"+String(_);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),f.push(I);break;case"PtgNameX":var R=X[1][1];_=X[1][2];var M;if(a.biff<=5)R<0&&(R=-R),r[R]&&(M=r[R][_]);else{var B="";if(((r[R]||[])[0]||[])[0]==14849||(((r[R]||[])[0]||[])[0]==1025?r[R][_]&&r[R][_].itab>0&&(B=r.SheetNames[r[R][_].itab-1]+"!"):B=r.SheetNames[_-1]+"!"),r[R]&&r[R][_])B+=r[R][_].Name;else if(r[0]&&r[0][_])B+=r[0][_].Name;else{var H=(aS(r,R,a)||"").split(";;");H[_-1]?B=H[_-1]:B+="SH33TJSERRX"}f.push(B);break}M||(M={Name:"SH33TJSERRY"}),f.push(M.Name);break;case"PtgParen":var V="(",Je=")";if(T>=0){switch(b="",t[0][T][1][0]){case 2:V=tn(" ",t[0][T][1][1])+V;break;case 3:V=tn("\r",t[0][T][1][1])+V;break;case 4:Je=tn(" ",t[0][T][1][1])+Je;break;case 5:Je=tn("\r",t[0][T][1][1])+Je;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][T][1][0])}T=-1}f.push(V+f.pop()+Je);break;case"PtgRefErr":f.push("#REF!");break;case"PtgRefErr3d":f.push("#REF!");break;case"PtgExp":g={c:X[1][1],r:X[1][0]};var He={c:n.c,r:n.r};if(r.sharedf[Ft(g)]){var de=r.sharedf[Ft(g)];f.push(Yl(de,u,He,r,a))}else{var Re=!1;for(h=0;h!=r.arrayf.length;++h)if(m=r.arrayf[h],!(g.c<m[0].s.c||g.c>m[0].e.c)&&!(g.r<m[0].s.r||g.r>m[0].e.r)){f.push(Yl(m[1],u,He,r,a)),Re=!0;break}Re||f.push(X[1])}break;case"PtgArray":f.push("{"+UM(X[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":T=k;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":f.push("");break;case"PtgAreaErr":f.push("#REF!");break;case"PtgAreaErr3d":f.push("#REF!");break;case"PtgList":f.push("Table"+X[1].idx+"[#"+X[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(X));default:throw new Error("Unrecognized Formula Token: "+String(X))}var ze=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&T>=0&&ze.indexOf(t[0][k][0])==-1){X=t[0][T];var Ye=!0;switch(X[1][0]){case 4:Ye=!1;case 0:b=tn(" ",X[1][1]);break;case 5:Ye=!1;case 1:b=tn("\r",X[1][1]);break;default:if(b="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+X[1][0])}f.push((Ye?b:"")+f.pop()+(Ye?"":b)),T=-1}}if(f.length>1&&a.WTF)throw new Error("bad formula stack");return f[0]}function HM(t){if(t==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof t=="number")return To(t);return To(0)}function GM(t,e,n,r,a){var o=wo(e,n,a),u=HM(t.v),f=ge(6),h=33;f.write_shift(2,h),f.write_shift(4,0);for(var m=ge(t.bf.length),g=0;g<t.bf.length;++g)m[g]=t.bf[g];var y=Gn([o,u,f,m]);return y}function X0(t,e,n){var r=t.read_shift(4),a=BM(t,r,n),o=t.read_shift(4),u=o>0?VM(t,o,a,n):null;return[a,u]}var qM=X0,Y0=X0,$M=X0,XM=X0,YM={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},sS={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},WM={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function KM(t){var e="of:="+t.replace(_1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function QM(t){return t.replace(/\./,"!")}var Ac=typeof Map<"u";function E1(t,e,n){var r=0,a=t.length;if(n){if(Ac?n.has(e):Object.prototype.hasOwnProperty.call(n,e)){for(var o=Ac?n.get(e):n[e];r<o.length;++r)if(t[o[r]].t===e)return t.Count++,o[r]}}else for(;r<a;++r)if(t[r].t===e)return t.Count++,r;return t[a]={t:e},t.Count++,t.Unique++,n&&(Ac?(n.has(e)||n.set(e,[]),n.get(e).push(a)):(Object.prototype.hasOwnProperty.call(n,e)||(n[e]=[]),n[e].push(a))),a}function W0(t,e){var n={min:t+1,max:t+1},r=-1;return e.MDW&&(Sa=e.MDW),e.width!=null?n.customWidth=1:e.wpx!=null?r=g0(e.wpx):e.wch!=null&&(r=e.wch),r>-1?(n.width=Qp(r),n.customWidth=1):e.width!=null&&(n.width=e.width),e.hidden&&(n.hidden=!0),e.level!=null&&(n.outlineLevel=n.level=e.level),n}function oS(t,e){if(t){var n=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=n[0]),t.right==null&&(t.right=n[1]),t.top==null&&(t.top=n[2]),t.bottom==null&&(t.bottom=n[3]),t.header==null&&(t.header=n[4]),t.footer==null&&(t.footer=n[5])}}function Ms(t,e,n){var r=n.revssf[e.z!=null?e.z:"General"],a=60,o=t.length;if(r==null&&n.ssf){for(;a<392;++a)if(n.ssf[a]==null){nA(e.z,a),n.ssf[a]=e.z,n.revssf[e.z]=r=a;break}}for(a=0;a!=o;++a)if(t[a].numFmtId===r)return a;return t[o]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},o}function ZM(t,e,n){if(t&&t["!ref"]){var r=$t(t["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+t["!ref"])}}function JM(t){if(t.length===0)return"";for(var e='<mergeCells count="'+t.length+'">',n=0;n!=t.length;++n)e+='<mergeCell ref="'+_n(t[n])+'"/>';return e+"</mergeCells>"}function e9(t,e,n,r,a){var o=!1,u={},f=null;if(r.bookType!=="xlsx"&&e.vbaraw){var h=e.SheetNames[n];try{e.Workbook&&(h=e.Workbook.Sheets[n].CodeName||h)}catch{}o=!0,u.codeName=Vc(Ot(h))}if(t&&t["!outline"]){var m={summaryBelow:1,summaryRight:1};t["!outline"].above&&(m.summaryBelow=0),t["!outline"].left&&(m.summaryRight=0),f=(f||"")+Ne("outlinePr",null,m)}!o&&!f||(a[a.length]=Ne("sheetPr",f,u))}var t9=["objects","scenarios","selectLockedCells","selectUnlockedCells"],n9=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function r9(t){var e={sheet:1};return t9.forEach(function(n){t[n]!=null&&t[n]&&(e[n]="1")}),n9.forEach(function(n){t[n]!=null&&!t[n]&&(e[n]="0")}),t.password&&(e.password=GA(t.password).toString(16).toUpperCase()),Ne("sheetProtection",null,e)}function i9(t){return oS(t),Ne("pageMargins",null,t)}function a9(t,e){for(var n=["<cols>"],r,a=0;a!=e.length;++a)(r=e[a])&&(n[n.length]=Ne("col",null,W0(a,r)));return n[n.length]="</cols>",n.join("")}function s9(t,e,n,r){var a=typeof t.ref=="string"?t.ref:_n(t.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var o=n.Workbook.Names,u=Ur(a);u.s.r==u.e.r&&(u.e.r=Ur(e["!ref"]).e.r,a=_n(u));for(var f=0;f<o.length;++f){var h=o[f];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==r){h.Ref="'"+n.SheetNames[r]+"'!"+a;break}}return f==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+a}),Ne("autoFilter",null,{ref:a})}function o9(t,e,n,r){var a={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,a),{})}function l9(t,e,n,r){if(t.c&&n["!comments"].push([e,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",o=t.t,u=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=tf[t.v];break;case"d":r&&r.cellDates?a=dr(t.v,-1).toISOString():(t=br(t),t.t="n",a=""+(t.v=Sr(dr(t.v)))),typeof t.z>"u"&&(t.z=nn[14]);break;default:a=t.v;break}var f=qn("v",Ot(a)),h={r:e},m=Ms(r.cellXfs,t,r);switch(m!==0&&(h.s=m),t.t){case"n":break;case"d":h.t="d";break;case"b":h.t="b";break;case"e":h.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){f=qn("v",""+E1(r.Strings,t.v,r.revStrings)),h.t="s";break}h.t="str";break}if(t.t!=o&&(t.t=o,t.v=u),typeof t.f=="string"&&t.f){var g=t.F&&t.F.slice(0,e.length)==e?{t:"array",ref:t.F}:null;f=Ne("f",Ot(t.f),g)+(t.v!=null?f:"")}return t.l&&n["!links"].push([e,t.l]),t.D&&(h.cm=1),Ne("c",f,h)}function u9(t,e,n,r){var a=[],o=[],u=$t(t["!ref"]),f="",h,m="",g=[],y=0,_=0,E=t["!rows"],w=Array.isArray(t),T={r:m},b,k=-1;for(_=u.s.c;_<=u.e.c;++_)g[_]=nr(_);for(y=u.s.r;y<=u.e.r;++y){for(o=[],m=$n(y),_=u.s.c;_<=u.e.c;++_){h=g[_]+m;var q=w?(t[y]||[])[_]:t[h];q!==void 0&&(f=l9(q,h,t,e))!=null&&o.push(f)}(o.length>0||E&&E[y])&&(T={r:m},E&&E[y]&&(b=E[y],b.hidden&&(T.hidden=1),k=-1,b.hpx?k=v0(b.hpx):b.hpt&&(k=b.hpt),k>-1&&(T.ht=k,T.customHeight=1),b.level&&(T.outlineLevel=b.level)),a[a.length]=Ne("row",o.join(""),T))}if(E)for(;y<E.length;++y)E&&E[y]&&(T={r:y+1},b=E[y],b.hidden&&(T.hidden=1),k=-1,b.hpx?k=v0(b.hpx):b.hpt&&(k=b.hpt),k>-1&&(T.ht=k,T.customHeight=1),b.level&&(T.outlineLevel=b.level),a[a.length]=Ne("row","",T));return a.join("")}function lS(t,e,n,r){var a=[yn,Ne("worksheet",null,{xmlns:tu[0],"xmlns:r":Fn.r})],o=n.SheetNames[t],u=0,f="",h=n.Sheets[o];h==null&&(h={});var m=h["!ref"]||"A1",g=$t(m);if(g.e.c>16383||g.e.r>1048575){if(e.WTF)throw new Error("Range "+m+" exceeds format limit A1:XFD1048576");g.e.c=Math.min(g.e.c,16383),g.e.r=Math.min(g.e.c,1048575),m=_n(g)}r||(r={}),h["!comments"]=[];var y=[];e9(h,n,t,e,a),a[a.length]=Ne("dimension",null,{ref:m}),a[a.length]=o9(h,e,t,n),e.sheetFormat&&(a[a.length]=Ne("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),h["!cols"]!=null&&h["!cols"].length>0&&(a[a.length]=a9(h,h["!cols"])),a[u=a.length]="<sheetData/>",h["!links"]=[],h["!ref"]!=null&&(f=u9(h,e),f.length>0&&(a[a.length]=f)),a.length>u+1&&(a[a.length]="</sheetData>",a[u]=a[u].replace("/>",">")),h["!protect"]&&(a[a.length]=r9(h["!protect"])),h["!autofilter"]!=null&&(a[a.length]=s9(h["!autofilter"],h,n,t)),h["!merges"]!=null&&h["!merges"].length>0&&(a[a.length]=JM(h["!merges"]));var _=-1,E,w=-1;return h["!links"].length>0&&(a[a.length]="<hyperlinks>",h["!links"].forEach(function(T){T[1].Target&&(E={ref:T[0]},T[1].Target.charAt(0)!="#"&&(w=Dt(r,-1,Ot(T[1].Target).replace(/#.*$/,""),wt.HLINK),E["r:id"]="rId"+w),(_=T[1].Target.indexOf("#"))>-1&&(E.location=Ot(T[1].Target.slice(_+1))),T[1].Tooltip&&(E.tooltip=Ot(T[1].Tooltip)),a[a.length]=Ne("hyperlink",null,E))}),a[a.length]="</hyperlinks>"),delete h["!links"],h["!margins"]!=null&&(a[a.length]=i9(h["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(a[a.length]=qn("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:m}))),y.length>0&&(w=Dt(r,-1,"../drawings/drawing"+(t+1)+".xml",wt.DRAW),a[a.length]=Ne("drawing",null,{"r:id":"rId"+w}),h["!drawing"]=y),h["!comments"].length>0&&(w=Dt(r,-1,"../drawings/vmlDrawing"+(t+1)+".vml",wt.VML),a[a.length]=Ne("legacyDrawing",null,{"r:id":"rId"+w}),h["!legacy"]=w),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function c9(t,e){var n={},r=t.l+e;n.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var o=t.read_shift(1);return t.l=r,o&7&&(n.level=o&7),o&16&&(n.hidden=!0),o&32&&(n.hpt=a/20),n}function f9(t,e,n){var r=ge(145),a=(n["!rows"]||[])[t]||{};r.write_shift(4,t),r.write_shift(4,0);var o=320;a.hpx?o=v0(a.hpx)*20:a.hpt&&(o=a.hpt*20),r.write_shift(2,o),r.write_shift(1,0);var u=0;a.level&&(u|=a.level),a.hidden&&(u|=16),(a.hpx||a.hpt)&&(u|=32),r.write_shift(1,u),r.write_shift(1,0);var f=0,h=r.l;r.l+=4;for(var m={r:t,c:0},g=0;g<16;++g)if(!(e.s.c>g+1<<10||e.e.c<g<<10)){for(var y=-1,_=-1,E=g<<10;E<g+1<<10;++E){m.c=E;var w=Array.isArray(n)?(n[m.r]||[])[m.c]:n[Ft(m)];w&&(y<0&&(y=E),_=E)}y<0||(++f,r.write_shift(4,y),r.write_shift(4,_))}var T=r.l;return r.l=h,r.write_shift(4,f),r.l=T,r.length>r.l?r.slice(0,r.l):r}function h9(t,e,n,r){var a=f9(r,n,e);(a.length>17||(e["!rows"]||[])[r])&&Se(t,0,a)}var d9=Fo,m9=ru;function p9(){}function g9(t,e){var n={},r=t[t.l];return++t.l,n.above=!(r&64),n.left=!(r&128),t.l+=18,n.name=b8(t),n}function v9(t,e,n){n==null&&(n=ge(84+4*t.length));var r=192;e&&(e.above&&(r&=-65),e.left&&(r&=-129)),n.write_shift(1,r);for(var a=1;a<3;++a)n.write_shift(1,0);return d0({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),wA(t,n),n.slice(0,n.l)}function _9(t){var e=ii(t);return[e]}function y9(t,e,n){return n==null&&(n=ge(8)),No(e,n)}function x9(t){var e=Do(t);return[e]}function E9(t,e,n){return n==null&&(n=ge(4)),Oo(e,n)}function T9(t){var e=ii(t),n=t.read_shift(1);return[e,n,"b"]}function w9(t,e,n){return n==null&&(n=ge(9)),No(e,n),n.write_shift(1,t.v?1:0),n}function A9(t){var e=Do(t),n=t.read_shift(1);return[e,n,"b"]}function S9(t,e,n){return n==null&&(n=ge(5)),Oo(e,n),n.write_shift(1,t.v?1:0),n}function b9(t){var e=ii(t),n=t.read_shift(1);return[e,n,"e"]}function R9(t,e,n){return n==null&&(n=ge(9)),No(e,n),n.write_shift(1,t.v),n}function C9(t){var e=Do(t),n=t.read_shift(1);return[e,n,"e"]}function I9(t,e,n){return n==null&&(n=ge(8)),Oo(e,n),n.write_shift(1,t.v),n.write_shift(2,0),n.write_shift(1,0),n}function N9(t){var e=ii(t),n=t.read_shift(4);return[e,n,"s"]}function D9(t,e,n){return n==null&&(n=ge(12)),No(e,n),n.write_shift(4,e.v),n}function O9(t){var e=Do(t),n=t.read_shift(4);return[e,n,"s"]}function F9(t,e,n){return n==null&&(n=ge(8)),Oo(e,n),n.write_shift(4,e.v),n}function M9(t){var e=ii(t),n=iu(t);return[e,n,"n"]}function P9(t,e,n){return n==null&&(n=ge(16)),No(e,n),To(t.v,n),n}function k9(t){var e=Do(t),n=iu(t);return[e,n,"n"]}function L9(t,e,n){return n==null&&(n=ge(12)),Oo(e,n),To(t.v,n),n}function V9(t){var e=ii(t),n=AA(t);return[e,n,"n"]}function B9(t,e,n){return n==null&&(n=ge(12)),No(e,n),SA(t.v,n),n}function U9(t){var e=Do(t),n=AA(t);return[e,n,"n"]}function j9(t,e,n){return n==null&&(n=ge(8)),Oo(e,n),SA(t.v,n),n}function z9(t){var e=ii(t),n=d1(t);return[e,n,"is"]}function H9(t){var e=ii(t),n=rr(t);return[e,n,"str"]}function G9(t,e,n){return n==null&&(n=ge(12+4*t.v.length)),No(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function q9(t){var e=Do(t),n=rr(t);return[e,n,"str"]}function $9(t,e,n){return n==null&&(n=ge(8+4*t.v.length)),Oo(e,n),Pn(t.v,n),n.length>n.l?n.slice(0,n.l):n}function X9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=t.read_shift(1),u=[a,o,"b"];if(n.cellFormula){t.l+=2;var f=Y0(t,r-t.l,n);u[3]=Yl(f,null,a,n.supbooks,n)}else t.l=r;return u}function Y9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=t.read_shift(1),u=[a,o,"e"];if(n.cellFormula){t.l+=2;var f=Y0(t,r-t.l,n);u[3]=Yl(f,null,a,n.supbooks,n)}else t.l=r;return u}function W9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=iu(t),u=[a,o,"n"];if(n.cellFormula){t.l+=2;var f=Y0(t,r-t.l,n);u[3]=Yl(f,null,a,n.supbooks,n)}else t.l=r;return u}function K9(t,e,n){var r=t.l+e,a=ii(t);a.r=n["!row"];var o=rr(t),u=[a,o,"str"];if(n.cellFormula){t.l+=2;var f=Y0(t,r-t.l,n);u[3]=Yl(f,null,a,n.supbooks,n)}else t.l=r;return u}var Q9=Fo,Z9=ru;function J9(t,e){return e==null&&(e=ge(4)),e.write_shift(4,t),e}function eP(t,e){var n=t.l+e,r=Fo(t),a=m1(t),o=rr(t),u=rr(t),f=rr(t);t.l=n;var h={rfx:r,relId:a,loc:o,display:f};return u&&(h.Tooltip=u),h}function tP(t,e){var n=ge(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));ru({s:Mn(t[0]),e:Mn(t[0])},n),p1("rId"+e,n);var r=t[1].Target.indexOf("#"),a=r==-1?"":t[1].Target.slice(r+1);return Pn(a||"",n),Pn(t[1].Tooltip||"",n),Pn("",n),n.slice(0,n.l)}function nP(){}function rP(t,e,n){var r=t.l+e,a=bA(t),o=t.read_shift(1),u=[a];if(u[2]=o,n.cellFormula){var f=qM(t,r-t.l,n);u[1]=f}else t.l=r;return u}function iP(t,e,n){var r=t.l+e,a=Fo(t),o=[a];if(n.cellFormula){var u=XM(t,r-t.l,n);o[1]=u,t.l=r}else t.l=r;return o}function aP(t,e,n){n==null&&(n=ge(18));var r=W0(t,e);n.write_shift(-4,t),n.write_shift(-4,t),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var a=0;return e.hidden&&(a|=1),typeof r.width=="number"&&(a|=2),e.level&&(a|=e.level<<8),n.write_shift(2,a),n}var uS=["left","right","top","bottom","header","footer"];function sP(t){var e={};return uS.forEach(function(n){e[n]=iu(t)}),e}function oP(t,e){return e==null&&(e=ge(6*8)),oS(t),uS.forEach(function(n){To(t[n],e)}),e}function lP(t){var e=t.read_shift(2);return t.l+=28,{RTL:e&32}}function uP(t,e,n){n==null&&(n=ge(30));var r=924;return(((e||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function cP(t){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),ru(t,e),e}function fP(t,e){return e==null&&(e=ge(16*4+2)),e.write_shift(2,t.password?GA(t.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?e.write_shift(4,t[n[0]]!=null&&!t[n[0]]?1:0):e.write_shift(4,t[n[0]]!=null&&t[n[0]]?0:1)}),e}function hP(){}function dP(){}function mP(t,e,n,r,a,o,u){if(e.v===void 0)return!1;var f="";switch(e.t){case"b":f=e.v?"1":"0";break;case"d":e=br(e),e.z=e.z||nn[14],e.v=Sr(dr(e.v)),e.t="n";break;case"n":case"e":f=""+e.v;break;default:f=e.v;break}var h={r:n,c:r};switch(h.s=Ms(a.cellXfs,e,a),e.l&&o["!links"].push([Ft(h),e.l]),e.c&&o["!comments"].push([Ft(h),e.c]),e.t){case"s":case"str":return a.bookSST?(f=E1(a.Strings,e.v,a.revStrings),h.t="s",h.v=f,u?Se(t,18,F9(e,h)):Se(t,7,D9(e,h))):(h.t="str",u?Se(t,17,$9(e,h)):Se(t,6,G9(e,h))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?u?Se(t,13,j9(e,h)):Se(t,2,B9(e,h)):u?Se(t,16,L9(e,h)):Se(t,5,P9(e,h)),!0;case"b":return h.t="b",u?Se(t,15,S9(e,h)):Se(t,4,w9(e,h)),!0;case"e":return h.t="e",u?Se(t,14,I9(e,h)):Se(t,3,R9(e,h)),!0}return u?Se(t,12,E9(e,h)):Se(t,1,y9(e,h)),!0}function pP(t,e,n,r){var a=$t(e["!ref"]||"A1"),o,u="",f=[];Se(t,145);var h=Array.isArray(e),m=a.e.r;e["!rows"]&&(m=Math.max(a.e.r,e["!rows"].length-1));for(var g=a.s.r;g<=m;++g){u=$n(g),h9(t,e,a,g);var y=!1;if(g<=a.e.r)for(var _=a.s.c;_<=a.e.c;++_){g===a.s.r&&(f[_]=nr(_)),o=f[_]+u;var E=h?(e[g]||[])[_]:e[o];if(!E){y=!1;continue}y=mP(t,E,g,_,r,e,y)}}Se(t,146)}function gP(t,e){!e||!e["!merges"]||(Se(t,177,J9(e["!merges"].length)),e["!merges"].forEach(function(n){Se(t,176,Z9(n))}),Se(t,178))}function vP(t,e){!e||!e["!cols"]||(Se(t,390),e["!cols"].forEach(function(n,r){n&&Se(t,60,aP(r,n))}),Se(t,391))}function _P(t,e){!e||!e["!ref"]||(Se(t,648),Se(t,649,cP($t(e["!ref"]))),Se(t,650))}function yP(t,e,n){e["!links"].forEach(function(r){if(r[1].Target){var a=Dt(n,-1,r[1].Target.replace(/#.*$/,""),wt.HLINK);Se(t,494,tP(r,a))}}),delete e["!links"]}function xP(t,e,n,r){if(e["!comments"].length>0){var a=Dt(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",wt.VML);Se(t,551,p1("rId"+a)),e["!legacy"]=a}}function EP(t,e,n,r){if(e["!autofilter"]){var a=e["!autofilter"],o=typeof a.ref=="string"?a.ref:_n(a.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var u=n.Workbook.Names,f=Ur(o);f.s.r==f.e.r&&(f.e.r=Ur(e["!ref"]).e.r,o=_n(f));for(var h=0;h<u.length;++h){var m=u[h];if(m.Name=="_xlnm._FilterDatabase"&&m.Sheet==r){m.Ref="'"+n.SheetNames[r]+"'!"+o;break}}h==u.length&&u.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+o}),Se(t,161,ru($t(o))),Se(t,162)}}function TP(t,e,n){Se(t,133),Se(t,137,uP(e,n)),Se(t,138),Se(t,134)}function wP(t,e){e["!protect"]&&Se(t,535,fP(e["!protect"]))}function AP(t,e,n,r){var a=Ar(),o=n.SheetNames[t],u=n.Sheets[o]||{},f=o;try{n&&n.Workbook&&(f=n.Workbook.Sheets[t].CodeName||f)}catch{}var h=$t(u["!ref"]||"A1");if(h.e.c>16383||h.e.r>1048575){if(e.WTF)throw new Error("Range "+(u["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575)}return u["!links"]=[],u["!comments"]=[],Se(a,129),(n.vbaraw||u["!outline"])&&Se(a,147,v9(f,u["!outline"])),Se(a,148,m9(h)),TP(a,u,n.Workbook),vP(a,u),pP(a,u,t,e),wP(a,u),EP(a,u,n,t),gP(a,u),yP(a,u,r),u["!margins"]&&Se(a,476,oP(u["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&_P(a,u),xP(a,u,t,r),Se(a,130),a.end()}function SP(t,e){t.l+=10;var n=rr(t);return{name:n}}var bP=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function RP(t){return!t.Workbook||!t.Workbook.WBProps?"false":i8(t.Workbook.WBProps.date1904)?"true":"false"}var CP="][*?/\\".split("");function cS(t,e){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return CP.forEach(function(r){if(t.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function IP(t,e,n){t.forEach(function(r,a){cS(r);for(var o=0;o<a;++o)if(r==t[o])throw new Error("Duplicate Sheet Name: "+r);if(n){var u=e&&e[a]&&e[a].CodeName||r;if(u.charCodeAt(0)==95&&u.length>22)throw new Error("Bad Code Name: Worksheet"+u)}})}function NP(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var e=t.Workbook&&t.Workbook.Sheets||[];IP(t.SheetNames,e,!!t.vbaraw);for(var n=0;n<t.SheetNames.length;++n)ZM(t.Sheets[t.SheetNames[n]],t.SheetNames[n],n)}function fS(t){var e=[yn];e[e.length]=Ne("workbook",null,{xmlns:tu[0],"xmlns:r":Fn.r});var n=t.Workbook&&(t.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(bP.forEach(function(f){t.Workbook.WBProps[f[0]]!=null&&t.Workbook.WBProps[f[0]]!=f[1]&&(r[f[0]]=t.Workbook.WBProps[f[0]])}),t.Workbook.WBProps.CodeName&&(r.codeName=t.Workbook.WBProps.CodeName,delete r.CodeName)),e[e.length]=Ne("workbookPr",null,r);var a=t.Workbook&&t.Workbook.Sheets||[],o=0;if(a&&a[0]&&a[0].Hidden){for(e[e.length]="<bookViews>",o=0;o!=t.SheetNames.length&&!(!a[o]||!a[o].Hidden);++o);o==t.SheetNames.length&&(o=0),e[e.length]='<workbookView firstSheet="'+o+'" activeTab="'+o+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",o=0;o!=t.SheetNames.length;++o){var u={name:Ot(t.SheetNames[o].slice(0,31))};if(u.sheetId=""+(o+1),u["r:id"]="rId"+(o+1),a[o])switch(a[o].Hidden){case 1:u.state="hidden";break;case 2:u.state="veryHidden";break}e[e.length]=Ne("sheet",null,u)}return e[e.length]="</sheets>",n&&(e[e.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(f){var h={name:f.Name};f.Comment&&(h.comment=f.Comment),f.Sheet!=null&&(h.localSheetId=""+f.Sheet),f.Hidden&&(h.hidden="1"),f.Ref&&(e[e.length]=Ne("definedName",Ot(f.Ref),h))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function DP(t,e){var n={};return n.Hidden=t.read_shift(4),n.iTabID=t.read_shift(4),n.strRelID=Kp(t),n.name=rr(t),n}function OP(t,e){return e||(e=ge(127)),e.write_shift(4,t.Hidden),e.write_shift(4,t.iTabID),p1(t.strRelID,e),Pn(t.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function FP(t,e){var n={},r=t.read_shift(4);n.defaultThemeVersion=t.read_shift(4);var a=e>8?rr(t):"";return a.length>0&&(n.CodeName=a),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function MP(t,e){e||(e=ge(72));var n=0;return t&&t.filterPrivacy&&(n|=8),e.write_shift(4,n),e.write_shift(4,0),wA(t&&t.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function PP(t,e,n){var r=t.l+e;t.l+=4,t.l+=1;var a=t.read_shift(4),o=R8(t),u=$M(t,0,n),f=m1(t);t.l=r;var h={Name:o,Ptg:u};return a<268435455&&(h.Sheet=a),f&&(h.Comment=f),h}function kP(t,e){Se(t,143);for(var n=0;n!=e.SheetNames.length;++n){var r=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[n]&&e.Workbook.Sheets[n].Hidden||0,a={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:e.SheetNames[n]};Se(t,156,OP(a))}Se(t,144)}function LP(t,e){e||(e=ge(127));for(var n=0;n!=4;++n)e.write_shift(4,0);return Pn("SheetJS",e),Pn(a0.version,e),Pn(a0.version,e),Pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function VP(t,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,t),e.write_shift(4,t);var n=120;return e.write_shift(1,n),e.length>e.l?e.slice(0,e.l):e}function BP(t,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var n=e.Workbook.Sheets,r=0,a=-1,o=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&a==-1?a=r:n[r].Hidden==1&&o==-1&&(o=r);o>a||(Se(t,135),Se(t,158,VP(a)),Se(t,136))}}function UP(t,e){var n=Ar();return Se(n,131),Se(n,128,LP()),Se(n,153,MP(t.Workbook&&t.Workbook.WBProps||null)),BP(n,t),kP(n,t),Se(n,132),n.end()}function jP(t,e,n){return(e.slice(-4)===".bin"?UP:fS)(t)}function zP(t,e,n,r,a){return(e.slice(-4)===".bin"?AP:lS)(t,n,r,a)}function HP(t,e,n){return(e.slice(-4)===".bin"?oF:XA)(t,n)}function GP(t,e,n){return(e.slice(-4)===".bin"?M5:HA)(t,n)}function qP(t,e,n){return(e.slice(-4)===".bin"?wF:ZA)(t)}function $P(t){return(t.slice(-4)===".bin"?pF:KA)()}function XP(t,e){var n=[];return t.Props&&n.push(H8(t.Props,e)),t.Custprops&&n.push(G8(t.Props,t.Custprops)),n.join("")}function YP(){return""}function WP(t,e){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(r,a){var o=[];o.push(Ne("NumberFormat",null,{"ss:Format":Ot(nn[r.numFmtId])}));var u={"ss:ID":"s"+(21+a)};n.push(Ne("Style",o.join(""),u))}),Ne("Styles",n.join(""))}function hS(t){return Ne("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+y1(t.Ref,{r:0,c:0})})}function KP(t){if(!((t||{}).Workbook||{}).Names)return"";for(var e=t.Workbook.Names,n=[],r=0;r<e.length;++r){var a=e[r];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||n.push(hS(a)))}return Ne("Names",n.join(""))}function QP(t,e,n,r){if(!t||!((r||{}).Workbook||{}).Names)return"";for(var a=r.Workbook.Names,o=[],u=0;u<a.length;++u){var f=a[u];f.Sheet==n&&(f.Name.match(/^_xlfn\./)||o.push(hS(f)))}return o.join("")}function ZP(t,e,n,r){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(Ne("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(Ne("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(Ne("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)a.push(Ne("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var o=0;o<n&&!(r.Workbook.Sheets[o]&&!r.Workbook.Sheets[o].Hidden);++o);o==n&&a.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(qn("ProtectContents","True")),t["!protect"].objects&&a.push(qn("ProtectObjects","True")),t["!protect"].scenarios&&a.push(qn("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(qn("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(u){t["!protect"][u[0]]&&a.push("<"+u[1]+"/>")})),a.length==0?"":Ne("WorksheetOptions",a.join(""),{xmlns:Vr.x})}function JP(t){return t.map(function(e){var n=r8(e.t||""),r=Ne("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",r,{"ss:Author":e.a})}).join("")}function ek(t,e,n,r,a,o,u){if(!t||t.v==null&&t.f==null)return"";var f={};if(t.f&&(f["ss:Formula"]="="+Ot(y1(t.f,u))),t.F&&t.F.slice(0,e.length)==e){var h=Mn(t.F.slice(e.length+1));f["ss:ArrayRange"]="RC:R"+(h.r==u.r?"":"["+(h.r-u.r)+"]")+"C"+(h.c==u.c?"":"["+(h.c-u.c)+"]")}if(t.l&&t.l.Target&&(f["ss:HRef"]=Ot(t.l.Target),t.l.Tooltip&&(f["x:HRefScreenTip"]=Ot(t.l.Tooltip))),n["!merges"])for(var m=n["!merges"],g=0;g!=m.length;++g)m[g].s.c!=u.c||m[g].s.r!=u.r||(m[g].e.c>m[g].s.c&&(f["ss:MergeAcross"]=m[g].e.c-m[g].s.c),m[g].e.r>m[g].s.r&&(f["ss:MergeDown"]=m[g].e.r-m[g].s.r));var y="",_="";switch(t.t){case"z":if(!r.sheetStubs)return"";break;case"n":y="Number",_=String(t.v);break;case"b":y="Boolean",_=t.v?"1":"0";break;case"e":y="Error",_=tf[t.v];break;case"d":y="DateTime",_=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||nn[14]);break;case"s":y="String",_=n8(t.v||"");break}var E=Ms(r.cellXfs,t,r);f["ss:StyleID"]="s"+(21+E),f["ss:Index"]=u.c+1;var w=t.v!=null?_:"",T=t.t=="z"?"":'<Data ss:Type="'+y+'">'+w+"</Data>";return(t.c||[]).length>0&&(T+=JP(t.c)),Ne("Cell",T,f)}function tk(t,e){var n='<Row ss:Index="'+(t+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=$A(e.hpt)),e.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(n+=' ss:Hidden="1"')),n+">"}function nk(t,e,n,r){if(!t["!ref"])return"";var a=$t(t["!ref"]),o=t["!merges"]||[],u=0,f=[];t["!cols"]&&t["!cols"].forEach(function(b,k){v1(b);var q=!!b.width,X=W0(k,b),ee={"ss:Index":k+1};q&&(ee["ss:Width"]=p0(X.width)),b.hidden&&(ee["ss:Hidden"]="1"),f.push(Ne("Column",null,ee))});for(var h=Array.isArray(t),m=a.s.r;m<=a.e.r;++m){for(var g=[tk(m,(t["!rows"]||[])[m])],y=a.s.c;y<=a.e.c;++y){var _=!1;for(u=0;u!=o.length;++u)if(!(o[u].s.c>y)&&!(o[u].s.r>m)&&!(o[u].e.c<y)&&!(o[u].e.r<m)){(o[u].s.c!=y||o[u].s.r!=m)&&(_=!0);break}if(!_){var E={r:m,c:y},w=Ft(E),T=h?(t[m]||[])[y]:t[w];g.push(ek(T,w,t,e,n,r,E))}}g.push("</Row>"),g.length>2&&f.push(g.join(""))}return f.join("")}function rk(t,e,n){var r=[],a=n.SheetNames[t],o=n.Sheets[a],u=o?QP(o,e,t,n):"";return u.length>0&&r.push("<Names>"+u+"</Names>"),u=o?nk(o,e,t,n):"",u.length>0&&r.push("<Table>"+u+"</Table>"),r.push(ZP(o,e,t,n)),r.join("")}function ik(t,e){e||(e={}),t.SSF||(t.SSF=br(nn)),t.SSF&&(G0(),H0(t.SSF),e.revssf=q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF,e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(XP(t,e)),n.push(YP()),n.push(""),n.push("");for(var r=0;r<t.SheetNames.length;++r)n.push(Ne("Worksheet",rk(r,e,t),{"ss:Name":Ot(t.SheetNames[r])}));return n[2]=WP(t,e),n[3]=KP(t),yn+Ne("Workbook",n.join(""),{xmlns:Vr.ss,"xmlns:o":Vr.o,"xmlns:x":Vr.x,"xmlns:ss":Vr.ss,"xmlns:dt":Vr.dt,"xmlns:html":Vr.html})}var yp={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function ak(t,e){var n=[],r=[],a=[],o=0,u,f=P2(Y2,"n"),h=P2(W2,"n");if(t.Props)for(u=Yn(t.Props),o=0;o<u.length;++o)(Object.prototype.hasOwnProperty.call(f,u[o])?n:Object.prototype.hasOwnProperty.call(h,u[o])?r:a).push([u[o],t.Props[u[o]]]);if(t.Custprops)for(u=Yn(t.Custprops),o=0;o<u.length;++o)Object.prototype.hasOwnProperty.call(t.Props||{},u[o])||(Object.prototype.hasOwnProperty.call(f,u[o])?n:Object.prototype.hasOwnProperty.call(h,u[o])?r:a).push([u[o],t.Custprops[u[o]]]);var m=[];for(o=0;o<a.length;++o)kA.indexOf(a[o][0])>-1||FA.indexOf(a[o][0])>-1||a[o][1]!=null&&m.push(a[o]);r.length&&Vt.utils.cfb_add(e,"/SummaryInformation",eE(r,yp.SI,h,W2)),(n.length||m.length)&&Vt.utils.cfb_add(e,"/DocumentSummaryInformation",eE(n,yp.DSI,f,Y2,m.length?m:null,yp.UDI))}function sk(t,e){var n=e||{},r=Vt.utils.cfb_new({root:"R"}),a="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":a="/Workbook",n.biff=8;break;case"biff5":a="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Vt.utils.cfb_add(r,a,dS(t,n)),n.biff==8&&(t.Props||t.Custprops)&&ak(t,r),n.biff==8&&t.vbaraw&&AF(r,Vt.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),r}var ok={0:{f:c9},1:{f:_9},2:{f:V9},3:{f:b9},4:{f:T9},5:{f:M9},6:{f:H9},7:{f:N9},8:{f:K9},9:{f:W9},10:{f:X9},11:{f:Y9},12:{f:x9},13:{f:U9},14:{f:C9},15:{f:A9},16:{f:k9},17:{f:q9},18:{f:O9},19:{f:d1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:PP},40:{},42:{},43:{f:H5},44:{f:j5},45:{f:$5},46:{f:Y5},47:{f:X5},48:{},49:{f:x8},50:{},51:{f:cF},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:E5},62:{f:z9},63:{f:gF},64:{f:hP},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Ki,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:lP},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:g9},148:{f:d9,p:16},151:{f:nP},152:{},153:{f:FP},154:{},155:{},156:{f:DP},157:{},158:{},159:{T:1,f:D5},160:{T:-1},161:{T:1,f:Fo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Q9},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:lF},336:{T:-1},337:{f:dF,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kp},357:{},358:{},359:{},360:{T:1},361:{},362:{f:p5},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:rP},427:{f:iP},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:sP},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:p9},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:eP},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kp},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:EF},633:{T:1},634:{T:-1},635:{T:1,f:yF},636:{T:-1},637:{f:A8},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:SP},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:dP},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Oe(t,e,n,r){var a=e;if(!isNaN(a)){var o=r||(n||[]).length||0,u=t.next(4);u.write_shift(2,a),u.write_shift(2,o),o>0&&c1(n)&&t.push(n)}}function lk(t,e,n,r){var a=(n||[]).length||0;if(a<=8224)return Oe(t,e,n,a);var o=e;if(!isNaN(o)){for(var u=n.parts||[],f=0,h=0,m=0;m+(u[f]||8224)<=8224;)m+=u[f]||8224,f++;var g=t.next(4);for(g.write_shift(2,o),g.write_shift(2,m),t.push(n.slice(h,h+m)),h+=m;h<a;){for(g=t.next(4),g.write_shift(2,60),m=0;m+(u[f]||8224)<=8224;)m+=u[f]||8224,f++;g.write_shift(2,m),t.push(n.slice(h,h+m)),h+=m}}}function rf(t,e,n){return t||(t=ge(7)),t.write_shift(2,e),t.write_shift(2,n),t.write_shift(2,0),t.write_shift(1,0),t}function uk(t,e,n,r){var a=ge(9);return rf(a,t,e),VA(n,r||"b",a),a}function ck(t,e,n){var r=ge(8+2*n.length);return rf(r,t,e),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function fk(t,e,n,r){if(e.v!=null)switch(e.t){case"d":case"n":var a=e.t=="d"?Sr(dr(e.v)):e.v;a==(a|0)&&a>=0&&a<65536?Oe(t,2,S5(n,r,a)):Oe(t,3,A5(n,r,a));return;case"b":case"e":Oe(t,5,uk(n,r,e.v,e.t));return;case"s":case"str":Oe(t,4,ck(n,r,(e.v||"").slice(0,255)));return}Oe(t,1,rf(null,n,r))}function hk(t,e,n,r){var a=Array.isArray(e),o=$t(e["!ref"]||"A1"),u,f="",h=[];if(o.e.c>255||o.e.r>16383){if(r.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");o.e.c=Math.min(o.e.c,255),o.e.r=Math.min(o.e.c,16383),u=_n(o)}for(var m=o.s.r;m<=o.e.r;++m){f=$n(m);for(var g=o.s.c;g<=o.e.c;++g){m===o.s.r&&(h[g]=nr(g)),u=h[g]+f;var y=a?(e[m]||[])[g]:e[u];y&&fk(t,y,m,g)}}}function dk(t,e){for(var n=e||{},r=Ar(),a=0,o=0;o<t.SheetNames.length;++o)t.SheetNames[o]==n.sheet&&(a=o);if(a==0&&n.sheet&&t.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Oe(r,n.biff==4?1033:n.biff==3?521:9,g1(t,16,n)),hk(r,t.Sheets[t.SheetNames[a]],a,n),Oe(r,10),r.end()}function mk(t,e,n){Oe(t,49,o5({sz:12,name:"Arial"},n))}function pk(t,e,n){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var a=r[0];a<=r[1];++a)e[a]!=null&&Oe(t,1054,c5(a,e[a],n))})}function gk(t,e){var n=ge(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Oe(t,2151,n),n=ge(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),jA($t(e["!ref"]||"A1"),n),n.write_shift(4,4),Oe(t,2152,n)}function vk(t,e){for(var n=0;n<16;++n)Oe(t,224,nE({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(r){Oe(t,224,nE(r,0,e))})}function _k(t,e){for(var n=0;n<e["!links"].length;++n){var r=e["!links"][n];Oe(t,440,_5(r)),r[1].Tooltip&&Oe(t,2048,y5(r))}delete e["!links"]}function yk(t,e){if(e){var n=0;e.forEach(function(r,a){++n<=256&&r&&Oe(t,125,T5(W0(a,r),a))})}}function xk(t,e,n,r,a){var o=16+Ms(a.cellXfs,e,a);if(e.v==null&&!e.bf){Oe(t,513,wo(n,r,o));return}if(e.bf)Oe(t,6,GM(e,n,r,a,o));else switch(e.t){case"d":case"n":var u=e.t=="d"?Sr(dr(e.v)):e.v;Oe(t,515,m5(n,r,u,o));break;case"b":case"e":Oe(t,517,d5(n,r,e.v,o,a,e.t));break;case"s":case"str":if(a.bookSST){var f=E1(a.Strings,e.v,a.revStrings);Oe(t,253,l5(n,r,f,o))}else Oe(t,516,u5(n,r,(e.v||"").slice(0,255),o,a));break;default:Oe(t,513,wo(n,r,o))}}function Ek(t,e,n){var r=Ar(),a=n.SheetNames[t],o=n.Sheets[a]||{},u=(n||{}).Workbook||{},f=(u.Sheets||[])[t]||{},h=Array.isArray(o),m=e.biff==8,g,y="",_=[],E=$t(o["!ref"]||"A1"),w=m?65536:16384;if(E.e.c>255||E.e.r>=w){if(e.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:IV16384");E.e.c=Math.min(E.e.c,255),E.e.r=Math.min(E.e.c,w-1)}Oe(r,2057,g1(n,16,e)),Oe(r,13,ei(1)),Oe(r,12,ei(100)),Oe(r,15,hr(!0)),Oe(r,17,hr(!1)),Oe(r,16,To(.001)),Oe(r,95,hr(!0)),Oe(r,42,hr(!1)),Oe(r,43,hr(!1)),Oe(r,130,ei(1)),Oe(r,128,h5()),Oe(r,131,hr(!1)),Oe(r,132,hr(!1)),m&&yk(r,o["!cols"]),Oe(r,512,f5(E,e)),m&&(o["!links"]=[]);for(var T=E.s.r;T<=E.e.r;++T){y=$n(T);for(var b=E.s.c;b<=E.e.c;++b){T===E.s.r&&(_[b]=nr(b)),g=_[b]+y;var k=h?(o[T]||[])[b]:o[g];k&&(xk(r,k,T,b,e),m&&k.l&&o["!links"].push([g,k.l]))}}var q=f.CodeName||f.name||a;return m&&Oe(r,574,s5((u.Views||[])[0])),m&&(o["!merges"]||[]).length&&Oe(r,229,v5(o["!merges"])),m&&_k(r,o),Oe(r,442,UA(q)),m&&gk(r,o),Oe(r,10),r.end()}function Tk(t,e,n){var r=Ar(),a=(t||{}).Workbook||{},o=a.Sheets||[],u=a.WBProps||{},f=n.biff==8,h=n.biff==5;if(Oe(r,2057,g1(t,5,n)),n.bookType=="xla"&&Oe(r,135),Oe(r,225,f?ei(1200):null),Oe(r,193,X8(2)),h&&Oe(r,191),h&&Oe(r,192),Oe(r,226),Oe(r,92,n5("SheetJS",n)),Oe(r,66,ei(f?1200:1252)),f&&Oe(r,353,ei(0)),f&&Oe(r,448),Oe(r,317,w5(t.SheetNames.length)),f&&t.vbaraw&&Oe(r,211),f&&t.vbaraw){var m=u.CodeName||"ThisWorkbook";Oe(r,442,UA(m))}Oe(r,156,ei(17)),Oe(r,25,hr(!1)),Oe(r,18,hr(!1)),Oe(r,19,ei(0)),f&&Oe(r,431,hr(!1)),f&&Oe(r,444,ei(0)),Oe(r,61,a5()),Oe(r,64,hr(!1)),Oe(r,141,ei(0)),Oe(r,34,hr(RP(t)=="true")),Oe(r,14,hr(!0)),f&&Oe(r,439,hr(!1)),Oe(r,218,ei(0)),mk(r,t,n),pk(r,t.SSF,n),vk(r,n),f&&Oe(r,352,hr(!1));var g=r.end(),y=Ar();f&&Oe(y,140,x5()),f&&n.Strings&&lk(y,252,i5(n.Strings)),Oe(y,10);var _=y.end(),E=Ar(),w=0,T=0;for(T=0;T<t.SheetNames.length;++T)w+=(f?12:11)+(f?2:1)*t.SheetNames[T].length;var b=g.length+w+_.length;for(T=0;T<t.SheetNames.length;++T){var k=o[T]||{};Oe(E,133,r5({pos:b,hs:k.Hidden||0,dt:0,name:t.SheetNames[T]},n)),b+=e[T].length}var q=E.end();if(w!=q.length)throw new Error("BS8 "+w+" != "+q.length);var X=[];return g.length&&X.push(g),q.length&&X.push(q),_.length&&X.push(_),Gn(X)}function wk(t,e){var n=e||{},r=[];t&&!t.SSF&&(t.SSF=br(nn)),t&&t.SSF&&(G0(),H0(t.SSF),n.revssf=q0(t.SSF),n.revssf[t.SSF[65535]]=0,n.ssf=t.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,T1(n),n.cellXfs=[],Ms(n.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)r[r.length]=Ek(a,n,t);return r.unshift(Tk(t,r,n)),Gn(r)}function dS(t,e){for(var n=0;n<=t.SheetNames.length;++n){var r=t.Sheets[t.SheetNames[n]];if(!(!r||!r["!ref"])){var a=Ur(r["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var o=e||{};switch(o.biff||2){case 8:case 5:return wk(t,e);case 4:case 3:case 2:return dk(t,e)}throw new Error("invalid type "+o.bookType+" for BIFF")}function Ak(t,e,n,r){for(var a=t["!merges"]||[],o=[],u=e.s.c;u<=e.e.c;++u){for(var f=0,h=0,m=0;m<a.length;++m)if(!(a[m].s.r>n||a[m].s.c>u)&&!(a[m].e.r<n||a[m].e.c<u)){if(a[m].s.r<n||a[m].s.c<u){f=-1;break}f=a[m].e.r-a[m].s.r+1,h=a[m].e.c-a[m].s.c+1;break}if(!(f<0)){var g=Ft({r:n,c:u}),y=r.dense?(t[n]||[])[u]:t[g],_=y&&y.v!=null&&(y.h||t8(y.w||(Oa(y),y.w)||""))||"",E={};f>1&&(E.rowspan=f),h>1&&(E.colspan=h),r.editable?_='<span contenteditable="true">'+_+"</span>":y&&(E["data-t"]=y&&y.t||"z",y.v!=null&&(E["data-v"]=y.v),y.z!=null&&(E["data-z"]=y.z),y.l&&(y.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+y.l.Target+'">'+_+"</a>")),E.id=(r.id||"sjs")+"-"+g,o.push(Ne("td",_,E))}}var w="<tr>";return w+o.join("")+"</tr>"}var Sk='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bk="</body></html>";function Rk(t,e,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function mS(t,e){var n=e||{},r=n.header!=null?n.header:Sk,a=n.footer!=null?n.footer:bk,o=[r],u=Ur(t["!ref"]);n.dense=Array.isArray(t),o.push(Rk(t,u,n));for(var f=u.s.r;f<=u.e.r;++f)o.push(Ak(t,u,f,n));return o.push("</table>"+a),o.join("")}function pS(t,e,n){var r=n||{},a=0,o=0;if(r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var u=typeof r.origin=="string"?Mn(r.origin):r.origin;a=u.r,o=u.c}var f=e.getElementsByTagName("tr"),h=Math.min(r.sheetRows||1e7,f.length),m={s:{r:0,c:0},e:{r:a,c:o}};if(t["!ref"]){var g=Ur(t["!ref"]);m.s.r=Math.min(m.s.r,g.s.r),m.s.c=Math.min(m.s.c,g.s.c),m.e.r=Math.max(m.e.r,g.e.r),m.e.c=Math.max(m.e.c,g.e.c),a==-1&&(m.e.r=a=g.e.r+1)}var y=[],_=0,E=t["!rows"]||(t["!rows"]=[]),w=0,T=0,b=0,k=0,q=0,X=0;for(t["!cols"]||(t["!cols"]=[]);w<f.length&&T<h;++w){var ee=f[w];if(uE(ee)){if(r.display)continue;E[T]={hidden:!0}}var he=ee.children;for(b=k=0;b<he.length;++b){var Ae=he[b];if(!(r.display&&uE(Ae))){var N=Ae.hasAttribute("data-v")?Ae.getAttribute("data-v"):Ae.hasAttribute("v")?Ae.getAttribute("v"):a8(Ae.innerHTML),I=Ae.getAttribute("data-z")||Ae.getAttribute("z");for(_=0;_<y.length;++_){var R=y[_];R.s.c==k+o&&R.s.r<T+a&&T+a<=R.e.r&&(k=R.e.c+1-o,_=-1)}X=+Ae.getAttribute("colspan")||1,((q=+Ae.getAttribute("rowspan")||1)>1||X>1)&&y.push({s:{r:T+a,c:k+o},e:{r:T+a+(q||1)-1,c:k+o+(X||1)-1}});var M={t:"s",v:N},B=Ae.getAttribute("data-t")||Ae.getAttribute("t")||"";N!=null&&(N.length==0?M.t=B||"z":r.raw||N.trim().length==0||B=="s"||(N==="TRUE"?M={t:"b",v:!0}:N==="FALSE"?M={t:"b",v:!1}:isNaN(Aa(N))?isNaN(Lc(N).getDate())||(M={t:"d",v:dr(N)},r.cellDates||(M={t:"n",v:Sr(M.v)}),M.z=r.dateNF||nn[14]):M={t:"n",v:Aa(N)})),M.z===void 0&&I!=null&&(M.z=I);var H="",V=Ae.getElementsByTagName("A");if(V&&V.length)for(var Je=0;Je<V.length&&!(V[Je].hasAttribute("href")&&(H=V[Je].getAttribute("href"),H.charAt(0)!="#"));++Je);H&&H.charAt(0)!="#"&&(M.l={Target:H}),r.dense?(t[T+a]||(t[T+a]=[]),t[T+a][k+o]=M):t[Ft({c:k+o,r:T+a})]=M,m.e.c<k+o&&(m.e.c=k+o),k+=X}}++T}return y.length&&(t["!merges"]=(t["!merges"]||[]).concat(y)),m.e.r=Math.max(m.e.r,T-1+a),t["!ref"]=_n(m),T>=h&&(t["!fullref"]=_n((m.e.r=f.length-w+T-1+a,m))),t}function gS(t,e){var n=e||{},r=n.dense?[]:{};return pS(r,t,e)}function Ck(t,e){return Io(gS(t,e),e)}function uE(t){var e="",n=Ik(t);return n&&(e=n(t).getPropertyValue("display")),e||(e=t.style&&t.style.display),e==="none"}function Ik(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Nk=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return yn+e}}(),cE=function(){var t=function(o){return Ot(o).replace(/  +/g,function(u){return'<text:s text:c="'+u.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(o,u,f){var h=[];h.push('      <table:table table:name="'+Ot(u.SheetNames[f])+`" table:style-name="ta1">
`);var m=0,g=0,y=Ur(o["!ref"]||"A1"),_=o["!merges"]||[],E=0,w=Array.isArray(o);if(o["!cols"])for(g=0;g<=y.e.c;++g)h.push("        <table:table-column"+(o["!cols"][g]?' table:style-name="co'+o["!cols"][g].ods+'"':"")+`></table:table-column>
`);var T="",b=o["!rows"]||[];for(m=0;m<y.s.r;++m)T=b[m]?' table:style-name="ro'+b[m].ods+'"':"",h.push("        <table:table-row"+T+`></table:table-row>
`);for(;m<=y.e.r;++m){for(T=b[m]?' table:style-name="ro'+b[m].ods+'"':"",h.push("        <table:table-row"+T+`>
`),g=0;g<y.s.c;++g)h.push(e);for(;g<=y.e.c;++g){var k=!1,q={},X="";for(E=0;E!=_.length;++E)if(!(_[E].s.c>g)&&!(_[E].s.r>m)&&!(_[E].e.c<g)&&!(_[E].e.r<m)){(_[E].s.c!=g||_[E].s.r!=m)&&(k=!0),q["table:number-columns-spanned"]=_[E].e.c-_[E].s.c+1,q["table:number-rows-spanned"]=_[E].e.r-_[E].s.r+1;break}if(k){h.push(n);continue}var ee=Ft({r:m,c:g}),he=w?(o[m]||[])[g]:o[ee];if(he&&he.f&&(q["table:formula"]=Ot(KM(he.f)),he.F&&he.F.slice(0,ee.length)==ee)){var Ae=Ur(he.F);q["table:number-matrix-columns-spanned"]=Ae.e.c-Ae.s.c+1,q["table:number-matrix-rows-spanned"]=Ae.e.r-Ae.s.r+1}if(!he){h.push(e);continue}switch(he.t){case"b":X=he.v?"TRUE":"FALSE",q["office:value-type"]="boolean",q["office:boolean-value"]=he.v?"true":"false";break;case"n":X=he.w||String(he.v||0),q["office:value-type"]="float",q["office:value"]=he.v||0;break;case"s":case"str":X=he.v==null?"":he.v,q["office:value-type"]="string";break;case"d":X=he.w||dr(he.v).toISOString(),q["office:value-type"]="date",q["office:date-value"]=dr(he.v).toISOString(),q["table:style-name"]="ce1";break;default:h.push(e);continue}var N=t(X);if(he.l&&he.l.Target){var I=he.l.Target;I=I.charAt(0)=="#"?"#"+QM(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),N=Ne("text:a",N,{"xlink:href":I.replace(/&/g,"&amp;")})}h.push("          "+Ne("table:table-cell",Ne("text:p",N,{}),q)+`
`)}h.push(`        </table:table-row>
`)}return h.push(`      </table:table>
`),h.join("")},a=function(o,u){o.push(` <office:automatic-styles>
`),o.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),o.push(`   <number:month number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:day number:style="long"/>
`),o.push(`   <number:text>/</number:text>
`),o.push(`   <number:year/>
`),o.push(`  </number:date-style>
`);var f=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!cols"]){for(var g=0;g<m["!cols"].length;++g)if(m["!cols"][g]){var y=m["!cols"][g];if(y.width==null&&y.wpx==null&&y.wch==null)continue;v1(y),y.ods=f;var _=m["!cols"][g].wpx+"px";o.push('  <style:style style:name="co'+f+`" style:family="table-column">
`),o.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),o.push(`  </style:style>
`),++f}}});var h=0;u.SheetNames.map(function(m){return u.Sheets[m]}).forEach(function(m){if(m&&m["!rows"]){for(var g=0;g<m["!rows"].length;++g)if(m["!rows"][g]){m["!rows"][g].ods=h;var y=m["!rows"][g].hpx+"px";o.push('  <style:style style:name="ro'+h+`" style:family="table-row">
`),o.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+y+`"/>
`),o.push(`  </style:style>
`),++h}}}),o.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),o.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),o.push(`  </style:style>
`),o.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),o.push(` </office:automatic-styles>
`)};return function(u,f){var h=[yn],m=Bc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),g=Bc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});f.bookType=="fods"?(h.push("<office:document"+m+g+`>
`),h.push(DA().replace(/office:document-meta/g,"office:meta"))):h.push("<office:document-content"+m+`>
`),a(h,u),h.push(`  <office:body>
`),h.push(`    <office:spreadsheet>
`);for(var y=0;y!=u.SheetNames.length;++y)h.push(r(u.Sheets[u.SheetNames[y]],u,y));return h.push(`    </office:spreadsheet>
`),h.push(`  </office:body>
`),f.bookType=="fods"?h.push("</office:document>"):h.push("</office:document-content>"),h.join("")}}();function vS(t,e){if(e.bookType=="fods")return cE(t,e);var n=s1(),r="",a=[],o=[];return r="mimetype",it(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",it(n,r,cE(t,e)),a.push([r,"text/xml"]),o.push([r,"ContentFile"]),r="styles.xml",it(n,r,Nk(t,e)),a.push([r,"text/xml"]),o.push([r,"StylesFile"]),r="meta.xml",it(n,r,yn+DA()),a.push([r,"text/xml"]),o.push([r,"MetadataFile"]),r="manifest.rdf",it(n,r,z8(o)),a.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",it(n,r,U8(a)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function _0(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Dk(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):di(Vc(t))}function Ok(t,e){e:for(var n=0;n<=t.length-e.length;++n){for(var r=0;r<e.length;++r)if(t[n+r]!=e[r])continue e;return!0}return!1}function Ds(t){var e=t.reduce(function(a,o){return a+o.length},0),n=new Uint8Array(e),r=0;return t.forEach(function(a){n.set(a,r),r+=a.length}),n}function Fk(t,e,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,a=n/Math.pow(10,r-6176);t[e+15]|=r>>7,t[e+14]|=(r&127)<<1;for(var o=0;a>=1;++o,a/=256)t[e+o]=a&255;t[e+15]|=n>=0?0:128}function Uc(t,e){var n=e?e[0]:0,r=t[n]&127;e:if(t[n++]>=128&&(r|=(t[n]&127)<<7,t[n++]<128||(r|=(t[n]&127)<<14,t[n++]<128)||(r|=(t[n]&127)<<21,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,28),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,35),++n,t[n++]<128)||(r+=(t[n]&127)*Math.pow(2,42),++n,t[n++]<128)))break e;return e&&(e[0]=n),r}function Nt(t){var e=new Uint8Array(7);e[0]=t&127;var n=1;e:if(t>127){if(e[n-1]|=128,e[n]=t>>7&127,++n,t<=16383||(e[n-1]|=128,e[n]=t>>14&127,++n,t<=2097151)||(e[n-1]|=128,e[n]=t>>21&127,++n,t<=268435455)||(e[n-1]|=128,e[n]=t/256>>>21&127,++n,t<=34359738367)||(e[n-1]|=128,e[n]=t/65536>>>21&127,++n,t<=4398046511103))break e;e[n-1]|=128,e[n]=t/16777216>>>21&127,++n}return e.slice(0,n)}function Vl(t){var e=0,n=t[e]&127;e:if(t[e++]>=128){if(n|=(t[e]&127)<<7,t[e++]<128||(n|=(t[e]&127)<<14,t[e++]<128)||(n|=(t[e]&127)<<21,t[e++]<128))break e;n|=(t[e]&127)<<28}return n}function An(t){for(var e=[],n=[0];n[0]<t.length;){var r=n[0],a=Uc(t,n),o=a&7;a=Math.floor(a/8);var u=0,f;if(a==0)break;switch(o){case 0:{for(var h=n[0];t[n[0]++]>=128;);f=t.slice(h,n[0])}break;case 5:u=4,f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 1:u=8,f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 2:u=Uc(t,n),f=t.slice(n[0],n[0]+u),n[0]+=u;break;case 3:case 4:default:throw new Error("PB Type ".concat(o," for Field ").concat(a," at offset ").concat(r))}var m={data:f,type:o};e[a]==null?e[a]=[m]:e[a].push(m)}return e}function Un(t){var e=[];return t.forEach(function(n,r){n.forEach(function(a){a.data&&(e.push(Nt(r*8+a.type)),a.type==2&&e.push(Nt(a.data.length)),e.push(a.data))})}),Ds(e)}function fi(t){for(var e,n=[],r=[0];r[0]<t.length;){var a=Uc(t,r),o=An(t.slice(r[0],r[0]+a));r[0]+=a;var u={id:Vl(o[1][0].data),messages:[]};o[2].forEach(function(f){var h=An(f.data),m=Vl(h[3][0].data);u.messages.push({meta:h,data:t.slice(r[0],r[0]+m)}),r[0]+=m}),(e=o[3])!=null&&e[0]&&(u.merge=Vl(o[3][0].data)>>>0>0),n.push(u)}return n}function wl(t){var e=[];return t.forEach(function(n){var r=[];r[1]=[{data:Nt(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Nt(+!!n.merge),type:0}]);var a=[];n.messages.forEach(function(u){a.push(u.data),u.meta[3]=[{type:0,data:Nt(u.data.length)}],r[2].push({data:Un(u.meta),type:2})});var o=Un(r);e.push(Nt(o.length)),e.push(o),a.forEach(function(u){return e.push(u)})}),Ds(e)}function Mk(t,e){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var n=[0],r=Uc(e,n),a=[];n[0]<e.length;){var o=e[n[0]]&3;if(o==0){var u=e[n[0]++]>>2;if(u<60)++u;else{var f=u-59;u=e[n[0]],f>1&&(u|=e[n[0]+1]<<8),f>2&&(u|=e[n[0]+2]<<16),f>3&&(u|=e[n[0]+3]<<24),u>>>=0,u++,n[0]+=f}a.push(e.slice(n[0],n[0]+u)),n[0]+=u;continue}else{var h=0,m=0;if(o==1?(m=(e[n[0]]>>2&7)+4,h=(e[n[0]++]&224)<<3,h|=e[n[0]++]):(m=(e[n[0]++]>>2)+1,o==2?(h=e[n[0]]|e[n[0]+1]<<8,n[0]+=2):(h=(e[n[0]]|e[n[0]+1]<<8|e[n[0]+2]<<16|e[n[0]+3]<<24)>>>0,n[0]+=4)),a=[Ds(a)],h==0)throw new Error("Invalid offset 0");if(h>a[0].length)throw new Error("Invalid offset beyond length");if(m>=h)for(a.push(a[0].slice(-h)),m-=h;m>=a[a.length-1].length;)a.push(a[a.length-1]),m-=a[a.length-1].length;a.push(a[0].slice(-h,-h+m))}}var g=Ds(a);if(g.length!=r)throw new Error("Unexpected length: ".concat(g.length," != ").concat(r));return g}function hi(t){for(var e=[],n=0;n<t.length;){var r=t[n++],a=t[n]|t[n+1]<<8|t[n+2]<<16;n+=3,e.push(Mk(r,t.slice(n,n+a))),n+=a}if(n!==t.length)throw new Error("data is not a valid framed stream!");return Ds(e)}function Al(t){for(var e=[],n=0;n<t.length;){var r=Math.min(t.length-n,268435455),a=new Uint8Array(4);e.push(a);var o=Nt(r),u=o.length;e.push(o),r<=60?(u++,e.push(new Uint8Array([r-1<<2]))):r<=256?(u+=2,e.push(new Uint8Array([240,r-1&255]))):r<=65536?(u+=3,e.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(u+=4,e.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(u+=5,e.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),e.push(t.slice(n,n+r)),u+=r,a[0]=0,a[1]=u&255,a[2]=u>>8&255,a[3]=u>>16&255,n+=r}return Ds(e)}function xp(t,e){var n=new Uint8Array(32),r=_0(n),a=12,o=0;switch(n[0]=5,t.t){case"n":n[1]=2,Fk(n,a,t.v),o|=1,a+=16;break;case"b":n[1]=6,r.setFloat64(a,t.v?1:0,!0),o|=2,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[1]=3,r.setUint32(a,e.indexOf(t.v),!0),o|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(8,o,!0),n.slice(0,a)}function Ep(t,e){var n=new Uint8Array(32),r=_0(n),a=12,o=0;switch(n[0]=3,t.t){case"n":n[2]=2,r.setFloat64(a,t.v,!0),o|=32,a+=8;break;case"b":n[2]=6,r.setFloat64(a,t.v?1:0,!0),o|=32,a+=8;break;case"s":if(e.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));n[2]=3,r.setUint32(a,e.indexOf(t.v),!0),o|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return r.setUint32(4,o,!0),n.slice(0,a)}function us(t){var e=An(t);return Uc(e[1][0].data)}function Pk(t,e,n){var r,a,o,u;if(!((r=t[6])!=null&&r[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var f=((u=(o=t[8])==null?void 0:o[0])==null?void 0:u.data)&&Vl(t[8][0].data)>0||!1;if(f)throw"Math only works with normal offsets";for(var h=0,m=_0(t[7][0].data),g=0,y=[],_=_0(t[4][0].data),E=0,w=[],T=0;T<e.length;++T){if(e[T]==null){m.setUint16(T*2,65535,!0),_.setUint16(T*2,65535);continue}m.setUint16(T*2,g,!0),_.setUint16(T*2,E,!0);var b,k;switch(typeof e[T]){case"string":b=xp({t:"s",v:e[T]},n),k=Ep({t:"s",v:e[T]},n);break;case"number":b=xp({t:"n",v:e[T]},n),k=Ep({t:"n",v:e[T]},n);break;case"boolean":b=xp({t:"b",v:e[T]},n),k=Ep({t:"b",v:e[T]},n);break;default:throw new Error("Unsupported value "+e[T])}y.push(b),g+=b.length,w.push(k),E+=k.length,++h}for(t[2][0].data=Nt(h);T<t[7][0].data.length/2;++T)m.setUint16(T*2,65535,!0),_.setUint16(T*2,65535,!0);return t[6][0].data=Ds(y),t[3][0].data=Ds(w),h}function kk(t,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Ur(n["!ref"]);r.s.r=r.s.c=0;var a=!1;r.e.c>9&&(a=!0,r.e.c=9),r.e.r>49&&(a=!0,r.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(_n(r)));var o=y0(n,{range:r,header:1}),u=["~Sh33tJ5~"];o.forEach(function(W){return W.forEach(function(K){typeof K=="string"&&u.push(K)})});var f={},h=[],m=Vt.read(e.numbers,{type:"base64"});m.FileIndex.map(function(W,K){return[W,m.FullPaths[K]]}).forEach(function(W){var K=W[0],Z=W[1];if(K.type==2&&K.name.match(/\.iwa/)){var ce=K.content,Le=hi(ce),Fe=fi(Le);Fe.forEach(function(Be){h.push(Be.id),f[Be.id]={deps:[],location:Z,type:Vl(Be.messages[0].meta[1][0].data)}})}}),h.sort(function(W,K){return W-K});var g=h.filter(function(W){return W>1}).map(function(W){return[W,Nt(W)]});m.FileIndex.map(function(W,K){return[W,m.FullPaths[K]]}).forEach(function(W){var K=W[0];if(W[1],!!K.name.match(/\.iwa/)){var Z=fi(hi(K.content));Z.forEach(function(ce){ce.messages.forEach(function(Le){g.forEach(function(Fe){ce.messages.some(function(Be){return Vl(Be.meta[1][0].data)!=11006&&Ok(Be.data,Fe[1])})&&f[Fe[0]].deps.push(ce.id)})})})}});for(var y=Vt.find(m,f[1].location),_=fi(hi(y.content)),E,w=0;w<_.length;++w){var T=_[w];T.id==1&&(E=T)}var b=us(An(E.messages[0].data)[1][0].data);for(y=Vt.find(m,f[b].location),_=fi(hi(y.content)),w=0;w<_.length;++w)T=_[w],T.id==b&&(E=T);for(b=us(An(E.messages[0].data)[2][0].data),y=Vt.find(m,f[b].location),_=fi(hi(y.content)),w=0;w<_.length;++w)T=_[w],T.id==b&&(E=T);for(b=us(An(E.messages[0].data)[2][0].data),y=Vt.find(m,f[b].location),_=fi(hi(y.content)),w=0;w<_.length;++w)T=_[w],T.id==b&&(E=T);var k=An(E.messages[0].data);{k[6][0].data=Nt(r.e.r+1),k[7][0].data=Nt(r.e.c+1);var q=us(k[46][0].data),X=Vt.find(m,f[q].location),ee=fi(hi(X.content));{for(var he=0;he<ee.length&&ee[he].id!=q;++he);if(ee[he].id!=q)throw"Bad ColumnRowUIDMapArchive";var Ae=An(ee[he].messages[0].data);Ae[1]=[],Ae[2]=[],Ae[3]=[];for(var N=0;N<=r.e.c;++N){var I=[];I[1]=I[2]=[{type:0,data:Nt(N+420690)}],Ae[1].push({type:2,data:Un(I)}),Ae[2].push({type:0,data:Nt(N)}),Ae[3].push({type:0,data:Nt(N)})}Ae[4]=[],Ae[5]=[],Ae[6]=[];for(var R=0;R<=r.e.r;++R)I=[],I[1]=I[2]=[{type:0,data:Nt(R+726270)}],Ae[4].push({type:2,data:Un(I)}),Ae[5].push({type:0,data:Nt(R)}),Ae[6].push({type:0,data:Nt(R)});ee[he].messages[0].data=Un(Ae)}X.content=Al(wl(ee)),X.size=X.content.length,delete k[46];var M=An(k[4][0].data);{M[7][0].data=Nt(r.e.r+1);var B=An(M[1][0].data),H=us(B[2][0].data);X=Vt.find(m,f[H].location),ee=fi(hi(X.content));{if(ee[0].id!=H)throw"Bad HeaderStorageBucket";var V=An(ee[0].messages[0].data);for(R=0;R<o.length;++R){var Je=An(V[2][0].data);Je[1][0].data=Nt(R),Je[4][0].data=Nt(o[R].length),V[2][R]={type:V[2][0].type,data:Un(Je)}}ee[0].messages[0].data=Un(V)}X.content=Al(wl(ee)),X.size=X.content.length;var He=us(M[2][0].data);X=Vt.find(m,f[He].location),ee=fi(hi(X.content));{if(ee[0].id!=He)throw"Bad HeaderStorageBucket";for(V=An(ee[0].messages[0].data),N=0;N<=r.e.c;++N)Je=An(V[2][0].data),Je[1][0].data=Nt(N),Je[4][0].data=Nt(r.e.r+1),V[2][N]={type:V[2][0].type,data:Un(Je)};ee[0].messages[0].data=Un(V)}X.content=Al(wl(ee)),X.size=X.content.length;var de=us(M[4][0].data);(function(){for(var W=Vt.find(m,f[de].location),K=fi(hi(W.content)),Z,ce=0;ce<K.length;++ce){var Le=K[ce];Le.id==de&&(Z=Le)}var Fe=An(Z.messages[0].data);{Fe[3]=[];var Be=[];u.forEach(function(nt,Wt){Be[1]=[{type:0,data:Nt(Wt)}],Be[2]=[{type:0,data:Nt(1)}],Be[3]=[{type:2,data:Dk(nt)}],Fe[3].push({type:2,data:Un(Be)})})}Z.messages[0].data=Un(Fe);var Me=wl(K),ut=Al(Me);W.content=ut,W.size=W.content.length})();var Re=An(M[3][0].data);{var ze=Re[1][0];delete Re[2];var Ye=An(ze.data);{var Q=us(Ye[2][0].data);(function(){for(var W=Vt.find(m,f[Q].location),K=fi(hi(W.content)),Z,ce=0;ce<K.length;++ce){var Le=K[ce];Le.id==Q&&(Z=Le)}var Fe=An(Z.messages[0].data);{delete Fe[6],delete Re[7];var Be=new Uint8Array(Fe[5][0].data);Fe[5]=[];for(var Me=0,ut=0;ut<=r.e.r;++ut){var nt=An(Be);Me+=Pk(nt,o[ut],u),nt[1][0].data=Nt(ut),Fe[5].push({data:Un(nt),type:2})}Fe[1]=[{type:0,data:Nt(r.e.c+1)}],Fe[2]=[{type:0,data:Nt(r.e.r+1)}],Fe[3]=[{type:0,data:Nt(Me)}],Fe[4]=[{type:0,data:Nt(r.e.r+1)}]}Z.messages[0].data=Un(Fe);var Wt=wl(K),ot=Al(Wt);W.content=ot,W.size=W.content.length})()}ze.data=Un(Ye)}M[3][0].data=Un(Re)}k[4][0].data=Un(M)}E.messages[0].data=Un(k);var xe=wl(_),U=Al(xe);return y.content=U,y.size=y.content.length,m}function Lk(t){return function(n){for(var r=0;r!=t.length;++r){var a=t[r];n[a[0]]===void 0&&(n[a[0]]=a[1]),a[2]==="n"&&(n[a[0]]=Number(n[a[0]]))}}}function T1(t){Lk([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function Vk(t,e){return e.bookType=="ods"?vS(t,e):e.bookType=="numbers"?kk(t,e):e.bookType=="xlsb"?Bk(t,e):Uk(t,e)}function Bk(t,e){Nl=1024,t&&!t.SSF&&(t.SSF=br(nn)),t&&t.SSF&&(G0(),H0(t.SSF),e.revssf=q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ac?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n=e.bookType=="xlsb"?"bin":"xml",r=JA.indexOf(e.bookType)>-1,a=CA();T1(e=e||{});var o=s1(),u="",f=0;if(e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",it(o,u,OA(t.Props,e)),a.coreprops.push(u),Dt(e.rels,2,u,wt.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],m=0;m<t.SheetNames.length;++m)(t.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(t.SheetNames[m]);t.Props.SheetNames=h}for(t.Props.Worksheets=t.Props.SheetNames.length,it(o,u,MA(t.Props)),a.extprops.push(u),Dt(e.rels,3,u,wt.EXT_PROPS),t.Custprops!==t.Props&&Yn(t.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,PA(t.Custprops)),a.custprops.push(u),Dt(e.rels,4,u,wt.CUST_PROPS)),f=1;f<=t.SheetNames.length;++f){var g={"!id":{}},y=t.Sheets[t.SheetNames[f-1]],_=(y||{})["!type"]||"sheet";switch(_){case"chart":default:u="xl/worksheets/sheet"+f+"."+n,it(o,u,zP(f-1,u,e,t,g)),a.sheets.push(u),Dt(e.wbrels,-1,"worksheets/sheet"+f+"."+n,wt.WS[0])}if(y){var E=y["!comments"],w=!1,T="";E&&E.length>0&&(T="xl/comments"+f+"."+n,it(o,T,qP(E,T)),a.comments.push(T),Dt(g,-1,"../comments"+f+"."+n,wt.CMNT),w=!0),y["!legacy"]&&w&&it(o,"xl/drawings/vmlDrawing"+f+".vml",QA(f,y["!comments"])),delete y["!comments"],delete y["!legacy"]}g["!id"].rId1&&it(o,NA(u),kl(g))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+n,it(o,u,GP(e.Strings,u,e)),a.strs.push(u),Dt(e.wbrels,-1,"sharedStrings."+n,wt.SST)),u="xl/workbook."+n,it(o,u,jP(t,u)),a.workbooks.push(u),Dt(e.rels,1,u,wt.WB),u="xl/theme/theme1.xml",it(o,u,WA(t.Themes,e)),a.themes.push(u),Dt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),u="xl/styles."+n,it(o,u,HP(t,u,e)),a.styles.push(u),Dt(e.wbrels,-1,"styles."+n,wt.STY),t.vbaraw&&r&&(u="xl/vbaProject.bin",it(o,u,t.vbaraw),a.vba.push(u),Dt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),u="xl/metadata."+n,it(o,u,$P(u)),a.metadata.push(u),Dt(e.wbrels,-1,"metadata."+n,wt.XLMETA),it(o,"[Content_Types].xml",IA(a,e)),it(o,"_rels/.rels",kl(e.rels)),it(o,"xl/_rels/workbook."+n+".rels",kl(e.wbrels)),delete e.revssf,delete e.ssf,o}function Uk(t,e){Nl=1024,t&&!t.SSF&&(t.SSF=br(nn)),t&&t.SSF&&(G0(),H0(t.SSF),e.revssf=q0(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ac?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var n="xml",r=JA.indexOf(e.bookType)>-1,a=CA();T1(e=e||{});var o=s1(),u="",f=0;if(e.cellXfs=[],Ms(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),u="docProps/core.xml",it(o,u,OA(t.Props,e)),a.coreprops.push(u),Dt(e.rels,2,u,wt.CORE_PROPS),u="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var h=[],m=0;m<t.SheetNames.length;++m)(t.Workbook.Sheets[m]||{}).Hidden!=2&&h.push(t.SheetNames[m]);t.Props.SheetNames=h}t.Props.Worksheets=t.Props.SheetNames.length,it(o,u,MA(t.Props)),a.extprops.push(u),Dt(e.rels,3,u,wt.EXT_PROPS),t.Custprops!==t.Props&&Yn(t.Custprops||{}).length>0&&(u="docProps/custom.xml",it(o,u,PA(t.Custprops)),a.custprops.push(u),Dt(e.rels,4,u,wt.CUST_PROPS));var g=["SheetJ5"];for(e.tcid=0,f=1;f<=t.SheetNames.length;++f){var y={"!id":{}},_=t.Sheets[t.SheetNames[f-1]],E=(_||{})["!type"]||"sheet";switch(E){case"chart":default:u="xl/worksheets/sheet"+f+"."+n,it(o,u,lS(f-1,e,t,y)),a.sheets.push(u),Dt(e.wbrels,-1,"worksheets/sheet"+f+"."+n,wt.WS[0])}if(_){var w=_["!comments"],T=!1,b="";if(w&&w.length>0){var k=!1;w.forEach(function(q){q[1].forEach(function(X){X.T==!0&&(k=!0)})}),k&&(b="xl/threadedComments/threadedComment"+f+"."+n,it(o,b,vF(w,g,e)),a.threadedcomments.push(b),Dt(y,-1,"../threadedComments/threadedComment"+f+"."+n,wt.TCMNT)),b="xl/comments"+f+"."+n,it(o,b,ZA(w)),a.comments.push(b),Dt(y,-1,"../comments"+f+"."+n,wt.CMNT),T=!0}_["!legacy"]&&T&&it(o,"xl/drawings/vmlDrawing"+f+".vml",QA(f,_["!comments"])),delete _["!comments"],delete _["!legacy"]}y["!id"].rId1&&it(o,NA(u),kl(y))}return e.Strings!=null&&e.Strings.length>0&&(u="xl/sharedStrings."+n,it(o,u,HA(e.Strings,e)),a.strs.push(u),Dt(e.wbrels,-1,"sharedStrings."+n,wt.SST)),u="xl/workbook."+n,it(o,u,fS(t)),a.workbooks.push(u),Dt(e.rels,1,u,wt.WB),u="xl/theme/theme1.xml",it(o,u,WA(t.Themes,e)),a.themes.push(u),Dt(e.wbrels,-1,"theme/theme1.xml",wt.THEME),u="xl/styles."+n,it(o,u,XA(t,e)),a.styles.push(u),Dt(e.wbrels,-1,"styles."+n,wt.STY),t.vbaraw&&r&&(u="xl/vbaProject.bin",it(o,u,t.vbaraw),a.vba.push(u),Dt(e.wbrels,-1,"vbaProject.bin",wt.VBA)),u="xl/metadata."+n,it(o,u,KA()),a.metadata.push(u),Dt(e.wbrels,-1,"metadata."+n,wt.XLMETA),g.length>1&&(u="xl/persons/person.xml",it(o,u,_F(g)),a.people.push(u),Dt(e.wbrels,-1,"persons/person.xml",wt.PEOPLE)),it(o,"[Content_Types].xml",IA(a,e)),it(o,"_rels/.rels",kl(e.rels)),it(o,"xl/_rels/workbook."+n+".rels",kl(e.wbrels)),delete e.revssf,delete e.ssf,o}function jk(t,e){var n="";switch((e||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":n=Da(t.slice(0,12));break;case"binary":n=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function _S(t,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return Jc(e.file,Vt.write(t,{type:St?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Vt.write(t,e)}function zk(t,e){var n=br(e||{}),r=Vk(t,n);return Hk(r,n)}function Hk(t,e){var n={},r=St?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(n.compression="DEFLATE"),e.password)n.type=r;else switch(e.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+e.type)}var a=t.FullPaths?Vt.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!e.compression}):t.generate(n);if(typeof Deno<"u"&&typeof a=="string"){if(e.type=="binary"||e.type=="base64")return a;a=new Uint8Array(z0(a))}return e.password&&typeof encrypt_agile<"u"?_S(encrypt_agile(a,e.password),e):e.type==="file"?Jc(e.file,a):e.type=="string"?xc(a):a}function Gk(t,e){var n=e||{},r=sk(t,n);return _S(r,n)}function Ui(t,e,n){n||(n="");var r=n+t;switch(e.type){case"base64":return kc(Vc(r));case"binary":return Vc(r);case"string":return t;case"file":return Jc(e.file,r,"utf8");case"buffer":return St?Ma(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ui(r,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function qk(t,e){switch(e.type){case"base64":return kc(t);case"binary":return t;case"string":return t;case"file":return Jc(e.file,t,"binary");case"buffer":return St?Ma(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Fh(t,e){switch(e.type){case"string":case"base64":case"binary":for(var n="",r=0;r<t.length;++r)n+=String.fromCharCode(t[r]);return e.type=="base64"?kc(n):e.type=="string"?xc(n):n;case"file":return Jc(e.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+e.type)}}function yS(t,e){yO(),NP(t);var n=br(e||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=yS(t,n);return n.type="array",z0(r)}var a=0;if(n.sheet&&(typeof n.sheet=="number"?a=n.sheet:a=t.SheetNames.indexOf(n.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Ui(ik(t,n),n);case"slk":case"sylk":return Ui(R5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"htm":case"html":return Ui(mS(t.Sheets[t.SheetNames[a]],n),n);case"txt":return qk(xS(t.Sheets[t.SheetNames[a]],n),n);case"csv":return Ui(A1(t.Sheets[t.SheetNames[a]],n),n,"\uFEFF");case"dif":return Ui(C5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"dbf":return Fh(b5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"prn":return Ui(I5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"rtf":return Ui(k5.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"eth":return Ui(zA.from_sheet(t.Sheets[t.SheetNames[a]],n),n);case"fods":return Ui(vS(t,n),n);case"wk1":return Fh(rE.sheet_to_wk1(t.Sheets[t.SheetNames[a]],n),n);case"wk3":return Fh(rE.book_to_wk3(t,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),Fh(dS(t,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),Gk(t,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return zk(t,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function $k(t){if(!t.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(t.bookType=n.slice(1)),t.bookType=e[t.bookType]||t.bookType}}function w1(t,e,n){var r={};return r.type="file",r.file=e,$k(r),yS(t,r)}function Xk(t,e,n,r,a,o,u,f){var h=$n(n),m=f.defval,g=f.raw||!Object.prototype.hasOwnProperty.call(f,"raw"),y=!0,_=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:n,enumerable:!1})}catch{_.__rowNum__=n}else _.__rowNum__=n;if(!u||t[n])for(var E=e.s.c;E<=e.e.c;++E){var w=u?t[n][E]:t[r[E]+h];if(w===void 0||w.t===void 0){if(m===void 0)continue;o[E]!=null&&(_[o[E]]=m);continue}var T=w.v;switch(w.t){case"z":if(T==null)break;continue;case"e":T=T==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+w.t)}if(o[E]!=null){if(T==null)if(w.t=="e"&&T===null)_[o[E]]=null;else if(m!==void 0)_[o[E]]=m;else if(g&&T===null)_[o[E]]=null;else continue;else _[o[E]]=g&&(w.t!=="n"||w.t==="n"&&f.rawNumbers!==!1)?T:Oa(w,T,f);T!=null&&(y=!1)}}return{row:_,isempty:y}}function y0(t,e){if(t==null||t["!ref"]==null)return[];var n={t:"n",v:0},r=0,a=1,o=[],u=0,f="",h={s:{r:0,c:0},e:{r:0,c:0}},m=e||{},g=m.range!=null?m.range:t["!ref"];switch(m.header===1?r=1:m.header==="A"?r=2:Array.isArray(m.header)?r=3:m.header==null&&(r=0),typeof g){case"string":h=$t(g);break;case"number":h=$t(t["!ref"]),h.s.r=g;break;default:h=g}r>0&&(a=0);var y=$n(h.s.r),_=[],E=[],w=0,T=0,b=Array.isArray(t),k=h.s.r,q=0,X={};b&&!t[k]&&(t[k]=[]);var ee=m.skipHidden&&t["!cols"]||[],he=m.skipHidden&&t["!rows"]||[];for(q=h.s.c;q<=h.e.c;++q)if(!(ee[q]||{}).hidden)switch(_[q]=nr(q),n=b?t[k][q]:t[_[q]+y],r){case 1:o[q]=q-h.s.c;break;case 2:o[q]=_[q];break;case 3:o[q]=m.header[q-h.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),f=u=Oa(n,null,m),T=X[u]||0,!T)X[u]=1;else{do f=u+"_"+T++;while(X[f]);X[u]=T,X[f]=1}o[q]=f}for(k=h.s.r+a;k<=h.e.r;++k)if(!(he[k]||{}).hidden){var Ae=Xk(t,h,k,_,r,o,b,m);(Ae.isempty===!1||(r===1?m.blankrows!==!1:m.blankrows))&&(E[w++]=Ae.row)}return E.length=w,E}var fE=/"/g;function Yk(t,e,n,r,a,o,u,f){for(var h=!0,m=[],g="",y=$n(n),_=e.s.c;_<=e.e.c;++_)if(r[_]){var E=f.dense?(t[n]||[])[_]:t[r[_]+y];if(E==null)g="";else if(E.v!=null){h=!1,g=""+(f.rawNumbers&&E.t=="n"?E.v:Oa(E,null,f));for(var w=0,T=0;w!==g.length;++w)if((T=g.charCodeAt(w))===a||T===o||T===34||f.forceQuotes){g='"'+g.replace(fE,'""')+'"';break}g=="ID"&&(g='"ID"')}else E.f!=null&&!E.F?(h=!1,g="="+E.f,g.indexOf(",")>=0&&(g='"'+g.replace(fE,'""')+'"')):g="";m.push(g)}return f.blankrows===!1&&h?null:m.join(u)}function A1(t,e){var n=[],r=e??{};if(t==null||t["!ref"]==null)return"";var a=$t(t["!ref"]),o=r.FS!==void 0?r.FS:",",u=o.charCodeAt(0),f=r.RS!==void 0?r.RS:`
`,h=f.charCodeAt(0),m=new RegExp((o=="|"?"\\|":o)+"+$"),g="",y=[];r.dense=Array.isArray(t);for(var _=r.skipHidden&&t["!cols"]||[],E=r.skipHidden&&t["!rows"]||[],w=a.s.c;w<=a.e.c;++w)(_[w]||{}).hidden||(y[w]=nr(w));for(var T=0,b=a.s.r;b<=a.e.r;++b)(E[b]||{}).hidden||(g=Yk(t,a,b,y,u,h,o,r),g!=null&&(r.strip&&(g=g.replace(m,"")),(g||r.blankrows!==!1)&&n.push((T++?f:"")+g)));return delete r.dense,n.join("")}function xS(t,e){e||(e={}),e.FS="	",e.RS=`
`;var n=A1(t,e);return n}function Wk(t){var e="",n,r="";if(t==null||t["!ref"]==null)return[];var a=$t(t["!ref"]),o="",u=[],f,h=[],m=Array.isArray(t);for(f=a.s.c;f<=a.e.c;++f)u[f]=nr(f);for(var g=a.s.r;g<=a.e.r;++g)for(o=$n(g),f=a.s.c;f<=a.e.c;++f)if(e=u[f]+o,n=m?(t[g]||[])[f]:t[e],r="",n!==void 0){if(n.F!=null){if(e=n.F,!n.f)continue;r=n.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}h[h.length]=e+"="+r}return h}function ES(t,e,n){var r=n||{},a=+!r.skipHeader,o=t||{},u=0,f=0;if(o&&r.origin!=null)if(typeof r.origin=="number")u=r.origin;else{var h=typeof r.origin=="string"?Mn(r.origin):r.origin;u=h.r,f=h.c}var m,g={s:{c:0,r:0},e:{c:f,r:u+e.length-1+a}};if(o["!ref"]){var y=$t(o["!ref"]);g.e.c=Math.max(g.e.c,y.e.c),g.e.r=Math.max(g.e.r,y.e.r),u==-1&&(u=y.e.r+1,g.e.r=u+e.length-1+a)}else u==-1&&(u=0,g.e.r=e.length-1+a);var _=r.header||[],E=0;e.forEach(function(T,b){Yn(T).forEach(function(k){(E=_.indexOf(k))==-1&&(_[E=_.length]=k);var q=T[k],X="z",ee="",he=Ft({c:f+E,r:u+b+a});m=jc(o,he),q&&typeof q=="object"&&!(q instanceof Date)?o[he]=q:(typeof q=="number"?X="n":typeof q=="boolean"?X="b":typeof q=="string"?X="s":q instanceof Date?(X="d",r.cellDates||(X="n",q=Sr(q)),ee=r.dateNF||nn[14]):q===null&&r.nullError&&(X="e",q=0),m?(m.t=X,m.v=q,delete m.w,delete m.R,ee&&(m.z=ee)):o[he]=m={t:X,v:q},ee&&(m.z=ee))})}),g.e.c=Math.max(g.e.c,f+_.length-1);var w=$n(u);if(a)for(E=0;E<_.length;++E)o[nr(E+f)+w]={t:"s",v:_[E]};return o["!ref"]=_n(g),o}function Kk(t,e){return ES(null,t,e)}function jc(t,e,n){if(typeof e=="string"){if(Array.isArray(t)){var r=Mn(e);return t[r.r]||(t[r.r]=[]),t[r.r][r.c]||(t[r.r][r.c]={t:"z"})}return t[e]||(t[e]={t:"z"})}return typeof e!="number"?jc(t,Ft(e)):jc(t,Ft({r:e,c:n||0}))}function Qk(t,e){if(typeof e=="number"){if(e>=0&&t.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var n=t.SheetNames.indexOf(e);if(n>-1)return n;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function Zk(){return{SheetNames:[],Sheets:{}}}function Jk(t,e,n,r){var a=1;if(!n)for(;a<=65535&&t.SheetNames.indexOf(n="Sheet"+a)!=-1;++a,n=void 0);if(!n||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&t.SheetNames.indexOf(n)>=0){var o=n.match(/(^.*?)(\d+)$/);a=o&&+o[2]||0;var u=o&&o[1]||n;for(++a;a<=65535&&t.SheetNames.indexOf(n=u+a)!=-1;++a);}if(cS(n),t.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return t.SheetNames.push(n),t.Sheets[n]=e,n}function eL(t,e,n){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var r=Qk(t,e);switch(t.Workbook.Sheets[r]||(t.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}t.Workbook.Sheets[r].Hidden=n}function tL(t,e){return t.z=e,t}function TS(t,e,n){return e?(t.l={Target:e},n&&(t.l.Tooltip=n)):delete t.l,t}function nL(t,e,n){return TS(t,"#"+e,n)}function rL(t,e,n){t.c||(t.c=[]),t.c.push({t:e,a:n||"SheetJS"})}function iL(t,e,n,r){for(var a=typeof e!="string"?e:$t(e),o=typeof e=="string"?e:_n(e),u=a.s.r;u<=a.e.r;++u)for(var f=a.s.c;f<=a.e.c;++f){var h=jc(t,u,f);h.t="n",h.F=o,delete h.v,u==a.s.r&&f==a.s.c&&(h.f=n,r&&(h.D=!0))}return t}var un={encode_col:nr,encode_row:$n,encode_cell:Ft,encode_range:_n,decode_col:h1,decode_row:f1,split_cell:y8,decode_cell:Mn,decode_range:Ur,format_cell:Oa,sheet_add_aoa:TA,sheet_add_json:ES,sheet_add_dom:pS,aoa_to_sheet:nu,json_to_sheet:Kk,table_to_sheet:gS,table_to_book:Ck,sheet_to_csv:A1,sheet_to_txt:xS,sheet_to_json:y0,sheet_to_html:mS,sheet_to_formulae:Wk,sheet_to_row_object_array:y0,sheet_get_cell:jc,book_new:Zk,book_append_sheet:Jk,book_set_sheet_visibility:eL,cell_set_number_format:tL,cell_set_hyperlink:TS,cell_set_internal_link:nL,cell_add_comment:rL,sheet_set_array_formula:iL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const aL=async t=>{try{const e=t.invoiceNumber||`temp${Math.random().toString(10).substring(2,10)}`,n=$l(_s,"invoices",e);(await gw(n)).exists()?(await Mc(n,t,{merge:!0}),alert("Invoice updated in Firebase!")):(await Mc(n,t),alert("Invoice saved to Firebase!"))}catch(e){console.error("Error saving invoice:",e),alert("Error saving invoice. Please try again.")}},sL=()=>{const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"If any work is extended on site, the additional amount will be added during the final completion and may be collected before the site is handed over.",items:[{sno:1,name:"",quantity:1,price:0,total:0}]}),{invoiceId:n}=Pb();ve.useEffect(()=>{(async()=>{const y=$l(_s,"invoices",n),_=await gw(y);_.exists()&&e(_.data())})()},[]);const r=()=>t.items.reduce((g,y)=>g+y.total,0),a=async()=>{try{if(t.invoiceNumber&&t.clientName){const y=t.invoiceNumber||`temp${Math.random().toString(10).substring(2,10)}`,_=$l(_s,"invoices",y);await Mc(_,t),console.log("Current invoice saved to Firebase")}const g={...t,invoiceNumber:"",date:new Date().toISOString().split("T")[0]};e(g),alert("Invoice copied! You can now edit the new invoice and assign a new invoice number.")}catch(g){console.error("Error copying invoice:",g),alert("Error copying invoice. Please try again.")}},o=()=>{try{const g=un.book_new(),y=r(),_=t.items.map(ee=>({"S.No":ee.sno,Description:ee.name,Quantity:ee.quantity,"Price ()":ee.price,"Total ()":ee.total}));_.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":y});const E=un.json_to_sheet(_);un.book_append_sheet(g,E,"Items");const w=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${y.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],T=un.aoa_to_sheet(w);un.book_append_sheet(g,T,"Invoice Info");const b=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${y.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(ee=>[ee.name,`${ee.quantity}  ${ee.price} = ${ee.total}`])],k=un.aoa_to_sheet(b);un.book_append_sheet(g,k,"Summary");const q=new Date().toISOString().slice(0,10),X=`Invoice_${t.invoiceNumber||"Data"}_${q}.xlsx`;w1(g,X),alert(`Excel file exported successfully: ${X}`)}catch(g){console.error("Error exporting to Excel:",g),alert("Error exporting to Excel. Please try again.")}},u=(g,y,_)=>{const E=[...t.items];E[g][y]=_,(y==="quantity"||y==="price")&&(E[g].total=E[g].quantity*E[g].price),e({...t,items:E})},f=()=>{const g={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,g]})},h=g=>{const _=t.items.filter((E,w)=>w!==g).map((E,w)=>({...E,sno:w+1}));e({...t,items:_})},m=()=>{const g=r(),y=Xl(Math.floor(g)),_=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
		  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
			.logo-container { width: 150px; height: 100px; margin: 0 auto 10px; display: flex; align-items: center; justify-content: center; }
            .logo { width: 150px; height: 100px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div class="logo-container">
              <img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" class="logo" alt="Dynamic Range Architects logo" />
            </div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Bill To:</h3>
              <strong>${t.clientName}</strong><br>
              ${t.clientAddress.replace(/\n/g,"<br>")}
			  <strong>Client GST:</strong> ${t.clientGST}
            </div>
            <div class="invoice-info">
              <h3>Invoice Details:</h3>
              <strong>Invoice #:</strong> ${t.invoiceNumber}<br>
              <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
			  <strong>PAN Number:</strong> ${t.panNumber}
            </div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(w=>`
                <tr>
                  <td class="number">${w.sno}</td>
                  <td>${w.name}</td>
                  <td class="number">${w.quantity}</td>
                  <td class="number">${w.price.toFixed(2)}</td>
                  <td class="number">${w.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${g.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${y} Rupees Only
          </div>

		  <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
 		   <strong>Note:</strong> ${t.note}
		  </div>

		<div style="margin-top: 60px; display: flex; justify-content: space-between;">
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Architect Signature
			</div>
		</div>
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Client Signature
			</div>
		</div>
		</div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,E=window.open("","_blank");E.document.write(_),E.document.close(),E.print()};return P.jsxs(P.Fragment,{children:[P.jsx(j0,{}),P.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[P.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[P.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:P.jsx("img",{src:sg,className:"logo",alt:"Dynamic Range Architects logo"})}),P.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),P.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Invoice Details"}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number"}),P.jsx("input",{type:"text",value:t.invoiceNumber,onChange:g=>e({...t,invoiceNumber:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"INV-001"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),P.jsx("input",{type:"date",value:t.date,onChange:g=>e({...t,date:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Number"}),P.jsx("input",{type:"text",value:t.panNumber,onChange:g=>e({...t,panNumber:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Client Information"}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),P.jsx("input",{type:"text",value:t.clientName,onChange:g=>e({...t,clientName:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client Name"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Address"}),P.jsx("textarea",{value:t.clientAddress,onChange:g=>e({...t,clientAddress:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"Client Address"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client GST"}),P.jsx("input",{type:"text",value:t.clientGST,onChange:g=>e({...t,clientGST:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client GST"})]})]})]})]}),P.jsxs("div",{className:"mb-8",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),P.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[P.jsx(ag,{size:16}),"Add Item"]})]}),P.jsx("div",{className:"overflow-x-auto",children:P.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[P.jsx("thead",{children:P.jsxs("tr",{className:"bg-yellow-600 text-white",children:[P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),P.jsx("tbody",{children:t.items.map((g,y)=>P.jsxs("tr",{className:"hover:bg-gray-50",children:[P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:g.sno}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"text",value:g.name,onChange:_=>u(y,"name",_.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:g.quantity,onChange:_=>u(y,"quantity",parseInt(_.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:g.price,onChange:_=>u(y,"price",parseFloat(_.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),P.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",g.total.toFixed(2)]}),P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&P.jsx("button",{onClick:()=>h(y),className:"text-red-600 hover:text-red-800 transition-colors",children:P.jsx(T0,{size:16})})})]},y))})]})})]}),P.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[P.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),P.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",r().toFixed(2)]})]}),P.jsxs("div",{className:"text-sm text-gray-600",children:[P.jsx("strong",{children:"Amount in Words:"})," ",Xl(Math.floor(r()))," Rupees Only"]}),P.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[" ",P.jsx("strong",{children:"Note:"}),t.note]}),P.jsxs("div",{className:"mb-8",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),P.jsx("textarea",{value:t.note,onChange:g=>e({...t,note:g.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]}),P.jsxs("div",{className:"flex justify-between items-center pt-8",children:[P.jsx("div",{className:"text-center",children:P.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Architect Signature"})}),P.jsx("div",{className:"text-center",children:P.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Client Signature"})})]})]}),P.jsxs("div",{className:"flex justify-center gap-12",children:[P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:m,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[P.jsx(Bl,{size:16}),"Generate PDF Invoice"]})}),P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:async()=>await aL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[P.jsx(ig,{size:16}),"Save Invoice Data"]})}),P.jsx("div",{className:"text-center",children:P.jsxs("button",{onClick:o,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[P.jsx(Bl,{size:16}),"Export to Excel"]})}),P.jsx("div",{className:"text-center",children:P.jsxs("button",{onClick:a,className:"flex items-center gap-2 bg-cyan-700 text-white px-6 py-3 rounded-md hover:bg-cyan-900 transition-colors mx-auto mt-4",children:[P.jsx(k3,{size:16}),"Copy as New Invoice"]})})]})]})]})},oL=({onInvoiceSelect:t})=>{const[e,n]=ve.useState([]),[r,a]=ve.useState(null),[o,u]=ve.useState(""),[f,h]=ve.useState(!1),m=5;ve.useEffect(()=>{g()},[f]);const g=async()=>{let w=l2(i2(_s,"invoices"),u2("date","desc"),c2(m));const T=await d2(w);a(T.docs[T.docs.length-1]),n(T.docs.map(b=>({id:b.id,...b.data()})))},y=async()=>{const w=l2(i2(_s,"invoices"),u2("date","desc"),OD(r),c2(m)),T=await d2(w);T.empty||(a(T.docs[T.docs.length-1]),n(b=>[...b,...T.docs.map(k=>({id:k.id,...k.data()}))]))},_=async w=>{window.confirm("Are you sure you want to delete this invoice?")&&(await LD($l(_s,"invoices",w)),h(T=>!T))},E=e.filter(w=>w.invoiceNumber?.toLowerCase().includes(o.toLowerCase())||w.clientName?.toLowerCase().includes(o.toLowerCase()));return P.jsxs(P.Fragment,{children:[P.jsx(j0,{}),P.jsxs("div",{className:"p-4",children:[P.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Saved Invoices"}),P.jsx("input",{type:"text",placeholder:"Search by invoice or client",value:o,onChange:w=>u(w.target.value),className:"w-full mb-4 p-2 border rounded-md focus:ring-2 focus:ring-yellow-500"}),P.jsx("div",{className:"space-y-3",children:E.length===0?P.jsx("p",{className:"text-gray-500",children:"No invoices found."}):E.map(w=>P.jsxs("div",{className:"flex justify-between items-center p-3 rounded border border-gray-300 hover:bg-gray-100 transition",children:[P.jsxs(Dl,{to:`/invoice/${w.id}`,className:"cursor-pointer flex-1",children:[P.jsx("div",{className:"font-semibold",children:w.invoiceNumber||w.id}),P.jsxs("div",{className:"text-sm text-gray-600",children:[w.clientName,"  ",w.items?.reduce((T,b)=>T+b.total,0).toFixed(2),"  ",w.date]})]}),P.jsx("button",{onClick:()=>_(w.id),className:"text-red-600 hover:text-red-800 ml-2",children:P.jsx(T0,{size:18})})]},w.id))}),e.length>=m&&P.jsx("button",{onClick:y,className:"mt-4 px-4 py-2 bg-gray-200 rounded hover:bg-gray-300",children:"Load More"})]})]})},lL=async t=>{const e=$l(_s,"invoices",t.invoiceNumber||temp+Math.random().toString(10).substring(2,10));await Mc(e,t),alert("Invoice saved to Firebase!")},uL=()=>{const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"If any work is extended on site, the additional amount will be added during the final completion and may be collected before the site is handed over.",items:[{sno:1,name:"",quantity:1,price:0,total:0}]}),n=(h,m,g)=>{const y=[...t.items];y[h][m]=g,(m==="quantity"||m==="price")&&(y[h].total=y[h].quantity*y[h].price),e({...t,items:y})},r=()=>{const h={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,h]})},a=h=>{const g=t.items.filter((y,_)=>_!==h).map((y,_)=>({...y,sno:_+1}));e({...t,items:g})},o=()=>t.items.reduce((h,m)=>h+m.total,0),u=()=>{try{const h=un.book_new(),m=o(),g=t.items.map(q=>({"S.No":q.sno,Description:q.name,Quantity:q.quantity,"Price ()":q.price,"Total ()":q.total}));g.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":m});const y=un.json_to_sheet(g);un.book_append_sheet(h,y,"Items");const _=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${m.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],E=un.aoa_to_sheet(_);un.book_append_sheet(h,E,"Invoice Info");const w=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${m.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(q=>[q.name,`${q.quantity}  ${q.price} = ${q.total}`])],T=un.aoa_to_sheet(w);un.book_append_sheet(h,T,"Summary");const b=new Date().toISOString().slice(0,10),k=`Invoice_${t.invoiceNumber||"Data"}_${b}.xlsx`;w1(h,k),alert(`Excel file exported successfully: ${k}`)}catch(h){console.error("Error exporting to Excel:",h),alert("Error exporting to Excel. Please try again.")}},f=()=>{const h=o(),m=Xl(Math.floor(h)),g=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
		  <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
            .logo { width: 25px; height: 20px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div className="w-25 h-20 mx-auto mb-2 bg-slate-600 rounded-lg flex items-center justify-center">
					<img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" className="logo" alt="Dynamic Range Architects logo" style="width: 150px; height: 80px;"/>
			</div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div class="invoice-details">
            <div class="client-info">
              <h3>Bill To:</h3>
              <strong>${t.clientName}</strong><br>
              ${t.clientAddress.replace(/\n/g,"<br>")}
			  <br><strong>Client GST:</strong> ${t.clientGST}
            </div>
            <div class="invoice-info">
              <h3>Invoice Details:</h3>
              <strong>Invoice #:</strong> ${t.invoiceNumber}<br>
              <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
			  <br><strong>PAN Number:</strong> ${t.panNumber}
            </div>
          </div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(_=>`
                <tr>
                  <td class="number">${_.sno}</td>
                  <td>${_.name}</td>
                  <td class="number">${_.quantity}</td>
                  <td class="number">${_.price.toFixed(2)}</td>
                  <td class="number">${_.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${h.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${m} Rupees Only
          </div>

		  <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
 		   <strong>Note:</strong> ${t.note}
		  </div>

		<div style="margin-top: 60px; display: flex; justify-content: space-between;">
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Architect Signature
			</div>
		</div>
		<div style="text-align: center;">
			<div style="border-top: 1px solid #999; width: 200px; margin: 0 auto; padding-top: 8px;">
			Client Signature
			</div>
		</div>
		</div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,y=window.open("","_blank");y.document.write(g),y.document.close(),y.print()};return P.jsxs(P.Fragment,{children:[P.jsx(j0,{}),P.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[P.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[P.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:P.jsx("img",{src:sg,className:"logo",alt:"Dynamic Range Architects logo"})}),P.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),P.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Invoice Details"}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Invoice Number"}),P.jsx("input",{type:"text",value:t.invoiceNumber,onChange:h=>e({...t,invoiceNumber:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"INV-001"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date"}),P.jsx("input",{type:"date",value:t.date,onChange:h=>e({...t,date:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"PAN Number"}),P.jsx("input",{type:"text",value:t.panNumber,onChange:h=>e({...t,panNumber:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent"})]})]})]}),P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Client Information"}),P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Name"}),P.jsx("input",{type:"text",value:t.clientName,onChange:h=>e({...t,clientName:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client Name"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client Address"}),P.jsx("textarea",{value:t.clientAddress,onChange:h=>e({...t,clientAddress:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"Client Address"})]}),P.jsxs("div",{children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Client GST"}),P.jsx("input",{type:"text",value:t.clientGST,onChange:h=>e({...t,clientGST:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Client GST"})]})]})]})]}),P.jsxs("div",{className:"mb-8",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),P.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[P.jsx(ag,{size:16}),"Add Item"]})]}),P.jsx("div",{className:"overflow-x-auto",children:P.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[P.jsx("thead",{children:P.jsxs("tr",{className:"bg-yellow-600 text-white",children:[P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),P.jsx("tbody",{children:t.items.map((h,m)=>P.jsxs("tr",{className:"hover:bg-gray-50",children:[P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:h.sno}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"text",value:h.name,onChange:g=>n(m,"name",g.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:h.quantity,onChange:g=>n(m,"quantity",parseInt(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:h.price,onChange:g=>n(m,"price",parseFloat(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),P.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",h.total.toFixed(2)]}),P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&P.jsx("button",{onClick:()=>a(m),className:"text-red-600 hover:text-red-800 transition-colors",children:P.jsx(T0,{size:16})})})]},m))})]})})]}),P.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[P.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),P.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",o().toFixed(2)]})]}),P.jsxs("div",{className:"text-sm text-gray-600",children:[P.jsx("strong",{children:"Amount in Words:"})," ",Xl(Math.floor(o()))," Rupees Only"]}),P.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[" ",P.jsx("strong",{children:"Note:"}),t.note]}),P.jsxs("div",{className:"mb-8",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),P.jsx("textarea",{value:t.note,onChange:h=>e({...t,note:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]}),P.jsxs("div",{className:"flex justify-between items-center pt-8",children:[P.jsx("div",{className:"text-center",children:P.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Architect Signature"})}),P.jsx("div",{className:"text-center",children:P.jsx("p",{className:"text-sm text-gray-700 border-t border-gray-400 pt-2 w-48 mx-auto",children:"Client Signature"})})]})]}),P.jsxs("div",{className:"flex justify-center gap-12",children:[P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[P.jsx(Bl,{size:20}),"Generate PDF Invoice"]})}),P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:async()=>await lL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[P.jsx(ig,{size:20}),"Save Invoice Data"]})}),P.jsx("div",{className:"text-center",children:P.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[P.jsx(Bl,{size:20}),"Export to Excel"]})})]})]})]})},cL=async t=>{const e=$l(_s,"invoices",t.invoiceNumber||temp+Math.random().toString(10).substring(2,10));await Mc(e,t),alert("Invoice saved to Firebase!")},fL=()=>{const[t,e]=ve.useState({fromName:"Aaditya Chakravarty",fromAddress:"Regus, Mohali Citi Centre 2, Third Floor, SCO 250251, Airport Road, Mohali  140306",fromPAN:"CJWPC9884M",fromPhone:"9557230546",clientName:"",clientAddress:"",clientGST:"",invoiceNumber:"",date:new Date().toISOString().split("T")[0],bankName:"State Bank Of India",accountName:"Aaditya Chakravarty",accountNumber:"43854002406",ifsc:"SBIN0050502",note:"",items:[{sno:1,name:"",quantity:1,price:0,total:0}]}),n=(h,m,g)=>{const y=[...t.items];y[h][m]=g,(m==="quantity"||m==="price")&&(y[h].total=y[h].quantity*y[h].price),e({...t,items:y})},r=()=>{const h={sno:t.items.length+1,name:"",quantity:1,price:0,total:0};e({...t,items:[...t.items,h]})},a=h=>{const g=t.items.filter((y,_)=>_!==h).map((y,_)=>({...y,sno:_+1}));e({...t,items:g})},o=()=>t.items.reduce((h,m)=>h+m.total,0),u=()=>{try{const h=un.book_new(),m=o(),g=t.items.map(q=>({"S.No":q.sno,Description:q.name,Quantity:q.quantity,"Price ()":q.price,"Total ()":q.total}));g.push({"S.No":"",Description:"",Quantity:"","Price ()":"Grand Total:","Total ()":m});const y=un.json_to_sheet(g);un.book_append_sheet(h,y,"Items");const _=[["Invoice Details",""],["Invoice Number",t.invoiceNumber||"N/A"],["Date",t.date||"N/A"],["PAN Number",t.panNumber||"N/A"],["",""],["Client Information",""],["Client Name",t.clientName||"N/A"],["Client Address",t.clientAddress||"N/A"],["Client GST",t.clientGST||"N/A"],["",""],["Additional Information",""],["Note",t.note||"N/A"],["Grand Total",`${m.toFixed(2)}`],["Total Items",t.items.length],["Export Date",new Date().toLocaleDateString()],["Export Time",new Date().toLocaleTimeString()]],E=un.aoa_to_sheet(_);un.book_append_sheet(h,E,"Invoice Info");const w=[["Summary",""],["Invoice Number",t.invoiceNumber||"N/A"],["Client Name",t.clientName||"N/A"],["Date",t.date||"N/A"],["Total Items",t.items.length],["Grand Total",`${m.toFixed(2)}`],["",""],["Items Breakdown",""],...t.items.map(q=>[q.name,`${q.quantity}  ${q.price} = ${q.total}`])],T=un.aoa_to_sheet(w);un.book_append_sheet(h,T,"Summary");const b=new Date().toISOString().slice(0,10),k=`Invoice_${t.invoiceNumber||"Data"}_${b}.xlsx`;w1(h,k),alert(`Excel file exported successfully: ${k}`)}catch(h){console.error("Error exporting to Excel:",h),alert("Error exporting to Excel. Please try again.")}},f=()=>{const h=o(),m=Xl(Math.floor(h)),g=`
      <html>
        <head>
          <title>Invoice - ${t.invoiceNumber}</title>
          <link rel="icon" type="image/x-icon" href="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png">
          <style>
            body { font-family: Arial, sans-serif; margin: 20px; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #DAA520; padding-bottom: 20px; }
            .logo { width: 25px; height: 20px; margin: 0 auto 10px; }
            .company-name { font-size: 24px; font-weight: bold; color: #DAA520; margin: 5px 0; }
            .company-tagline { font-size: 14px; color: #666; }
            .invoice-details { display: flex; justify-content: space-between; margin-bottom: 30px; }
            .client-info, .invoice-info { flex: 1; }
            .invoice-info { text-align: right; }
            table { width: 100%; border-collapse: collapse; margin-bottom: 20px; }
            th, td { border: 1px solid #ddd; padding: 12px; text-align: left; }
            th { background-color: #DAA520; color: white; font-weight: bold; }
            .number { text-align: right; }
            .total-row { background-color: #f9f9f9; font-weight: bold; }
            .total-section { margin-top: 20px; text-align: right; }
            .grand-total { font-size: 18px; font-weight: bold; color: #DAA520; }
            .amount-words { margin-top: 20px; padding: 15px; background-color: #f5f5f5; border-left: 4px solid #DAA520; }
            .footer { margin-top: 40px; text-align: center; font-size: 12px; color: #666; }
          </style>
        </head>
        <body>
          <div class="header">
           <div className="w-25 h-20 mx-auto mb-2 bg-slate-600 rounded-lg flex items-center justify-center">
                    <img src="https://res.cloudinary.com/dvstorage/image/upload/v1751884378/1000168781-removebg-preview_xjquev.png" className="logo" alt="Dynamic Range Architects logo" style="width: 150px; height: 80px;"/>
            </div>
            <div class="company-name">DYNAMIC RANGE ARCHITECTS</div>
            <div class="company-tagline">Professional Architectural Services</div>
          </div>
          
          <div style="display: flex; justify-content: space-between; margin-top: 30px;">

  <!-- LEFT: FROM -->
  <div style="width: 48%; text-align: left;">
    <h3>From:</h3>
    <strong>${t.fromName}</strong><br>
    Phone: ${t.fromPhone}<br>
    Address: ${t.fromAddress.replace(/\n/g,"<br>")}<br>
    PAN: ${t.fromPAN}
  </div>

  <!-- RIGHT: BILL TO -->
  <div style="width: 48%; text-align: right;">
    <h3>Bill To:</h3>
    <strong>${t.clientName}</strong><br>
    ${t.clientAddress.replace(/\n/g,"<br>")}<br>
    GST: ${t.clientGST}
  </div>

</div>

<!-- INVOICE META -->
<div style="display: flex; justify-content: space-between; margin-top: 20px;">
  <div>
    <strong>Invoice No:</strong> ${t.invoiceNumber}
  </div>
  <div>
    <strong>Date:</strong> ${new Date(t.date).toLocaleDateString()}
  </div>
</div>
          
          <table>
            <thead>
              <tr>
                <th style="width: 8%;">S.No</th>
                <th style="width: 50%;">Description</th>
                <th style="width: 12%;">Quantity</th>
                <th style="width: 15%;">Price</th>
                <th style="width: 15%;">Total</th>
              </tr>
            </thead>
            <tbody>
              ${t.items.map(_=>`
                <tr>
                  <td class="number">${_.sno}</td>
                  <td>${_.name}</td>
                  <td class="number">${_.quantity}</td>
                  <td class="number">${_.price.toFixed(2)}</td>
                  <td class="number">${_.total.toFixed(2)}</td>
                </tr>
              `).join("")}
              <tr class="total-row">
                <td colspan="4" style="text-align: right; font-weight: bold;">Grand Total:</td>
                <td class="number grand-total">${h.toFixed(2)}</td>
              </tr>
            </tbody>
          </table>
          
          <div class="amount-words">
            <strong>Amount in Words:</strong> ${m} Rupees Only
          </div>

          <div style="margin-top: 30px; padding: 15px; border: 1px solid #ddd;">
  <h3 style="margin-bottom: 10px;">Payment Details</h3>
  <p><strong>Bank:</strong> ${t.bankName}</p>
  <p><strong>Account Name:</strong> ${t.accountName}</p>
  <p><strong>Account Number:</strong> ${t.accountNumber}</p>
  <p><strong>IFSC:</strong> ${t.ifsc}</p>
</div>

          <div style="margin-top: 30px; font-style: italic; color: #333; font-size: 14px;">
          <strong></strong> ${t.note}
          </div>

        </div>
          
          <div class="footer">
            <p>Thank you for your business!</p>
            <p>Dynamic Range Architects - Building Dreams, Designing Futures</p>
          </div>
        </body>
      </html>
    `,y=window.open("","_blank");y.document.write(g),y.document.close(),y.print()};return P.jsxs(P.Fragment,{children:[P.jsx(j0,{}),P.jsxs("div",{className:"max-w-6xl mx-auto p-6 bg-white",children:[P.jsxs("div",{className:"text-center mb-8 border-b-2 border-yellow-600 pb-6",children:[P.jsx("div",{className:"w-35 h-20 p-2 mx-auto mb-4 bg-gray-600 rounded-lg flex items-center justify-center",children:P.jsx("img",{src:sg,className:"logo",alt:"Dynamic Range Architects logo"})}),P.jsx("h1",{className:"text-3xl font-bold text-yellow-600 mb-2",children:"DYNAMIC RANGE ARCHITECTS"}),P.jsx("p",{className:"text-gray-600",children:"Professional Architectural Services"})]}),P.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 mb-8",children:[P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-3",children:"From"}),P.jsx("input",{placeholder:"Name",value:t.fromName,onChange:h=>e({...t,fromName:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),P.jsx("input",{placeholder:"Phone Number",value:t.fromPhone,onChange:h=>e({...t,fromPhone:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),P.jsx("textarea",{placeholder:"Address",value:t.fromAddress,onChange:h=>e({...t,fromAddress:h.target.value}),className:"w-full mb-2 p-2 border rounded",rows:2}),P.jsx("input",{placeholder:"PAN Number",value:t.fromPAN,onChange:h=>e({...t,fromPAN:h.target.value}),className:"w-full p-2 border rounded"})]}),P.jsxs("div",{children:[P.jsx("h2",{className:"text-xl font-semibold mb-3",children:"Bill To"}),P.jsx("input",{placeholder:"Client / Company Name",value:t.clientName,onChange:h=>e({...t,clientName:h.target.value}),className:"w-full mb-2 p-2 border rounded"}),P.jsx("textarea",{placeholder:"Client Address",value:t.clientAddress,onChange:h=>e({...t,clientAddress:h.target.value}),className:"w-full mb-2 p-2 border rounded",rows:3}),P.jsx("input",{placeholder:"GST Number",value:t.clientGST,onChange:h=>e({...t,clientGST:h.target.value}),className:"w-full p-2 border rounded"})]})]}),P.jsxs("div",{className:"flex flex-col md:flex-row justify-between mb-8 gap-4",children:[P.jsx("input",{placeholder:"Invoice Number (e.g. DRA-003)",value:t.invoiceNumber,onChange:h=>e({...t,invoiceNumber:h.target.value}),className:"p-2 border rounded w-full md:w-1/3"}),P.jsx("input",{type:"date",value:t.date,onChange:h=>e({...t,date:h.target.value}),className:"p-2 border rounded w-full md:w-1/3"})]}),P.jsxs("div",{className:"flex justify-between mb-6",children:[P.jsxs("p",{children:[P.jsx("strong",{children:"Invoice No:"})," ",t.invoiceNumber]}),P.jsxs("p",{children:[P.jsx("strong",{children:"Date:"})," ",t.date]})]}),P.jsxs("div",{className:"mb-8",children:[P.jsxs("div",{className:"flex justify-between items-center mb-4",children:[P.jsx("h2",{className:"text-xl font-semibold",children:"Invoice Items"}),P.jsxs("button",{onClick:r,className:"flex items-center gap-2 bg-yellow-600 text-white px-4 py-2 rounded-md hover:bg-yellow-700 transition-colors",children:[P.jsx(ag,{size:16}),"Add Item"]})]}),P.jsx("div",{className:"overflow-x-auto",children:P.jsxs("table",{className:"w-full border-collapse border border-gray-300",children:[P.jsx("thead",{children:P.jsxs("tr",{className:"bg-yellow-600 text-white",children:[P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"S.No."}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Description"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Quantity"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Price ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Total ()"}),P.jsx("th",{className:"border border-gray-300 p-3 text-left",children:"Action"})]})}),P.jsx("tbody",{children:t.items.map((h,m)=>P.jsxs("tr",{className:"hover:bg-gray-50",children:[P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:h.sno}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"text",value:h.name,onChange:g=>n(m,"name",g.target.value),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",placeholder:"Item description"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:h.quantity,onChange:g=>n(m,"quantity",parseInt(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"1"})}),P.jsx("td",{className:"border border-gray-300 p-3",children:P.jsx("input",{type:"number",value:h.price,onChange:g=>n(m,"price",parseFloat(g.target.value)||0),className:"w-full p-1 border border-gray-200 rounded focus:ring-2 focus:ring-yellow-500 focus:border-transparent",min:"0",step:"0.01"})}),P.jsxs("td",{className:"border border-gray-300 p-3 text-right font-medium",children:["",h.total.toFixed(2)]}),P.jsx("td",{className:"border border-gray-300 p-3 text-center",children:t.items.length>1&&P.jsx("button",{onClick:()=>a(m),className:"text-red-600 hover:text-red-800 transition-colors",children:P.jsx(T0,{size:16})})})]},m))})]})})]}),P.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mb-8 space-y-4",children:[P.jsxs("div",{className:"flex justify-between items-center mb-2",children:[P.jsx("span",{className:"text-xl font-semibold",children:"Grand Total:"}),P.jsxs("span",{className:"text-2xl font-bold text-yellow-600",children:["",o().toFixed(2)]})]}),P.jsxs("div",{className:"text-sm text-gray-600",children:[P.jsx("strong",{children:"Amount in Words:"})," ",Xl(Math.floor(o()))," Rupees Only"]}),P.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg mt-6",children:[P.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Payment Details"}),P.jsxs("p",{children:[P.jsx("strong",{children:"Bank:"})," ",t.bankName]}),P.jsxs("p",{children:[P.jsx("strong",{children:"Account Name:"})," ",t.accountName]}),P.jsxs("p",{children:[P.jsx("strong",{children:"Account Number:"})," ",t.accountNumber]}),P.jsxs("p",{children:[P.jsx("strong",{children:"IFSC:"})," ",t.ifsc]})]}),P.jsxs("div",{className:"text-sm text-gray-700 italic mt-4",children:[P.jsx("strong",{}),t.note]}),P.jsxs("div",{className:"mb-8",children:[P.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Note (Optional)"}),P.jsx("textarea",{value:t.note,onChange:h=>e({...t,note:h.target.value}),className:"w-full p-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-yellow-500 focus:border-transparent",rows:"3",placeholder:"e.g. Additional charges may apply for extended work on site."})]})]}),P.jsxs("div",{className:"flex justify-center gap-12",children:[P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:f,className:"flex items-center gap-2 bg-green-600 text-white px-6 py-3 rounded-md hover:bg-green-700 transition-colors mx-auto",children:[P.jsx(Bl,{size:20}),"Generate PDF Invoice"]})}),P.jsx("div",{className:"text-center mt-4",children:P.jsxs("button",{onClick:async()=>await cL(t),className:"flex items-center gap-2 bg-blue-600 text-white px-6 py-3 rounded-md hover:bg-blue-700 transition-colors mx-auto",children:[P.jsx(ig,{size:20}),"Save Invoice Data"]})}),P.jsx("div",{className:"text-center",children:P.jsxs("button",{onClick:u,className:"flex items-center gap-2 bg-purple-600 text-white px-6 py-3 rounded-md hover:bg-purple-700 transition-colors mx-auto mt-4",children:[P.jsx(Bl,{size:20}),"Export to Excel"]})})]})]})]})};function hL(){const[t,e]=ve.useState({invoiceNumber:"",date:new Date().toISOString().split("T")[0],panNumber:"CJWPC9884M",clientName:"",clientAddress:"",clientGST:"",note:"",items:[{sno:1,name:"",quantity:1,price:0,total:0}]}),n=async r=>{const a=doc(db,"invoices",r),o=await getDoc(a);o.exists()?e(o.data()):alert("Invoice not found")};return P.jsx(x3,{basename:"/dra-invoice",children:P.jsxs(Kb,{children:[P.jsx(lc,{path:"/invoice/:invoiceId",element:P.jsx(sL,{invoiceData:t,setInvoiceData:e})}),P.jsx(lc,{path:"/create-new-invoice",element:P.jsx(uL,{})}),P.jsx(lc,{path:"/brand-invoice",element:P.jsx(fL,{})}),P.jsx(lc,{path:"/",element:P.jsx(oL,{onInvoiceSelect:n})})]})})}nb.createRoot(document.getElementById("root")).render(P.jsx(ve.StrictMode,{children:P.jsx(hL,{})}));
